define(['exports', 'preact/jsx-runtime', 'preact/hooks', './BaseButton-d2266b25', './ButtonLabelLayout-9cc087dc', './ChevronLeft-b190b987', './ChevronRight-3c1f1b2c', './ChevronUp-fd41f17e', './ChevronDown-1d01f028', './classNames-08d99695', './UNSAFE_ConveyorBelt/themes/ConveyorBeltStyles.css', './useUser-988f7da2', './clientHints-6d361eaa', './ConveyorBeltContext-d8653090', './useTestId-a2e433c2', 'preact/compat', './useComponentTheme-5aa41a8f', './UNSAFE_ConveyorBelt/themes/redwood/ConveyorBeltTheme'], (function(e,t,r,n,o,s,i,c,l,u,f,h,a,d,m,v,g,b){"use strict";function C(){return"phone"===a.getClientHints().deviceRenderMode}function p(e){return"fixed"===getComputedStyle(e).position?null:e.offsetParent}function x(e,t){let r=p(e),n=e.offsetLeft;for(;r&&r!==t&&r!==document.body;)n+=r.offsetLeft,r=p(r);return n}function W(e,t){let r=p(e),n=e.offsetTop;for(;r!==t;)null!=r&&(n+=r.offsetTop,r=p(r));return n}const y=v.forwardRef((({children:e,scrollPosition:a,onScrollPositionChanged:p,arrowVisibility:y="auto",orientation:T="horizontal",testId:B},R=null)=>{const[H,j]=r.useState(!1),[w,E]=r.useState(!1),I=r.useRef(null),L=r.useRef(null),S=r.useRef(null),z=r.useRef(null),N=r.useRef(null),k=r.useRef(null),A=r.useRef(null),V=r.useRef(null),U=r.useRef(null),[$,F]=r.useState(C()&&"auto"===y||"hidden"===y),{direction:P}=h.useUser(),{itemElementsRef:D,addItem:M}=((e,t,n,o,s)=>{const i=r.useRef(),c=r.useRef([]),[l]=r.useState([]),u=r.useCallback((e=>{null!==c.current&&(c.current.push(e),l.push(e))}),[l]);r.useEffect((()=>{if(l&&l.length>0&&e){const r="horizontal"===t?"ltr"===s?`0px ${o?-o.offsetWidth:0}px 0px ${n?-n.offsetWidth:0}px`:`0px ${n?-n.offsetWidth:0}px 0px ${o?-o.offsetWidth:0}px`:`${o?-o.offsetHeight:0}px 0px ${n?-n.offsetHeight:0}px 0px`;i.current=new IntersectionObserver(f,{root:e,rootMargin:r,threshold:1});for(const e of l)null!=e&&i.current.observe(e.element)}return()=>{for(const e of l)i.current&&null!=e&&i.current.unobserve(e.element)}}),[l,l.length,e,o,n,s,t]);const f=e=>{const t=c.current.map(((t,r)=>{const n=e.find((e=>e.target===t.element));return n?{element:n.target,isVisible:n.isIntersecting,isCurrent:t.isCurrent,index:r}:t}));c.current=t};return r.useMemo((()=>({itemElementsRef:c,addItem:u})),[c,u])})(I.current,T,z.current,S.current,P);v.useImperativeHandle(R,(()=>({scrollElementIntoView:e=>{Z(e)},scrollPrevious:()=>{re()},scrollNext:()=>{ne()}})));const q=m.useTestId(B),O="leftArrow"+B,_="rightArrow"+B,{variantClasses:G}=g.useComponentTheme(b.ConveyorBeltRedwoodTheme,{orientation:T}),{variantClasses:J}=g.useComponentTheme(b.ConveyorBeltRedwoodTheme,{content:T}),{variantClasses:K}=g.useComponentTheme(b.ConveyorBeltRedwoodTheme,{pagination:H&&w?"both":H?"next":w?"previous":"none",direction:P,orientation:T,overflow:T,arrowVisibility:!0===$?"hidden":"visible"}),{classes:Q}=g.useComponentTheme(b.ConveyorBeltRedwoodTheme,{nextButton:T,direction:P}),{classes:X}=g.useComponentTheme(b.ConveyorBeltRedwoodTheme,{previousButton:T,direction:P});r.useEffect((()=>{(()=>{const e=L.current?Array.from(L.current.querySelectorAll("[data-oj-conveyorbelt-item]")):[];if(e){let t=-1;D.current=[];for(const r of e)t++,r&&M({element:r,isVisible:!1,index:t,isCurrent:!1})}})()}));const Y=r.useCallback((()=>{p&&p(I.current?.scrollLeft)}),[p]);r.useEffect((()=>{F(C()&&"auto"===y||"hidden"===y)}),[y]),r.useEffect((()=>{I.current&&I.current.scrollTo({left:a})}),[a]),r.useEffect((()=>{const e=I.current,t=k.current,r=A.current;return e&&t&&r&&($||(V.current=new IntersectionObserver((e=>{e.forEach((e=>{"left"===e.target.getAttribute("data-intersection-id")?E(!e.isIntersecting):j(!e.isIntersecting)}))}),{root:e}),V.current.observe(t),V.current.observe(r)),e.addEventListener("scrollend",Y)),()=>{e&&(e.removeEventListener("scrollend",Y),V.current?.unobserve(t),V.current?.unobserve(r))}}),[$,Y]);const Z=r.useCallback((e=>{const t=z.current?z.current.offsetWidth:0,r=S.current?S.current.offsetHeight:0,n=z.current?z.current.offsetWidth:0,o=S.current?S.current.offsetWidth:0,s=((e,s,i)=>{if(!s||!i)return!1;let c,l,u,f;if(i===document.documentElement)c=0,l=document.documentElement.clientWidth,u=0,f=document.documentElement.clientHeight;else{const e=i.getBoundingClientRect();c=w?e.left+t:e.left,l=H?e.right-n:e.right,u=w?e.top+r:e.top,f=H?e.bottom-o:e.bottom}const h=s.getBoundingClientRect();return"horizontal"===e?h.left<=l&&h.right<=l&&h.left>=c&&h.right>=c:h.top<=f&&h.bottom<=f&&h.top>=u&&h.bottom>=u})(T,e,I.current);if(s)return;const i=((e,t,r)=>{if(!t||!r)return!1;const n=t.getBoundingClientRect(),o=r.getBoundingClientRect();let s=o.width,i=o.height;return"horizontal"===e?(s=w&&z.current?s-z.current.offsetWidth:s,s=H&&S.current?s-S.current.offsetWidth:s):(i=w&&z.current?i-z.current.offsetHeight:i,i=H&&S.current?i-S.current.offsetHeight:i),"horizontal"===e?n.width>s:n.height>i})(T,e,I.current);if(!I.current||!L.current)return;const c=((e,t,r,s)=>{if(!r||!s)return!1;let i,c,l;if(s===document.documentElement)c=0,i=document.documentElement.clientWidth,l=document.documentElement.clientHeight;else{const e=s.getBoundingClientRect();i=H?e.right-n:e.right,c=H?e.left-n:e.left,l=H?e.bottom-o:e.bottom}const u=r.getBoundingClientRect();return"horizontal"===t?e?u.right>i:u.left<c:u.bottom>l})("ltr"===P,T,e,I.current);"vertical"!==T?"ltr"===P?c&&!i?I.current.scrollTo({left:x(e,L.current)+e.offsetWidth-I.current.offsetWidth+(S.current?.offsetWidth?S.current?.offsetWidth+1:0),behavior:"smooth"}):I.current.scrollTo({left:x(e,L.current)-(z.current?.offsetWidth?z.current?.offsetWidth+1:0),behavior:"smooth"}):c&&!i?I.current.scrollTo({left:x(e,L.current)-L.current.offsetWidth+I.current.offsetWidth-(S.current?.offsetWidth?S.current?.offsetWidth+1:0),behavior:"smooth"}):I.current.scrollTo({left:x(e,L.current)+e.offsetWidth-L.current.offsetWidth+(z.current?.offsetWidth?z.current?.offsetWidth+1:0),behavior:"smooth"}):c&&!i?I.current.scrollTo({top:W(e,L.current)+e.offsetHeight-I.current.offsetHeight+(S.current?.offsetHeight?S.current?.offsetHeight+1:0),behavior:"smooth"}):I.current.scrollTo({top:W(e,L.current)-(z.current?.offsetHeight?z.current?.offsetHeight+1:0),behavior:"smooth"})}),[H,w,P,T]),ee=r.useCallback((()=>{const e=D.current.find((e=>0==e.isVisible&&e.index>=1&&1==D.current[e.index-1].isVisible));return e?.element}),[D]),te=r.useCallback((()=>{const e=D.current.find((e=>0==e.isVisible&&e.index<D.current.length-1&&1==D.current[e.index+1].isVisible));return e?.element}),[D]),re=r.useCallback((()=>{const e=I.current,t="horizontal"===T?I.current?.clientWidth:I.current?.clientHeight;if(e&&t){const r=te();if("vertical"===T)return void(r?e.scrollTo({top:W(r,L.current)+r.offsetHeight-e.offsetHeight+(z.current?.offsetHeight?z.current?.offsetHeight+1:0),behavior:"smooth"}):e.scrollTo({top:e.scrollTop-t,behavior:"smooth"}));"ltr"===P?r?e.scrollTo({left:x(r,L.current)+r.offsetWidth-e.offsetWidth+(z.current?.offsetWidth?z.current?.offsetWidth+1:0),behavior:"smooth"}):e.scrollTo({left:e.scrollLeft-t,behavior:"smooth"}):r?e.scrollTo({left:x(r,L.current)-(L.current?L.current.offsetWidth:0)+e.offsetWidth-(z.current?.offsetWidth?z.current?.offsetWidth+1:0),behavior:"smooth"}):e.scrollTo({left:e.scrollLeft+t,behavior:"smooth"})}}),[P,T,te]),ne=r.useCallback((()=>{const e=I.current,t="horizontal"===T?I.current?.clientWidth:I.current?.clientHeight;if(e&&t){const r=ee();if("vertical"===T)return void(r?e.scrollTo({top:W(r,L.current)-(S.current?.offsetHeight?S.current?.offsetHeight+1:0),behavior:"smooth"}):e.scrollTo({top:e.scrollTop+t,behavior:"smooth"}));"ltr"===P?r?e.scrollTo({left:(x(r,L.current)??0)-(S.current?.offsetWidth?S.current?.offsetWidth+1:0),behavior:"smooth"}):e.scrollTo({left:e.scrollLeft+t,behavior:"smooth"}):r?e.scrollTo({left:-((L.current?L.current.offsetWidth:0)-(x(r,L.current)??0))+(r?.offsetWidth??0)+(S.current?.offsetWidth?S.current?.offsetWidth+1:0),behavior:"smooth"}):e.scrollTo({left:e.scrollLeft-t,behavior:"smooth"})}}),[P,T,ee]),oe=r.useCallback((e=>{if(U.current!==e){const t=D.current.find((t=>t.element===e)),r=D.current.find((e=>!0===e.isCurrent));if(t===r||!t)return;r&&(r.isCurrent=!1),t.isCurrent=!0,U.current=e,e&&Z(e)}}),[D,Z]),se=r.useCallback((e=>{if(!N.current?.isEqualNode(e.target))if(D.current.length>0){const t=D.current.find((t=>t.element.contains(e.target)));t&&Z(t.element)}else Z(e.target)}),[Z,D]),ie=u.classNames([f.styles.buttonContainer,X]),ce=u.classNames([f.styles.buttonContainer,Q]);return t.jsx(d.ConveyorBeltContext.Provider,{value:{setCurrentItem:oe},children:t.jsxs("div",{onFocus:se,ref:N,className:u.classNames([f.styles.conveyorStyle,G]),...q,children:[w&&!$&&t.jsx("div",{ref:z,class:ie,children:t.jsx(n.BaseButton,{elementDetails:{type:"span",isFocusable:!1},styling:["min"],size:"sm",variant:"ghost",onAction:()=>re(),"aria-hidden":!0,testId:O,children:t.jsx(o.ButtonLabelLayout,{size:"sm",display:"icons",startIcon:"horizontal"===T?"ltr"===P?t.jsx(s.SvgChevronLeft,{}):t.jsx(i.SvgChevronRight,{}):t.jsx(c.SvgChevronUp,{})})})}),t.jsx("div",{className:u.classNames([f.styles.overflowContainer,K]),ref:I,tabIndex:-1,children:t.jsxs("div",{className:u.classNames([f.styles.contentContainer,G,J]),ref:L,children:[t.jsx("div",{"data-intersection-id":"left",ref:k,style:{minWidth:1,minHeight:1}}),e,t.jsx("div",{"data-intersection-id":"right",ref:A,style:{minWidth:1,minHeight:1}})]})}),H&&!$&&t.jsx("div",{ref:S,class:ce,children:t.jsx(n.BaseButton,{elementDetails:{type:"span",isFocusable:!1},styling:["min"],size:"sm",variant:"ghost",onAction:()=>ne(),"aria-hidden":!0,testId:_,children:t.jsx(o.ButtonLabelLayout,{size:"sm",display:"icons",startIcon:"horizontal"===T?"ltr"===P?t.jsx(i.SvgChevronRight,{}):t.jsx(s.SvgChevronLeft,{}):t.jsx(l.SvgChevronDown,{})})})})]})})}));e.ConveyorBelt=y}));
//# sourceMappingURL=ConveyorBelt-9982a911.js.map
