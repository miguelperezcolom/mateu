{"version":3,"file":"CompactHelpSource-103a8263.js","sources":["../../src/UNSAFE_UserAssistance/usePopupFocusWithin.ts","../../src/UNSAFE_UserAssistance/CompactHelpSource.tsx"],"sourcesContent":["import { useCallback, useRef } from 'preact/hooks';\n\nimport { useFocusWithin } from '../hooks/UNSAFE_useFocusWithin';\n\nexport function usePopupFocusWithin() {\n  const ref = useRef<HTMLElement | null>(null);\n  const { focusProps, isFocused } = useFocusWithin();\n\n  const onTransitionEnd = useCallback(\n    (isAfterOpen?: boolean) => {\n      if (isAfterOpen) {\n        if (focusProps.onFocusIn) {\n          ref.current?.addEventListener('focusin', focusProps.onFocusIn, false);\n        }\n        if (focusProps.onFocusOut) {\n          ref.current?.addEventListener('focusout', focusProps.onFocusOut, false);\n        }\n      } else {\n        if (focusProps.onFocusIn) {\n          ref.current?.removeEventListener('focusin', focusProps.onFocusIn, false);\n        }\n        if (focusProps.onFocusOut) {\n          ref.current?.removeEventListener('focusout', focusProps.onFocusOut, false);\n        }\n      }\n    },\n    [focusProps.onFocusIn, focusProps.onFocusOut, ref]\n  );\n\n  return {\n    isFocused,\n    popupProps: {\n      onTransitionEnd,\n      ref\n    }\n  };\n}\n","import { useState, useRef } from 'preact/hooks';\n\nimport { useTabbableMode } from '../hooks/UNSAFE_useTabbableMode';\nimport { useTranslationBundle } from '../hooks/UNSAFE_useTranslationBundle';\nimport { BundleType } from '../resources/nls/bundle';\nimport { classNames } from '../utils/UNSAFE_classNames';\nimport { HelpIcon } from '../PRIVATE_ThemedIcons/HelpIcon';\nimport { Popup } from '../UNSAFE_Popup';\nimport { usePopupFocusWithin } from './usePopupFocusWithin';\nimport {\n  helpIconBase,\n  helpIconLabelEdgeStart,\n  helpContentStyles\n} from './themes/UserAssistanceStyles.css';\nimport { useComponentTheme } from '../hooks/UNSAFE_useComponentTheme';\nimport { LabelRedwoodTheme } from '../UNSAFE_Label/themes/redwood/LabelTheme';\n\ntype Props = {\n  children?: string;\n  id?: string;\n  labelEdge?: 'inside' | 'start' | 'top';\n  source?: string;\n};\n\nexport function CompactHelpSource({ children, id, labelEdge, source }: Props) {\n  const [isOver, setOver] = useState(false);\n  const translations = useTranslationBundle<BundleType>('@oracle/oraclejet-preact');\n  const userAssistance_learnMoreStr = translations.userAssistance_learnMore();\n  const { isTabbable, tabbableModeProps } = useTabbableMode();\n  const flip = { mainAxis: true, crossAxis: false };\n  // TODO: Implement and use a preact Link component instead of using an anchor tag\n  const anchorRef = useRef<HTMLAnchorElement>(null);\n\n  const text = children ?? userAssistance_learnMoreStr;\n\n  // helpIconBase references 'Label' vars, so we need to get the baseTheme for 'Label' and include it in the class list\n  // so that we pick up the definitions for the labelVars we are using.\n  const { baseTheme: labelBaseTheme } = useComponentTheme(LabelRedwoodTheme);\n\n  const styles = classNames([\n    labelBaseTheme,\n    helpIconBase,\n    labelEdge === 'start' && helpIconLabelEdgeStart\n  ]);\n\n  const { isFocused: isPopupFocused, popupProps } = usePopupFocusWithin();\n\n  const isOpen = isOver === true || isPopupFocused === true;\n\n  return (\n    <>\n      <a\n        target=\"_blank\"\n        {...(source && { href: source })}\n        aria-label={text}\n        class={styles}\n        id={id}\n        ref={anchorRef}\n        role=\"link\"\n        onMouseEnter={() => setOver(true)}\n        onMouseLeave={() => setOver(false)}\n        onFocus={() => setOver(true)}\n        onBlur={() => setOver(false)}\n        {...(!isTabbable ? tabbableModeProps : { tabIndex: 0 })}>\n        <HelpIcon />\n      </a>\n      <Popup\n        {...popupProps}\n        placement=\"end-top-corner\"\n        isOpen={isOpen}\n        anchorRef={anchorRef}\n        flipOptions={flip}\n        role=\"tooltip\"\n        maxWidth={'296px'}>\n        <div class={helpContentStyles}>{text}</div>\n      </Popup>\n    </>\n  );\n}\n"],"names":["usePopupFocusWithin","ref","useRef","focusProps","isFocused","useFocusWithin","popupProps","onTransitionEnd","useCallback","isAfterOpen","onFocusIn","current","addEventListener","onFocusOut","removeEventListener","children","id","labelEdge","source","isOver","setOver","useState","userAssistance_learnMoreStr","useTranslationBundle","userAssistance_learnMore","isTabbable","tabbableModeProps","useTabbableMode","anchorRef","text","baseTheme","labelBaseTheme","useComponentTheme","LabelRedwoodTheme","styles","classNames","helpIconBase","helpIconLabelEdgeStart","isPopupFocused","isOpen","_jsxs","jsxs","_Fragment","Fragment","_jsx","target","href","class","role","onMouseEnter","onMouseLeave","onFocus","onBlur","tabIndex","HelpIcon","Popup","placement","flipOptions","mainAxis","crossAxis","maxWidth","helpContentStyles"],"mappings":"+aAIgBA,IACd,MAAMC,EAAMC,SAA2B,OACjCC,WAAEA,EAAUC,UAAEA,GAAcC,EAAcA,iBAuBhD,MAAO,CACLD,YACAE,WAAY,CACVC,gBAxBoBC,eACrBC,IACKA,GACEN,EAAWO,WACbT,EAAIU,SAASC,iBAAiB,UAAWT,EAAWO,WAAW,GAE7DP,EAAWU,YACbZ,EAAIU,SAASC,iBAAiB,WAAYT,EAAWU,YAAY,KAG/DV,EAAWO,WACbT,EAAIU,SAASG,oBAAoB,UAAWX,EAAWO,WAAW,GAEhEP,EAAWU,YACbZ,EAAIU,SAASG,oBAAoB,WAAYX,EAAWU,YAAY,GAEvE,GAEH,CAACV,EAAWO,UAAWP,EAAWU,WAAYZ,IAO5CA,OAGN,qBCZM,UAA4Bc,SAAEA,EAAQC,GAAEA,EAAEC,UAAEA,EAASC,OAAEA,IAC3D,MAAOC,EAAQC,GAAWC,EAAQA,UAAC,GAE7BC,EADeC,uBAAiC,4BACLC,4BAC3CC,WAAEA,EAAUC,kBAAEA,GAAsBC,EAAeA,kBAGnDC,EAAY1B,SAA0B,MAEtC2B,EAAOd,GAAYO,GAIjBQ,UAAWC,GAAmBC,EAAiBA,kBAACC,EAAiBA,mBAEnEC,EAASC,EAAAA,WAAW,CACxBJ,EACAK,EAAYA,aACE,UAAdnB,GAAyBoB,EAAsBA,0BAGzCjC,UAAWkC,EAAchC,WAAEA,GAAeN,IAE5CuC,GAAoB,IAAXpB,IAAsC,IAAnBmB,EAElC,OACEE,EAAAC,KAAAC,EAAAC,SAAA,CAAA5B,SAAA,CACE6B,EAAAA,IACE,IAAA,CAAAC,OAAO,YACF3B,GAAU,CAAE4B,KAAM5B,GAAS,aACpBW,EACZkB,MAAOb,EACPlB,GAAIA,EACJf,IAAK2B,EACLoB,KAAK,OACLC,aAAc,IAAM7B,GAAQ,GAC5B8B,aAAc,IAAM9B,GAAQ,GAC5B+B,QAAS,IAAM/B,GAAQ,GACvBgC,OAAQ,IAAMhC,GAAQ,MAChBK,EAAiC,CAAE4B,SAAU,GAAhC3B,WACnBkB,MAACU,EAAAA,QAAW,CAAA,KAEdV,EAAAA,IAACW,EAAKA,MAAA,IACAjD,EACJkD,UAAU,iBACVjB,OAAQA,EACRX,UAAWA,EACX6B,YA1CO,CAAEC,UAAU,EAAMC,WAAW,GA2CpCX,KAAK,UACLY,SAAU,QAAO7C,SACjB6B,aAAKG,MAAOc,oBAAiB9C,SAAGc,QAIxC"}