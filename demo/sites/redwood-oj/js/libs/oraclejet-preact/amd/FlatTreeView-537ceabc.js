define(['exports', 'preact/jsx-runtime', 'preact/hooks', './mergeProps-bcfa6a92', './collectionUtils-26e6c87c', './LoadMoreCollection-3ac9e69e', './classNames-08d99695', './TabbableModeContext-a9c97640', './useId-c9578d26', './View-5520bcf5', './UNSAFE_FlatTreeView/themes/TreeViewStyles.css', './UNSAFE_FlatTreeView/themes/TreeViewContract.css', './Flex-4bc3a394', './Skeleton-a7e166a0', './useHover-8b8a1496', './clientHints-6d361eaa', './Expander-8209c6c7', './UNSAFE_FlatTreeView/themes/redwood/TreeViewTheme.css', './useSelection-87a6bea9', './useAdditiveSelection-9135c06c', './ReorderableContext-6d10a1b7', './keys-4755c121', './LayerHost-7d4aa6d3', 'preact/compat', './useExpandCollapse-4478c2eb', './useComponentTheme-5aa41a8f', './useUser-988f7da2', './useNavigation-a6a2218f', './Selector-470f114d', './LiveRegion-4b9317e5', './HiddenAccessible-037ef42d', './useTranslationBundle-27bf6340'], (function(e,t,n,a,r,l,i,s,o,d,c,u,x,y,g,m,p,b,v,f,h,E,T,S,C,k,j,w,I,M,L,R){"use strict";function K({children:e,indentation:a=0}){const[r,l]=n.useState(!1);return n.useEffect((()=>{setTimeout((()=>{l(!0)}),50)}),[]),r&&e?t.jsx("div",{role:"presentation",children:t.jsx(d.View,{paddingInlineStart:a,children:[...Array(1)].map(((t,n)=>e(n)))})}):null}function A({indentation:e=0,isLeaf:n=!1}){return t.jsx(d.View,{paddingInlineStart:O(e,!n||void 0),children:t.jsx(d.View,{padding:[0,"4px"],children:t.jsxs(x.Flex,{height:"9x",align:"center",gap:"2x",children:[!n&&t.jsx(y.Skeleton,{width:"6x",height:"6x",borderRadius:"4px"}),t.jsx(y.Skeleton,{height:"5x",borderRadius:"4px"})]})})})}function F(){return t.jsxs(t.Fragment,{children:[t.jsx(A,{}),t.jsx(A,{indentation:1}),t.jsx(A,{indentation:2,isLeaf:!0})]})}function V({itemKey:e,depth:a,context:r,children:l,isExpanded:u,onToggle:y,selected:m,isSelectable:b,isCheckboxless:v,isTabbable:f,isLoading:h,isFocusRingVisible:E}){const T=n.useRef(null),S=O(a,u),C=O(a+1,u),{isHover:k,hoverProps:j}=g.useHover(),w=i.classNames([c.styles.treeItemStyles.base,E&&c.styles.treeItemStyles.focused,!0===m&&c.styles.treeItemStyles.selected,!0===m&&v&&c.styles.treeItemStyles.checkboxlessSelected,b&&!m&&k&&c.styles.treeItemStyles.hovered]);return t.jsxs(t.Fragment,{children:[t.jsx("div",{ref:T,id:o.useId(),tabIndex:_()?-1:void 0,"data-oj-key":e,class:w,role:"treeitem","aria-level":a+1,"aria-selected":m?"true":"false",...void 0!==u&&{"aria-expanded":u},..."number"==typeof e&&{"data-oj-key-type":"number"},...j,children:t.jsxs(t.Fragment,{children:[!0===m&&k&&t.jsx("div",{class:c.styles.selectedHoveredOverlay}),t.jsx(s.TabbableModeContext.Provider,{value:{isTabbable:f},children:t.jsx(d.View,{paddingInlineStart:S,children:t.jsxs(x.Flex,{align:"center",children:[void 0!==u&&t.jsx(p.Expander,{itemKey:e,expanded:u,onToggle:y}),l(r)]})})})]})}),h?t.jsx(K,{indentation:C,children:()=>t.jsx(F,{})}):null]})}const _=()=>{const{platform:e}=m.getClientHints();return"ios"===e||"android"===e},O=(e,t)=>{const n=void 0===t?"40px":"0px";return`calc(${Math.max(0,e)} * ${u.treeViewVars.indentWidth} + ${n})`};function N({children:e,minimumCount:a=1,onSkeletonVisible:r}){const[l,s]=n.useState(!1);n.useEffect((()=>{setTimeout((()=>{s(!0),r?.()}),50)}),[r]);const o=i.classNames([c.styles.skeletonStyles.container]);return l&&e?t.jsx("div",{class:o,role:"presentation",children:[...Array(a)].map(((t,n)=>e(n)))}):null}function P({data:e,children:n,selectionMode:a,onToggle:r=()=>{},viewportConfig:i,hasMore:s=!1,onLoadMore:o=()=>{},loadMoreIndicator:d=H,updateContext:c}){return t.jsx(t.Fragment,{children:null===e?null:t.jsx(l.LoadMoreCollection,{data:e,viewportConfig:i,hasMore:s,onLoadMore:o,loadMoreIndicator:d,children:e=>{const l=e.data.metadata.key,i={index:e.index,data:e.data.data,metadata:{key:l}};c&&c(i);const s=e.data.metadata.expanded;return t.jsx(V,{itemKey:i.metadata.key,context:i,depth:e.data.metadata.treeDepth,isExpanded:"ongoing"===s||s,onToggle:r,isSelectable:"none"!==a,isCheckboxless:"single"===a,selected:e.data.metadata.selected,isLoading:"ongoing"===s,isTabbable:!1,isFocusRingVisible:e.data.metadata.hasFocus,children:n},i.metadata.key)}})})}const H=t.jsx("div",{class:l.LOADMORE_STYLE_CLASS,children:t.jsx(N,{minimumCount:1,children:()=>t.jsx(F,{})})});const U=(e,t,n,a)=>{if(e&&null!==t){const r=Array.from(e.querySelectorAll(a)),l=r.findIndex((e=>e.dataset.ojKey==t));for(let e=l;e>=0;e--){const t=r[e].getAttribute("aria-level");if(null!==t&&Number(t)==n-1)return r[e]}}return null};const D=e=>t.jsx(N,{minimumCount:8,onSkeletonVisible:e,children:()=>t.jsx(F,{})}),B=e=>e.id,$=(e,t)=>{const n=t.map((e=>e.metadata.key)),a=n.indexOf(e.value.start),r=n.indexOf(e.value.end),l=Math.min(a,r),i=Math.max(a,r);return-1===l?{offset:0,count:-1}:n.slice(l,i+1)};e.FlatTreeView=function({"aria-label":e,"aria-labelledby":l,"aria-describedby":i,data:s,selectionMode:d="none",selectedKeys:c={all:!1,keys:new Set},onSelectionChange:u,onToggle:x,viewportConfig:y,...g}){const m=n.useRef(null),[p,h]=n.useState(),{collection_loading:T,collection_loaded:S}=R.useTranslationBundle("@oracle/oraclejet-preact"),K=o.useId(),A=n.useCallback((e=>{if(m.current){const t=r.findElementByKey(m.current,e,r.ITEM_SELECTOR);return"true"===t?.getAttribute("aria-expanded")}return!1}),[]),{treeNavigationProps:F,currentKey:V,showFocusRing:O}=function(e,t,l,i){const{direction:s}=j.useUser(),o={ArrowUp:e=>r.getPrevNextKey(t.current,e,!0,r.ITEM_SELECTOR),ArrowDown:e=>r.getPrevNextKey(t.current,e,!1,r.ITEM_SELECTOR)},{navigationProps:d,currentKey:c,onCurrentKeyChange:u,showFocusRing:x}=w.useNavigation(e,t,i,o,void 0,void 0,void 0,void 0,!0,!1,!0,!1),y=n.useCallback((e=>"tree"===e.getAttribute("role")?void 0===c?null:c:r.keyExtractor(e,r.ITEM_SELECTOR)),[c,r.keyExtractor]),g=n.useCallback((e=>{if("ArrowLeft"===e.key||"ArrowRight"===e.key){const n="rtl"===s,a="ArrowLeft"===e.key&&!n,i=y(e.target);if(i){const e=l(i);if(a&&!e&&t.current){const e=r.findElementByKey(t.current,i,r.ITEM_SELECTOR);if(e){const n=e.getAttribute("aria-level"),a=null!==n&&U(t.current,i,Number(n),r.ITEM_SELECTOR),l=a&&y(a);E.isKeyDefined(l)&&u?.({value:l})}}else if(!a&&e){const e=r.getPrevNextKey(t.current,i,!1,r.ITEM_SELECTOR)();E.isKeyDefined(e)&&u?.({value:e})}}}}),[s,l,u,y]);return{treeNavigationProps:a.mergeProps(d,{onKeyUp:g}),currentKey:c,showFocusRing:x}}(s,m,A,B),N=n.useMemo((()=>s?.map((e=>{const t=e.metadata.key,n={...e};return n.metadata.selected=E.containsKey(c,t),n.metadata.hasFocus=V===t&&O,n}))||[]),[s,c,V,O]),H=C.useExpandCollapse((e=>"tree"===e.getAttribute("role")?void 0===V?null:V:r.keyExtractor(e,r.ITEM_SELECTOR)),A,x,!0),q=n.useRef(),z=n.useCallback((e=>{u&&(!1===e.value.all&&e.value.keys.size>0&&(q.current=Array.from(e.value.keys.values()).pop()),u(e))}),[q,u]),W=n.useCallback((e=>{if(s&&u){const t=$(e,s);if(Array.isArray(t))if("shiftSpace"===e.eventType?q.current=e.value.start:q.current=e.value.end,"multipleToggle"===d){const e=E.addKeys(c,t);u({value:e,target:null})}else u({value:{all:!1,keys:new Set(t)},target:null})}}),[s,c,u]),{selectionProps:Y}=v.useSelection((e=>e===m.current?void 0===V?null:V:r.keyExtractor(e,r.ITEM_SELECTOR)),c,"multipleToggle"===d?"none":d,!1,"replace",z,q.current,V,((e,t)=>r.getPrevNextKey(m.current,e,t,r.ITEM_SELECTOR)),void 0,(e=>{if(m.current){const t=r.findElementByKey(m.current,e,r.ITEM_SELECTOR);t&&t.scrollIntoView({block:"nearest"})}}),W),{eventProps:G}=f.useAdditiveSelection((e=>e===m.current?void 0===V?null:V:r.keyExtractor(e,r.ITEM_SELECTOR)),c,"multipleToggle"===d?"multiple":"none",!1,(e=>s?s.findIndex((t=>t.metadata.key===e)):-1),((e,t)=>{if(s){return s.map((e=>e.metadata.key)).slice(e,t)}return[]}),((e,t)=>r.getPrevNextKey(m.current,e,t,r.ITEM_SELECTOR)),V,z,W),J=n.useCallback((e=>{"multiple"!==d&&"multipleToggle"!==d||u&&(e.metaKey||e.ctrlKey)&&"a"===e.key&&(e.preventDefault(),u({value:{all:!0,deletedKeys:new Set},target:e.target}))}),[u,d]),{classes:Q}=k.useComponentTheme(b.TreeViewRedwoodTheme);y=r.getViewportConfig(m,y);const X=n.useCallback((e=>{const n=e.metadata.key;e.selector="none"===d||"single"===d?void 0:e=>t.jsx("div",{"aria-hidden":!_()||void 0,children:t.jsx(I.Selector,{"aria-label":_()?e:void 0,rowKey:n,selectedKeys:c,onChange:u})})}),[d,c,u]),Z=n.useCallback((()=>{h(T())}),[T]);return t.jsxs(t.Fragment,{children:[t.jsx("div",{"aria-label":e,"aria-labelledby":l,"aria-describedby":null==s?i?[...new Set(i.split(/\s+/).concat(K))].join(" "):K:i,ref:m,role:"tree","aria-multiselectable":"multiple"===d,tabIndex:0,class:Q,...a.mergeProps(F,Y,G,H,{onKeyDown:J}),children:null==s?D(Z):t.jsx(P,{data:N,selectionMode:d,onToggle:x,viewportConfig:y,updateContext:X,...g})}),t.jsx(L.HiddenAccessible,{id:K,children:T()}),t.jsx(M.LiveRegion,{children:null==s?p:p===T()?S():""})]})}}));
//# sourceMappingURL=FlatTreeView-537ceabc.js.map
