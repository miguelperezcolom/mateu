{"version":3,"file":"IconUserAssistance-af9839fb.js","sources":["../../src/UNSAFE_UserAssistance/IconUserAssistance.tsx"],"sourcesContent":["import { useCallback, useRef } from 'preact/hooks';\n\nimport { useTranslationBundle } from '#hooks/UNSAFE_useTranslationBundle';\nimport { BundleType } from '#resources/nls/bundle';\n\nimport { HelpIcon } from '#PRIVATE_ThemedIcons/HelpIcon';\nimport { Popup } from '#UNSAFE_Popup';\nimport { HiddenAccessible } from '#UNSAFE_HiddenAccessible';\nimport { InlineHelp } from './InlineHelp';\nimport {\n  iconUserAssistanceIcon,\n  iconUserAssistancePopupFocus\n} from './themes/UserAssistanceStyles.css';\nimport { useComponentTheme } from '#hooks/UNSAFE_useComponentTheme';\nimport { classNames } from '#utils/UNSAFE_classNames';\nimport { PopupRedwoodTheme } from '#UNSAFE_Popup/themes/redwood/PopupTheme';\nimport { useToggle } from '#hooks/UNSAFE_useToggle';\n\ntype Props = {\n  /**\n   * Text to provide guidance to help the user understand what data to enter.\n   */\n  assistiveText?: string;\n  /**\n   * Help source URL associated with the component.\n   */\n  helpSourceLink?: string;\n  /**\n   * Custom text to be rendered for the `helpSourceLink`. \"Learn more\" will be used if no custom text is provided.\n   */\n  helpSourceText?: string;\n  /**\n   * Whether the trigger element is in tab sequence\n   */\n  isTabbable?: boolean;\n  /**\n   * ID of the pop up content that can be used for aria-describedby\n   */\n  id?: string;\n};\n\n/**\n * Created to match icon user assistance spec for use with radio option, pending design review\n * of inline UA assistance.\n */\nconst IconUserAssistance = ({\n  assistiveText,\n  helpSourceLink,\n  helpSourceText,\n  isTabbable = true,\n  id\n}: Props) => {\n  const { bool: isOpen, setFalse: setIsOpenFalse, toggle } = useToggle(false);\n\n  const translations = useTranslationBundle<BundleType>('@oracle/oraclejet-preact');\n  const userAssistance_learnMoreStr = translations.userAssistance_learnMore();\n  const sourceText = helpSourceLink && (helpSourceText || userAssistance_learnMoreStr);\n  const helpForRadioString = translations.radio_helpForRadio();\n  const helpStringId = `${id}-help-string`;\n  const anchorRef = useRef<HTMLSpanElement>(null);\n\n  const handleOutsideClick = useCallback(\n    (event: MouseEvent) => {\n      const target = event?.target;\n      // We need to filter out anchor click events, because anchor is responsible for the toggling\n      if (\n        (target instanceof Element || target instanceof Document) &&\n        !anchorRef.current?.contains(target) &&\n        isOpen\n      ) {\n        setIsOpenFalse();\n      }\n    },\n    [isOpen, setIsOpenFalse]\n  );\n\n  const handleLinkEvent = useCallback(\n    (e: Event) => {\n      // if it's a key event that is not \"enter\", return early\n      const { key } = e as KeyboardEvent;\n      if (key && key !== 'Enter') {\n        return;\n      }\n\n      // We want to close the pop up if a link is triggered with mouse or keyboard\n      const { tagName } = e.target as Element;\n\n      if (tagName?.toLowerCase() === 'a') {\n        setIsOpenFalse();\n\n        // we want to refocus to the help icon after the browser has launched the link\n        // prematurely doing so prevents keyboard events from firing\n        setTimeout(() => anchorRef.current?.focus());\n      }\n    },\n    [setIsOpenFalse]\n  );\n\n  const handleOnKeyDown = useCallback(\n    (e: KeyboardEvent) => {\n      // allow user to close popup without having to focus it\n      if (['Tab', 'Escape'].includes(e.code) && isOpen) {\n        setIsOpenFalse();\n      }\n\n      // toggle and prevent scroll jump\n      if (['Space', 'Enter'].includes(e.code)) {\n        e.preventDefault();\n        toggle();\n      }\n    },\n    [isOpen, setIsOpenFalse, toggle]\n  );\n\n  const onClickHandler = useCallback(\n    (e: Event) => {\n      e.preventDefault();\n      toggle();\n    },\n    [toggle]\n  );\n\n  // We are referencing popup vars, so we need to bring in the baseTheme for popup\n  const { baseTheme: popupBaseTheme } = useComponentTheme(PopupRedwoodTheme);\n  const iconUserAssistanceClasses = classNames([popupBaseTheme, iconUserAssistancePopupFocus]);\n\n  return helpSourceLink || assistiveText ? (\n    <>\n      <span\n        onKeyDown={handleOnKeyDown}\n        onClick={onClickHandler}\n        role=\"link\"\n        aria-describedby={helpStringId}\n        aria-haspopup=\"dialog\"\n        ref={anchorRef}\n        tabIndex={isTabbable ? 0 : -1}\n        class={iconUserAssistanceIcon}\n        id={`${id}-help-icon`}>\n        <HelpIcon />\n      </span>\n      <HiddenAccessible id={helpStringId} isHidden={true}>\n        {helpForRadioString}\n      </HiddenAccessible>\n      <Popup\n        placement=\"top\"\n        isOpen={isOpen}\n        anchorRef={anchorRef}\n        onClose={setIsOpenFalse}\n        onClickOutside={handleOutsideClick}\n        shiftOptions={{ mainAxis: true, crossAxis: false }}\n        role=\"tooltip\"\n        maxWidth={'296px'}>\n        <div\n          id={id}\n          tabIndex={0}\n          class={iconUserAssistanceClasses}\n          onMouseUp={handleLinkEvent}\n          onKeyDown={handleLinkEvent}>\n          <InlineHelp\n            assistiveText={assistiveText}\n            sourceLink={helpSourceLink}\n            sourceText={sourceText}\n          />\n        </div>\n      </Popup>\n    </>\n  ) : null;\n};\n\nexport { IconUserAssistance };\n"],"names":["assistiveText","helpSourceLink","helpSourceText","isTabbable","id","bool","isOpen","setFalse","setIsOpenFalse","toggle","useToggle","translations","useTranslationBundle","userAssistance_learnMoreStr","userAssistance_learnMore","sourceText","helpForRadioString","radio_helpForRadio","helpStringId","anchorRef","useRef","handleOutsideClick","useCallback","event","target","Element","Document","current","contains","handleLinkEvent","e","key","tagName","toLowerCase","setTimeout","focus","handleOnKeyDown","includes","code","preventDefault","onClickHandler","baseTheme","popupBaseTheme","useComponentTheme","PopupRedwoodTheme","iconUserAssistanceClasses","classNames","iconUserAssistancePopupFocus","_jsxs","jsxs","_Fragment","children","_jsx","onKeyDown","onClick","role","ref","tabIndex","class","iconUserAssistanceIcon","jsx","HelpIcon","SvgHelp","HiddenAccessible","isHidden","Popup","placement","onClose","onClickOutside","shiftOptions","mainAxis","crossAxis","maxWidth","onMouseUp","InlineHelp","sourceLink"],"mappings":"8aA6C2B,EACzBA,gBACAC,iBACAC,iBACAC,cAAa,EACbC,SAEA,MAAQC,KAAMC,EAAQC,SAAUC,EAAcC,OAAEA,GAAWC,aAAU,GAE/DC,EAAeC,uBAAiC,4BAChDC,EAA8BF,EAAaG,2BAC3CC,EAAad,IAAmBC,GAAkBW,GAClDG,EAAqBL,EAAaM,qBAClCC,EAAe,GAAGd,gBAClBe,EAAYC,SAAwB,MAEpCC,EAAqBC,eACxBC,IACC,MAAMC,EAASD,GAAOC,QAGnBA,aAAkBC,SAAWD,aAAkBE,YAC/CP,EAAUQ,SAASC,SAASJ,IAC7BlB,GAEAE,GACD,GAEH,CAACF,EAAQE,IAGLqB,EAAkBP,eACrBQ,IAEC,MAAMC,IAAEA,GAAQD,EAChB,GAAIC,GAAe,UAARA,EACT,OAIF,MAAMC,QAAEA,GAAYF,EAAEN,OAES,MAA3BQ,GAASC,gBACXzB,IAIA0B,YAAW,IAAMf,EAAUQ,SAASQ,UACrC,GAEH,CAAC3B,IAGG4B,EAAkBd,eACrBQ,IAEK,CAAC,MAAO,UAAUO,SAASP,EAAEQ,OAAShC,GACxCE,IAIE,CAAC,QAAS,SAAS6B,SAASP,EAAEQ,QAChCR,EAAES,iBACF9B,IACD,GAEH,CAACH,EAAQE,EAAgBC,IAGrB+B,EAAiBlB,eACpBQ,IACCA,EAAES,iBACF9B,GAAQ,GAEV,CAACA,KAIKgC,UAAWC,GAAmBC,EAAiBA,kBAACC,EAAiBA,mBACnEC,EAA4BC,EAAUA,WAAC,CAACJ,EAAgBK,EAAAA,+BAE9D,OAAO9C,GAAkBD,EACvBgD,EAAAC,KAAAC,WAAA,CAAAC,SAAA,CACEC,MACE,OAAA,CAAAC,UAAWjB,EACXkB,QAASd,EACTe,KAAK,0BACarC,EAAY,gBAChB,SACdsC,IAAKrC,EACLsC,SAAUtD,EAAa,GAAK,EAC5BuD,MAAOC,yBACPvD,GAAI,GAAGA,cACP+C,SAAAC,EAAAQ,IAACC,EAAQC,QAAA,CAAA,KAEXV,MAACW,EAAAA,iBAAgB,CAAC3D,GAAIc,EAAc8C,UAAU,EAAIb,SAC/CnC,IAEHoC,EAAAA,IAACa,EAAAA,OACCC,UAAU,MACV5D,OAAQA,EACRa,UAAWA,EACXgD,QAAS3D,EACT4D,eAAgB/C,EAChBgD,aAAc,CAAEC,UAAU,EAAMC,WAAW,GAC3ChB,KAAK,UACLiB,SAAU,QAAOrB,SACjBC,EACEQ,IAAA,MAAA,CAAAxD,GAAIA,EACJqD,SAAU,EACVC,MAAOb,EACP4B,UAAW5C,EACXwB,UAAWxB,EACXsB,SAAAC,EAAAQ,IAACc,EAAUA,WACT,CAAA1E,cAAeA,EACf2E,WAAY1E,EACZc,WAAYA,WAKlB,IAAI"}