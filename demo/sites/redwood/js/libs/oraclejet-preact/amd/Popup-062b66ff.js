define(['exports', 'preact/jsx-runtime', 'preact/hooks', './Floating-366a30f8', './tabbableUtils-9101c0e5', './refUtils-77e97004', './FocusTrap-d06ac102', './Layer-dc3c1ac9', 'preact/compat', './LayerHost-7d4aa6d3', './Modal-8d647f76', './WindowOverlay-bd810e3b', './usePopupAnimation-9f80595b', './useTestId-a2e433c2', './useOutsideClick-9c4ceb18', './clientHints-6d361eaa', './LiveRegion-4b9317e5', './HiddenAccessible-037ef42d', './useTranslationBundle-27bf6340', './useComponentTheme-5aa41a8f', './UNSAFE_Popup/themes/PopupContract.css', './stringUtils-4ffd9d59', './classNames-08d99695', './UNSAFE_Popup/themes/redwood/PopupTheme', './dimensions-f24f9a2b', './colors-17f17162', './mergeInterpolations-9ede4cf7', './unsafeDomAccess-602c5dde'], (function(e,n,t,s,o,r,i,a,c,l,u,d,p,f,m,b,g,h,x,A,y,v,E,O,k,C,F,_){"use strict";function j({message:e,callback:s}){const o=t.useRef(null),r=e=>{"Enter"===e.code&&(e.stopPropagation(),e.preventDefault())};return n.jsx("div",{ref:o,children:n.jsx(h.HiddenAccessible,{children:n.jsx("a",{onClick:s,tabIndex:-1,href:"#",role:"button",onKeyDown:r,onKeyUp:r,onKeyPress:r,children:e})})})}const R=c.forwardRef((({anchorRef:e,launcherRef:c,children:l,isOpen:h=!1,modality:R="modeless",offset:P={mainAxis:0,crossAxis:0},flipOptions:T={mainAxis:!0,crossAxis:!0},shiftOptions:S={mainAxis:!1,crossAxis:!1},onClickOutside:w,onClose:L,initialFocus:D="auto",placement:I=(e?"top":"center"),tail:U="none",onTransitionEnd:N,onFocusSet:M,variant:H="standard",role:K="dialog","aria-label":W,"aria-labelledby":V,"aria-describedby":B,testId:$,...q},z)=>{const G=t.useRef(null),[J,Q]=t.useState(),X=t.useRef(null),Y=t.useRef("unmounted"),Z=f.useTestId($),ee=[X];G.current&&G.current!==document.body&&ee.push(G);const ne=x.useTranslationBundle("@oracle/oraclejet-preact"),te=t.useCallback((()=>"modal"===R),[R]);m.useOutsideClick({isDisabled:!(h&&X.current),ref:ee,handler:e=>{w?.(e)}});const se=t.useCallback((e=>{G.current!==o.getActiveElement()||"F6"!==e.code||te()||(e.preventDefault(),e.stopPropagation(),o.focusWithin(X.current),M?.())}),[te]),{setAnimationElementRef:oe,status:re,onPosition:ie}=p.usePopupAnimation({isOpen:h,isAnimatedOnMount:!0,onTransitionEnd:e=>{e?(le(),N?.(!0)):N?.(!1)},placement:I}),ae=t.useMemo((()=>r.mergeRefs(X,z)),[X,z]),ce=t.useCallback((()=>{const n=G.current,t=e?.current;if(n)o.focusOn(n);else if(t){let e=null;t instanceof Element?e=t:t[_.UNSAFE_DOM_ACCESS]&&(e=t[_.UNSAFE_DOM_ACCESS]),e&&o.focusOn(e)}}),[G,e]);t.useEffect((()=>(h||"opening"!==re||te()?!h&&"unmounted"===re&&te()&&re!==Y.current&&ce():X.current?.contains(o.getActiveElement())&&ce(),()=>{Y.current=re})),[h,re,ce,te]),t.useEffect((()=>(h&&(c?.current&&c.current instanceof Element?G.current=document.body.contains(c.current)?c.current:o.getActiveElement():G.current=o.getActiveElement(),G.current?.addEventListener("keydown",se)),()=>{G.current?.removeEventListener("keydown",se)})),[h,c,se]);const le=()=>{let e=D;"auto"===D&&(e=te()?"firstFocusable":"none"),"popup"===e&&(o.focusOn(X.current),M?.()),"firstFocusable"===e&&(o.focusWithin(X.current),M?.())},ue={mainAxis:(e=>{let n=0;return e&&(n="number"==typeof e?e:e.mainAxis||0,"simple"===U&&(n+=5)),n})(P),crossAxis:(e=>e?"number"==typeof e?0:e.crossAxis||0:0)(P)},de=e=>{const n=o.getActiveElement(),t=X.current,s=G.current;if(t===n||t?.contains(n))switch(e.code){case"Escape":L?.({reason:"escapeKey"});break;case"F6":e.preventDefault(),e.stopPropagation(),s&&!te()&&o.focusOn(s)}};t.useLayoutEffect((()=>{if("unmounted"===re||null==X.current||null!=J||"none"===U)return;const e=v.g(y.popupVars.backgroundColor),n=getComputedStyle(X.current);Q(q.backgroundColor||n.getPropertyValue(e))}),[re,X,J,U,q.backgroundColor]);const pe=b.getClientHints(),fe=["ios","android"].indexOf(pe.platform)>-1,me="opening"===re,{baseTheme:be,classes:ge}=A.useComponentTheme(O.PopupRedwoodTheme),he="unmounted"!==re,xe=[...Object.values(k.dimensionInterpolations),...Object.values(C.colorInterpolations)],Ae=F.mergeInterpolations(xe),{...ye}=Ae(q),ve=()=>{L?.({reason:"closeSkipLink"})},Ee=()=>n.jsxs(n.Fragment,{children:[n.jsx(i.FocusTrap,{restoreFocusRef:!1,children:n.jsxs("div",{ref:ae,tabIndex:-1,role:K,className:E.classNames([be,"unstyled"===H?null:ge]),style:ye,onKeyDown:de,"aria-label":W,"aria-labelledby":V,"aria-describedby":B,...Z,children:[!te()&&fe&&me&&n.jsx(j,{callback:ve,message:`${ne.popup_close_skipLink}`}),l]})}),!te()&&!fe&&n.jsx(g.LiveRegion,{children:`${-1!=["auto","none"].indexOf(D)?ne.popup_liveRegion_F6_initial_focus_none:ne.popup_liveRegion_F6_initial_focus_firstFocusable}`})]}),Oe=()=>e&&e.current?n.jsx(s.Floating,{ref:oe,backgroundColor:J,anchorRef:e,placement:I,offsetValue:ue,flipOptions:T,shiftOptions:S,tail:U,onPosition:ie,children:Ee()}):n.jsx(d.WindowOverlay,{placement:I,offset:ue,children:n.jsx("div",{ref:oe,children:Ee()})});return he?te()?n.jsx(u.Modal,{isOpen:he,children:Oe()}):n.jsx(a.Layer,{children:Oe()}):null}));e.Popup=R}));
//# sourceMappingURL=Popup-062b66ff.js.map
