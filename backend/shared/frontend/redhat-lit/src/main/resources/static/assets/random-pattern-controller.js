import{_ as m,L as N,a as t}from"./mateu-redhat.js";var d,g,p,C,w,R,S,b,k,f,i,T,v,y,E,I,G,W,F,L,A;function X(r){let a=5381,e=r.length;for(;e;)a=a*33^r.charCodeAt(--e);return a>>>0}function q(r,a,e){return e<0&&(e+=1),e>1&&(e-=1),6*e<1?r+(a-r)*6*e:2*e<1?a:3*e<2?r+(a-r)*(2/3-e)*6:r}function D(r,a,e){let n,s,h;const c=Math.max(0,Math.min(1,r)),l=Math.max(0,Math.min(1,a)),o=Math.max(0,Math.min(1,e));if(l===0)n=o*255,s=o*255,h=o*255;else{const u=o<.5?o*(1+l):o+l-l*o,M=2*o-u;n=Math.floor(255*q(M,u,c+1/3)),s=Math.floor(255*q(M,u,c)),h=Math.floor(255*q(M,u,c-1/3))}return[n,s,h]}function J(r,a,e){let n,s;const h=Math.max(0,Math.min(255,r)),c=Math.max(0,Math.min(255,a)),l=Math.max(0,Math.min(255,e)),o=h/255,u=c/255,M=l/255,x=Math.min(Math.min(o,u),M),_=Math.max(Math.max(o,u),M),P=_-x,$=(_+x)/2;if(P===0)n=0,s=0;else{$<.5?s=P/(_+x):s=P/(2-_-x);const j=((_-o)/6+P/2)/P,B=((_-u)/6+P/2)/P,z=((_-M)/6+P/2)/P;o===_?n=z-B:u===_?n=1/3+j-z:M===_&&(n=2/3+B-j),n??(n=0),n<0?n+=1:n>1&&(n-=1)}return[n,s,$]}const K={4:{regexp:/^#([A-f0-9])([A-f0-9])([A-f0-9])$/,parser:r=>parseInt(`${r}${r}`,16)},7:{regexp:/^#([A-f0-9]{2})([A-f0-9]{2})([A-f0-9]{2})$/,parser:r=>parseInt(r,16)}};function O(r){const n=J(...r);return n[2]+=n[2]>.1?-.1:.1,D(...n)}class U{constructor(a,e){d.add(this),g.set(this,[]),p.set(this,[]),C.set(this,void 0),w.set(this,"squares"),R.set(this,0),S.set(this,0),b.set(this,""),k.set(this,""),f.set(this,void 0),i.set(this,void 0),T.set(this,void 0),m(this,T,new N(a),"f"),m(this,f,e,"f"),m(this,i,t(this,f,"f").getContext("2d"),"f"),this.render()}render(a){var e,n;m(this,C,a?.name??t(this,C,"f"),"f"),m(this,p,a?.colors??t(this,p,"f"),"f"),m(this,w,a?.pattern??t(this,w,"f"),"f"),t(this,f,"f").width=a?.size??0,t(this,f,"f").height=a?.size??0,a?.colors&&m(this,g,t(this,d,"m",v).call(this),"f");const s=X(t(this,C,"f")??"").toString(2),h=s.split("").map(l=>Number(l)),c=Math.floor(t(this,g,"f").length*parseInt(s,2)/2**32);e=this,n=this,[{set value(l){m(e,b,l,"f")}}.value,{set value(l){m(n,k,l,"f")}}.value]=t(this,g,"f")[c]??[],m(this,R,t(this,f,"f").width/8,"f"),m(this,S,t(this,f,"f").width/4,"f"),t(this,d,"m",y).call(this),t(this,d,"m",E).call(this),t(this,w,"f")==="squares"?t(this,d,"m",I).call(this,h):t(this,w,"f")==="triangles"&&t(this,d,"m",F).call(this,h)}}g=new WeakMap,p=new WeakMap,C=new WeakMap,w=new WeakMap,R=new WeakMap,S=new WeakMap,b=new WeakMap,k=new WeakMap,f=new WeakMap,i=new WeakMap,T=new WeakMap,d=new WeakSet,v=function(){const a=[];return t(this,p,"f").forEach(e=>{const{regexp:n,parser:s}=K[e.length]??{};if(n&&s){const[,...h]=n.exec(e)??[];if(h.length){const c=h.map(s);a.push([`rgb(${c.join(",")})`,`rgb(${O(c).join(",")})`])}else t(this,T,"f").warn(`invalid color ${e}`)}}),a},y=function(){t(this,i,"f")&&t(this,f,"f")&&t(this,i,"f").clearRect(0,0,t(this,f,"f").width,t(this,f,"f").height)},E=function(){t(this,i,"f")&&t(this,f,"f")&&(t(this,i,"f").fillStyle=t(this,b,"f"),t(this,i,"f").fillRect(0,0,t(this,f,"f").width,t(this,f,"f").height))},I=function(a){if(t(this,i,"f")){t(this,i,"f").fillStyle=t(this,k,"f");let e=a.length;for(;e--;)a[e]&&t(this,d,"m",G).call(this,e%4,Math.floor(e/4))}},G=function(a,e){t(this,i,"f")&&(t(this,d,"m",W).call(this,a,e),t(this,d,"m",W).call(this,7-a,e))},W=function(a,e){t(this,i,"f")&&t(this,i,"f").fillRect(t(this,R,"f")*a,t(this,R,"f")*e,t(this,R,"f"),t(this,R,"f"))},F=function(a){if(t(this,i,"f")){t(this,i,"f").fillStyle=t(this,k,"f")??"";let e=a.length;for(;e--;)if(a[e]){const n=Math.floor(e/2)%2,s=Math.floor(e/4),h=e%4,c=[n,s],l=[n,s],o=[n,s];switch(h){case 0:l[1]++,o[0]++,o[1]++;break;case 1:l[0]++,o[0]++,o[1]++;break;case 2:l[0]++,o[1]++;break;case 3:c[0]++,l[0]++,l[1]++,o[1]++;break}t(this,d,"m",L).call(this,c,l,o)}}},L=function(a,e,n){t(this,i,"f")&&(t(this,d,"m",A).call(this,a,e,n),t(this,d,"m",A).call(this,[4-a[0],a[1]],[4-e[0],e[1]],[4-n[0],n[1]]))},A=function(a,e,n){const s=h=>h*t(this,S,"f");t(this,i,"f")&&(t(this,i,"f").beginPath(),t(this,i,"f").moveTo(...a.map(s)),t(this,i,"f").lineTo(...e.map(s)),t(this,i,"f").lineTo(...n.map(s)),t(this,i,"f").closePath(),t(this,i,"f").fill(),t(this,i,"f").fill())};export{U as RandomPatternController};
