define(['exports', 'preact/hooks'], (function(e,n){"use strict";const t=new Map,r=[],o=new Map;let u,c,s=!1;function i(e){0===t.size||"F6"!==e.key||e.defaultPrevented||function(e){for(let n=function(e,n,t=-1){const r=e.indexOf(n);return-1!==r?r:t}(r,c,r.length)-1;n>-1;n--){const o=r[n],{ref:u}=t.get(o)??{};if(u?.current?.focus?.()){if(e.preventDefault(),c){const{callbacks:e}=t.get(c)??{};e?.onFocusLeave?.()}return!0}}return!1}(e)||c&&g(c,e)}function f(e){u=e.target}function a(e,n){if(!t.has(e)||n.defaultPrevented)return;c=e;const{callbacks:r}=t.get(e);u&&!function(e){for(const{ref:n}of t.values())if(n.current?.contains(e))return!0;return!1}(u)&&(o.set(e,u),r?.onFocus?.())}function l(e,n){t.set(e,n),r.push(e)}function d(e){t.has(e)&&(t.delete(e),r.splice(r.indexOf(e),1))}function g(e,n){const u=function(e){for(let n=r.indexOf(e);n<r.length;n++)if(o.has(r[n]))return o.get(r[n]);return null}(e),{callbacks:c}=t.get(e)??{};return!(!u||!document.body.contains(u))&&(u.focus(),c?.onFocusLeave?.(),o.clear(),n?.preventDefault(),!0)}const v={prioritize:function(e){if(!t.has(e))return;const n=t.get(e);d(e),l(e,n)},register:function(e,n,r={handleEscapeKey:!0}){s||(document.documentElement.addEventListener("keydown",i,!0),document.documentElement.addEventListener("blur",f,!0),s=!0),l(e,n);const o={onFocusIn:n=>a(e,n),onFocusOut:n=>function(e,n){t.has(e)&&!n.defaultPrevented&&(c=void 0)}(e,n)};return r.handleEscapeKey&&(o.onKeyUp=n=>function(e,n){t.has(e)&&!n.defaultPrevented&&"keyup"===n.type&&["Escape"].includes(n.key)&&g(e,n)}(e,n)),o},togglePreviousFocus:g,unregister:function(e){d(e),function(e){o.delete(e)}(e),s&&0===t.size&&(document.documentElement.removeEventListener("keydown",i,!0),document.documentElement.removeEventListener("blur",f,!0),s=!1)}};e.useMessageFocusManager=function(e,t,r){const o=n.useRef(Symbol()),u=n.useRef(v),[c,s]=n.useState({}),i=n.useMemo((()=>({prioritize:()=>u.current.prioritize(o.current),restorePriorFocus:()=>u.current.togglePreviousFocus(o.current)})),[]);return n.useEffect((()=>{const n=u.current,c=o.current;return s(n.register(c,{ref:e,callbacks:t},r)),()=>n.unregister(c)}),[]),{handlers:c,controller:i}}}));
//# sourceMappingURL=useMessagesFocusManager-8777bce0.js.map
