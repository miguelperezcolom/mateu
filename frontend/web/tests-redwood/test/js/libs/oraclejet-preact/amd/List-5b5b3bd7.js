define(['exports', 'preact/jsx-runtime', 'preact/hooks', './classNames-08d99695', './mergeProps-bcfa6a92', './keys-4755c121', './collectionUtils-26e6c87c', './LoadMoreCollection-3ac9e69e', './VirtualizedCollection-5dfbcdee', 'preact/compat', './TabbableModeContext-a9c97640', './useId-c9578d26', './FocusTrap-d06ac102', './useNavigation-a6a2218f', './useInteractionStyle-15a2bdd0', './mergeInterpolations-9ede4cf7', './flexitem-5db48325', './PRIVATE_List/themes/ListStyles.css', './Skeleton-a7e166a0', './Flex-4bc3a394', './Selector-470f114d', './ImageVars.css-17386400', './useTheme-af7bfac1', './useTestId-a2e433c2', './ReorderableContext-6d10a1b7', './LayerHost-7d4aa6d3', './CollectionInteractionContext-0b4ed98b', './useCollectionInteractionContext-f345e8f7', 'preact', './useSelection-87a6bea9', './useAdditiveSelection-9135c06c', './useItemAction-cb69dd7f', './Inset-a34e9c57', 'module'], (function(e,t,i,s,n,l,a,o,r,c,d,u,g,b,m,f,p,v,y,h,S,x,k,I,C,T,A,P,j,M,E,R,V,w){"use strict";const L=e=>{switch(e){case"listbox":return{list:"listbox",item:"presentation",cell:"option"};case"treegrid":return{list:"treegrid",item:"row",cell:"gridcell"};default:return{list:"grid",item:"row",cell:"gridcell"}}},F="[data-oj-key]";function K({children:e,context:n,itemDepth:l,isFocused:a,isFocusRingVisible:o,isActive:r,isGridlineVisible:c,isSelected:y,isTopGridlineVisible:h=!1,isTabbable:S=!1,role:x,selectionMode:k,suggestion:I,currentItemVariant:C,padding:T}){const A=i.useRef(null),P=i.useMemo((()=>L(x)),[x]),j=n.metadata.key,M=n.index,E="option"===P.cell?{role:P.cell,"aria-posinset":M+1,"aria-setsize":-1}:{role:P.cell},{interactionProps:R,applyActiveStyle:V,applyHoverStyle:w,applyPseudoHoverStyle:F}=m.useInteractionStyle(),K=v.listItemMultiVariantStyles({selectable:H(k,y)?"isSelectable":"notSelectable",selected:y?"isSelected":"notSelected",selectedSingle:y&&"single"===k?"isSelectedSingle":"notSelectedSingle",needsEventsHover:w?"isNeedsEventsHover":"notNeedsEventsHover",pseudoHover:F?"isPseudoHover":"notPseudoHover",active:V||r?"isActive":"notActive",focusHighlight:"highlight"===C&&a?"isFocusHighlight":"notFocusHighlight",focusRingVisible:o&&a?"isFocusRingVisible":"notFocusRingVisible",gridlineTop:h?"visible":"hidden",gridlineBottom:!c&&("end"!==I||c||y&&"single"===k)?"hidden":"visible"}),z=[];T&&("enabled"===T?z.push(v.paddingStyles.allPadding):"disabled"!==T&&("enabled"===T.top&&z.push(v.paddingStyles.topItemPadding),"enabled"===T.bottom&&z.push(v.paddingStyles.bottomItemPadding),"enabled"===T.start&&z.push(v.paddingStyles.startItemPadding),"enabled"===T.end&&z.push(v.paddingStyles.endItemPadding)));const N=s.classNames([K,...z]),O=f.mergeInterpolations([...Object.values(p.flexitemInterpolations)]),{class:D,..._}=O({flex:"1 1 auto",alignSelf:"center"}),G=s.classNames([D,b.isMultipleSelection(k)&&v.listItemStyles.checkboxContainer]);return t.jsx("div",{"aria-rowindex":"grid"===x?M+1:void 0,"aria-level":l,"data-oj-key":j,class:N,ref:A,role:P.item,...I&&{"data-oj-suggestion":!0},..."number"==typeof j&&{"data-oj-key-type":"number"},...R,children:t.jsx("div",{id:u.useId(),style:_,class:G,"aria-posinset":"grid"===x?void 0:M+1,"aria-setsize":"grid"===x?void 0:-1,onKeyDown:e=>{!S||"ArrowDown"!==e.key&&"ArrowUp"!==e.key||e.stopPropagation()},"aria-colindex":"grid"===x?1:void 0,"aria-selected":"none"!==k?y:void 0,...E,children:t.jsx(d.TabbableModeContext.Provider,{value:{isTabbable:S},children:t.jsx(g.FocusTrap,{isDisabled:!S,restoreFocusRef:!1,children:e(n)})})})})}const H=(e,t)=>"none"!==e&&(b.isMultipleSelection(e)||!t),z=c.memo(K,((e,t)=>!(!e||!t)&&(e.children===t.children&&e.isFocused===t.isFocused&&e.isFocusRingVisible===t.isFocusRingVisible&&e.isSelected===t.isSelected&&e.isTabbable===t.isTabbable&&e.isActive===t.isActive&&e.suggestion===t.suggestion&&e.isGridlineVisible===t.isGridlineVisible&&e.isTopGridlineVisible===t.isTopGridlineVisible&&e.padding===t.padding&&a.compareListItemContext(e.context,t.context))));function N({children:e,minimumCount:n=1}){const[l,a]=i.useState(!1);i.useEffect((()=>{setTimeout((()=>{a(!0)}),50)}),[]);const o=s.classNames([v.skeletonStyles.container]);return l&&e?t.jsx("div",{class:o,role:"presentation",children:[...Array(n)].map(((t,i)=>e(i)))}):null}function O({sparkleHeight:e}){const{name:i}=k.useTheme();if(e<=0)return null;const n=e+"px",l=s.classNames([v.sparkleStyles.base]),a=s.classNames([v.sparkleStyles.container,"oj-collection-sparkle","redwood"===i&&x.globalImages]);return t.jsx("div",{class:a,children:t.jsx("div",{class:l,style:{height:n}})},"sparkle")}const D=(e,t)=>{if(0===t)return null;return e.slice(0,t).reduce(((e,i,s)=>{const n=i.metadata.key;return s===t-1?e.set(n,"end"):e.set(n,!0),e}),new Map)},_=(e,t)=>{const i=t.data.map((e=>e.metadata.key)),s=i.indexOf(e.value.start),n=i.indexOf(e.value.end),l=Math.min(s,n),a=Math.max(s,n);return-1===l?{offset:0,count:t.totalSize}:i.slice(l,a+1)};const G=(e,t)=>t??{scroller:()=>e.current},B=(e,t)=>e.querySelector(`[role=${t}]`)?.id||"",U={all:!1,keys:new Set},q=t.jsx(N,{minimumCount:25,children:()=>t.jsx(V.Inset,{variant:"listview",children:t.jsx(h.Flex,{height:"6x",align:"center",children:t.jsx(y.Skeleton,{height:"4x"})})})}),W=t.jsx("div",{class:o.LOADMORE_STYLE_CLASS,children:t.jsx(N,{minimumCount:3,children:()=>t.jsx(V.Inset,{variant:"listview",children:t.jsx(h.Flex,{height:"6x",align:"center",children:t.jsx(y.Skeleton,{height:"4x"})})})})}),Y=(e,t)=>{if(t){const i=Math.min(t.offset,e.offset+e.totalSize),s=i-e.offset;s>0&&(e={offset:i,data:e.data.slice(s,s+t.count),totalSize:e.totalSize,sizePrecision:e.sizePrecision})}return e};e.List=function({"aria-label":e,"aria-labelledby":c,"aria-describedby":d,allowTabbableMode:u=!0,children:g,data:m,gridlines:f,loadingIndicator:p=q,loadMoreIndicator:y=W,currentItemOverride:h,onPersistCurrentItem:x,onLoadRange:k,onSelectionChange:C,onItemAction:T,rangeExtractor:A,role:j="grid",selectedKeys:V=U,selectionMode:w="none",viewportConfig:H,currentItemVariant:N,promotedSection:$,isVirtualized:J=!1,customItemRenderer:Q,scrollToVisibleOffset:X,testId:Z,scrollerRef:ee,reorderProps:te,contextMenuTriggerProps:ie,itemPadding:se,itemEnterKeyFocusBehavior:ne="focusWithin",...le}){const ae=i.useRef(null),oe=i.useRef(!1),re=i.useRef(),[ce,de]=i.useState(!1),ue="none"===w?void 0:b.isMultipleSelection(w),ge=null===m?void 0:"exact"===m.sizePrecision?m.totalSize:-1,be=s.classNames([v.listStyles.base]),me="embedded"===P.useCollectionInteractionContext(),fe=void 0!==N?N:me?"highlight":"none",pe=i.useCallback(((e,t)=>{m&&(re.current={detail:e,range:{offset:m.offset,count:m.data.length}},k(t))}),[m,k]),ve=i.useRef({offset:0,count:0}),ye=i.useCallback((e=>{oe.current&&ve.current.offset===e.offset&&ve.current.count===e.count||(oe.current=!0,ve.current=e,k(e))}),[oe,k]);i.useEffect((()=>{oe.current=!1}),[m]);const he=i.useMemo((()=>L(j)),[j]),Se={ArrowUp:e=>a.getPrevNextKey(ae.current,e,!0,a.ITEM_SELECTOR),ArrowDown:e=>a.getPrevNextKey(ae.current,e,!1,a.ITEM_SELECTOR)},{navigationProps:xe,currentKey:ke,showFocusRing:Ie,isCurrentTabbableKey:Ce}=b.useNavigation(m,ae,(e=>B(e,he.cell)),Se,h,x,H,X,"multiple"!==w||me,u,!0,me,"focusWithin"===ne),{eventProps:Te,handleSelectionChange:Ae,setAdditiveSelectionACKey:Pe}=((e,t,s="none",o,r,c,d,u,g,m,f)=>{const p=i.useRef(),v=i.useCallback((e=>{o&&(!1===e.value.all&&e.value.keys.size>0&&(p.current=Array.from(e.value.keys.values()).pop()),o(e))}),[p,o]),y=i.useCallback((e=>{if(c&&o){const i=_(e,c);if(Array.isArray(i))if("shiftSpace"===e.eventType?p.current=e.value.start:p.current=e.value.end,f||"multipleToggle"===s){const e=l.addKeys(t,i);o({value:e,target:null})}else o({value:{all:!1,keys:new Set(i)},target:null});else m(e,i)}}),[c,f,t,o,m]),{selectionProps:h}=M.useSelection((t=>t===g.current?void 0===e?null:e:a.keyExtractor(t,F)),t,f||"multipleToggle"===s?"none":s,!1,"replace",v,p.current,e,((e,t)=>a.getPrevNextKey(g.current,e,t,F)),void 0,(e=>{if(g.current){const t=a.findElementByKey(g.current,e,F);if(t){const e=d?.scroller(),i=u?u(g.current):0;b.scrollToVisible(t,null!=e?e:g.current,i)}}}),y),{eventProps:S,setAdditiveSelectionACKey:x}=E.useAdditiveSelection((t=>t===g.current?void 0===e?null:e:a.keyExtractor(t,F)),t,"multipleToggle"===s?"multiple":f?s:"none",!1,(e=>c?c.data.findIndex((t=>t.metadata.key===e)):-1),((e,t)=>c?c.data.map((e=>e.metadata.key)).slice(e,t):[]),((e,t)=>a.getPrevNextKey(g.current,e,t,F)),e,v,y,"multipleToggle"!==s&&f),k=R.useItemAction(e,c,r,F,f);return{eventProps:n.mergeProps(h,k,S),handleSelectionChange:v,setAdditiveSelectionACKey:x}})(ke,V,w,C,T,m,H,X,ae,pe,me);if(m&&void 0!==re.current&&C){const e=_(re.current.detail,m);if(Array.isArray(e))if(me){C({value:l.addKeys(V,e),target:null})}else C({value:{all:!1,keys:new Set(e)},target:null});const t=re.current?re.current.range:{offset:m.offset,count:m.data.length};m=Y(m,t),re.current=void 0,k(t)}const{sparkleHeight:je,suggestions:Me}=((e,t,s)=>{const[n,l]=i.useState(0),a=i.useMemo((()=>e&&t&&D(e.data,t.count)),[e,t]);return i.useEffect((()=>{if(a){const e=s.current?.querySelector("."+r.PLACEHOLDER_STYLE_CLASS);let t=e?.offsetHeight||0;const i=s.current?.querySelectorAll("[data-oj-suggestion]");i?.forEach((e=>t+=e.offsetHeight)),l(t)}}),[s,a]),{sparkleHeight:n,suggestions:a}})(m,$,ae),Ee=t.jsx(O,{sparkleHeight:je}),Re=i.useCallback((e=>{const i=e.data,s=b.isMultipleSelection(w)?()=>t.jsx(S.Selector,{onChange:e=>{Ae(e),Pe(i.metadata.key)},rowKey:i.metadata.key,selectedKeys:V}):void 0;return{index:e.index,data:i.data,metadata:i.metadata,selector:s}}),[w,V,Ae]),Ve=J?K:z,we=e=>{const i=Re(e),s=Me?.get(i.metadata.key),n=u&&Ce(i.metadata.key),a=ke===i.metadata.key&&!n,o=a&&ce,r=l.containsKey(V,i.metadata.key),c=a&&Ie,d=(e,n)=>{return t.jsx(Ve,{context:e,isFocused:a,isFocusRingVisible:c,isActive:o,isGridlineVisible:(l=i.index,"visible"===f?.item&&(l+1!==m?.totalSize||"visible"===f?.bottom)),isSelected:r,isTabbable:u&&Ce(i.metadata.key),role:j,selectionMode:w,currentItemVariant:fe,padding:se,...s&&{suggestion:s},...0===i.index&&{isTopGridlineVisible:"visible"===f?.item&&"visible"===f?.top},...n,children:g},i.metadata.key);var l};if(Q){return Q({listItemContext:i,isFocused:a,isFocusRingVisible:c,isSelected:r,isTabbable:n,isActive:o,defaultListItem:d})}return d(i)};H=G(ae,H);const Le=i.useCallback((e=>{" "===e.key&&l.isKeyDefined(ke)&&"none"!==w&&de(!0)}),[ke,w,de]),Fe=i.useCallback((()=>{de(!1)}),[de]);i.useImperativeHandle(ee,(()=>ae.current));const Ke=I.useTestId(Z);return t.jsx("div",{...n.mergeProps(Te,xe,ie||{},te||{},{onKeyDown:Le,onKeyUp:Fe},le),...Ke,role:j,"aria-rowcount":"grid"===j?ge:void 0,"aria-colcount":"grid"===j?1:void 0,ref:ae,class:be,tabIndex:0,"aria-label":e,"aria-labelledby":c,"aria-describedby":d,"aria-multiselectable":ue,children:null==m?p:J?t.jsx(r.VirtualizedCollection,{data:m,itemSelector:a.ITEM_SELECTOR,loadMoreIndicator:y,onLoadRange:k,rangeExtractor:A,suggestions:Ee,viewportConfig:H,children:we}):t.jsx(o.LoadMoreCollection,{data:m.data,loadMoreIndicator:y,hasMore:"atLeast"===m.sizePrecision&&m.data.length<=m.totalSize,onLoadMore:()=>{m&&ye({offset:0,count:m.data.length+25})},suggestions:Ee,viewportConfig:H,children:we})})},e.SkeletonContainer=N}));
//# sourceMappingURL=List-5b5b3bd7.js.map
