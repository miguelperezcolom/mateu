define("oj-c/conveyor-belt/conveyorBeltItem",["require","exports","preact/jsx-runtime","@oracle/oraclejet-preact/UNSAFE_ConveyorBelt"],(function(require,e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConveyorBeltItem=void 0;e.ConveyorBeltItem=({context:e,itemTemplate:a})=>{const o={data:e.data.data,item:e.data};return(0,t.jsx)(r.ConveyorBeltItem,{children:a&&a(o)})}})),
/**
 * @license
 * Copyright (c) %FIRSTYEAR% %CURRENTYEAR%, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define("oj-c/hooks/UNSAFE_useDataProvider/utils",["require","exports"],(function(require,e){"use strict";function t(e,t,r,a){const o=[...a];return e.forEach(((e,a)=>{const n={data:t[a],key:r[a]?.key,metadata:r[a]};e>=0?o.splice(e,0,n):o.push(n)})),o}async function r(e,t){const r=[],a=(await e.fetchByKeys({keys:t})).results;for(const e of t)if(a.has(e)){const t=a.get(e);r.push({...t,key:e})}return r}function a(e,t){return e.has(t)?e.get(t):-1}function o(e,t){const r=[...t];return e.sort(((e,t)=>t-e)),e.forEach((e=>{e<r.length&&r.splice(e,1)})),r}Object.defineProperty(e,"__esModule",{value:!0}),e.getUpdatedItemsFromMutationDetail=async function(e,n,s){const{add:i,remove:c,update:l}=e??{},d=new Map;for(const[e,t]of n.entries())d.set(t.key,e);let u=[...n];c&&(u=function(e,t,r){const{indexes:n,keys:s}=e;let i=[...t];n?.length?i=o(n,i):s?.size&&(i=function(e,t,r){const n=[];return e.forEach((e=>{const t=a(r,e);-1!==t&&n.push(t)})),o(n,t)}(s,i,r));return i}(c,u,d));i&&(u=await async function(e,o,n,s){const{addBeforeKeys:i,data:c,indexes:l,keys:d,metadata:u}=e;let h=[...o],f=c||[],y=u||[];if(0===f.length&&d?.size){const e=await r(s,d)??[];f=e.map((e=>e.data)),y=e.map((e=>e.metadata))}0===y.length&&d?.size&&(y=[...d].map((e=>({key:e}))));f.length&&(h=l?.length?t(l,f,y,h):i?.length?function(e,r,o,n){const s=[],i=[];return e.forEach((e=>{s.push(a(n,e)),i.push({key:e})})),t(s,r,i,o)}(i,f,h,n):function(e,r,a){return t(new Array(e.length).fill(-1),e,r,a)}(f,y,h));return h}(i,u,d,s));l&&(u=await async function(e,t,o,n){const{data:s,indexes:i,keys:c,metadata:l}=e;let d=[...t],u=s||[],h=l||[];if(0===u.length&&c?.size){const e=await r(n,c)??[];u=e.map((e=>e.data)),h=e.map((e=>e.metadata))}0===h.length&&c?.size&&(h=[...c].map((e=>({key:e}))));u.length&&(i?.length?d=function(e,t,r,a){const o=[...a];return e.forEach(((e,a)=>{if(o[e]){const n={data:t[a],key:r[a]?.key,metadata:r[a]};o.splice(e,1,n)}})),o}(i,u,h,d):c?.size&&(d=function(e,t,r,o,n){const s=[...o];return e.forEach((e=>{const o=a(n,e),i={data:t[o],key:r[o]?.key,metadata:r[o]};o>=0&&s.splice(o,1,i)})),s}(c,u,h,d,o)));return d}(l,u,d,s));return u}})),define("oj-c/hooks/UNSAFE_useDataProvider/DataProviderHandler",["require","exports","./utils"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DataProviderHandler=void 0;e.DataProviderHandler=class{constructor(e,r,a){this.handleMutateEvent=async e=>{const{detail:r}=e,a=this.addBusyState("updating data from mutation event"),o=await(0,t.getUpdatedItemsFromMutationDetail)(r,this.currentData,this.dataProvider);a?.(),this.currentData=o,this.callback?.onDataUpdated?.(o)},this.handleRefreshEvent=()=>{this._fetchDataAndNotify()},this.addBusyState=r,this.callback=a,this.dataProvider=e,this.currentData=[],e.addEventListener("refresh",this.handleRefreshEvent),e.addEventListener("mutate",this.handleMutateEvent),this._fetchDataAndNotify()}destroy(){this.callback=void 0,this.currentData=[],this.dataProvider.removeEventListener("refresh",this.handleRefreshEvent),this.dataProvider.removeEventListener("mutate",this.handleMutateEvent)}async _fetchData(){const e=[],t=this.dataProvider.fetchFirst({size:-1});for await(const r of t){const t=r.data.map(((e,t)=>({data:e,key:r.metadata[t].key,metadata:r.metadata[t]})));e.push(...t)}return this.currentData=e.slice(),e}async _fetchDataAndNotify(){const e=this.addBusyState("fetching data"),t=await this._fetchData();this.callback?.onDataUpdated?.(t),e()}}})),
/**
 * @license
 * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define("oj-c/hooks/UNSAFE_useDataProvider/useDataProvider",["require","exports","preact/hooks","./DataProviderHandler"],(function(require,e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useDataProvider=function({addBusyState:e,data:a}){const[o,n]=(0,t.useState)([]),s=(0,t.useRef)();return(0,t.useEffect)((()=>(void 0!==a&&(s.current=new r.DataProviderHandler(a,e,{onDataUpdated:n})),()=>{s.current?.destroy(),s.current=void 0})),[a,e]),{data:o}}})),define("oj-c/conveyor-belt/conveyor-belt",["require","exports","preact/jsx-runtime","@oracle/oraclejet-preact/translationBundle","ojs/ojcontext","@oracle/oraclejet-preact/UNSAFE_ConveyorBelt","@oracle/oraclejet-preact/hooks/UNSAFE_useUser","ojs/ojvcomponent","preact/hooks","preact/compat","./conveyorBeltItem","oj-c/hooks/UNSAFE_useDataProvider/useDataProvider","css!oj-c/conveyor-belt/conveyor-belt-styles.css"],(function(require,e,t,r,a,o,n,s,i,c,l,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConveyorBelt=void 0;const u=(0,c.forwardRef)((({addBusyState:e,onScrollPositionChanged:r,items:a,itemTemplate:n,children:s,...c},u)=>{const h=(0,i.useRef)(null);(0,i.useImperativeHandle)(u,(()=>({scrollElementIntoView:e=>h.current?.scrollElementIntoView(e),scrollPrevious:()=>h.current?.scrollPrevious(),scrollNext:()=>h.current?.scrollNext()})),[]);const f=function(e){return e&&"fetchFirst"in e||!1}(a),{data:y}=(0,d.useDataProvider)({data:f?a:void 0,addBusyState:e}),v=(0,i.useMemo)((()=>{const e=!f&&a?[...a].map((e=>{const t={key:e.key};return{key:e.key,data:{data:e.data,metadata:t}}})):[];return f?Array.isArray(y)?y.map((e=>{const t={key:e.key};return{key:e.key,data:{data:e.data,metadata:e.metadata??t}}})):[]:e}),[y,f,a]),m=n?v.map(((e,r)=>{const a={index:r,data:e.data,metadata:e.data.metadata};return(0,t.jsx)(l.ConveyorBeltItem,{context:a,itemTemplate:n})})):s;return(0,t.jsx)(o.ConveyorBelt,{onScrollPositionChanged:e=>{null!=e&&r?.(e)},ref:h,...c,children:m})}));e.ConveyorBelt=(0,s.registerCustomElement)("oj-c-conveyor-belt",(0,c.forwardRef)((({children:e,orientation:r="horizontal",...o},c)=>{const l=(0,i.useRef)(),d=(0,i.useRef)(null),h=(0,i.useRef)(a.getContext(l.current).getBusyContext()),f=(0,i.useCallback)((e=>h.current?.addBusyState({description:`oj-c-conveyor-belt: ${e}`})),[]),{direction:y}=(0,n.useUser)();return(0,i.useImperativeHandle)(c,(()=>({scrollElementIntoView:e=>d.current?.scrollElementIntoView(e)})),[]),(0,t.jsx)(s.Root,{ref:l,onKeyDown:e=>{if(e.target===l.current)if("horizontal"===r)switch(e.key){case"ArrowRight":"rtl"===y?d.current?.scrollPrevious():d.current?.scrollNext(),e.preventDefault();break;case"ArrowLeft":"rtl"===y?d.current?.scrollNext():d.current?.scrollPrevious(),e.preventDefault()}else if("vertical"===r)switch(e.key){case"ArrowDown":d.current?.scrollNext(),e.preventDefault();break;case"ArrowUp":d.current?.scrollPrevious(),e.preventDefault()}},children:(0,t.jsx)(u,{ref:d,addBusyState:f,orientation:r,...o,children:e})})})),"ConveyorBelt",{slots:{"":{},itemTemplate:{data:{}}},properties:{scrollPosition:{type:"number",writeback:!0},arrowVisibility:{type:"string",enumValues:["auto","hidden","visible"]},items:{type:"Array<object>|DataProvider"},orientation:{type:"string",enumValues:["horizontal","vertical"]}},extension:{_WRITEBACK_PROPS:["scrollPosition"],_READ_ONLY_PROPS:[]},methods:{scrollElementIntoView:{}}},{orientation:"horizontal"},{"@oracle/oraclejet-preact":r.default})})),define("oj-c/conveyor-belt",["require","exports","oj-c/conveyor-belt/conveyor-belt"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConveyorBelt=void 0,Object.defineProperty(e,"ConveyorBelt",{enumerable:!0,get:function(){return t.ConveyorBelt}})}));
//# sourceMappingURL=conveyor-belt.js.map