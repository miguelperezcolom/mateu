define(['exports', 'preact/hooks', './useCurrentKey-2f1ca19e', './useReorderableContext-a5453bd7', './useCollectionFocusRing-35d278f5', './useTabbableModeSet-290ab1cf', './collectionUtils-26e6c87c', './mergeProps-bcfa6a92', './keys-4755c121'], (function(e,r,t,n,c,o,u,s,i){"use strict";const l=(e,t)=>{const[c,o]=r.useState(),u=r.useRef(),s=r.useRef(!1),i=n.useReorderableContext(),l=r.useMemo((()=>e=>{const r=e.value;o({rowKey:r}),t?.(e),null!=i?.currentItemKey&&(i.currentItemKey.current=r)}),[t,i?.currentItemKey]);return u.current!==e&&(u.current=e,c?.rowKey!==e?.rowKey&&(s.current=!0,l({value:e?.rowKey}))),r.useEffect((()=>{s.current=!1})),{currentKey:c?.rowKey,onCurrentKeyChange:l,isCurrentItemOverridden:s.current}},a=(e,r,t)=>{if(e&&r&&(e.scrollIntoViewIfNeeded?e.scrollIntoViewIfNeeded():e.scrollIntoView({block:"nearest"}),t>0)){const n=r.getBoundingClientRect(),c=e.getBoundingClientRect(),o=n.top+t-c.top;o>0&&(r.scrollTop=r.scrollTop-o)}},d=(e,r,t,n)=>{if(r.current){const c=t?.scroller(),o=n?n(r.current):0;a(e,c||r.current,o)}},f=e=>!(!e.parentElement||!e.parentElement.classList.contains("oj-listview-expander"));e.excludeGroup=(e,r)=>{if(!r.all){const t=e.data.filter((e=>!e.metadata.isLeaf)).map((e=>e.metadata.key)),n=Array.from(r.keys.values()).filter((e=>!t.includes(e)));return{...r,keys:new Set(n)}}return r},e.isMultipleSelection=e=>"multiple"===e||"multipleToggle"===e,e.scrollToVisible=a,e.useCurrentItemOverride=l,e.useNavigation=(e,n,a,y,C,E,K,b,m,g,p,T,v)=>{const I=r.useRef(),R=r.useRef(!0),{currentKey:w,onCurrentKeyChange:k,isCurrentItemOverridden:S}=l(C,E),{currentKeyProps:O}=t.useCurrentKey((e=>u.keyExtractor(e,u.ITEM_SELECTOR)),m,y.ArrowUp(w),y.ArrowDown(w),y.ArrowLeft?.(w),y.ArrowRight?.(w),w,k),[M,L]=c.useCollectionFocusRing(n,Object.keys(y)),[x,A]=o.useTabbableModeSet(n,(e=>f(e)?null:u.keyExtractor(e,u.ITEM_SELECTOR)),w,k,void 0,void 0,v),h=r.useCallback((e=>{const r=u.keyExtractor(e.target,u.ITEM_SELECTOR);i.isKeyDefined(r)&&(I.current=r,r!==w&&(R.current=!1))}),[w]),D=r.useCallback((()=>{if(n.current&&(!g||x(void 0))){const e=I.current||u.getFirstVisibleKey(n.current,u.ITEM_SELECTOR);i.isKeyDefined(e)&&k({value:e})}}),[n,w,k,g,x]),_=r.useCallback((e=>{if(f(e.target))n.current?.focus({preventScroll:!0});else if(n.current)if(i.isKeyDefined(w)){const e=u.findElementByKey(n.current,w,u.ITEM_SELECTOR);e?(R.current&&d(e,n,K,b),R.current=!0):D()}else D()}),[n,w,D,K,b]);return r.useEffect((()=>{if(p&&n.current&&i.isKeyDefined(w)){const e=u.findElementByKey(n.current,w,u.ITEM_SELECTOR);if(e){const r=a(e),t=n.current.getAttribute("aria-activedescendant");if(""!==r&&t!==r){n.current.setAttribute("aria-activedescendant",r);const t=n.current?.contains(document.activeElement);(!S&&t||T)&&d(e,n,K,b)}}}}),[e,n,w,a,K,b,S,p,T]),{navigationProps:s.mergeProps(O,L,g?A:{},{onFocus:_,onPointerDown:h}),currentKey:w,onCurrentKeyChange:k,isCurrentItemOverridden:S,showFocusRing:M,isCurrentTabbableKey:x}}}));
//# sourceMappingURL=useNavigation-a6a2218f.js.map
