define(['exports', 'preact/jsx-runtime', 'preact/compat', './useModal-536cb7ff', './Layer-dc3c1ac9', './LayerHost-7d4aa6d3', './UNSAFE_Modal/themes/ModalStyles.css', './tabbableUtils-9101c0e5', './popupUtils-e19b93b5'], (function(e,t,n,s,r,o,l,a,i){"use strict";const u=n.forwardRef((({variant:e="scrim"},n)=>{const s=l.multiVariantStyles({backdrop:"transparent"===e?"transparent":"scrim"});return t.jsx("div",{ref:n,class:s})}));const c=new class{constructor(){this.isFocusHandlerActive=!1,this.focusHandler=e=>{const t=this.getTopModal(),n=e.target;if(t&&n){const s=t.modalRef;if(s&&!s.contains(n)&&!i.isLogicalAncestor(s,n)&&!this._parentLayerContainsNode(s,n)){a.allTabbableElements(s).length>0&&(a.focusWithin(s),e.preventDefault(),e.stopPropagation())}}},this.getTopModal=()=>this.modals.length>0?this.modals[this.modals.length-1]:null,this.islegacyLayerSupportAvailable=()=>null!==document.getElementById("__oj_zorder_container"),this.modals=[],this.styleBackup=[]}push(e){if(-1===this._findModalIndex(e)){if(this.modals.push(e),1===this.modals.length){const t=this._getOwnerDocument(e.modalRef).body,n=window.innerWidth-document.documentElement.clientWidth;if(n>1){Math.round(document.documentElement.getBoundingClientRect().left)+document.documentElement.scrollLeft?(this.styleBackup.push({property:"padding-left",value:t.style.paddingLeft}),t.style.paddingLeft=`${n}px`):(this.styleBackup.push({property:"padding-right",value:t.style.paddingRight}),t.style.paddingRight=`${n}px`)}this.styleBackup.push({property:"overflow",value:t.style.overflow}),this.styleBackup.push({property:"overflow-x",value:t.style.overflowX}),this.styleBackup.push({property:"overflow-y",value:t.style.overflowY}),t.style.overflow="hidden"}1!==this.modals.length||this.islegacyLayerSupportAvailable()||(document.addEventListener("focus",this.focusHandler,!0),this.isFocusHandlerActive=!0)}}pop(e){const t=this._findModalIndex(e);if(-1!==t&&t===this.modals.length-1&&(this.isFocusHandlerActive&&1===this.modals.length&&document.removeEventListener("focus",this.focusHandler,!0),this.modals.pop(),0===this.modals.length)){const t=this._getOwnerDocument(e.modalRef).body;this.styleBackup.forEach((({property:e,value:n})=>{t.style.setProperty(e,n)}))}}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}_findModalIndex(e){let t=-1;return this.modals.forEach(((n,s)=>{n!==e||(t=s)})),t}_getOwnerDocument(e){return e&&e.ownerDocument||document}_parentLayerContainsNode(e,t){const n=e.closest("[data-oj-layer]");return!(!n||!n.contains(t))}};function d(e){const t=[];let n=e.previousSibling;for(;null!=n;)1===n.nodeType&&t.push(n),n=n.previousSibling;for(n=e.nextSibling;null!=n;)1===n.nodeType&&t.push(n),n=n.nextSibling;return t}function p(e){e.forEach((e=>{e.removeAttribute("aria-hidden")}))}e.Modal=({children:e,isOpen:o,onBackdropClick:a,backdropVariant:i})=>{const h=c,{backdropRef:f}=s.useModal({isOpen:o,onBackdropClick:a}),m=n.useRef(null),y=n.useRef(null),g=n.useRef({}),v=()=>(g.current.modalRef=m.current,g.current);n.useEffect((()=>{o&&m.current?h?.push(v()):g.current.modalRef&&(null!==y.current&&(p(y.current),y.current=null),h?.pop(v()))}),[o,h]),n.useEffect((()=>{const e=g.current.modalRef;return()=>{null!==y.current&&(p(y.current),y.current=null),e&&h?.pop(v())}}),[h]);return o?t.jsx(r.Layer,{isModal:!0,children:t.jsxs("div",{ref:m,class:l.baseStyle,onFocus:()=>{m.current&&null===y.current&&(y.current=function(e){if(!e)return[];const t=[];let n=e.parentElement;do{if(!n)break;d(n).forEach((e=>{"script"!==e.tagName.toLowerCase()&&"true"!==e.getAttribute("aria-hidden")&&(t.push(e),e.setAttribute("aria-hidden","true"))})),n=n.parentElement}while(n&&"body"!==n.tagName.toLowerCase());return t}(m.current))},children:[t.jsx(u,{ref:f,variant:i}),e]})}):null}}));
//# sourceMappingURL=Modal-8d647f76.js.map
