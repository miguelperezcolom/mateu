/**
 * @license
 * Copyright (c) 2014, 2025, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["exports","jquery","ojs/ojdomutils","ojs/ojcore-base"],function(e,t,n,o){"use strict";t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o;const s={_EVENT_NAMESPACE:".contextMenu",stopDetectContextMenuGesture:function(e){const n=o.AgentUtils.getAgentInfo().os===o.AgentUtils.OS.IOS,r=e._allowBrowserContextMenu;e._touchStartListener&&(document.removeEventListener("touchstart",e._touchStartListener,{passive:!0}),delete e._touchStartListener),e._touchCancelListener&&(document.removeEventListener("touchcancel",e._touchCancelListener,{passive:!0}),delete e._touchCancelListener),e._touchEndListener&&(document.removeEventListener("touchend",e._touchEndListener,{passive:!1}),delete e._touchEndListener),e._browserSelectionChangeListener&&(document.removeEventListener("selectionchange",e._browserSelectionChangeListener,{passive:!0}),delete e._browserSelectionChangeListener),e._touchMoveListener&&(r&&n?document.removeEventListener("touchmove",e._touchMoveListener,{passive:!0}):e.removeEventListener("touchmove",e._touchMoveListener,{passive:!0}),delete e._touchMoveListener),e._clickListener&&(t(e).off(s._EVENT_NAMESPACE).removeClass("oj-menu-context-menu-launcher")[0].removeEventListener("click",e._clickListener,!0),clearTimeout(e._contextMenuPressHoldTimer),delete e._clickListener,delete e._contextMenuPressHoldTimer),e._touchStartAndMouseDownListener&&(e.removeEventListener("touchstart",e._touchStartAndMouseDownListener,{passive:!1}),delete e._touchStartAndMouseDownListener),e._browserSelectStartListener&&(document.removeEventListener("selectstart",e._browserSelectStartListener,{passive:!0}),delete e._browserSelectStartListener,delete e._webKitUserSelectValue,delete e._userSelectValue),e._dragListener&&(e.removeEventListener("drag",e._dragListener,{passive:!1}),delete e._dragListener)},startDetectContextMenuGesture:function(e,r,u,c){var i,a,l,d,v,m=n.PRESS_HOLD_THRESHOLD;let h;n.isTouchSupported()&&t(e).addClass("oj-menu-context-menu-launcher");var p,L,_=!1,f=!1,y=null,S=s._EVENT_NAMESPACE,E=!1;const w=function(n,o,s){if((_=s)&&t(e).one("touchend"+S,function(){E=!0,setTimeout(function(){E=!1},50)}),"touchstart"===y&&"contextmenu"===n.type||"contextmenu"===y&&"touchstart"===n.type||"keydown"===y&&"contextmenu"===n.type)return"keydown"===y&&"contextmenu"===n.type&&n.preventDefault(),y=null,void clearTimeout(L);n.isDefaultPrevented&&n.isDefaultPrevented()||n.originalEvent&&n.originalEvent.defaultPrevented||n.defaultPrevented||("touchstart"!==n.type&&"touchmove"!==n.type||(n.originalEvent=n),c?.allowBrowserContextMenu&&v()||(r(n,o),(n.isDefaultPrevented&&n.isDefaultPrevented()||n.defaultPrevented)&&("touchstart"!==n.type&&"contextmenu"!==n.type&&"keydown"!==n.type||(y=n.type,L=setTimeout(function(){y=null},300)))))};t(e).on("keydown"+S+" contextmenu"+S,function(e){var t;("contextmenu"===e.type||("F10"===e.key||121===e.keyCode)&&e.shiftKey)&&(t=f?"touch":"keydown"===e.type?"keyboard":"mouse",w(e,t,!1));return!0});const g=o.AgentUtils.getAgentInfo().os===o.AgentUtils.OS.IOS,b=c?.allowBrowserContextMenu;if(b){e._allowBrowserContextMenu=!0,e.classList.add("oj-menu-allow-browser-context-menu"),d=!1,v=function(){if(d)return!0;const e=document.getSelection();return!("None"===e.type||e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset)};const t=function(e){"#text"===e.target.nodeName?(d=!0,setTimeout(()=>{d=!1},10)):d=!1};if(e._browserSelectStartListener=t,document.addEventListener("selectstart",t,{passive:!0}),g){let t,n,o,s,c;const d=function(n){n.preventDefault(),t=!0,e._webKitUserSelectValue=document.body.style["-webkit-user-select"],document.body.style["-webkit-user-select"]="none",e._userSelectValue=document.body.style.userSelect,document.body.style.userSelect="none",document.getSelection().empty(),r(n,"touch")},v=function(e){const t=e.touches[0];i=t.pageX,a=t.pageY;let r=2*m;null==n?(o=Date.now(),s=e):r=n+m,c=setTimeout(d.bind(null,e),r)};e._touchStartListener=v,document.addEventListener("touchstart",v,{passive:!0});const h=function(n){clearTimeout(c),t&&(n.preventDefault(),setTimeout(()=>{document.body.style["-webkit-user-select"]=e._webKitUserSelectValue,document.body.style.userSelect=e._userSelectValue,t=!1},500),setTimeout(()=>{u&&u.focus()},1e3))};e._touchEndListener=h,document.addEventListener("touchend",h,{passive:!1});const p=function(){clearTimeout(c),t&&(document.body.style["-webkit-user-select"]=e._webKitUserSelectValue,document.body.style.userSelect=e._userSelectValue,t=!1)};e._touchCancelListener=p,document.addEventListener("touchcancel",p,{passive:!0}),l=function(e){const t=e.touches[0];(Math.abs(i-t.pageX)>5||Math.abs(a-t.pageY)>5)&&clearTimeout(c)},e._touchMoveListener=l,document.addEventListener("touchmove",l,{passive:!0});const L=function(){null!=o&&null==n&&"Range"===document.getSelection().type&&(clearTimeout(c),n=Date.now()-o,c=setTimeout(d.bind(null,s),m))};return e._browserSelectionChangeListener=L,void document.addEventListener("selectionchange",L,{passive:!0})}}else{const t=function(){setTimeout(()=>{h&&(u&&(u.contains(document.activeElement)||u.focus()),h=!1)},1e3)};e._touchEndListener=t,document.addEventListener("touchend",t,{passive:!1})}var M=function(e){_&&(e.preventDefault(),e.stopPropagation(),_=!1)};e._clickListener=M,e.addEventListener("click",M,!0);var x=function(t){if("mousedown"!==t.type||!E){if(_=!1,"touchstart"===t.type&&1===t.touches.length){var n=t.touches[0];i=n.pageX,a=n.pageY,f=!0,p=setTimeout(()=>{w.bind(void 0,t,"touch",!0)(),h=!0},m),e._contextMenuPressHoldTimer=p}return!0}};e._touchStartAndMouseDownListener=x,e.addEventListener("touchstart",x,{passive:!1}),l=function(e){var t=e.touches[0];return(Math.abs(i-t.pageX)>5||Math.abs(a-t.pageY)>5)&&(f=!1,clearTimeout(p)),!0},e._touchMoveListener=l,e.addEventListener("touchmove",l,{passive:!0});const T=function(e){return(Math.abs(i-e.pageX)>5||Math.abs(a-e.pageY)>5)&&(f=!1,clearTimeout(p)),!0};e._dragListener=T,e.addEventListener("drag",T,{passive:!0}),t(e).on("touchend"+S+" touchcancel"+S,function(){return f=!1,clearTimeout(p),!0}).on("mousedown"+S,x)}},r=s.startDetectContextMenuGesture,u=s.stopDetectContextMenuGesture;e.startDetectContextMenuGesture=r,e.stopDetectContextMenuGesture=u,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ojgestureutils.js.map