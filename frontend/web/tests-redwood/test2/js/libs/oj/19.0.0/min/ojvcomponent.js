/**
 * @license
 * Copyright (c) 2014, 2025, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["require","exports","preact/compat","preact/jsx-runtime","preact","ojs/ojcustomelement-utils","ojs/ojcustomelement-registry","preact/hooks","@oracle/oraclejet-preact/UNSAFE_Environment","ojs/ojcore-base","ojs/ojpreact-patch","ojs/ojlogger","ojs/ojmetadatautils","@oracle/oraclejet-preact/UNSAFE_Layer","ojs/ojlayerutils","ojs/ojconfig","ojs/ojcontext","ojs/ojtranslationbundleutils","@oracle/oraclejet-preact/hooks/UNSAFE_useBusyStateContext"],function(e,t,o,n,s,r,i,a,l,c,p,u,d,h,_,m,f,y,g){"use strict";c=c&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c,f=f&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f;let C,v=0;const b=new Map,P=new Map,E=Symbol(),S="@oj_s";function j(e,t,o,n){const i=function(e){let t=e[E];void 0===t&&(t=S+v++,e[E]=t);return t}(t);let l=0;function c(){l++}function d(){if(l--,l<0)throw new r.JetElementError(e,"Slot reference count underflow");if(0===l)n(t);else{const e=t.parentElement;e&&p.patchSlotParent(e)}}t[p.OJ_SLOT_REMOVE]=()=>null;const h=function(e){e?(c(),p.patchSlotParent(t.parentElement),o(t)):d()};return s.h(()=>(function(e,t,o){let n=b.get(e);const s=0===b.size;n?n.has(t)&&function(e,t){const o=t.nodeType===Node.ELEMENT_NODE?t.getAttribute("slot")??"":"";u.error(`Custom Element "<${e.localName}>" with id "${e.id}" \n  is distributing slot "${o}" more than once`)}(e,o):(n=new Set,b.set(e,n));n.add(t),P.set(t,o),s&&(C=document.createElementNS,document.createElementNS=x)}(e,i,t),c(),a.useLayoutEffect(()=>{!function(e,t){const o=b.get(e);o?.delete(t),0===o?.size&&b.delete(e);0===b.size&&(P.clear(),document.createElementNS=C)}(e,i),d()}),s.h(i,{ref:h,key:i})),null)}function x(e,t,o){return t.startsWith(S)?P.get(t):C.call(document,e,t,o)}class w{parkNode(e){this._getLot().appendChild(e)}disposeNodes(e,t){w._iterateSlots(e,e=>{const o=e.parentElement;this._lot===o?(t(e),this._lot.__removeChild(e)):o||t(e)})}disconnectNodes(e){w._iterateSlots(e,e=>{this._lot===e.parentElement&&this._lot.__removeChild(e)})}reconnectNodes(e){w._iterateSlots(e,e=>{e.parentElement||this._lot.appendChild(e)})}isParked(e){return e?.parentElement===this._lot}_getLot(){if(!this._lot){const e=document.createElement("div");e.__removeChild=e.removeChild,e.removeChild=e=>e,e.style.display="none",document.body.appendChild(e),this._lot=e}return this._lot}static _iterateSlots(e,t){Object.keys(e).forEach(o=>{e[o].forEach(e=>{t(e)})})}}const k=new w,R=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function O(e,t,o){"-"===t[0]?e.setProperty(t,o):null==o?e[t]="":"number"!=typeof o||R.test(t)?e[t]=o:e[t]=o+"px"}function T(e,t,o,n,s){let r;e:if("style"===t)if("string"==typeof o)e.style.cssText=o;else{if("string"==typeof n&&(e.style.cssText=n=""),n)for(t in n)o&&t in o||O(e.style,t,"");if(o)for(t in o)n&&o[t]===n[t]||O(e.style,t,o[t])}else if("o"===t[0]&&"n"===t[1])if(r=t!==(t=t.replace(/(PointerCapture)$|Capture$/i,"$1")),t=t.toLowerCase()in e||"onFocusOut"===t||"onFocusIn"===t?t.toLowerCase().slice(2):t.slice(2),e._listeners||(e._listeners={}),e._listeners[t+r]=o,o){if(!n){const o=r?M:A;e.addEventListener(t,o,r)}}else{const o=r?M:A;e.removeEventListener(t,o,r)}else if("dangerouslySetInnerHTML"!==t){if(s)t=t.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if("width"!=t&&"height"!=t&&"href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!=t&&"download"!=t&&"rowSpan"!=t&&"colSpan"!=t&&"role"!=t&&"popover"!=t&&t in e)try{e[t]=null==o?"":o;break e}catch(e){}"function"==typeof o||(null==o||!1===o&&"-"!==t[4]?e.removeAttribute(t):e.setAttribute(t,"popover"==t&&1==o?"":o))}}function A(e){this._listeners[e.type+!1](s.options.event?s.options.event(e):e)}function M(e){this._listeners[e.type+!0](s.options.event?s.options.event(e):e)}const N=Symbol(),L=Symbol();class U extends s.Component{constructor(e){super(e),this.getEnvironmentContextObj=(e,t,o,n,s)=>{let r=e;return r?t&&t!==r?(r=t,this.extendTranslationBundleMap(r,s)):(o&&o!==r.colorScheme||n&&n!==r.scale)&&(r=Object.assign({},r,o&&{colorScheme:o},n&&{scale:n})):(r=t||{colorScheme:o,scale:n,user:{locale:m.getLocale()}},this.extendTranslationBundleMap(r,s)),r},this.extendTranslationBundleMap=(e,t)=>{e.translations?e.translations!==t&&Object.keys(t).forEach(o=>{e.translations[o]||(e.translations[o]=t[o])}):e.translations=t},this.state={compProps:e.initialCompProps,renderCount:0,connected:!0},this._layerContext=_.getLayerContext(e.baseElem)}shouldComponentUpdate(e,t){return this.state.renderCount!==t.renderCount||this.state.connected!==t.connected}render(e){if(!this.state.connected)return null;const t=this.state.compProps,o=e.baseComp,s=n.jsx(o,{...t}),r=B(this.getEnvironmentContextObj,[e.baseElem.__oj_private_contexts?.get(l.EnvironmentContext),e.baseElem.__oj_private_color_scheme,e.baseElem.__oj_private_scale,e.translationBundleMap]),i=e.baseElem.__oj_private_contexts,a=i?Array.from(i).reduce((e,[t,o])=>{if(t===l.EnvironmentContext)return e;return n.jsx(t.Provider,{value:o,children:e})},s):s,c=s.props;return c[N]=e.baseElem,c[L]=e.rootPatchCallback,n.jsx(h.LayerContext.Provider,{value:this._layerContext,children:n.jsx(l.RootEnvironmentProvider,{environment:r,children:a})})}}const B=(e,t)=>(e.memoState||(e.memoState={value:void 0,prevArgs:void 0}),H(e.memoState.prevArgs,t)&&(e.memoState.value=e(e.memoState.value,...t),e.memoState.prevArgs=t),e.memoState.value),H=(e,t)=>!e||e.length!==t.length||t.some((t,o)=>t!==e[o]),D=(e,t)=>{if(e){if("function"==typeof e)return e(t);e.current=t}},I=new Set,V=Symbol(),F=Symbol(),$="subproperty",q="propChange";class z{constructor(e,t,o,n,i,a){this.ref=s.createRef(),this._compWithContextsRef=s.createRef(),this._initialized=!1,this._isPatching=!1,this._props={ref:this.ref},this._verifyingState=W.Unset,this._earlySets=[],this._eventQueue=[],this._isRenderQueued=!1,this._state=r.CustomElementUtils.getElementState(e),this._element=e,this._metadata=o,this._component=t,this._controlledProps=i?.length>0?new Set(i):I,this._controlledAttrs=n?.length>0?new Set(n):I,this._defaultProps=a,this._rootPatchCallback=this._patchRootElement.bind(this),this._renderCount=0}connectedCallback(){this._verifyConnectDisconnect(W.Connect)}disconnectedCallback(){this._verifyConnectDisconnect(W.Disconnect)}attributeChangedCallback(e,t,o){if(!this._isPatching&&this._state.canHandleAttributes()){const n=r.AttributeUtils.attributeToPropertyName(e),s=n.split(".")[0];if(this._state.dirtyProps.has(s))this._state.dirtyProps.delete(s);else if(t===o)return;null===o&&(o=void 0),"knockout"===this._state.getBindingProviderType()&&(r.AttributeUtils.isGlobalOrData(n)||this._element.dispatchEvent(new CustomEvent("attribute-changed",{detail:{attribute:e,value:o,previousValue:t}})));const{propPath:i,propValue:a,propMeta:l,subPropMeta:c}=this._getPropValueInfo(e,o);i&&this._updatePropsAndQueueRenderAsNeeded(i,a,l,c)}}getProperty(e){if(d.getPropertyMetadata(e,this._metadata?.properties)){let t=r.CustomElementUtils.getPropertyValue(this._props,e);return void 0===t&&this._defaultProps&&(t=r.CustomElementUtils.getPropertyValue(this._defaultProps,e)),t}return this._element[e]}setProperty(e,t){if(this._isPatching)return;const{prop:o,subProp:n}=d.getComplexPropertyMetadata(e,this._metadata?.properties);o?this._state.allowPropertySets()?(t=r.transformPreactValue(this._element,e,n,t),this._updatePropsAndQueueRenderAsNeeded(e,t,o,n)):this._earlySets.push({property:e,value:t}):this._element[e]=t}setProperties(e){this._isPatching||Object.keys(e).forEach(t=>{this.setProperty(t,e[t])})}getProps(){return this._props}isInitialized(){return!!this._vdom}appendChildHelper(e,t){return r.CustomElementUtils.canRelocateNode(e,t)?HTMLElement.prototype.appendChild.call(e,t):t}insertBeforeHelper(e,t,o){return r.CustomElementUtils.canRelocateNode(e,t)?(o&&o.parentNode!==e&&u.info(`Using insertBefore where ${e.tagName} is not a parent of ${o.tagName}`),o&&o.parentNode?HTMLElement.prototype.insertBefore.call(o.parentNode,t,o):HTMLElement.prototype.insertBefore.call(e,t,o)):t}_render(){if(!this._initialized){this._initialized=!0,this._initializePropsFromDom();const e=this._metadata.events;e&&this._initializeActionCallbacks(e);const t=this._metadata.extension?._WRITEBACK_PROPS;t&&this._initializeWritebackCallbacks(t),this._playbackEarlyPropertySets()}if(this._vdom)throw new Error(`Unexpected render call for already rendered component ${this._element.tagName}`);this._vdom=n.jsx(U,{ref:this._compWithContextsRef,baseComp:this._component,baseElem:this._element,initialCompProps:this._props,rootPatchCallback:this._rootPatchCallback,translationBundleMap:this._state.getTranslationBundleMap()}),s.render(this._vdom,this._element)}_getPropValueInfo(e,t){if("knockout"!==this._state.getBindingProviderType()||!r.AttributeUtils.getExpressionInfo(t).expr){const o=r.AttributeUtils.attributeToPropertyName(e),{prop:n,subProp:s}=d.getComplexPropertyMetadata(o,this._metadata?.properties);if(n)return n.readOnly?{}:{propPath:o,propValue:r.AttributeUtils.attributeToPropertyValue(this._element,e,t,s),propMeta:n,subPropMeta:s};const i=r.AttributeUtils.getGlobalPropForAttr(e);if(this._controlledProps.has(i))return{propPath:i,propValue:this._element[r.AttributeUtils.getGlobalValuePropForAttr(e)]??t}}return{}}_updatePropsAndQueueRenderAsNeeded(e,t,o,n,s=!0){const i=this.getProperty(e),a=void 0===t?r.CustomElementUtils.getPropertyValue(this._defaultProps,e):t;if(o&&r.ElementUtils.comparePropertyValues(o.writeback,a,i))return;const l=e.split("."),p=l[0],u=l.length>1;let d=this.getProperty(p);if(c.CollectionUtils.isPlainObject(d)&&(d=c.CollectionUtils.copyInto({},d,void 0,!0)),s&&this._verifyProps(e,t,o,n),this._updateProps(l,t),!s||this._state.allowPropertyChangedEvents()&&!r.AttributeUtils.isGlobalOrData(e)){this._state.dirtyProps.add(p);const o=s?"external":"internal",n={value:this.getProperty(p),previousValue:d,updatedFrom:o};u&&(n[$]={path:e,value:t,previousValue:i});const r=p+"Changed",a=u?null:e=>{if(e.kind!==q||e.type!==r||e.detail[$])return null;const t=Object.assign({},n,{previousValue:e.detail.previousValue});return{type:r,detail:t,collapse:a,kind:q}};this._queueFireEventsTask({type:r,detail:n,collapse:a,kind:q})}const h=this._oldRootProps;h&&this._controlledProps.has(e)&&(h[e]=t),this._vdom&&!o?.readOnly&&(this._compWithContextsRef?.current?this._queueRender():window.queueMicrotask(()=>{this._queueRender()}))}_queueRender(){if(!this._compWithContextsRef?.current)throw new Error(`Render requested for a disconnected component ${this._element.tagName}`);this._renderCount++,this._compWithContextsRef.current.setState({compProps:this._props,renderCount:this._renderCount})}_verifyProps(e,t,o,n){if(o){if(o.readOnly)throw new r.JetElementError(this._element,`Read-only property '${e}' cannot be set.`);try{d.checkEnumValues(this._element,e,t,n)}catch(e){throw new r.JetElementError(this._element,e.message)}}}_updateProps(e,t){const o=e[0];let n=this._props;if(e.length>1){const e=this._props[o]??this._defaultProps?.[o];e&&c.CollectionUtils.isPlainObject(e)?n[o]=c.CollectionUtils.copyInto({},e,void 0,!0):n[o]={}}for(;e.length;){const o=e.shift();0===e.length?n[o]=t:n[o]||(n[o]={}),n=n[o]}}_queueFireEventsTask(e){let t=e;const o=this._getEventCollapseInfo(e,this._eventQueue);if(o){const[e,n]=o;this._eventQueue.splice(e,1),t=n}return this._eventQueue.push(t),this._queuedEvents||(this._queuedEvents=new Promise(e=>{window.queueMicrotask(()=>{try{for(;this._eventQueue.length;){const e=this._eventQueue.shift(),t=e.kind===q?new CustomEvent(e.type,{detail:e.detail}):e.event;this._element.dispatchEvent(t)}}finally{e(),this._queuedEvents=null}})})),this._queuedEvents}_getEventCollapseInfo(e,t){if(e.kind!==q)return null;for(let o=0;o<t.length;o++){const n=e.collapse?.(t[o]);if(n)return[o,n]}return null}_verifyConnectDisconnect(e){this._state.isComplete()&&this._compWithContextsRef?.current?.setState({connected:e===W.Connect}),this._verifyingState===W.Unset&&window.queueMicrotask(()=>{this._verifyingState===e&&(this._verifyingState===W.Connect?this._verifiedConnect():this._verifiedDisconnect()),this._verifyingState=W.Unset}),this._verifyingState=e}_verifiedConnect(){if(this._state.isComplete())this._reconnectSlots();else if(this._state.startCreationCycle(),this._state.isCreating()){const e=()=>{this._element[r.CHILD_BINDING_PROVIDER]="preact";let e=this._state.getSlotMap();if(e)this._reconnectSlots();else{e=this._state.getSlotMap(!0);const t=this._removeAndConvertSlotsToProps(e);Object.assign(this._props,t)}this._render()};this._state.setCreateCallback(e),this._state.setBindingsDisposedCallback(()=>this._handleBindingsDisposed())}this._state.executeLifecycleCallbacks(!0)}_verifiedDisconnect(){this._state.executeLifecycleCallbacks(!1),this._state.isComplete()?(this._disconnectSlots(),this._state.resetCreationCycle(),s.render(null,this._element),D(this.ref,null),D(this._compWithContextsRef,null),"function"==typeof this._oldRootCleanupCallback&&(this._oldRootCleanupCallback(),this._oldRootCleanupCallback=void 0),D(this._oldRootRef,null),this._oldRootRef=void 0,this._vdom=null):this._state.pauseCreationCycle()}_initializePropsFromDom(){const e=this._element.attributes;for(let t=0;t<e.length;t++){const{name:o,value:n}=e[t],{propPath:s,propValue:r,propMeta:i,subPropMeta:a}=this._getPropValueInfo(o,n);s&&(this._verifyProps(s,r,i,a),this._updateProps(s.split("."),r))}}_playbackEarlyPropertySets(){for(;this._earlySets.length;){const e=this._earlySets.shift(),t=d.getPropertyMetadata(e.property,this._metadata?.properties),o=r.transformPreactValue(this._element,e.property,t,e.value);this.setProperty(e.property,o)}}_patchRootElement(e){const t=this._oldRootProps||this._getInitialRootProps(),o=e.props;this._isPatching=!0;try{!function(e,t,o,n,s,r){let i;for(i in o)"children"===i||"key"===i||i in t||r(e,i,null,o[i],n)||T(e,i,null,o[i],n);for(i in t)s&&"function"!=typeof t[i]||"children"===i||"key"===i||"value"===i||"checked"===i||o[i]===t[i]||r(e,i,t[i],o[i],n)||T(e,i,t[i],o[i],n)}(this._element,o,t,!1,!1,z._setPropertyOverrides)}finally{this._isPatching=!1}const n=e.ref;this._oldRootRef!==n&&("function"==typeof this._oldRootCleanupCallback&&this._oldRootCleanupCallback(),this._oldRootCleanupCallback=D(n,this._element),n&&D(this._oldRootRef,null)),this._oldRootProps=o,this._oldRootRef=n}static _setPropertyOverrides(e,t,o,n){if("style"===t&&"string"==typeof o)throw new Error("CSS style must be an object. CSS text is not supported");if("class"===t||"className"===t){const t=null==n?I:r.CustomElementUtils.getClassSet(n),s=null==o?I:r.CustomElementUtils.getClassSet(o);for(const o of t.values())s.has(o)||e.classList.remove(o);for(const o of s.values())t.has(o)||e.classList.add(o);return!0}if("o"===t[0]&&"n"===t[1]){const s=t!==(t=t.replace(/(PointerCapture)$|Capture$/i,"$1"));t=t.toLowerCase()in e||"onFocusOut"===t||"onFocusIn"===t?t.toLowerCase().slice(2):t.slice(2),z._getRootListeners(e,s)[t]=o;const r=s?z._eventProxyCapture:z._eventProxy;return o?n||e.addEventListener(t,r,s):e.removeEventListener(t,r,s),!0}return"role"===t&&(o?e.setAttribute(t,o):e.removeAttribute(t),!0)}static _getRootListeners(e,t){const o=t?F:V;let n=e[o];return n||(n=e[o]={}),n}_getInitialRootProps(){const e={};for(const t of this._controlledProps.values())t in this._props&&(e[t]=this._props[t]);return e}_removeAndConvertSlotsToProps(e){const t=this._metadata.extension?._DYNAMIC_SLOT,o=t?.prop,n=this._metadata?.slots,s=Object.keys(e),r={};if(s.length>0&&s.forEach(s=>{const i=e[s];i.forEach(e=>{k.parkNode(e),this._propagateSubtreeHidden(e)});const a=d.getPropertyMetadata(s,n);if(a){const e=!!a?.data,t=e||""!==s?s:"children";this._assignSlotProperty(r,t,void 0,s,e,i)}else{if(!o)return;r[o]||(r[o]={});const e=t.isTemplate;this._assignSlotProperty(r,s,o,s,e,i)}}),"knockout"===this._state.getBindingProviderType()){let e;for(;e=this._element.firstChild;)this._state.getBindingProviderCleanNode()(e),e.remove()}return r}_assignSlotProperty(e,t,o,n,s,i){const a=o?e[o]:e;if(s){if("TEMPLATE"!==i[0]?.nodeName)throw new r.JetElementError(this._element,`Slot content for template slot ${n} must be a template element.`);{const e=i[0];let n=e.render;n?(a[t]=n,Object.defineProperties(e,{render:{enumerable:!0,get:()=>n,set:e=>{n=e,e&&(this._updateProps([t],e),this._queueRender())}}})):a[t]=this._getSlotRenderer(e,t,o)}}else{const e=i.map((e,t)=>j(this._element,e,this._handleSlotMount.bind(this),this._handleSlotUnmount.bind(this)));a[t]=e}}_getSlotRenderer(e,t,o){const n=this._state.getBindingProvider(),s=n?()=>{(o?this._props[o]:this._props)[t]=this._getSlotRenderer(e,t,o),this._queueRender()}:null;return t=>{const o=this._state.getTemplateEngine();if(!o)throw new r.JetElementError(this._element,"Unexpected call to render a template slot");return o.execute(this._element,e,t,n,s)}}_handleBindingsDisposed(){k.disposeNodes(this._state.getSlotMap(),this._state.getBindingProviderCleanNode()),this._state.disposeTemplateCache()}_disconnectSlots(){k.disconnectNodes(this._state.getSlotMap())}_reconnectSlots(){k.reconnectNodes(this._state.getSlotMap())}_propagateSubtreeHidden(e){e.nodeType===Node.ELEMENT_NODE&&r.CustomElementUtils.subtreeHidden(e)}_handleSlotUnmount(e){this._state.isPostCreateCallbackOrComplete()&&this._element.isConnected&&(k.parkNode(e),window.queueMicrotask(()=>{k.isParked(e)&&this._propagateSubtreeHidden(e)}))}_handleSlotMount(e){const t=r.CustomElementUtils.subtreeShown;t&&e.nodeType===Node.ELEMENT_NODE&&(e.isConnected?t(e):window.queueMicrotask(()=>t(e)))}static _eventProxy(e){this[V][e.type](s.options.event?s.options.event(e):e)}static _eventProxyCapture(e){this[F][e.type](s.options.event?s.options.event(e):e)}_initializeActionCallbacks(e){Object.keys(e).forEach(t=>{const o=e[t],n=r.AttributeUtils.eventTypeToEventListenerProperty(t);this._props[n]=e=>{const n=Object.assign({},e),s=!!o.cancelable,r=[];s&&(n.accept=e=>{r.push(e)});const i={detail:n,bubbles:!!o.bubbles,cancelable:s},a=new CustomEvent(t,i),l=this._queueFireEventsTask({event:a,kind:"action"});if(s)return l.then(()=>a.defaultPrevented?Promise.reject():Promise.all(r).then(()=>Promise.resolve(),e=>Promise.reject(e)))}})}_initializeWritebackCallbacks(e){e.forEach(e=>{const t=r.AttributeUtils.propertyNameToChangedCallback(e),{prop:o,subProp:n}=d.getComplexPropertyMetadata(e,this._metadata?.properties);this._props[t]=t=>{this._updatePropsAndQueueRenderAsNeeded(e,t,o,n,!1)}})}}var W;!function(e){e[e.Connect=0]="Connect",e[e.Disconnect=1]="Disconnect",e[e.Unset=2]="Unset"}(W||(W={}));const G=o.forwardRef((e,t)=>{let o=e.children;const r=i.getElementRegistration(o.type).cache.contexts,c=[l.EnvironmentContext,...r??[]],p=c.map(e=>{const t=a.useContext(e),n=o.props.__oj_provided_contexts?.get(e);return void 0!==n?n:t}),u=a.useMemo(()=>{const e=new Map;for(let t=0;t<c.length;t++)e.set(c[t],p[t]);return e},p);if(void 0!==o.props.__oj_private_contexts&&o.props.__oj_private_contexts!==u&&(o=s.cloneElement(o).props.children),o.props.__oj_private_contexts=u,t)if(o.ref){const e=o.ref;o.ref=o=>{let n,s;return n=D(e,o),s=D(t,o),i=s,(r=n)||i?()=>{"function"==typeof r&&r(),"function"==typeof i&&i()}:void 0;var r,i}}else o.ref=t;return n.jsx(s.Fragment,{children:o})});G.__ojIsEnvironmentWrapper=!0;const Q=(e,t)=>{if(Object.prototype.hasOwnProperty.call(e,t)){e[r.publicToPrivateName.get(t)]=r.toSymbolizedValue(e[t]),delete e[t]}},J=s.options.vnode;let Y=!1;s.options.vnode=e=>{const t=e.type;if("string"==typeof t&&i.isElementRegistered(t)){const t=e.props;Q(t,"value"),Q(t,"checked")}if("string"==typeof t&&!Y&&i.isVComponent(t)){Y=!0;try{const t=s.cloneElement(e),o=n.jsx(G,{children:t});Object.assign(e,o)}finally{Y=!1}}J?.(e)};const Z=100,K=s.options.requestAnimationFrame;s.options.requestAnimationFrame=function(e){const t=new Promise(o=>{const n=()=>{o(),f.__removePreactPromise(t),e()};if(K)K(n);else{const e=()=>{clearTimeout(t),cancelAnimationFrame(o),setTimeout(n)},t=setTimeout(e,Z),o=requestAnimationFrame(e)}});f.__addPreactPromise(t,"Preact requestAnimationFrame")};const X=s.options;if(X.__m||X._hydrationMismatch){const e=[],t=!X._hydrationMismatch,o=t?X.__r:X._render,n=t?X.__e:X._catchError,s=X.diffed,r=t=>{e[e.length-1]===(t.__c||t._component)&&e.pop()};X._render=X.__r=n=>{const s=t?n.__c:n._component;e.push(s),o&&o(n)},X._hook=X.__h=(t,o,n)=>{const s=e[e.length-1];if(!t||s!==t)throw new Error("Hook can only be invoked from render methods.")},X._catchError=X.__e=(e,t,o,s)=>{r(t),n&&n(e,t,o,s)},X.diffed=e=>{r(e),s&&s(e)}}const ee=new class{constructor(){this.appendChildHelper=(e,t)=>HTMLElement.prototype.appendChild.call(e,t),this.insertBeforeHelper=(e,t,o)=>HTMLElement.prototype.insertBefore.call(e,t,o)}connectedCallback(){}disconnectedCallback(){}attributeChangedCallback(e,t,o){}getProperty(e){}setProperty(e,t){}setProperties(e){}};class te extends HTMLElement{static get observedAttributes(){let e=[];return this.metadata.properties&&(e=e.concat(d.getFlattenedAttributes(this.metadata.properties))),this.rootObservedAttributes&&(e=e.concat(this.rootObservedAttributes)),e}connectedCallback(){this._getHelper().connectedCallback()}disconnectedCallback(){this._helper?.disconnectedCallback()}attributeChangedCallback(e,t,o){this._helper?.attributeChangedCallback(e,t,o)}getProperty(e){return this._getHelper().getProperty(e)}setProperty(e,t){this._getHelper().setProperty(e,t)}setProperties(e){this._getHelper().setProperties(e)}appendChild(e){return this._getHelper().appendChildHelper(this,e)}insertBefore(e,t){return this._getHelper().insertBeforeHelper(this,e,t)}setAttribute(e,t){if("class"===e){const e=r.CustomElementUtils.getClassSet(t);r.CustomElementUtils.getElementState(this).setOuterClasses(e)}else HTMLElement.prototype.setAttribute.call(this,e,t)}removeAttribute(e){"class"===e?this.setAttribute("class",""):HTMLElement.prototype.removeAttribute.call(this,e)}_getHelper(){return this._helper||(this.hasAttribute("data-oj-jsx")?(this.removeAttribute("data-oj-jsx"),this.classList.add("oj-complete"),this._helper=ee):this._helper=new z(this,this.constructor.component,this.constructor.metadata,this.constructor.rootObservedAttributes,this.constructor.rootObservedProperties,this.constructor.defaultProps)),this._helper}}const oe=s.createContext(null);function ne(e,t){return"className"===e||r.AttributeUtils.isGlobalOrData(e)||function(e,t){if(t?.properties?.[e])return!1;const o=e.match(se);if(o){const e=o[1].toLowerCase()+o[2];return!t?.events?.[e]}return!1}(e,t)}const se=/^on(?!.*Changed$)([A-Za-z])([A-Za-z]*)$/;const re=({children:e})=>{const{tagName:t,metadata:o,isElementFirst:s,vcompProps:i,elemRefObj:l}=a.useContext(oe);if(s)return e;const c=Object.keys(i).filter(e=>ne(e,o)).reduce((e,t)=>(e[t]=i[t],e),{}),p=n.jsx("div",{ref:function(e){e&&(e[r.CustomElementUtils.VCOMP_INSTANCE]={props:i}),l.current=e},"data-oj-jsx":"",...c,children:e});return p.type=t,p},ie="class",ae=o.forwardRef((e,t)=>{const{tagName:o,metadata:i,isElementFirst:l,vcompProps:c,observedPropsSet:p,elemRefObj:u}=a.useContext(oe);if(l){const r=n.jsx("div",{...e,ref:t});return r.type=o,c[L](r),n.jsx(s.Fragment,{children:e.children})}const d={};c.style&&e.style&&(d.style=Object.assign({},c.style,e.style));const h=c[ie];if(h){const t=e[ie]||"";d[ie]=`${h} ${t}`}const _=Object.keys(c).filter(t=>!(t in e)&&!p.has(t)&&ne(t,i)).reduce((e,t)=>(e[t]=c[t],e),{}),m=n.jsx("div",{...e,...d,..._,ref:e=>{let o;return t&&(o=D(t,e)),e&&(e[r.CustomElementUtils.VCOMP_INSTANCE]={props:c}),u.current=e,o},"data-oj-jsx":""});return m.type=o,m});class le extends r.LifecycleElementState{constructor(e){super(e),this._translationBundleMap={}}getTranslationBundleMap(){return this._translationBundleMap}getTemplateEngine(){return le._cachedTemplateEngine}getTrackChildrenOption(){return"immediate"}allowPropertyChangedEvents(){return super.allowPropertyChangedEvents()&&(e=>{const t=e._getHelper();return!!t.isInitialized?.()})(this.Element)}allowPropertySets(){return this._allowPropertySets||super.allowPropertySets()}resetCreationCycle(){this._allowPropertySets=super.allowPropertySets(),super.resetCreationCycle()}disposeTemplateCache(){const e=this.getSlotMap(),t=Object.keys(e),o=i.getElementDescriptor(this.Element.tagName).metadata,n=o?.extension?._DYNAMIC_SLOT,s=!!n?.isTemplate;t.filter(e=>{const t=d.getPropertyMetadata(e,o?.slots);if(t){if(t.data)return!0}else if(s)return!0;return!1}).forEach(t=>{const o=e[t];"TEMPLATE"===o[0]?.nodeName&&this.getTemplateEngine().cleanupTemplateCache(o[0])})}GetPreCreatedPromise(){let e,t;return this.Element.constructor.translationBundleMap&&(e=this._getTranslationBundlesPromise()),!le._cachedTemplateEngine&&this._hasDirectTemplateChildren()&&(t=this._getTemplateEnginePromise()),Promise.all([e,t]).then(()=>this.Element.isConnected?super.GetPreCreatedPromise():Promise.reject())}IsTransferAttribute(e){return this.Element.constructor.rootObservedAttrSet.has(e)}GetDescriptiveTransferAttributeValue(e){return((e,t)=>{const o=e.getAttribute(t);if(o)return o;const n=e._getHelper();return(n.getProps?.()||{})[t]})(this.Element,e)}_getTranslationBundlesPromise(){const e=this.Element.constructor.translationBundleMap,t=Object.keys(e),o=[];return t.forEach(e=>{o.push(y.getTranslationBundlePromise(e))}),Promise.all(o).then(e=>{t.forEach((t,o)=>{this._translationBundleMap[t]=e[o]})})}_getTemplateEnginePromise(){return new Promise(function(t,o){e(["ojs/ojvcomponent-template"],function(e){t(function(e){if(e&&e.__esModule)return e;var t={};return e&&Object.keys(e).forEach(function(o){var n=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(t,o,n.get?n:{enumerable:!0,get:function(){return e[o]}})}),t.default=e,t}(e))},o)}).then(e=>{le._cachedTemplateEngine=e})}_hasDirectTemplateChildren(){const e=this.Element.childNodes;for(let t=0;t<e.length;t++){if("template"===e[t].localName)return!0}return!1}}function ce({elemRefObj:e,children:t}){const o=a.useCallback(t=>{if(e.current){const o=`${e.current.tagName.toLowerCase()}: `;return f.getContext(e.current).getBusyContext().addBusyState({description:`${o}${t}`})}throw new Error("Cannot call addBusyState() when the component is not connected to the DOM. Ensure the component is mounted before attempting to add a busy state.")},[e]),s=a.useMemo(()=>({addBusyState:o}),[o]);return n.jsx(g.BusyStateContext.Provider,{value:s,children:t})}const pe=Symbol("functional component"),ue=Symbol();function de(e){return function(t){const o=t._metadata||t.metadata||{};!function(e){e.properties||(e.properties={});e.properties.__oj_private_color_scheme={type:"string",binding:{consume:{name:"colorScheme"}}},e.properties.__oj_private_scale={type:"string",binding:{consume:{name:"scale"}}},e.properties.__oj_private_contexts={type:"object"},e.properties.__oj_provided_contexts={type:"object"},e.properties.__oj_private_identifier_to_prop={type:"object",writeback:!0},e.properties.__oj_private_identifier_to_value={type:"object",writeback:!0}}(o);const s=o?.extension?._OBSERVED_GLOBAL_PROPS||[],a=s.map(e=>r.AttributeUtils.getGlobalAttrForProp(e));!function(e,t,o,s){const i=t.prototype.render;t.prototype.render=function(t,a,l){const c=o?.extension?._READ_ONLY_PROPS;c&&c.forEach(e=>delete t[e]);const p=t[N],u=!!p;u&&r.CustomElementUtils.getElementState(p).disposeTemplateCache();let d=t;if(t[N]){const{[N]:e,[L]:o,...n}=t;d=n}return this[ue]=this[ue]||{current:t[N]},n.jsx(oe.Provider,{value:{tagName:e,metadata:o,isElementFirst:u,vcompProps:t,observedPropsSet:s,elemRefObj:this[ue]},children:n.jsx(ce,{elemRefObj:this[ue],children:n.jsx(he,{instance:this,baseRender:i,props:d,state:a,context:l,tagName:e,metadata:o})})})}}(e,t,o,new Set(s)),function(e,t,o,n,s,a){a&&y.registerTranslationBundleLoaders(a);class l extends te{}l.metadata=t,l.component=o,l.rootObservedAttributes=s,l.rootObservedAttrSet=new Set(s),l.rootObservedProperties=n,l.defaultProps=o.defaultProps||o._defaultProps?d.deepFreeze(o.defaultProps||o._defaultProps):null,l.translationBundleMap=a,function(e,t){if(!t)return;for(let o in t)Object.defineProperty(e,o,{get(){return this.getProperty(o)},set(e){this.setProperty(o,e)}}),r.addPrivatePropGetterSetters(e,o)}(l.prototype,t?.properties),function(e,t){if(!t)return;for(let o in t)e[o]=function(){if(this._helper===ee)throw new r.JetElementError(this,"Cannot access element methods when rendered as a value based element.");const e=this._helper.ref.current;if(!e)throw new r.JetElementError(this,"Cannot access methods before element is upgraded.");return e[o].apply(e,arguments)}}(l.prototype,t?.methods),i.registerElement(e,{descriptor:{metadata:t},stateClass:le,vcomp:!0,cache:{contexts:o._consumedContexts}},l)}(e,o,t,s,a,t._translationBundleMap||t.translationBundleMap),!t._metadata&&t.metadata&&u.warn(`Component ${e} is compiled with JET version prior to 14.0.0`)}}const he=({instance:e,tagName:t,metadata:r,baseRender:i,props:a,state:l,context:c})=>{let p=i.call(e,a,l,c);if(p?.type?.__ojIsEnvironmentWrapper&&p.props.children.type===t){const e=p.props.children;e.type=ae;try{p=s.cloneElement(e)}finally{e.type=t}}const u=p?.type;return u!==ae&&(_e(u)===(me||(me=_e(o.forwardRef(()=>null))),me)&&u[pe]&&0!==Object.keys(r.methods||{}).length||(p=n.jsx(re,{children:p}))),p};function _e(e){return e?.$$typeof}let me;"undefined"!=typeof window&&(HTMLTemplateElement.prototype.hasOwnProperty("render")||Object.defineProperty(HTMLTemplateElement.prototype,"render",{value:null,writable:!0}));const fe=s.createContext(null),ye=r.ElementUtils.getUniqueId.bind(null,null);t.ReportBusyContext=fe,t.Root=ae,t.consumedContexts=function(e){return function(e){}},t.customElement=de,t.getUniqueId=ye,t.method=function(e,t,o){},t.registerCustomElement=function(e,t,r){class i extends s.Component{constructor(){if(super(),this.__refCallback=e=>{this.__vcompRef&&(this.__vcompRef.current=e);const t=this.props.innerRef;return D(t,e)},i._metadata?.methods){this.__vcompRef=s.createRef();const e=i._metadata.methods,t=this;for(let o in e)t[o]=(...e)=>this.__vcompRef.current?.[o].apply(this.__vcompRef.current,e)}}render(){return arguments[0].ref=this.__refCallback,t(arguments[0])}}return i.displayName=arguments[2],arguments.length>=4&&arguments[3]&&(i._metadata=arguments[3],arguments.length>=5&&arguments[4]&&(i._defaultProps=arguments[4])),arguments.length>=6&&(i._translationBundleMap=arguments[5]),arguments.length>=7&&(i._consumedContexts=arguments[6].consume),i[pe]=!0,de(e)(i),o.forwardRef((e,t)=>n.jsx(i,{...e,innerRef:t}))},Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ojvcomponent.js.map