define(['exports', 'preact/hooks', './clientHints-6d361eaa', './textSelectionUtils-06c7855d'], (function(e,t,r,c){"use strict";const o=750,n=200,u=5;e.useContextMenuGesture=(e,l={isTouchHoldReleaseGesture:!1,isDisabled:!1})=>{const s=l.isTouchHoldReleaseGesture?"touchHoldRelease":"ios"===r.getClientHints().platform?"touchHold":"native",a="touchHold"===s?o:n,d=t.useRef(!1),i=t.useRef({isTouchHoldComplete:!1}),h=t.useRef(!1),m=t.useRef(),g=t.useCallback((()=>!!h.current||c.getIsSelectionPending()),[]),T=t.useCallback((()=>{document.body.style.userSelect=i.current.bodyUserSelectValue,document.body.style.webkitUserSelect=i.current.webkitBodyUserSelectValue,i.current.isMenuOpened=!1}),[]);t.useEffect((()=>{const e=()=>{const{timeNeededForSelection:e,startTime:t}=i.current;t&&!e&&"Range"===document.getSelection()?.type&&(clearTimeout(m.current),i.current.timeNeededForSelection=Date.now()-t,i.current.scheduleAndHandleTouchHold?.(a))},t=e=>{"#text"===(e?.target).nodeName?(h.current=!0,setTimeout((()=>{h.current=!1}),10)):h.current=!1};return"touchHold"===s||"touchHoldRelease"===s?document.addEventListener("selectionchange",e,!0):document.addEventListener("selectstart",t,!0),()=>{document.removeEventListener("selectionchange",e,!0),document.removeEventListener("selectstart",t,!0)}}),[s,a]);const y=t.useCallback((t=>{"touch"!==t.pointerType||"touchHoldRelease"!==s?g()||(t.preventDefault(),d.current?d.current=!1:e({gesture:"touch"===t.pointerType?"touch":"mouse",anchor:{x:t.clientX,y:t.clientY,contextElement:t.currentTarget},currentTarget:t.currentTarget,target:t.target})):t.preventDefault()}),[e,g,s]),b=t.useCallback((t=>{if(!g()&&"F10"===t.key&&t.shiftKey){d.current=!0;const r=t.currentTarget;e({gesture:"keyboard",anchor:r,currentTarget:r,target:t.target})}}),[e,g]),p=t.useCallback((t=>{if(1===t.touches.length){const r=i.current.timeNeededForSelection;let c="touchHold"===s?2*a:a;void 0===r?i.current.startTime=Date.now():c=r+a;const o=t.touches[0];i.current.touchPageCoords={x:o.pageX,y:o.pageY};const n=t.currentTarget,u=()=>{i.current.bodyUserSelectValue=document.body.style.userSelect,i.current.webkitBodyUserSelectValue=document.body.style.webkitUserSelect,document.body.style.userSelect="none",document.body.style.webkitUserSelect="none",document.getSelection()?.empty(),i.current.isMenuOpened=!0,e({gesture:"touch",anchor:{x:o.clientX,y:o.clientY,contextElement:n},currentTarget:n,target:t.target})},l=e=>{i.current.isTouchHoldComplete=!1,m.current=setTimeout((()=>{"touchHold"===s&&u(),i.current.isTouchHoldComplete=!0}),e)};i.current.launchContextMenu=u,i.current.scheduleAndHandleTouchHold=l,l(c)}}),[e,s,a]),H=t.useCallback((e=>{const t=e.touches[0];(Math.abs(i.current.touchPageCoords?.x-t.pageX)>u||Math.abs(i.current.touchPageCoords?.y-t.pageY)>u)&&clearTimeout(m.current)}),[]),C=t.useCallback((e=>{clearTimeout(m.current),"touchHoldRelease"===s&&i.current.isTouchHoldComplete&&i.current.launchContextMenu?.(),i.current.isMenuOpened&&(e.preventDefault(),setTimeout((()=>{T()}),500)),i.current.isTouchHoldComplete=!1}),[T,s]),S=t.useCallback((()=>{clearTimeout(m.current),i.current.isMenuOpened&&T()}),[T]);return{triggerProps:l.isDisabled?{}:{onContextMenu:y,onKeyDown:b,...("touchHold"===s||"touchHoldRelease"===s)&&{onTouchStart:p,onTouchMove:H,onTouchEnd:C,onTouchCancel:S}}}}}));
//# sourceMappingURL=useContextMenuGesture-69b54d61.js.map
