{"version":3,"file":"UNSAFE_Dialog.js","sources":["../../src/UNSAFE_Dialog/useFlexibleComponent.ts"],"sourcesContent":["import type { RefObject } from 'preact';\nimport { useState, useRef } from 'preact/hooks';\nimport { Coords } from '../UNSAFE_Floating';\nimport { Size } from '../utils/UNSAFE_size';\nimport { Position, Rect } from '../utils/UNSAFE_flexibleComponentUtils';\n\ntype Dimensions = {\n  width: number;\n  height: number;\n};\n\ntype DimensionsCss = {\n  width: Size;\n  height: Size;\n};\n\nexport type DragMoveDetail = {\n  originalPosition: Position;\n  position: Position;\n};\n\nexport type ResizeDetail = {\n  originalPosition: Position;\n  originalSize: Dimensions;\n  position: Position;\n  size: Dimensions;\n};\n\ntype UseFlexibleComponentProps = {\n  isDisabled?: boolean;\n  isDraggable?: boolean;\n  isResizable?: boolean;\n  onDragStart?: (detail: DragMoveDetail) => void;\n  onDragMove?: (detail: DragMoveDetail) => void;\n  onDragEnd?: (detail: DragMoveDetail) => void;\n  onResizeStart?: (detail: ResizeDetail) => void;\n  onResize?: (detail: ResizeDetail) => void;\n  onResizeEnd?: (detail: ResizeDetail) => void;\n};\n\n/**\n * A custom hook that adds drag and/or resize capabilities to a component (e. g. Dialog).\n * The hook maintains the original and current position and size and returns handlers and\n * props to be spread on the component to make it \"flexible\". In addition, allows its consumer\n * to be notified when the drag or resize life-cycle events occur.\n */\nexport const useFlexibleComponent = ({\n  isDisabled = false,\n  isDraggable = false,\n  isResizable = false,\n  onDragStart: onDragStartHandler,\n  onDragMove: onDragMoveHandler,\n  onDragEnd: onDragEndHandler,\n  onResizeStart: onResizeStartHandler,\n  onResize: onResizeHandler,\n  onResizeEnd: onResizeEndHandler\n}: UseFlexibleComponentProps): {\n  onDragStart?: (pos: Position) => void;\n  onDragMove?: (pos: Position) => void;\n  onDragEnd?: (pos: Position) => void;\n  onResizeStart?: (rect: Rect) => void;\n  onResize?: (rect: Rect) => void;\n  onResizeEnd?: (rect: Rect) => void;\n  anchorRef?: RefObject<Coords>;\n  width?: Size;\n  height?: Size;\n} => {\n  const [coords, _setCoords] = useState<Coords>();\n  const [dimensions, setDimensions] = useState<DimensionsCss>();\n\n  const coordsRef = useRef<Coords | null>(null);\n\n  const origPosRef = useRef<Position | null>(null);\n  const origSizeRef = useRef<Dimensions | null>(null);\n\n  const setCoords = (coords: Coords) => {\n    _setCoords({ x: coords.x, y: coords.y });\n    coordsRef.current = { x: coords.x, y: coords.y };\n  };\n\n  if (isDisabled || (!isDraggable && !isResizable)) {\n    return {};\n  }\n\n  const onDragStart = (pos: Position) => {\n    setCoords({ x: pos.x, y: pos.y });\n    origPosRef.current = { x: pos.x, y: pos.y };\n    onDragStartHandler?.({\n      originalPosition: { x: origPosRef.current.x, y: origPosRef.current.y },\n      position: { x: pos.x, y: pos.y }\n    });\n  };\n\n  const onDragMove = (pos: Position) => {\n    setCoords({ x: pos.x, y: pos.y });\n    onDragMoveHandler?.({\n      originalPosition: { x: origPosRef.current!.x, y: origPosRef.current!.y },\n      position: { x: pos.x, y: pos.y }\n    });\n  };\n\n  const onDragEnd = (pos: Position) => {\n    setCoords({ x: pos.x, y: pos.y });\n    onDragEndHandler?.({\n      originalPosition: { x: origPosRef.current!.x, y: origPosRef.current!.y },\n      position: { x: pos.x, y: pos.y }\n    });\n    origPosRef.current = null;\n  };\n\n  const onResizeStart = (rect: Rect) => {\n    setCoords({ x: rect.x, y: rect.y });\n    origPosRef.current = { x: rect.x, y: rect.y };\n    setDimensions({ width: (rect.width + 'px') as Size, height: (rect.height + 'px') as Size });\n    origSizeRef.current = { width: rect.width, height: rect.height };\n    onResizeStartHandler?.({\n      originalPosition: { x: origPosRef.current!.x, y: origPosRef.current!.y },\n      originalSize: { width: origSizeRef.current!.width, height: origSizeRef.current!.height },\n      position: { x: rect.x, y: rect.y },\n      size: { width: rect.width, height: rect.height }\n    });\n  };\n\n  const onResize = (rect: Rect) => {\n    setCoords({ x: rect.x, y: rect.y });\n    setDimensions({ width: (rect.width + 'px') as Size, height: (rect.height + 'px') as Size });\n    onResizeHandler?.({\n      originalPosition: { x: origPosRef.current!.x, y: origPosRef.current!.y },\n      originalSize: { width: origSizeRef.current!.width, height: origSizeRef.current!.height },\n      position: { x: rect.x, y: rect.y },\n      size: { width: rect.width, height: rect.height }\n    });\n  };\n\n  const onResizeEnd = (rect: Rect) => {\n    setCoords({ x: rect.x, y: rect.y });\n    setDimensions({ width: (rect.width + 'px') as Size, height: (rect.height + 'px') as Size });\n    onResizeEndHandler?.({\n      originalPosition: { x: origPosRef.current!.x, y: origPosRef.current!.y },\n      originalSize: { width: origSizeRef.current!.width, height: origSizeRef.current!.height },\n      position: { x: rect.x, y: rect.y },\n      size: { width: rect.width, height: rect.height }\n    });\n    origPosRef.current = null;\n    origSizeRef.current = null;\n  };\n\n  return {\n    ...(isDraggable && { onDragStart, onDragMove, onDragEnd }),\n    ...(isResizable && { onResizeStart, onResize, onResizeEnd }),\n    ...(coords && { anchorRef: coordsRef }),\n    ...(dimensions && { width: dimensions.width, height: dimensions.height })\n  };\n};\n"],"names":["isDisabled","isDraggable","isResizable","onDragStart","onDragStartHandler","onDragMove","onDragMoveHandler","onDragEnd","onDragEndHandler","onResizeStart","onResizeStartHandler","onResize","onResizeHandler","onResizeEnd","onResizeEndHandler","coords","_setCoords","useState","dimensions","setDimensions","coordsRef","useRef","origPosRef","origSizeRef","setCoords","x","y","current","pos","originalPosition","position","rect","width","height","originalSize","size","anchorRef"],"mappings":"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"}