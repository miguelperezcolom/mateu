define("oj-c/hooks/UNSAFE_useListData/useListData",["require","exports","ojs/ojabortreason","ojs/ojdataproviderfactory","preact/hooks"],(function(require,e,t,r,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getEmptyState=e.useListData=void 0;const s=Object.freeze({status:"loading",data:null}),n={isInitialFetchDeferred:!1};e.useListData=(r,c=n)=>{const u=(0,a.useRef)(null),d=(0,a.useRef)(0),h=(0,a.useRef)(!1),b=(0,a.useRef)(null),p=(0,a.useRef)(null),g=c.fetchSize&&c.fetchSize>0?c.fetchSize:25,C=(0,a.useMemo)((()=>i(r)),[r]),[S,v]=(0,a.useReducer)(o,0===c.initialRowsFetched?(0,e.getEmptyState)("atLeast"):s),k=(0,a.useCallback)((async(e,t)=>{if(null==C)return;const r={attributes:c.attributes,sortCriteria:c.sortCriteria,filterCriterion:c.filterCriterion,offset:e.offset,size:e.count},a=!0===h.current?"exact":"atLeast";if(0!==e.count)try{const s=(await C.fetchByOffset(r)).results;t&&t(s),v({status:"success",data:{offset:e.offset,data:s,totalSize:d.current,sizePrecision:a}})}catch(e){v({status:"error",error:e})}else v({status:"success",data:{offset:e.offset,data:[],totalSize:d.current,sizePrecision:a}})}),[C,c.attributes,c.filterCriterion,c.sortCriteria]),x=(0,a.useCallback)((async()=>{if(null==C)return;"loading"===S.status&&p.current?.abort((0,t.getAbortReason)()),v({status:"loading",data:null});const e=new AbortController;p.current=e;const r=C.fetchFirst({attributes:c.attributes,sortCriteria:c.sortCriteria,filterCriterion:c.filterCriterion,size:g,signal:e.signal})[Symbol.asyncIterator]();b.current=r;try{const e=await r.next();if(r!==b.current)return;const t=e.value.fetchParameters;if(t.signal&&t.signal.aborted)return;d.current=e.value.data.length,void 0!==e.done&&(h.current=e.done);const a=c.initialRowsFetched&&c.initialRowsFetched>0?c.initialRowsFetched:g;k({offset:0,count:Math.min(d.current,a)})}catch(e){if(e instanceof DOMException&&"AbortError"===e.name)return;v({status:"error",error:e}),b.current=null}}),[C,k,g,c.attributes,c.filterCriterion,c.initialRowsFetched,c.sortCriteria,c.fetchSize]),j=(0,a.useCallback)((async e=>{if(null===b.current)x();else{const t=e.offset+e.count;if(t>d.current){if(null==u.current){const r=l(b,d.current,t);u.current=r;try{const t=await r;void 0!==t.done&&(h.current=t.done);const a=t.total;(a>0||0===a&&h.current)&&(d.current=a,k({offset:e.offset,count:Math.min(d.current-e.offset,e.count)})),u.current=null}catch(e){v({status:"error",error:e}),u.current=null}}}else k(e)}}),[x,k]),w=(0,a.useCallback)((()=>{b.current=null,u.current=null,d.current=0,h.current=!1,0===c.initialRowsFetched?v((0,e.getEmptyState)("atLeast")):c.isInitialFetchDeferred?v({status:"loading",data:null}):x()}),[x,c.isInitialFetchDeferred,c.initialRowsFetched]);(0,a.useEffect)((()=>{C&&w()}),[C,w]);const P=(0,a.useCallback)((e=>{if("success"===S.status&&S.data){const t=S.data;let r,a=t.data.length,s=!1;if(e.detail.add){const r=f(e.detail.add,t,c,!0);d.current=d.current+r,a+=r,s=r>0||"exact"===t.sizePrecision,r<e.detail.add.data.length&&(h.current=!1)}if(e.detail.remove){const r=f(e.detail.remove,t,c,!1);d.current=Math.max(0,d.current-r),a=Math.max(0,a-r),s=s||r>0}const n=e.detail.update;n&&(s=s||y(n,t,c),r=e=>{m(n,t,e)}),s&&k({offset:t.offset,count:a},r)}}),[S,c,k]),E=(0,a.useCallback)((e=>{let t=-1;const r=e.detail?.disregardAfterKey;if(r&&"success"===S.status){const e=S.data.data.findIndex((e=>e.metadata.key===r));if(e>-1&&(t=S.data.data.length-e-1),0===t&&S.data.data.length>=g)return}t>-1&&"success"===S.status?(d.current=d.current-t,j({offset:S.data.offset,count:Math.max(S.data.data.length,g)})):("loading"===S.status&&p.current?.abort(),w())}),[S,g,j,w]);if((0,a.useEffect)((()=>(C&&(C.addEventListener("refresh",E),C.addEventListener("mutate",P)),()=>{C&&(C.removeEventListener("refresh",E),C.removeEventListener("mutate",P))})),[C,w,P,E]),!r){return[(0,e.getEmptyState)("exact"),e=>Promise.resolve()]}return[S,j]};const i=e=>{if(null==e)return null;return(0,r.getEnhancedDataProvider)(e,{fetchFirst:{caching:"visitedByCurrentIterator",forceLocalCaching:"enabled"}})},o=(e,t)=>e.status===t.status&&"loading"===t.status?e:t,l=async(e,t,r)=>await c(e,t,r),c=async(e,t,r)=>{const a=e.current;if(null===a)return{total:-1,done:void 0};const s=await a.next();return a===e.current?(t+=s.value.data.length)>=r||s.done?{total:t,done:s.done}:c(e,t,r):{total:-1,done:void 0}};e.getEmptyState=e=>"atLeast"===e?u:d;const u=Object.freeze({status:"success",data:{offset:0,data:[],totalSize:0,sizePrecision:"atLeast"}}),d=Object.freeze({status:"success",data:{offset:0,data:[],totalSize:0,sizePrecision:"exact"}}),f=(e,t,r,a)=>{let s=0;if(h(e,r)){const r=a?e.indexes?.sort(((e,t)=>e-t)):e.indexes;let n=t.totalSize-1;r?.forEach((e=>{e<=n&&(s=s+=1,a&&(n=n+=1))}))}else if(a);else{const r=t.data.map((e=>e.metadata.key));e.keys.forEach((e=>{r.includes(e)&&(s+=1)}))}return s},y=(e,t,r)=>{if(h(e,r)){const r=e.indexes?e.indexes:[],a=t.offset,s=a+t.data.length;for(let e=0;e<r.length;e++)if(r[e]>=a&&r[e]<s)return!0}else{const r=Array.from(e.keys),a=t.data.map((e=>e.metadata.key));for(let e=0;e<r.length;e++){const t=r[e];if(a.includes(t))return!0}}return!1},m=(e,t,r)=>{e.keys.forEach((e=>{const a=r.find((t=>t.metadata.key==e)),s=t.data.find((t=>t.metadata.key==e));s&&a&&s.data===a.data&&(a.data=new Proxy(a.data,{}))}))},h=(e,t)=>e.indexes&&null==t.sortCriteria&&null==t.filterCriterion})),
/**
 * @license
 * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define("oj-c/utils/PRIVATE_keyUtils/keySetUtils",["require","exports","ojs/ojkeyset"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isEqual=e.getFirstKey=e.isEmpty=e.keysToKeySet=e.keySetToKeys=void 0;e.keySetToKeys=e=>{if(!e)return{all:!1,keys:new Set};let t={};if(e.isAddAll()){t={all:!0,deletedKeys:new Set(e.deletedValues())}}else if(!e.isAddAll()){t={all:!1,keys:new Set(e.values())}}return t};e.keysToKeySet=e=>{let r;return e.all?(r=new t.AllKeySetImpl,r=r.delete(new Set(e.deletedKeys.values()))):e.all||(r=new t.KeySetImpl(new Set(e.keys.values()))),r};e.isEmpty=e=>!e.all&&0===e.keys.size;e.getFirstKey=(e,t)=>{if(!1===e.all&&e.keys.size>0){const[t]=e.keys;return t}return t.length>0?t[0]:null};e.isEqual=(e,t)=>{if(e===t)return!0;if(e.keys.all!==t.keys.all)return!1;const r=!0===e.keys.all?Array.from(e.keys.deletedKeys.values()):Array.from(e.keys.keys.values()),a=!0===t.keys.all?Array.from(t.keys.deletedKeys.values()):Array.from(t.keys.keys.values());if(r.length!==a.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==a[e])return!1;return!0}})),
/**
 * @license
 * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define("oj-c/utils/PRIVATE_collectionUtils/collectionUtils",["require","exports","../PRIVATE_keyUtils/keySetUtils"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.handleOnSelectionChanged=e.getSelectedKeys=void 0;e.getSelectedKeys=(e,r,a,s)=>{const n=e?.keys?.all?r?.data.length:e?.keys.keys?.size;let i;return r&&r.data.length>0&&"singleRequired"===a&&0===n?(i={all:!1,keys:new Set([r.data[0].metadata.key])},s&&s((0,t.keysToKeySet)(i))):i=(0,t.keySetToKeys)(e),i};e.handleOnSelectionChanged=(e,r,a,s)=>{"singleRequired"===e&&0===r.value.keys?.size||a&&!s(r.target)&&a((0,t.keysToKeySet)(r.value))}})),
/**
 * @license
 * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define("oj-c/card-view/useCardViewPreact",["require","exports","preact/hooks","../hooks/UNSAFE_useListData/useListData","../utils/PRIVATE_collectionUtils/collectionUtils"],(function(require,e,t,r,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useCardViewPreact=void 0;e.useCardViewPreact=({"aria-label":e,"aria-labelledby":s,"aria-describedby":n,data:i,gutterSize:o,focusBehavior:l,selected:c,onSelectedChanged:u,scrollPolicyOptions:d,selectionMode:f,initialAnimation:y,columns:m,reorderable:h,onOjReorder:b,onCurrentItemChanged:p,skeletonTemplate:g},C,S)=>{const[v,k]=(0,r.useListData)(i,{fetchSize:d?.fetchSize}),x=(0,t.useRef)(),j="error"!==v.status?v.data:null;(0,t.useEffect)((()=>{"loading"===v.status?x.current=S.addBusyState("list data is in fetch state"):x.current&&(x.current(),x.current=void 0)}),[v.status,S]),(0,t.useEffect)((()=>()=>{x.current&&(x.current(),x.current=void 0)}),[]);const w=Number(m),P=Number.isInteger(w)?w:void 0,E=(0,a.getSelectedKeys)(c,j,f,u),_=d?.scroller?{scroller:()=>d.scroller?document.querySelector(d.scroller):null}:void 0,R=(0,t.useCallback)((()=>{if(j){const e=d&&d.fetchSize?d.fetchSize:25;k({offset:0,count:j.data.length+e})}}),[v,d,k]);return{status:v.status,cardViewProps:{"aria-label":e,"aria-labelledby":s,"aria-describedby":n,data:j?j.data:null,getRowKey:e=>e.metadata.key,gutterSize:o,hasMore:!!j&&"atLeast"===j.sizePrecision,onLoadMore:R,focusBehavior:l,onSelectionChange:e=>{(0,a.handleOnSelectionChanged)(f,e,u,C)},selectedKeys:E,selectionMode:"singleRequired"===f?"single":f,initialAnimation:y,columns:P,viewportConfig:_,onReorder:"enabled"===h?.items?e=>{b&&b(e)}:null,onPersistCurrentItem:e=>{p?.(e.value)},skeletonRenderer:g}}}})),define("oj-c/hooks/PRIVATE_useSelectionContext/ItemKeyContext",["require","exports","preact"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ItemKeyContext=void 0,e.ItemKeyContext=(0,t.createContext)(void 0)})),define("oj-c/card-view/cardViewItem",["require","exports","preact/jsx-runtime","@oracle/oraclejet-preact/hooks/UNSAFE_useTabbableMode","../hooks/PRIVATE_useSelectionContext/ItemKeyContext"],(function(require,e,t,r,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CardViewItem=void 0;e.CardViewItem=({context:e,itemTemplate:s})=>{const n=(0,r.useTabbableMode)(),i={isTabbable:n.isTabbable,data:e.data.data,item:e.data};return(0,t.jsx)(a.ItemKeyContext.Provider,{value:e.metadata.key,children:(0,t.jsx)(r.TabbableModeContext.Provider,{value:n,children:s&&s(i)})})}})),define("oj-c/hooks/PRIVATE_useSelectionContext/SelectionContext",["require","exports","preact"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionContext=void 0,e.SelectionContext=(0,t.createContext)(void 0)})),define("oj-c/card-view/card-view",["require","exports","preact/jsx-runtime","@oracle/oraclejet-preact/translationBundle","preact/hooks","ojs/ojvcomponent","preact/compat","@oracle/oraclejet-preact/UNSAFE_CardFlexView","@oracle/oraclejet-preact/UNSAFE_CardGridView","./useCardViewPreact","./cardViewItem","@oracle/oraclejet-preact/hooks/UNSAFE_useTranslationBundle","@oracle/oraclejet-preact/UNSAFE_EmptyList","../hooks/PRIVATE_useSelectionContext/SelectionContext","@oracle/oraclejet-preact/hooks/UNSAFE_useBusyStateContext","css!oj-c/card-view/card-view-styles.css"],(function(require,e,t,r,a,s,n,i,o,l,c,u,d,f,y){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CardView=void 0;const m=({isClickthroughDisabled:e,busyStateContext:r,itemTemplate:s,noData:y,...m})=>{const{status:h,cardViewProps:b}=(0,l.useCardViewPreact)(m,e,r),p=(0,u.useTranslationBundle)("@oracle/oraclejet-preact");if("success"===h&&!b.hasMore&&0===b.data?.length){if(y)return(0,t.jsx)(d.EmptyList,{children:y(n.Children)});{const e=p.noData_message();return(0,t.jsx)(d.EmptyList,{children:e})}}const g={selected:m.selected,selectionMode:b.selectionMode,onSelectedChange:m.onSelectedChanged},C=(0,a.useCallback)((e=>(0,t.jsx)(c.CardViewItem,{context:e,itemTemplate:s})),[s]);return b.columns?(0,t.jsx)(f.SelectionContext.Provider,{value:g,children:(0,t.jsx)(o.CardGridView,{...b,children:C})}):(0,t.jsx)(f.SelectionContext.Provider,{value:g,children:(0,t.jsx)(i.CardFlexView,{...b,children:C})})},h=(0,s.registerCustomElement)("oj-c-card-view",(({columns:e="auto",data:r=null,focusBehavior:n="card",gutterSize:i="sm",initialAnimation:o="slideUp",scrollPolicyOptions:l={fetchSize:25},selectionMode:c="none",reorderable:u={items:"disabled"},...d})=>{const f=(0,a.useRef)(null),h=(0,a.useContext)(y.BusyStateContext),p=(0,a.useCallback)((e=>null!==e&&null!==f.current&&b({target:e},f.current)),[]),g={columns:e,data:r,focusBehavior:n,gutterSize:i,initialAnimation:o,scrollPolicyOptions:l,selectionMode:c,reorderable:u,...d};return(0,t.jsx)(s.Root,{id:g.id,ref:f,children:(0,t.jsx)(m,{isClickthroughDisabled:p,busyStateContext:h,...g})})}),"CardView",{properties:{currentItem:{type:"string|number",readOnly:!0,writeback:!0},data:{type:"DataProvider|null"},gutterSize:{type:"string",enumValues:["sm","md","lg","xs","xl"]},scrollPolicyOptions:{type:"object",properties:{fetchSize:{type:"number"},scroller:{type:"string"}}},selected:{type:"object",writeback:!0},selectionMode:{type:"string",enumValues:["none","multiple","single","singleRequired"]},initialAnimation:{type:"string",enumValues:["slideUp","slideDown"]},focusBehavior:{type:"string",enumValues:["content","card"]},columns:{type:"number|string"},reorderable:{type:"object",properties:{items:{type:"string",enumValues:["disabled","enabled"]}}}},slots:{noData:{data:{}},itemTemplate:{data:{}},skeletonTemplate:{data:{}}},events:{ojReorder:{}},extension:{_WRITEBACK_PROPS:["currentItem","selected"],_READ_ONLY_PROPS:["currentItem"],_OBSERVED_GLOBAL_PROPS:["aria-label","aria-labelledby","aria-describedby","id"]}},{columns:"auto",data:null,focusBehavior:"card",gutterSize:"sm",initialAnimation:"slideUp",scrollPolicyOptions:{fetchSize:25},selectionMode:"none",reorderable:{items:"disabled"}},{"@oracle/oraclejet-preact":r.default});e.CardView=h;const b=function(e,t){let r=e.target;for(;null!=r&&r!==t;){if(p(r))return!0;r=r.parentNode}return!1},p=function(e){return"disabled"===e.dataset.ojClickthrough}})),define("oj-c/card-view",["require","exports","oj-c/card-view/card-view"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CardView=void 0,Object.defineProperty(e,"CardView",{enumerable:!0,get:function(){return t.CardView}})}));
//# sourceMappingURL=card-view.js.map