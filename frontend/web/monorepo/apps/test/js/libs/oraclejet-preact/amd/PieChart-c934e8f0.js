define(['exports', 'preact/jsx-runtime', './UNSAFE_PieChart/themes/PieChartStyles.css', './TrackResizeContainer-a4999df9', './datatipUtils-6846028e', './accUtils-acd70e81', './lineUtils-81206f70', './utils-8ccd1b88', './classNames-08d99695', './usePieChartNav-339488db', './useDatatip-36aa820b', './layoutUtils-641af87a', './mergeProps-bcfa6a92', './VisTabularDatatip-ab3b0b91', './useUser-988f7da2', './useTestId-a2e433c2', './useVisTouchResponse-88a7bb09', 'preact/hooks', './stringUtils-4ffd9d59', './useContextMenu-4bd1c23a', './Menu-45a26116', './MenuItem-ff1cd14d', 'preact', './logger-0f873e29', './LayerHost-7d4aa6d3', 'preact/compat', 'css!./TooltipContentStyles.styles.css', 'module', './hooks/UNSAFE_useTooltip/themes/redwood/TooltipContentVariants.css', './tooltipUtils-3c8a0253', 'css!./IconStyle.styles.css', './SelectMenuGroupContext-67f24a8f', './UNSAFE_Menu/themes/MenuItemStyles.css', './UNSAFE_Separator/themes/SeparatorStyles.css', 'css!./MenuSeparatorStyles.styles.css', 'module', './UNSAFE_Menu/themes/redwood/MenuSeparatorVariants.css', 'css!./MenuStyles.styles.css', './eventsUtils-5fb81c3e', './utils-cd60c9d4', './useTextDimensions-f254e8f5', './useCssVars-d782da3d', './cssUtils-1609d0af', './colorUtils-b9dc1bd1'], (function(e,t,n,s,i,o,a,l,r,c,h,d,u,f,x,g,y,b,m,M,p,I,v,S,C,P,T,w,F,L,j,A,R,N,V,U,D,E,z,k,_,B,O,Y){"use strict";function q(e){return e*(Math.PI/180)}function H(e,t,n,s){const i=Math.atan2(s,n)-Math.atan2(t,e);return i<0?i+2*Math.PI:i}function G(e,t,n,s,i,o,l,r,c){const h=Math.max(s-e,0),d=Math.max(i-e,0),u=360==l||h<e?0:r+2*e,f=o?o+e:0,x=q(360==l?359.99:l),g=q(c),y=u/2,b=y<h?Math.asin(y/h):0,m=-x/2-g,M=Math.min(5*y,x>0?Math.abs(y/Math.sin(x/2)):0),p=0==h?M:M*d/h,I=t+Math.cos(m)*M,v=n+Math.sin(m)*p,S=t+Math.cos(-b-g)*h,C=n+Math.sin(-b-g)*d,P=t+Math.cos(-g-x+b)*h,T=n+Math.sin(-g-x+b)*d;let w,F=H(P-t,T-n,S-t,C-n);if(F=Math.min(F,x),f>0){const e=y<f?Math.asin(y/f):0,s=t+Math.cos(-e-g)*f,i=n+Math.sin(-e-g)*f,o=t+Math.cos(-g-x+e)*f,r=n+Math.sin(-g-x+e)*f;let c=H(o-t,r-n,s-t,i-n);c=Math.min(c,F,x),360==l?(w=a.moveTo(P,T),w+=a.arcTo(h,d,x,1,S,C),w+=a.lineTo(P,T),w+=a.moveTo(s,i),w+=a.arcTo(f,f,x,0,o,r)):(w=a.moveTo(o,r),w+=a.lineTo(P,T),w+=a.arcTo(h,d,F,1,S,C),w+=a.lineTo(s,i),w+=a.arcTo(f,f,c,0,o,r))}else 360==l?(w=a.moveTo(P,T),w+=a.arcTo(h,d,x,1,S,C)):(w=a.moveTo(I,v),w+=a.lineTo(P,T),w+=a.arcTo(h,d,F,1,S,C));return w+=a.closePath(),w}function W(e,t,n){return{innerBounds:{width:Math.sqrt(2)*n,height:Math.sqrt(2)*n,x:e-n/Math.sqrt(2),y:t-n/Math.sqrt(2)},outerBounds:{width:2*n,height:2*n,x:e-n,y:t-n}}}function $(e,t,n,s,i,o){return o?function(e,t,n,s,i,o){const a=(e+t/2)/180*Math.PI,l=(i+o)/2;return{x:n+l*Math.cos(a),y:s-l*Math.sin(a),width:0,height:0}}(e[o.itemIndex].startAngle,e[o.itemIndex].angleExtent,t,n,s,i):void 0}function J(e,t,n){return n?.color||null!=t?.itemIndex?e[t.itemIndex]:void 0}function K({cx:e,cy:s,r:i,startAngle:o,angleExtent:a,gap:l,innerRadius:c,color:h,id:d,itemIndex:u,isFocused:f=!1,isInteractive:x,...g}){const{interactiveItemStyle:y,contrastBorder:b,innerShapes:m}=n.styles,M=r.classNames([x&&y,b,m]),p=G(0,e,s,i,i,c,a,l,o);let I;return f?(I=G(2,e,s,i,i,c,a,l,o),t.jsxs("g",{id:d,role:g.accessibleLabel?"img":void 0,"data-oj-private-item-index":u,"data-oj-private-object":"pieSlice","aria-label":g.accessibleLabel,children:[t.jsx("path",{d:p,fill:h,stroke:h,className:n.styles.innerShapes}),t.jsx("path",{d:I,fill:h,className:M})]})):t.jsx("path",{role:g.accessibleLabel?"img":void 0,"aria-label":g.accessibleLabel,d:p,"data-oj-private-object":"pieSlice",fill:h,id:d,"data-oj-private-item-index":u,className:x?y:void 0})}const Q=1.04,X=.1;function Z(e,t,n,s,i){const o=(360-e)*(Math.PI/180);return{x:t+Math.cos(o)*s,y:n+Math.sin(o)*i}}function ee(e,t){const{angleExtent:n}=e;return n<3&&t>120}function te(e,t,n,s,i,o,a){const{angleExtent:l,startAngle:r}=e,c=o,h=(t-s)/a,d=(n-i)/a;let u=-Math.atan2(d,h)*(180/Math.PI);for(;u<r;)u+=360;for(;u-r>=360;)u-=360;const f=Math.pow(h,2)+Math.pow(d,2);return Math.sqrt(f)>c/a&&f<=1&&u<=r+l}const ne=(e,t,n,s,i,o,a)=>{const[l,r]=function(e,t,n,s,i,o){const a=[],l=new Set,{cx:r,cy:c}=s;for(const h of e){const{labelPosition:d,startAngle:u,angleExtent:f,label:x,labelStyle:g}=h,y=d||"auto";if("none"===y)continue;if("outside"===y||ee(h,e.length)||null==x){l.add(h.index);continue}const b=u+f/2,m=t,M=s;let p,I;if(1===e.length)p=M.cx,I=M.cy;else{const e=Math.max(.45,.65-.45*m/Math.max(n,.001)),t=Z(b,M.cx,M.cy,m+(n-m)*e,m+(n-m)*e);p=t.x,I=t.y}const v={x:p,y:I},S=o(x,{fontSize:i,...g});let C=p,P=p;const T=I-S.height/2,w=I+S.height/2;for(;te(h,C,T,r,c,t,n)&&te(h,C,w,r,c,t,n);)C--;for(;te(h,P,T,r,c,t,n)&&te(h,P,w,r,c,t,n);)P++;C=Math.ceil(C+3),P=Math.floor(P-3);let F=2*Math.min(p-C,P-p);if(F<S.width&&(v.x=(C+P)/2,F=P-C),"inside"===y)S.width<F&&a.push({position:b,angle:b,slice:h,textInfo:k.getTextInfo(x,{fontSize:i,...g},F,S.height,!1,x.length,o),...S,...v});else{const e=x.length,t=k.getTextInfo(x,{fontSize:i,...g},F,S.height,!1,e,o);t.didNotFit?l.add(h.index):a.push({position:b,angle:b,slice:h,textInfo:t,...S,...v})}}return[a,l]}(e,n,s,t,a,o),{leftLabels:c,rightLabels:h}=function(e,t,n,s,i,o,a){const l=[],r=[],{cx:c,cy:h}=s;for(let s=0;s<e.length;s++){const d=e[s],{labelPosition:u,startAngle:f,angleExtent:x,label:g,labelStyle:y}=d;if(null==g||"none"==u||"inside"==u||ee(e[s],e.length)||!t.has(d.index))continue;let b=f+x/2;b>360&&(b-=360),b<0&&(b+=360);const m=Z(b,c,h,i*Q,i*Q),M=b>=90&&b<270,p=se(n,m.x,M),I=k.getTextInfo(g,{fontSize:o,...y},p,1/0,!0,1,a),v={x:I.width,y:I.height},S=15;if(b<180-S&&b>S?m.y-=1*v.y:b<S||b>360-S?(m.y-=.5*v.y,m.x+=.2*v.y):b>180-S&&b<180+S&&(m.y-=.5*v.y,m.x-=.2*v.y),1==e.length&&(m.x-=v.x/2),m.y<n.y||m.y+v.y>n.y+n.height)continue;let C;b>=90&&b<270?(C=b-90,ie(d,b,C,v,m,I,l)):(C=b<=90?Math.abs(90-b):180-(b-270),ie(d,b,C,v,m,I,r))}return{leftLabels:l,rightLabels:r}}(e,r,i,t,s,a,o),d=oe(e,s,t,i,c,"left"),u=oe(e,s,t,i,h,"right");return 1===d&&0!==u&&re(e,i,t,s,c,!0,!0,!0),0!==d&&1===u&&re(e,i,t,s,h,!1,!0,!0),ce(c,i,t,s,"left",{fontSize:a},o),ce(h,i,t,s,"right",{fontSize:a},o),{insideLabels:l,rightLabels:h,leftLabels:c}};function se(e,t,n){return n?t-e.x:e.x+e.width-t}function ie(e,t,n,s,i,o,a){let l=-1;for(let e=0;e<a.length;e++){const t=a[e];if(t.position&&t.position>n){l=e;break}}-1==l&&(l=a.length);const r={position:n,angle:t,width:s.x,height:s.y,x:i.x,y:i.y,slice:e,textInfo:o};a.splice(l,0,r)}function oe(e,t,n,s,i,o){if(i.length<1)return;let a,l,r=s.y,c=!1,h=!1,d=!1,u=0,f=!1,x=!1;const g="left"==o;for(let e=0;e<i.length;e++)a=i[e],l=f,a.position>90&&(f=!0),u=a.y+a.height,x=r-a.y>1,x&&(f?l?d=!0:h=!0:c=!0),u>r&&(r=u);return c&&d||h?(re(e,s,n,t,i,g,!0,!0),2):c?(re(e,s,n,t,i,g,!0,!1),1):d?(re(e,s,n,t,i,g,!1,!0),1):0}function ae(e,t,n,s,i){const o=Z(e.angle,i.cx,i.cy,s,s);return Math.atan2(Math.abs(t-o.x),o.y-n)}function le(e,t,n,s){t.x=n;const i=1.1*e,o=q(t.position),a=i*Math.cos(o);let l=s.cy-a-.5*t.height+0;const r=t.minY,c=t.maxY;r<=c&&(l=Math.max(l,r),l=Math.min(l,c)),t.y=l}function re(e,t,n,s,i,o,a,l){const r=t;let c,h,d,u,f=r.y,x=r.y+r.height,g=0,y=n.cx;const b=1.2000000000000002*s;for(o?(y-=b,u=y+s*X):(y+=b,u=y-s*X),c=0;c<i.length;c++)h=i[c],g=q(h.position),d=ae(h,u,f,s,n),d-g>.45*Math.PI||ee(i[c].slice,e.length)?(i.splice(c,1),c--):(i[c].minY=f,f+=i[c].height);for(c=i.length-1;c>=0;c--){h=i[c];g=q(h.position),d=ae(h,u,x,s,n),g-d>.45*Math.PI||ee(i[c].slice,e.length)?i.splice(c,1):(x-=i[c].height,i[c].maxY=x)}if(0==i.length)return;const m=function(e){let t=91,n=-1;for(let s=0;s<e.length;s++){const i=e[s].position;Math.abs(i-90)<t&&(t=Math.abs(i-90),n=s)}return n}(i),M=i[m];a&&!l&&M.minY+M.height>n.cy&&(l=!0),l&&!a&&M.maxY<n.cy&&(a=!0);const p=M.position;(l&&a||p>90&&l||p<=90&&a)&&(le(s,M,y,n),M.slice.hasFeelers=!0);let I,v,S=M.y,C=M.y+M.height;if(a)for(c=m-1;c>=0;c--)h=i[c],v=h.height,le(s,h,y,n),h.slice.hasFeelers=!0,I=h.y,I+v<S?S=I:S-=v,h.y=S;if(l)for(c=m+1;c<i.length;c++)h=i[c],v=h.height,le(s,h,y,n),h.slice.hasFeelers=!0,I=h.y,I>C?C=I+v:C+=v,h.y=C-v}function ce(e,t,n,s,i,o,a){if(null==e||e.length<=0)return;let l,r,c;const h="left"===i,d=t;let u,f=1/0;for(l=0;l<e.length;l++){const i=e[l],r={...o,...i.slice.labelStyle};if(i.slice.hasFeelers){u=he(i,n,s,h);const e=a("MW",r).height,o=i.width,l=Math.min(2*e,o);if(se(t,i.x,h)+u<l||0==i.width){i.textInfo=void 0,i.slice.hasFeelers=!1;continue}f=Math.min(f,u)}else i.slice.hasFeelers=!1}for(l=0;l<e.length;l++){const i=e[l];if(r=i.slice,c=i.slice.label,c)if(i.slice.hasFeelers&&(i.x=h?i.x+f:i.x-f,he(i,n,s,h)),i.y<d.y||i.y+i.height>d.y+d.height)r.label="",r.hasFeelers=!1;else{const e=se(t,i.x,h),n=i.textInfo&&k.getTextInfo(i.slice.label,{...o,...i.slice.labelStyle},e,i.textInfo.height,!0,1,a);i.textInfo=n,0!==i.height&&0!==i.width||(r.label="",r.hasFeelers=!1)}}}function he(e,t,n,s){const{x:i,y:o,height:a}=e;let l=i;const r=o+.5*a,c=X*n;let h;s?(l+=3,h=l+c):(l-=3,h=l-c);const d={x:h,y:r},u={x:l,y:r},f=Z(e.angle,t.cx,t.cy,n,n),x=q(e.position),g=Math.abs(Math.atan2(d.x-f.x,f.y-d.y)),y=(f.y-d.y)*Math.tan(x);return(x>Math.PI/2&&g>Math.PI/2&&g<x||x<Math.PI/2&&g<Math.PI/2&&g>x)&&(d.x=s?f.x-y:f.x+y),e.startPt=f,e.midPt=d,e.endPt=u,Math.abs(u.x-d.x)-c}function de({pieLabelInfo:e,labelPos:s,fontSize:i,isRtl:o}){const{x:a,y:l,textInfo:r,slice:c,startPt:h,midPt:d,endPt:u}=e,f=c.color,x="inside"===s?Y.getContrastingTextColor(f):void 0;return t.jsx(t.Fragment,{children:r?.lines.map(((e,f)=>{const g=a,y=l+(f+.5)*r.dims[f].height,b=o&&"left"===s||!o&&"right"===s?"start":"inside"===s?"middle":"end";return t.jsxs(t.Fragment,{children:[c.label&&t.jsx("text",{className:n.styles.labelStyle,x:g,y:y,textAnchor:b,dominantBaseline:"inside"===s?"center":"middle",style:{fill:x,fontSize:i},children:e}),c.hasFeelers&&h&&d&&u&&t.jsxs(t.Fragment,{children:[t.jsx("line",{x1:h.x,x2:d.x,y1:h.y,y2:d.y,className:n.styles.fillerLineStyle}),t.jsx("line",{x1:u.x,x2:d.x,y1:u.y,y2:d.y,className:n.styles.fillerLineStyle})]})]})}))})}const ue=O.getChartVars();function fe({width:e,height:s,testId:i,innerRadius:o=0,contextMenuConfig:a,drilling:r="off",selectionMode:p="none",onItemDrill:I,onItemHover:v,onItemFocus:S,...C}){const P=b.useRef(null),{direction:T}=x.useUser(),w="rtl"===T,{resolvedVars:F,cssContent:L}=B.useCssVars(ue),j=Array.from(Array(12)).map(((e,t)=>F[`color${t+1}`])),A=w?C.data.slice().reverse():C.data,{totalValue:R,isLabelOutside:N}=A.reduce((({totalValue:e,isLabelOutside:t},n)=>({totalValue:e+n.value,isLabelOutside:t||!!n.label&&("outside"===n.labelPosition||"auto"===n.labelPosition)})),{totalValue:0,isLabelOutside:!1});const V=function(e,t,n,s){let i,o=90;const a=[];for(let l=0;l<e.length;l++){const r=e[l],c=r.value;i=c===t?100:0===t?0:Math.min(c/t*100,99.99);const h=3.6*i;let d=o-h;d<0&&(d+=360),a.push({color:n[(s?e.length-1-l:l)%n.length],index:l,startAngle:d,angleExtent:h,...r}),o=d}return a}(A,R,j,w),U=A.length>0,D=function(e){return 3*e}(.5),E=A.length>100,k=g.useTestId(i),O=l.getAvailSpace(e,s,!1),{cx:Y,cy:q}=function(e){return{cx:e.x+Math.floor(e.width/2),cy:e.y+Math.floor(e.height/2)}}(O),H=function(e,t){const n=t?.38:.45;return Math.floor(Math.min(e.width,e.height)*n)}(O,N),G=o*H,Q=function(e,t,n){if(!t)return e;const s=2*Math.PI*n;let i=0;return e.filter((({startAngle:e,angleExtent:t})=>{const n=(t+e)/360*s;return!(t/360*s<1.5&&Math.abs(i-n)<1.5||(i=n,0))}))}(V,E,H),{getDetailFromInfo:X,getNextChartItem:Z}=function(e,t){return{getNextChartItem:({itemIndex:n},s)=>{let i=n;return i=t&&("ArrowRight"===s||"ArrowUp"===s)||!t&&("ArrowLeft"===s||"ArrowDown"===s)?n-1:n+1,{itemIndex:(i%e.length+e.length)%e.length}},getDetailFromInfo:t=>{if(!t)return{id:void 0,data:void 0};const n=function(e,t){const{itemIndex:n}=e;return t[n]}(t,e);return{id:n?n.id:void 0,data:n}}}}(A,"rtl"===T),{textMeasureContent:ee,getTextDimensions:te}=_.useTextDimensions(),se=!(!p||"none"===p),ie="on"===r,{touchResponse:oe,touchResponseStyle:ae}=y.useVisTouchResponse({type:"auto",supportsTouchDragGestures:!1,rootRef:P}),{activeId:le,focusedItemInfo:re,hoveredItemInfo:ce,eventsProps:he,onContextMenuDismissed:fe}=c.usePieChartNav(oe,X,Z,r,I),xe=re.isFocusVisible?re:ce,ge=xe?A[Q[xe.itemIndex].index]:void 0,{content:ye,borderColor:be}=ge&&C.datatip?C.datatip({data:ge}):((e,n)=>e?e.accessibleLabel?{content:e.accessibleLabel,borderColor:J(j,n,e)}:{content:t.jsx(f.VisTabularDatatip,{tableData:[{key:"Value",value:e.value}]}),borderColor:J(j,n,e)}:{content:void 0,borderColor:void 0})(ge,xe),me=re.isFocusVisible?"element":"pointer",Me=xe?.isFocusVisible?$(Q,Y,q,G,H,xe):void 0,pe=d.calculateOffset(w,e,Me),{datatipContent:Ie,datatipProps:ve}=h.useDatatip({content:ye,offset:pe,anchor:me,placement:"top-start",borderColor:be,touchResponse:oe});ve["aria-describedby"]=m.l([C["aria-describedby"],ve["aria-describedby"]]);const{contextMenuContent:Se,contextMenuProps:Ce}=(({offset:e,rootRef:t,contextMenuConfig:n,focusedItemInfo:s,items:i,onContextMenuDismissed:o,width:a,isRtl:l})=>{const{contextMenuProps:r,contextMenuContent:c}=M.useContextMenu({onContextMenuHandler:({gesture:n,target:o})=>{if("keyboard"===n){const t=s.itemIndex;return{type:"offset",context:{type:"item",data:i[t]},offsetValue:e,isRtl:l,width:a}}const r=z.getInfo(t,o)?.itemIndex,c=void 0!==r?i[r]:null;let h;return h=c?{type:"item",data:c}:t.current?.children[1].contains(o)?{type:"centerLabel"}:{type:"background"},{type:"pointer",context:h}},contextMenuOptions:{isDisabled:!n},rootRef:t,contextMenuConfig:n,onContextMenuDismissed:o});return{contextMenuContent:c,contextMenuProps:r}})({offset:pe,rootRef:P,contextMenuConfig:U?a:void 0,onContextMenuDismissed:fe,focusedItemInfo:re,items:V,width:e,isRtl:w}),Pe=u.mergeProps(he,ve,Ce);let Te=[],we=[],Fe=[];const Le=F.labelFontSize;if(te){const e=ne(Q,{cx:Y,cy:q},G,H,O,te,Le);Te=e.insideLabels,we=e.rightLabels,Fe=e.leftLabels}return t.jsxs("div",{ref:P,tabIndex:0,"aria-label":C["aria-label"],"aria-labelledby":C["aria-labelledby"],"aria-activedescendant":le,role:"application",...Pe,...k,className:n.styles.chart,style:{width:e,height:s,...ae},children:[Q.length>0&&t.jsxs("svg",{className:n.styles.svg,children:[Q.map(((e,n)=>t.jsx(K,{isInteractive:se||ie,cx:Y,cy:q,itemIndex:n,id:xe?.itemIndex===n?le:void 0,isFocused:re?.itemIndex===n&&re?.isFocusVisible,isHovered:ce?.itemIndex===n,r:H,startAngle:e.startAngle,gap:D,innerRadius:G,angleExtent:e.angleExtent,color:e.color,accessibleLabel:e.accessibleLabel},e.id))),Te?.map((e=>t.jsx(de,{isRtl:w,pieLabelInfo:e,labelPos:"inside",fontSize:Le}))),Fe?.map((e=>t.jsx(de,{isRtl:w,pieLabelInfo:e,labelPos:"left",fontSize:Le}))),we?.map((e=>t.jsx(de,{isRtl:w,pieLabelInfo:e,labelPos:"right",fontSize:Le})))]}),C.children?.(W(Y,q,G)),Ie,L,Se,ee]})}e.PieChart=function({width:e,height:i,...o}){return t.jsx(s.TrackResizeContainer,{width:e,height:i,class:n.dimensionStyle,children:(e,n)=>t.jsx(fe,{width:e,height:n,...o})})}}));
//# sourceMappingURL=PieChart-c934e8f0.js.map
