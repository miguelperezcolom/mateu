/**
 * @license
 * Copyright (c) 2014, 2025, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["exports","ojs/ojexpparser"],function(n,e){"use strict";
/**
   * @license
   * Copyright (c) 2019 2025, Oracle and/or its affiliates.
   * Licensed under The Universal Permissive License (UPL), Version 1.0
   * as shown at https://oss.oracle.com/licenses/upl/
   *
   * @license
   * Based on the Expression Evaluator 2.0.0
   * https://github.com/donmccurdy/expression-eval
   * under MIT License
   * @ignore
   */const r=Symbol("proxy");n.CspExpressionEvaluatorInternal=function(n){var t=new e.ExpParser,u=Object.assign({},n);u.globalScope&&u.globalScope.Object||(u.globalScope=Object.assign({Object:Object},u.globalScope)),this.createEvaluator=function(n){var e;try{e=t.parse(n)}catch(e){y(e,n)}var r=u.globalScope;return{evaluate:function(t){var u,o=t;r&&(o=t.concat([r]));try{u=i(e,o)}catch(e){y(e,n)}return u}}},this.evaluate=function(n,e){return i(n,[e])};var o={"||":function(n,e){return n||e()},"??":function(n,e){return n??e()},"&&":function(n,e){return n&&e()},"|":function(n,e){return n|e},"^":function(n,e){return n^e},"&":function(n,e){return n&e},"==":function(n,e){return n==e},"!=":function(n,e){return n!=e},"===":function(n,e){return n===e},"!==":function(n,e){return n!==e},"<":function(n,e){return n<e},">":function(n,e){return n>e},"<=":function(n,e){return n<=e},">=":function(n,e){return n>=e},"<<":function(n,e){return n<<e},">>":function(n,e){return n>>e},">>>":function(n,e){return n>>>e},"+":function(n,e){return n+e},"-":function(n,e){return n-e},"*":function(n,e){return n*e},"/":function(n,e){return n/e},"%":function(n,e){return n%e},"**":function(n,e){return n**e},instanceof:function(n,e){return n instanceof e}},c={"-":function(n){return-n},"+":function(n){return n},"~":function(n){return~n},"!":function(n){return!n},"...":function(n){return new a(n)},typeof:function(n){return typeof n}};function a(n){this.items=function(){return n}}function i(n,e){const t=s(n,e);return t?.[r]??t}function s(n,r){switch(n.type){case e.IDENTIFIER:return function(n,e){var r=l(n,e);if(r)return r[e];throw new Error("Variable "+e+" is undefined")}(r,n.name);case e.MEMBER_EXP:return p(n,r)[1];case e.LITERAL:return n.value;case e.CALL_EXP:var t,u,a;switch(n.callee.type){case e.IDENTIFIER:a=function(n,e){var r=l(n,e);if(r)return[r,r[e]];throw new Error("Variable "+e+" is undefined")}(r,n.callee.name);break;case e.MEMBER_EXP:a=p(n.callee,r);break;default:u=i(n.callee,r)}return!u&&Array.isArray(a)&&(t=a[0],u=a[1]),"function"!=typeof u&&E("Expression is not a function"),u.apply(t,f(n.arguments,r));case e.UNARY_EXP:var s;try{s=i(n.argument,r)}catch(r){if(n.argument.type!==e.IDENTIFIER)throw r}return c[n.operator](s);case e.BINARY_EXP:return"="===n.operator?function(n,r,t){switch(n.type){case e.IDENTIFIER:var u=n.name,o=l(r,u);o||E("Cannot assign value to undefined variable "+u),o[u]=t;break;case e.MEMBER_EXP:var c=n.computed?i(n.property,r):n.property.name;p(n,r)[0][c]=t;break;default:E("Expression of type: "+n.type+" not supported for assignment")}return t}(n.left,r,i(n.right,r)):o[n.operator](i(n.left,r),i(n.right,r));case e.LOGICAL_EXP:return o[n.operator](i(n.left,r),function(){return i(n.right,r)});case e.CONDITIONAL_EXP:return i(n.test,r)?i(n.consequent,r):i(n.alternate,r);case e.ARRAY_EXP:return f(n.elements,r);case e.OBJECT_EXP:return function(n,r){return n.properties.reduce(function(n,t){return n[e.getKeyValue(t.key)]=i(t.value,r),n},{})}(n,r);case e.FUNCTION_EXP:case e.ARROW_EXP:return function(n,r){return function(){var t=arguments,u=n.params.reduce(function(n,e,r){return n[e.name]=t[r],n},{});u.this=this;try{const t=n.body.body.type===e.RETURN_STATEMENT,o=i(t?n.body.body.argument:n.body.body,[u].concat(r));return t?o:void 0}catch(e){y(e,n.body.expr)}}}(n,r);case e.NEW_EXP:return function(n,e){var r=i(n.callee,e);r instanceof Function||E("Node of type "+n.callee.type+" is not evaluated into a constructor");return new(Function.prototype.bind.apply(r,[null].concat(f(n.arguments,e))))}(n,r);case e.TEMPLATE_LITERAL:return function(n,e){const r=n.expressions.map(n=>i(n,e)),t=n.quasis.reduce((n,t,u)=>(n.push(i(t,e)),u<r.length&&n.push(r[u]),n),[]);return t.join("")}(n,r);case e.TEMPLATE_ELEMENT:return n.value.cooked;default:throw new Error("Unsupported expression type: "+n.type)}}function f(n,e){return n.reduce((n,r)=>{const t=i(r,e);return t instanceof a?n.push(...t.items()):n.push(t),n},[])}function p(n,e){var r=s(n.object,e);return!r&&n.optional?[]:n.computed?[r,r[s(n.property,e)]]:[r,r[n.property.name]]}function l(n,e){for(var r=0;r<n.length;r++){var t=n[r];if(t instanceof Object&&e in t)return t}return null}function E(n){throw new Error(n)}function y(n,e){throw new Error(n.message+' in expression "'+e+'"')}},n.PROXY_SYMBOL=r,Object.defineProperty(n,"__esModule",{value:!0})});
//# sourceMappingURL=ojcspexpressionevaluator-internal.js.map