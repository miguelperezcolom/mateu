/**
 * @license
 * Copyright (c) 2014, 2025, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["touchr","ojs/ojdatasource-common","ojs/ojdatacollection-utils","ojs/ojinputnumber","ojs/ojmenu","ojs/ojmenuselectmany","ojs/ojdialog","ojs/ojbutton","ojdnd","ojs/ojcore-base","@oracle/oraclejet-preact/hooks/UNSAFE_useFormVariantContext","ojs/ojcomponentcore","ojs/ojcontext","ojs/ojdatacollection-common","ojs/ojdomutils","ojs/ojconfig","ojs/ojcustomelement-utils","ojs/ojkeyboardfocus-utils","jquery","ojs/ojlogger","ojs/ojthemeutils","ojs/ojtranslationbundleutils"],function(e,t,i,s,o,n,r,l,a,h,d,m,c,u,_,g,p,f,C,y,w,E){"use strict";var v;h=h&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h,c=c&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c,C=C&&Object.prototype.hasOwnProperty.call(C,"default")?C.default:C,(v={properties:{bandingInterval:{type:"object",properties:{column:{type:"number",value:0},row:{type:"number",value:0}}},cell:{type:"object",properties:{alignment:{type:"object",properties:{horizontal:{type:"function|string",value:"auto"},vertical:{type:"function|string",value:"auto"}}},className:{type:"function|string"},editable:{type:"function|string",enumValues:["disable","enable"],value:"enable"},renderer:{type:"function"},style:{type:"function|string"}}},currentCell:{type:"object",writeback:!0},data:{type:"DataGridProvider",extension:{webelement:{exceptionStatus:[{type:"unsupported",since:"13.0.0",description:"Data sets from a DataProvider cannot be sent to WebDriverJS; use ViewModels or page variables instead."}]}}},dataTransferOptions:{type:"object",properties:{copy:{type:"string",enumValues:["disable","enable"],value:"disable"},cut:{type:"string",enumValues:["disable","enable"],value:"disable"},fill:{type:"string",enumValues:["disable","enable"],value:"disable"},headerLabelCut:{type:"string",enumValues:["disable","enable"],value:"disable"},paste:{type:"string",enumValues:["disable","enable"],value:"disable"}}},dnd:{type:"object",properties:{drag:{type:"object",properties:{columnEndLabels:{type:"object",properties:{dataTypes:{type:"string|Array<string>"},drag:{type:"function"},dragEnd:{type:"function"},dragStart:{type:"function"}}},columnLabels:{type:"object",properties:{dataTypes:{type:"string|Array<string>"},drag:{type:"function"},dragEnd:{type:"function"},dragStart:{type:"function"}}},columns:{type:"object",properties:{dataTypes:{type:"string|Array<string>"},drag:{type:"function"},dragEnd:{type:"function"},dragStart:{type:"function"}}},rowEndLabels:{type:"object",properties:{dataTypes:{type:"string|Array<string>"},drag:{type:"function"},dragEnd:{type:"function"},dragStart:{type:"function"}}},rowLabels:{type:"object",properties:{dataTypes:{type:"string|Array<string>"},drag:{type:"function"},dragEnd:{type:"function"},dragStart:{type:"function"}}},rows:{type:"object",properties:{dataTypes:{type:"string|Array<string>"},drag:{type:"function"},dragEnd:{type:"function"},dragStart:{type:"function"}}}}},drop:{type:"object",properties:{columnEndLabels:{type:"object",properties:{dataTypes:{type:"string|Array<string>"},dragEnter:{type:"function"},dragLeave:{type:"function"},dragOver:{type:"function"},drop:{type:"function"}}},columnLabels:{type:"object",properties:{dataTypes:{type:"string|Array<string>"},dragEnter:{type:"function"},dragLeave:{type:"function"},dragOver:{type:"function"},drop:{type:"function"}}},columns:{type:"object",properties:{dataTypes:{type:"string|Array<string>"},dragEnter:{type:"function"},dragLeave:{type:"function"},dragOver:{type:"function"},drop:{type:"function"}}},rowEndLabels:{type:"object",properties:{dataTypes:{type:"string|Array<string>"},dragEnter:{type:"function"},dragLeave:{type:"function"},dragOver:{type:"function"},drop:{type:"function"}}},rowLabels:{type:"object",properties:{dataTypes:{type:"string|Array<string>"},dragEnter:{type:"function"},dragLeave:{type:"function"},dragOver:{type:"function"},drop:{type:"function"}}},rows:{type:"object",properties:{dataTypes:{type:"string|Array<string>"},dragEnter:{type:"function"},dragLeave:{type:"function"},dragOver:{type:"function"},drop:{type:"function"}}}}},reorder:{type:"object",properties:{row:{type:"string",enumValues:["disable","enable"],value:"disable"}}}}},editCell:{type:"object",writeback:!0},editMode:{type:"string",writeback:!0,enumValues:["cellEdit","cellNavigation","none"],value:"none"},frozenColumnCount:{type:"number",writeback:!0,value:0},frozenRowCount:{type:"number",writeback:!0,value:0},gridlines:{type:"object",properties:{horizontal:{type:"string",enumValues:["hidden","visible"],value:"visible"},vertical:{type:"string",enumValues:["hidden","visible"],value:"visible"}}},header:{type:"object",properties:{column:{type:"object",properties:{alignment:{type:"object",properties:{horizontal:{type:"function|string",value:"auto"},vertical:{type:"function|string",value:"auto"}}},className:{type:"function|string"},description:{type:"function"},filterable:{type:"function|string",enumValues:["auto","disable"],value:"disable"},freezable:{type:"string",enumValues:["disable","enable"],value:"disable"},hidable:{type:"string",enumValues:["disable","enable"],value:"disable"},label:{type:"object",properties:{alignment:{type:"object",properties:{horizontal:{type:"function|string",value:"auto"},vertical:{type:"function|string",value:"auto"}}},className:{type:"function|string"},description:{type:"function"},renderer:{type:"function"},sortable:{type:"function|string",enumValues:["auto","disable"],value:"disable"},style:{type:"function|string"}}},renderer:{type:"function"},resizable:{type:"object",properties:{height:{type:"string",enumValues:["disable","enable"],value:"disable"},width:{type:"string|function",enumValues:["disable","enable"],value:"disable"}}},sortable:{type:"function|string",enumValues:["auto","disable","enable"],value:"auto"},style:{type:"function|string"}}},columnEnd:{type:"object",properties:{alignment:{type:"object",properties:{horizontal:{type:"function|string",value:"auto"},vertical:{type:"function|string",value:"auto"}}},className:{type:"function|string"},description:{type:"function"},label:{type:"object",properties:{alignment:{type:"object",properties:{horizontal:{type:"function|string",value:"auto"},vertical:{type:"function|string",value:"auto"}}},className:{type:"function|string"},description:{type:"function"},renderer:{type:"function"},sortable:{type:"function|string",enumValues:["auto","disable"],value:"disable"},style:{type:"function|string"}}},renderer:{type:"function"},resizable:{type:"object",properties:{height:{type:"string",enumValues:["disable","enable"],value:"disable"},width:{type:"string|function",enumValues:["disable","enable"],value:"disable"}}},style:{type:"function|string"}}},row:{type:"object",properties:{alignment:{type:"object",properties:{horizontal:{type:"function|string",value:"auto"},vertical:{type:"function|string",value:"auto"}}},className:{type:"function|string"},description:{type:"function"},freezable:{type:"string",enumValues:["disable","enable"],value:"disable"},hidable:{type:"string",enumValues:["disable","enable"],value:"disable"},label:{type:"object",properties:{alignment:{type:"object",properties:{horizontal:{type:"function|string",value:"auto"},vertical:{type:"function|string",value:"auto"}}},className:{type:"function|string"},description:{type:"function"},renderer:{type:"function"},sortable:{type:"function|string",enumValues:["auto","disable"],value:"disable"},style:{type:"function|string"}}},renderer:{type:"function"},resizable:{type:"object",properties:{height:{type:"string|function",enumValues:["disable","enable"],value:"disable"},width:{type:"string",enumValues:["disable","enable"],value:"disable"}}},sortable:{type:"function|string",enumValues:["auto","disable","enable"],value:"auto"},style:{type:"function|string"}}},rowEnd:{type:"object",properties:{alignment:{type:"object",properties:{horizontal:{type:"function|string",value:"auto"},vertical:{type:"function|string",value:"auto"}}},className:{type:"function|string"},description:{type:"function"},label:{type:"object",properties:{alignment:{type:"object",properties:{horizontal:{type:"function|string",value:"auto"},vertical:{type:"function|string",value:"auto"}}},className:{type:"function|string"},description:{type:"function"},renderer:{type:"function"},sortable:{type:"function|string",enumValues:["auto","disable"],value:"disable"},style:{type:"function|string"}}},renderer:{type:"function"},resizable:{type:"object",properties:{height:{type:"string|function",enumValues:["disable","enable"],value:"disable"},width:{type:"string",enumValues:["disable","enable"],value:"disable"}}},style:{type:"function|string"}}}}},hiddenColumns:{type:"object",writeback:!0},hiddenRows:{type:"object",writeback:!0},scrollPolicy:{type:"string",enumValues:["auto","loadMoreOnScroll","scroll"],value:"auto"},scrollPolicyOptions:{type:"object",properties:{maxColumnCount:{type:"number",value:500},maxRowCount:{type:"number",value:500}}},scrollPosition:{type:"object",writeback:!0,value:{x:0,y:0},properties:{columnIndex:{type:"number"},columnKey:{type:"any"},offsetX:{type:"number"},offsetY:{type:"number"},rowIndex:{type:"number"},rowKey:{type:"any"},x:{type:"number"},y:{type:"number"}}},scrollToKey:{type:"string",enumValues:["always","auto","capability","never"],value:"auto"},selection:{type:"Array<Object>",writeback:!0,value:[]},selectionMode:{type:"object",properties:{cell:{type:"string",enumValues:["multiple","none","single"],value:"none"},row:{type:"string",enumValues:["multiple","none","single"],value:"none"}}},translations:{type:"object",value:{},properties:{accessibleActionableMode:{type:"string"},accessibleCollapsed:{type:"string"},accessibleColumnContext:{type:"string"},accessibleColumnEndHeaderContext:{type:"string"},accessibleColumnEndHeaderLabelContext:{type:"string"},accessibleColumnHeaderContext:{type:"string"},accessibleColumnHeaderLabelContext:{type:"string"},accessibleColumnHierarchicalFull:{type:"string"},accessibleColumnHierarchicalPartial:{type:"string"},accessibleColumnHierarchicalUnknown:{type:"string"},accessibleColumnSelected:{type:"string"},accessibleColumnSpanContext:{type:"string"},accessibleContainsControls:{type:"string"},accessibleEndOfDataGrid:{type:"string"},accessibleExpanded:{type:"string"},accessibleFilterable:{type:"string"},accessibleFiltered:{type:"string"},accessibleFirstColumn:{type:"string"},accessibleFirstRow:{type:"string"},accessibleLastColumn:{type:"string"},accessibleLastRow:{type:"string"},accessibleLevelContext:{type:"string"},accessibleLevelHierarchicalContext:{type:"string"},accessibleMultiCellSelected:{type:"string"},accessibleNavigationMode:{type:"string"},accessibleRangeSelectModeOff:{type:"string"},accessibleRangeSelectModeOn:{type:"string"},accessibleRowCollapsed:{type:"string"},accessibleRowContext:{type:"string"},accessibleRowEndHeaderContext:{type:"string"},accessibleRowEndHeaderLabelContext:{type:"string"},accessibleRowExpanded:{type:"string"},accessibleRowHeaderContext:{type:"string"},accessibleRowHeaderLabelContext:{type:"string"},accessibleRowHierarchicalFull:{type:"string"},accessibleRowHierarchicalPartial:{type:"string"},accessibleRowHierarchicalUnknown:{type:"string"},accessibleRowSelected:{type:"string"},accessibleRowSpanContext:{type:"string"},accessibleSelectionAffordanceBottom:{type:"string"},accessibleSelectionAffordanceTop:{type:"string"},accessibleSortAscending:{type:"string"},accessibleSortDescending:{type:"string"},accessibleSortable:{type:"string"},accessibleStateSelected:{type:"string"},accessibleSummaryEstimate:{type:"string"},accessibleSummaryExact:{type:"string"},accessibleSummaryExpanded:{type:"string"},collapsedText:{type:"string"},columnWidth:{type:"string"},expandedText:{type:"string"},labelCopyCells:{type:"string"},labelCut:{type:"string"},labelCutCells:{type:"string"},labelDisableNonContiguous:{type:"string"},labelEnableNonContiguous:{type:"string"},labelFillCells:{type:"string"},labelFilter:{type:"string"},labelFilterCol:{type:"string"},labelFreezeCol:{type:"string"},labelFreezeRow:{type:"string"},labelHideColumn:{type:"string"},labelHideRow:{type:"string"},labelPaste:{type:"string"},labelPasteCells:{type:"string"},labelResize:{type:"string"},labelResizeColumn:{type:"string"},labelResizeDialogApply:{type:"string"},labelResizeDialogCancel:{type:"string"},labelResizeDialogSubmit:{type:"string"},labelResizeFitToContent:{type:"string"},labelResizeHeight:{type:"string"},labelResizeRow:{type:"string"},labelResizeWidth:{type:"string"},labelSelectMultiple:{type:"string"},labelSortAsc:{type:"string"},labelSortCol:{type:"string"},labelSortColAsc:{type:"string"},labelSortColDsc:{type:"string"},labelSortDsc:{type:"string"},labelSortRow:{type:"string"},labelSortRowAsc:{type:"string"},labelSortRowDsc:{type:"string"},labelUnfreezeCol:{type:"string"},labelUnfreezeRow:{type:"string"},labelUnhideColumn:{type:"string"},labelUnhideRow:{type:"string"},msgFetchingData:{type:"string"},msgNoData:{type:"string"},msgReadOnly:{type:"string"},resizeColumnDialog:{type:"string"},resizeRowDialog:{type:"string"},rowHeight:{type:"string"},tooltipRequired:{type:"string"}}}},methods:{getContextByNode:{},getProperty:{},refresh:{},setProperties:{},setProperty:{},getNodeBySubId:{},getSubIdByNode:{}},events:{ojBeforeCurrentCell:{},ojBeforeEdit:{},ojBeforeEditEnd:{},ojCellResize:{},ojCollapseRequest:{},ojCopyRequest:{},ojCutRequest:{},ojExpandRequest:{},ojFillRequest:{},ojFilterRequest:{},ojHeaderLabelCutRequest:{},ojPasteRequest:{},ojResize:{},ojScroll:{},ojSort:{},ojSortLabelRequest:{},ojSortRequest:{}},extension:{}}).extension._WIDGET_NAME="ojDataGrid",v.extension._BINDING={provide:new Map([[d.FormVariantContext,"legacyEmbedded"]])},h.CustomElementBridge.register("oj-data-grid",{metadata:h.CollectionUtils.mergeDeep(v,{properties:{userAssistanceDensity:{binding:{provide:[{name:"containerUserAssistanceDensity",default:"compact"},{name:"userAssistanceDensity",default:"compact"}]}}}})});const x=function(e,t,i,s){this.rtlMode=e,this.translationFunction=t,this.defaultOptions=i,this.widgetName=s,this.styles={},this.styles.datagrid="oj-datagrid",this.styles.cell="oj-datagrid-cell",this.styles.banded="oj-datagrid-banded",this.styles.row="oj-datagrid-row",this.styles.databody="oj-datagrid-databody",this.styles.topcorner="oj-datagrid-top-corner",this.styles.bottomcorner="oj-datagrid-bottom-corner",this.styles.rowheaderspacer="oj-datagrid-row-header-spacer",this.styles.colheaderspacer="oj-datagrid-column-header-spacer",this.styles.status="oj-datagrid-status",this.styles.loadingicon="oj-icon oj-datagrid-loading-icon",this.styles.emptytext="oj-datagrid-empty-text",this.styles.header="oj-datagrid-header",this.styles.endheader="oj-datagrid-end-header",this.styles.groupingcontainer="oj-datagrid-header-grouping",this.styles.headercell="oj-datagrid-header-cell",this.styles.rowheader="oj-datagrid-row-header",this.styles.colheader="oj-datagrid-column-header",this.styles.colheadercell="oj-datagrid-column-header-cell",this.styles.rowheadercell="oj-datagrid-row-header-cell",this.styles.endheadercell="oj-datagrid-end-header-cell",this.styles.rowendheader="oj-datagrid-row-end-header",this.styles.colendheader="oj-datagrid-column-end-header",this.styles.colendheadercell="oj-datagrid-column-end-header-cell",this.styles.rowendheadercell="oj-datagrid-row-end-header-cell",this.styles.headerlabel="oj-datagrid-header-label",this.styles.rowheaderlabel="oj-datagrid-row-header-label",this.styles.columnheaderlabel="oj-datagrid-column-header-label",this.styles.rowendheaderlabel="oj-datagrid-row-end-header-label",this.styles.columnendheaderlabel="oj-datagrid-column-end-header-label",this.styles.scroller="oj-datagrid-scroller",this.styles.scrollers="oj-datagrid-scrollers",this.styles.scrollbarForce="oj-scrollbar-force",this.styles.focus="oj-focus",this.styles.hover="oj-hover",this.styles.active="oj-active",this.styles.selected="oj-selected",this.styles.topSelected="oj-datagrid-selected-top",this.styles.bottomSelected="oj-datagrid-selected-bottom",this.styles.startSelected="oj-datagrid-selected-start",this.styles.endSelected="oj-datagrid-selected-end",this.styles.topEdit="oj-datagrid-cell-edit-top",this.styles.bottomEdit="oj-datagrid-cell-edit-bottom",this.styles.startEdit="oj-datagrid-cell-edit-start",this.styles.endEdit="oj-datagrid-cell-edit-end",this.styles.topEditInvalid="oj-datagrid-cell-edit-top-invalid",this.styles.bottomEditInvalid="oj-datagrid-cell-edit-bottom-invalid",this.styles.startEditInvalid="oj-datagrid-cell-edit-start-invalid",this.styles.endEditInvalid="oj-datagrid-cell-edit-end-invalid",this.styles.topFloodfill="oj-datagrid-floodfill-top",this.styles.bottomFloodfill="oj-datagrid-floodfill-bottom",this.styles.startFloodfill="oj-datagrid-floodfill-start",this.styles.endFloodfill="oj-datagrid-floodfill-end",this.styles.topResized="oj-datagrid-resized-top",this.styles.bottomResized="oj-datagrid-resized-bottom",this.styles.endResized="oj-datagrid-resized-end",this.styles.startResized="oj-datagrid-resized-start",this.styles.disabled="oj-disabled",this.styles.enabled="oj-enabled",this.styles.default="oj-default",this.styles.sortIcon="oj-datagrid-sort-icon",this.styles.sortascending="oj-datagrid-sort-ascending-icon",this.styles.sortdescending="oj-datagrid-sort-descending-icon",this.styles.sortdefault="oj-datagrid-sort-default-icon",this.styles.icon="oj-component-icon",this.styles.clickableicon="oj-clickable-icon-nocontext",this.styles.info="oj-helper-hidden-accessible",this.styles.rowexpander="oj-rowexpander",this.styles.cut="oj-datagrid-cut",this.styles.selectaffordance="oj-datagrid-touch-selection-affordance",this.styles.selectaffordancetopcornerbounded="oj-datagrid-touch-selection-affordance-top-corner-bounded",this.styles.selectaffordancebottomcornerbounded="oj-datagrid-touch-selection-affordance-bottom-corner-bounded",this.styles.selectaffordancetoprow="oj-datagrid-touch-selection-affordance-top-row",this.styles.selectaffordancebottomrow="oj-datagrid-touch-selection-affordance-bottom-row",this.styles.selectaffordancetopcolumn="oj-datagrid-touch-selection-affordance-top-column",this.styles.selectaffordancebottomcolumn="oj-datagrid-touch-selection-affordance-bottom-column",this.styles.floodfillaffordance="oj-datagrid-floodfill-affordance",this.styles.toucharea="oj-datagrid-touch-area",this.styles.readOnly="oj-read-only",this.styles.editable="oj-datagrid-editable",this.styles.cellEdit="oj-datagrid-cell-edit",this.styles.draggable="oj-draggable",this.styles.drag="oj-drag",this.styles.drop="oj-drop",this.styles.activedrop="oj-active-drop",this.styles.validdrop="oj-valid-drop",this.styles.invaliddrop="oj-invalid-drop",this.styles.formcontrol="oj-form-control-inherit",this.styles.borderHorizontalNone="oj-datagrid-border-horizontal-none",this.styles.borderVerticalNone="oj-datagrid-border-vertical-none",this.styles.borderHorizontalSmall="oj-datagrid-small-content-border-horizontal",this.styles.borderVerticalSmall="oj-datagrid-small-content-border-vertical",this.styles.offsetOutline="oj-datagrid-focus-offset",this.styles.depth="oj-datagrid-depth-",this.styles.popupHeader="oj-datagrid-popup-header",this.styles.popupContent="oj-datagrid-popup-content",this.styles.popupFooter="oj-datagrid-popup-footer",this.styles.dialogTitle="oj-dialog-title",this.styles.resizeDialog="oj-datagrid-resize-dialog",this.styles.headerAllSelected="oj-selected",this.styles.headerPartialSelected="oj-partial-selected",this.styles.disclosureContainer="oj-datagrid-disclosure-icon-container",this.styles.disclosureIcon="oj-datagrid-disclosure-icon",this.styles.expanded="oj-datagrid-expanded-icon",this.styles.collapsed="oj-datagrid-collapsed-icon",this.styles.spacer="oj-datagrid-tree-spacer",this.styles.hierarchicalTree="oj-datagrid-hierarchical-tree",this.styles.hierarchicalGroup="oj-datagrid-hierarchical-group",this.styles.iconContainer="oj-datagrid-icon-container",this.styles.requiredIcon="oj-datagrid-required-icon",this.styles.noDataContainer="oj-datagrid-no-data-container",this.styles.draggableItem="oj-datagrid-draggable",this.styles.dragSourceOpaque="drag-source-opaque",this.styles.rowDropTargetLine="oj-datagrid-row-drop-target-line",this.styles.colDropTargetLine="oj-datagrid-col-drop-target-line",this.styles.dragging="oj-datagrid-drag-active",this.styles.dropTarget="oj-datagrid-drop-target",this.styles.disabledElement="oj-datagrid-disabled-element",this.styles.databodyFrozenCol="oj-datagrid-databody-frozen-column",this.styles.databodyFrozenRow="oj-datagrid-databody-frozen-row",this.styles.databodyFrozenCorner="oj-datagrid-databody-frozen-corner",this.styles.colHeaderFrozen="oj-datagrid-column-header-frozen",this.styles.rowHeaderFrozen="oj-datagrid-row-header-frozen",this.styles.colEndHeaderFrozen="oj-datagrid-column-end-header-frozen",this.styles.rowEndHeaderFrozen="oj-datagrid-row-end-header-frozen",this.styles.rowFrozenIndicator="oj-datagrid-row-frozen-indicator",this.styles.colFrozenIndicator="oj-datagrid-col-frozen-indicator",this.styles.frozenHeader="oj-datagrid-header-frozen",this.styles.frozenCell="oj-datagrid-cell-frozen",this.styles.skeletonContainer="oj-datagrid-skeleton-container",this.styles.skeletonCell="oj-datagrid-skeleton-cell",this.styles.skeleton="oj-datagrid-skeleton",this.styles.skeletonAnimation="oj-animation-skeleton",this.styles.colHiddenIndicator="oj-datagrid-col-hidden-indicator",this.styles.rowHiddenIndicator="oj-datagrid-row-hidden-indicator",this.styles.colHeaderHiddenIndicator="oj-datagrid-col-header-hidden-indicator",this.styles.rowHeaderHiddenIndicator="oj-datagrid-row-header-hidden-indicator",this.styles.filterIcon="oj-datagrid-filter-icon",this.styles.filterable="oj-datagrid-filterable-icon",this.styles.filtered="oj-datagrid-filtered-icon",this.styles.headerCellContent="oj-datagrid-header-cell-content",this.styles.headerLabelCellContent="oj-datagrid-header-label-cell-content",this.styles.iconHidden="oj-datagrid-icon-hidden",this.styles.validationError="oj-datagrid-cell-validation-error",this.commands={},this.commands.sortCol="oj-datagrid-sortCol",this.commands.sortColAsc="oj-datagrid-sortColAsc",this.commands.sortColDsc="oj-datagrid-sortColDsc",this.commands.sortRow="oj-datagrid-sortRow",this.commands.sortRowAsc="oj-datagrid-sortRowAsc",this.commands.sortRowDsc="oj-datagrid-sortRowDsc",this.commands.resize="oj-datagrid-resize",this.commands.resizeWidth="oj-datagrid-resizeWidth",this.commands.resizeHeight="oj-datagrid-resizeHeight",this.commands.resizeFitToContent="oj-datagrid-resizeFitToContent",this.commands.cut="oj-datagrid-cut",this.commands.paste="oj-datagrid-paste",this.commands.cutCells="oj-datagrid-cutCells",this.commands.copyCells="oj-datagrid-copyCells",this.commands.pasteCells="oj-datagrid-pasteCells",this.commands.autoFill="oj-datagrid-fillCells",this.commands.discontiguousSelection="oj-datagrid-discontiguousSelection",this.commands.freezeCol="oj-datagrid-freezeCol",this.commands.freezeRow="oj-datagrid-freezeRow",this.commands.unfreezeCol="oj-datagrid-unfreezeCol",this.commands.unfreezeRow="oj-datagrid-unfreezeRow",this.commands.hideCol="oj-datagrid-hideCol",this.commands.unhideCol="oj-datagrid-unhideCol",this.commands.hideRow="oj-datagrid-hideRow",this.commands.unhideRow="oj-datagrid-unhideRow",this.commands.filterCol="oj-datagrid-filterCol",this.attributes={},this.attributes.busyContext=c._OJ_CONTEXT_ATTRIBUTE,this.attributes.context="data-oj-cellContext",this.attributes.resizable="data-oj-resizable",this.attributes.sortable="data-oj-sortable",this.attributes.sortDir="data-oj-sortdir",this.attributes.expander="data-oj-expander",this.attributes.expanderIndex="data-oj-expander-index",this.attributes.container=m._OJ_CONTAINER_ATTR,this.attributes.extent="data-oj-extent",this.attributes.start="data-oj-start",this.attributes.depth="data-oj-depth",this.attributes.level="data-oj-level",this.attributes.metadata="data-oj-metaData",this.attributes.hiddenIndicatorIndex="data-oj-hiddenIndicatorIndex",this.attributes.filterable="data-oj-filterable",this.attributes.readOnly="data-oj-readOnly",this.attributes.dropIndex="data-oj-dropIndex",this.attributes.dropLevel="data-oj-dropLevel",this.attributes.dropAxis="data-oj-dropAxis"};h._registerLegacyNamespaceProp("DataGridResources",x),x.prototype.setRTLMode=function(e){this.rtlMode=e},x.prototype.isRTLMode=function(){return"rtl"===this.rtlMode},x.prototype.getTranslatedText=function(e,t){return this.translationFunction(e,t)},x.prototype.getDefaultOption=function(e){return this.defaultOptions[e]},x.prototype.getMappedStyle=function(e){return null!=e?this.styles[e]:null},x.prototype.getMappedCommand=function(e){return null!=e?this.commands[e]:null},x.prototype.getMappedAttribute=function(e){return null!=e?this.attributes[e]:null};const H=function(e){this.dataprovider=e,this.pendingHeaderCallback={},e.options&&e.options.implicitSort&&(this.currentSortCriteria=e.options.implicitSort),this.sortUpdated=!1;var t=this.dataprovider.getCapability("fetchByOffset");this.fetchByOffset=null!=t&&"randomAccess"===t.implementation,this._registerEventListeners(),H.superclass.constructor.call(this)};function b(e,t,i,s){this.indexes=e,this.data=i,this.metadata=t,this.columns=s}function S(e,t,i){this.response=e,this.results=e.results,this.cellRanges=t,this.columns=i,this._setBounds(e,t,i)}function R(e,t,i,s){this.start=e,this.end=t,this.headers=i,this.sortCriteria=s}h.Object.createSubclass(H,h.DataGridDataSource,"DataProviderDataGridDataSource"),H.prototype._registerEventListeners=function(){this._mutationListener=this._handleDataProviderMutationEvent.bind(this),this._refreshListener=this._handleDataProviderRefreshEvent.bind(this),this.dataprovider.addEventListener("mutate",this._mutationListener),this.dataprovider.addEventListener("refresh",this._refreshListener)},H.prototype._handleDataProviderMutationEvent=function(e){var t,i=e.detail.add;if(null!=i){var s={indexes:[],keys:[]},o=[],n=[],r=[];for(t=0;t<i.data.length;t++)s.source=this,s.operation="insert",s.keys.push({row:i.metadata[t].key,column:null}),s.indexes.push({row:i.indexes[t],column:-1}),r.push(i.indexes[t]),o.push(i.data[t]),n.push(i.metadata[t]),t!==i.data.length-1&&i.indexes[t+1]===i.indexes[t]+1||(s.result=new b(r,n,o,this.columns),this.handleEvent("change",s),(s={}).indexes=[],s.keys=[],o=[],n=[],r=[])}var l=e.detail.remove;if(null!=l){var a={source:this,operation:"delete",keys:[],indexes:[]};for(t=0;t<l.data.length;t++)a.keys.push({row:l.metadata[t].key,column:null}),a.indexes.push({row:l.indexes[t],column:-1});this.handleEvent("change",a)}var h=e.detail.update;if(null!=h)for(t=0;t<h.data.length;t++){var d={source:this,operation:"update",keys:{row:h.metadata[t].key,column:null},indexes:{row:h.indexes[t],column:-1}};d.result=new b([h.indexes[t]],[h.metadata[t]],[h.data[t]],this.columns),this.handleEvent("change",d)}},b.prototype.getData=function(e){var t=this,i={};return Object.defineProperty(i,"data",{enumerable:!0,get:function(){return t.data[e.row-t.getStart("row")][t.columns[e.column]]},set:function(i){t.data[e.row-t.getStart("row")][t.columns[e.column]]=i}}),i},b.prototype.getMetadata=function(e){var t=this,i=t.metadata[e.row-t.getStart("row")];return i.keys={row:i.key,column:t.columns[e.column]},i},b.prototype.getStart=function(e){return"row"===e?this.indexes[0]:0},b.prototype.getCount=function(e){return"row"===e?this.data.length:"column"===e?this.columns.length:0},b.prototype.getExtent=function(){return{row:{extent:1,more:{before:!1,after:!1}},column:{extent:1,more:{before:!1,after:!1}}}},H.prototype._handleDataProviderRefreshEvent=function(){this._asyncIterator=null,this.handleEvent("change",{operation:"refresh"})},H.prototype.fetchHeaders=function(e,t,i){if(null!=t){var s=e.axis,o={headerRange:e,callbacks:t,callbackObjects:i};this.pendingHeaderCallback[s]=o}},H.prototype._processPendingHeaderCallbacks=function(e){var t=this.pendingHeaderCallback[e];if(null!=t){var i=t.headerRange,s=t.callbacks,o=t.callbackObjects;this._handleHeaderFetchSuccess(i,s,o),this.pendingHeaderCallback[e]=null}},H.prototype._handleHeaderFetchSuccess=function(e,t,i){var s,o=e.axis,n=e.start,r=e.count;"column"===o&&null!=this.columns?s=new R(n,Math.min(this.columns.length,n+r),this.columns,this.currentSortCriteria):s=null;null!=t&&t.success&&t.success.call(i.success,s,e,null)},S.prototype._setBounds=function(e,t,i){for(var s=0;s<t.length;s+=1){var o=t[s];"row"===o.axis?(this.rowStart=e.fetchParameters.offset?e.fetchParameters.offset:o.start,this.rowEnd=this.rowStart+e.results.length-1):"column"===o.axis&&(this.colStart=o.start,this.colEnd=Math.min(this.colStart+o.count-1,this.colStart+i.length-1))}},S.prototype.getData=function(e){var t=this,i={};return Object.defineProperty(i,"data",{enumerable:!0,get:function(){return t.results[e.row-t.rowStart].data[t.columns[e.column]]},set:function(i){t.results[e.row-t.rowStart].data[t.columns[e.column]]=i}}),i},S.prototype.getMetadata=function(e){var t=this.results[e.row-this.rowStart].metadata;return t.keys={row:this.results[e.row-this.rowStart].metadata.key,column:this.columns[e.column]},t},S.prototype.getCount=function(e){return"row"===e?this.rowEnd-this.rowStart+1:"column"===e?this.colEnd-this.colStart+1:0},S.prototype.getExtent=function(){return{row:{extent:1,more:{before:!1,after:!1}},column:{extent:1,more:{before:!1,after:!1}}}},H.prototype.setUpColumns=function(e){if(null==this.columns||0===this.columns.length){var t=[];if(e.results.length)for(var i=Object.keys(e.results[0].data),s=0;s<i.length;s++)t.push(i[s]);this.columns=t}},H.prototype.getRangeInfo=function(e){for(var t={},i=0;i<e.length;i+=1){var s=e[i];"row"===s.axis?(t.rowStart=s.start,t.rowEnd=t.rowStart+s.count-1):"column"===s.axis&&(t.colStart=s.start,t.colEnd=t.colStart+s.count-1)}return t},H.prototype._createResults=function(e){e.results=[];for(var t=0;t<e.value.data.length;t++){var i={data:e.value.data[t],metadata:e.value.metadata[t]};e.results.push(i)}},H.prototype.handleFetchResult=function(e,t,i,s){var o=s[0];o.results||(this._createResults(o),o.fetchParameters=o.value.fetchParameters),this.setUpColumns(o),this._processPendingHeaderCallbacks("column"),this._processPendingHeaderCallbacks("row");var n=new S(o,e,this.columns);if(null!=t&&null!=t.success){var r=i?i.success:null;t.success.call(r,n,e)}},H.prototype.fetchCells=function(e,t,i){var s=this;this.getCount("row");var o=s.getRangeInfo(e),n=o.rowEnd-o.rowStart+1;if(s.fetchByOffset){var r=o.rowStart;s._fetchPromise=s.dataprovider.fetchByOffset({size:n,offset:r,sortCriteria:s.currentSortCriteria})}else(null==s._asyncIterator||this.sortUpdated)&&(s._clientId=s._clientId||Symbol(),s._asyncIterator=s.dataprovider.fetchFirst({clientId:s._clientId,size:n,sortCriteria:s.currentSortCriteria})[Symbol.asyncIterator]()),s._fetchPromise=s._asyncIterator.next();this.sortUpdated=!1,Promise.all([s._fetchPromise,s._getCountPromise]).then(s.handleFetchResult.bind(s,e,t,i))},H.prototype.getCapability=function(e){if("sort"===e){var t=this.dataprovider.getCapability(e).attributes;return"multiple"===t||"single"===t?"column":t}return"none"},H.prototype.getCount=function(e){var t=this;if("row"===e){if(void 0!==t.totalRowCount)return t.totalRowCount;t._getCountPromise=this.dataprovider.getTotalSize(),t._getCountPromise.then(function(e){t.totalRowCount=e})}else if("column"===e&&null!=this.columns)return this.columns.length;return-1},H.prototype.getCountPrecision=function(){return"estimate"},H.prototype.indexes=function(){return{row:-1,column:-1}},H.prototype.keys=function(){return{row:null,column:null}},H.prototype.move=function(){return!1},H.prototype.moveOK=function(){return"invalid"},H.prototype.sort=function(e,t,i){this.sortUpdated=!0,this.currentSortCriteria=[{attribute:e.key,direction:e.direction}],null==i&&(i={}),null!=t&&null!=t.success&&t.success.call(i.success)},R.prototype.getData=function(e){return this.headers[e]},R.prototype.getMetadata=function(e){var t=this.getData(e),i={key:t};if(null!=this.sortCriteria)for(var s=0;s<this.sortCriteria.length;s++)this.sortCriteria[s].attribute===t&&(i.sortDirection=this.sortCriteria[s].direction);return i},R.prototype.getLevelCount=function(){return 1},R.prototype.getExtent=function(){return{extent:1,more:{before:!1,after:!1}}},R.prototype.getLabel=function(){return null},R.prototype.getDepth=function(){return 1},R.prototype.getCount=function(){return Math.max(0,this.end-this.start)};const I=function(e){this.grid=e};I.prototype.getAction=function(e,t){var i=e.keyCode,s=this.grid.m_utils.ctrlEquivalent(e),o=e.shiftKey,n=e.altKey,r=this.grid.keyCodes,l=t.cellOrHeader,a=t.readOnly,h=t.currentMode,d=t.activeMove,m=t.activeDrag,c=t.rowMove,u=t.columnSort;let _=t.rowSort;var g=t.selection,p=t.selectionMode,f=t.multipleSelection,C=t.expandCollapse,y=t.copyCells,w=t.cutCells,E=t.pasteCells,v=t.fill;switch(i){case r.TAB_KEY:if("actionable"===h)return o?"TAB_PREV_IN_CELL":"TAB_NEXT_IN_CELL";if("edit"===h)return o?"TAB_PREV_IN_CELL_OR_FOCUS_LEFT":"TAB_NEXT_IN_CELL_OR_FOCUS_RIGHT";if(!a)return o?"FOCUS_LEFT":"FOCUS_RIGHT";break;case r.ENTER_KEY:if("actionable"===h)return"NO_OP";if("column"===l&&u||"row"===l&&_)return"SORT";if(!n&&a&&"navigation"===h||"cell"!==l)return"ACTIONABLE";if(!a&&!n)return o?"FOCUS_UP":"FOCUS_DOWN";if(n&&a&&"navigation"===h)return"EDITABLE";if(!a&&("navigation"===h||"edit"===h))return"EDIT";break;case r.ESC_KEY:if("actionable"===h)return"EXIT_ACTIONABLE";if(d)return"CANCEL_REORDER";if(m)return"CANCEL_DRAG";if(a){if(this.grid.m_discontiguousSelection)return"SELECT_DISCONTIGUOUS"}else{if("navigation"===h)return"EXIT_EDITABLE";if("edit"===h)return"CANCEL_EDIT"}break;case r.SPACE_KEY:if(-1!==l.indexOf("row")&&g&&("cell"===p&&f||"row"===p)&&"navigation"===h)return"SELECT_ROW";if(-1!==l.indexOf("column")&&g&&"cell"===p&&f&&"navigation"===h)return"SELECT_COLUMN";if("cell"===l)if(a&&"navigation"===h){if(s&&g&&"cell"===p&&f)return"SELECT_COLUMN";if(o&&g&&("cell"===p&&f||"row"===p))return"SELECT_ROW"}else if("navigation"===h)return"DATA_ENTRY";break;case r.PAGEUP_KEY:if("navigation"===h)return"FOCUS_ROW_FIRST";break;case r.PAGEDOWN_KEY:if("navigation"===h)return"FOCUS_ROW_LAST";break;case r.END_KEY:if("navigation"===h)return s&&"cell"===l?"FOCUS_LAST_CELL_IN_GRID":"FOCUS_COLUMN_LAST";break;case r.HOME_KEY:if("navigation"===h)return s&&"cell"===l?"FOCUS_FIRST_CELL_IN_GRID":"FOCUS_COLUMN_FIRST";break;case r.LEFT_KEY:if(s&&C&&this.grid._isHeaderExpanded(e.target))return"COLLAPSE";if("actionable"===h)return"NO_OP";if("navigation"===h)return o&&g&&"cell"===p&&f?"SELECT_EXTEND_LEFT":s?"FOCUS_LEFT_NON_EMPTY_CELL":"FOCUS_LEFT";break;case r.UP_KEY:if("actionable"===h)return"NO_OP";if("navigation"===h)return o&&g&&f?"SELECT_EXTEND_UP":s?"FOCUS_UP_NON_EMPTY_CELL":"FOCUS_UP";break;case r.RIGHT_KEY:if(s&&C&&this.grid._isHeaderCollapsed(e.target))return"EXPAND";if("actionable"===h)return"NO_OP";if("navigation"===h)return o&&g&&"cell"===p&&f?"SELECT_EXTEND_RIGHT":s?"FOCUS_RIGHT_NON_EMPTY_CELL":"FOCUS_RIGHT";break;case r.DOWN_KEY:if("actionable"===h)return"NO_OP";if("navigation"===h)return o&&g&&f?"SELECT_EXTEND_DOWN":s?"FOCUS_DOWN_NON_EMPTY_CELL":"FOCUS_DOWN";break;case r.F2_KEY:if("actionable"===h)return"EXIT_ACTIONABLE";if("cell"!==l)return"ACTIONABLE";if(a&&"navigation"===h)return"EDITABLE";if(!a&&"navigation"===h)return"EDIT";if(!a&&"edit"===h)return"CANCEL_EDIT";break;case r.F8_KEY:if(o&&g&&f)return"SELECT_DISCONTIGUOUS";break;case r.F10_KEY:if(o)return"NO_OP";break;case r.V_KEY:if("navigation"===h&&s){if(c)return"PASTE";if(E)return"PASTE_CELLS"}if(!a&&"navigation"===h&&"cell"===l)return"DATA_ENTRY";break;case r.X_KEY:if("navigation"===h&&s){if(c)return"CUT";if(w)return"CUT_CELLS"}if(!a&&"navigation"===h&&"cell"===l)return"DATA_ENTRY";break;case r.C_KEY:if("navigation"===h&&s&&y)return"COPY_CELLS";if(!a&&"navigation"===h&&"cell"===l)return"DATA_ENTRY";break;case r.D_KEY:if("navigation"===h&&s&&v)return"FILL";if(!a&&"navigation"===h&&"cell"===l&&!s)return"DATA_ENTRY";break;case r.R_KEY:if("navigation"===h&&s&&n&&t.filterCol)return"FILTER_COLUMN";if("navigation"===h&&s&&v)return"FILL";if(!a&&"navigation"===h&&"cell"===l&&!s)return"DATA_ENTRY";break;case r.SHIFT_KEY:case r.CTRL_KEY:case r.ALT_KEY:break;case r.A_KEY:if(s&&g&&f&&"navigation"===h)return"SELECT_ALL";case r.NUM5_KEY:if(s&&n&&"navigation"===h)return"READ_CELL";default:if((i<r.F1_KEY||i>r.F15_KEY)&&!a&&"navigation"===h&&"cell"===l&&!s)return"DATA_ENTRY"}return"NO_OP"},I.prototype.getNoDataAction=function(e,t){var i=e.keyCode,s=e.shiftKey,o=this.grid.keyCodes,n=t.currentMode;switch(i){case o.TAB_KEY:if("actionable"===n)return s?"TAB_PREV_IN_CELL":"TAB_NEXT_IN_CELL";break;case o.ESC_KEY:if("actionable"===n)return"EXIT_ACTIONABLE";break;case o.F2_KEY:return"actionable"===n?"EXIT_ACTIONABLE":"ACTIONABLE";case o.UP_KEY:if("navigation"===n)return"FOCUS_COLUMN_HEADER";break;case o.DOWN_KEY:if("navigation"===n)return"FOCUS_COLUMN_END_HEADER";break;case o.LEFT_KEY:if("navigation"===n)return"FOCUS_ROW_HEADER";break;case o.RIGHT_KEY:if("navigation"===n)return"FOCUS_ROW_END_HEADER"}return"NO_OP"};const z=function(e,t){this.options=e,this.rendererWrapperFunction=t};z.prototype.extract=function(e,t,i,s,o){if(null!=e){var n=this.options[e];if(null!=t&&null!=n){var r=n[t];if(null!=i&&null!=r){var l=r[i];if(null!=s&&null!=l){var a=l[s];return null!=o&&null!=a?a[o]:a}return l}return r}return n}return null},z.prototype.evaluate=function(e,t){return"function"==typeof e?e.call(this,t):e},z.prototype.getRawProperty=function(e,t,i){var s,o,n,r;return"row"===t||"column"===t||"rowEnd"===t||"columnEnd"===t?(s="header",o=t,i?(n="label",r=e):n=e):"cell"===t&&(s="cell",o=e),this.extract(s,o,n,r)},z.prototype.getProperty=function(e,t,i,s){return void 0===i?this.extract(e,t,s):this.evaluate(this.getRawProperty(e,t,s),i)},z.prototype.getRowBandingInterval=function(){var e=this.getProperty("bandingInterval","row");return null!=e?e:0},z.prototype.getColumnBandingInterval=function(){var e=this.getProperty("bandingInterval","column");return null!=e?e:0},z.prototype.getEmptyText=function(){return this.getProperty("emptyText")},z.prototype.getHorizontalGridlines=function(){var e=this.extract("gridlines","horizontal");return null!=e?e:"visible"},z.prototype.getVerticalGridlines=function(){var e=this.extract("gridlines","vertical");return null!=e?e:"visible"},z.prototype.getScrollToKey=function(){var e=this.getProperty("scrollToKey");return null!=e?e:"auto"},z.prototype.getScrollPosition=function(){var e=this.getProperty("scrollPosition");return null!=e?e:null},z.prototype.getSelectionCardinality=function(){var e=this.getProperty("selectionMode");if(null==e)return"none";var t=e[this.getSelectionMode()];return null!=t?t:"none"},z.prototype.getSelectionMode=function(){var e=this.getProperty("selectionMode");if(null==e)return"cell";var t=e.row;return null!=t&&"none"!==t?"row":"cell"},z.prototype.getSelection=function(){return this.getProperty("selection")},z.prototype.getCurrentCell=function(){return this.getProperty("currentCell")},z.prototype.getEditMode=function(){return this.getProperty("editMode")},z.prototype.getEditCell=function(){return this.getProperty("editCell")},z.prototype.isSortable=function(e,t,i){return this.getProperty("sortable",e,t,i)},z.prototype.isResizable=function(e,t,i){var s=this.extract("header",e,"resizable",t);return null!=i?this.evaluate(s,i):s},z.prototype.isMoveable=function(e){return this.extract("dnd","reorder",e)},z.prototype._isDragEnabled=function(e){let t=!1,i="row"===e||"rowEnd"===e?"rows":"columns",s=this.getProperty("dnd").drag;return s&&s[i]&&(t=!0),t},z.prototype._isDragEnabledOnLabel=function(e){let t=!1,i="row"===e||"rowEnd"===e?"rowLabels":"columnLabels",s=this.getProperty("dnd").drag;return s&&s[i]&&(t=!0),t},z.prototype.isFloodFillEnabled=function(){let e=!1;return"enable"===this.extract("dataTransferOptions","fill")&&(e=!0),e},z.prototype.isCopyEnabled=function(){let e=!1;return"enable"===this.extract("dataTransferOptions","copy")&&(e=!0),e},z.prototype.isCutEnabled=function(){let e=!1;return"enable"===this.extract("dataTransferOptions","cut")&&(e=!0),e},z.prototype._isLabelCutEnabled=function(){let e=!1;return"enable"===this.extract("dataTransferOptions","headerLabelCut")&&(e=!0),e},z.prototype.isPasteEnabled=function(){let e=!1;return"enable"===this.extract("dataTransferOptions","paste")&&(e=!0),e},z.prototype.isFreezeEnabled=function(e){let t=!1;return"enable"===this.extract("header",e,"freezable")&&(t=!0),t},z.prototype._getFreezeIndex=function(e){let t=null;return t="row"===e?this.getProperty("frozenRowCount"):this.getProperty("frozenColumnCount"),null!==t&&(t=parseInt(t,10)-1),t},z.prototype.isHideEnabled=function(e){let t=!1;return"enable"===this.extract("header",e,"hidable")&&(t=!0),t},z.prototype._getHiddenIndices=function(e){let t;return"column"===e?t=this.getProperty("hiddenColumns"):"row"===e&&(t=this.getProperty("hiddenRows")),t},z.prototype.getInlineStyle=function(e,t,i){return this.getProperty("style",e,t,i)},z.prototype.getStyleClass=function(e,t,i){return this.getProperty("className",e,t,i)},z.prototype.isEditable=function(e,t,i){return this.getProperty("editable",e,t,i)},z.prototype.getRenderer=function(e,t){return this.rendererWrapperFunction?this.rendererWrapperFunction(this.getRawProperty("renderer",e,t)):this.getRawProperty("renderer",e,t)},z.prototype.getScrollPolicy=function(){var e=this.getProperty("scrollPolicy");return null==e&&(e="auto"),e},z.prototype.getScrollPolicyOptions=function(){return this.getProperty("scrollPolicyOptions")},z.prototype.isFilterEnabled=function(e,t){return this.getProperty("filterable",e,t)},z.prototype.getAlignment=function(e,t,i,s){let o;return o="cell"===t?this.extract("cell","alignment",e):s?this.extract("header",t,"label","alignment",e):this.extract("header",t,"alignment",e),null==o&&(o="auto"),null!=i?this.evaluate(o,i):o},z.prototype.getHorizontalAlignment=function(e,t,i){return this.getAlignment("horizontal",e,t,i)},z.prototype.getVerticalAlignment=function(e,t,i){return this.getAlignment("vertical",e,t,i)},z.prototype.getDescription=function(e,t){return t?this.extract("header",e,"label","description"):this.extract("header",e,"description")};const F=function(){this.sizes={column:new Map,row:new Map}};F.prototype.setSize=function(e,t,i){this.sizes[e].set(t,i)},F.prototype.getSize=function(e,t){var i=this.sizes[e].get(t);return null!=i||this.sizes[e].forEach(function(e,s){null==i&&h.Object.compareValues(s,t)&&(i=e)}),i},F.prototype.clear=function(){this.sizes.column.clear(),this.sizes.row.clear()};const M=function(e){this.scrollbarSize=-1,this.dataGrid=e};M.prototype._getMaxDivHeightForScrolling=function(){return null==this.m_maxDivHeightForScrolling&&this._setMaxValuesForScrolling(),this.m_maxDivHeightForScrolling},M.prototype._getMaxDivWidthForScrolling=function(){return null==this.m_maxDivWidthForScrolling&&this._setMaxValuesForScrolling(),this.m_maxDivWidthForScrolling},M.prototype._setMaxValuesForScrolling=function(){this._calculateBrowserDefinedValues()},M.prototype._calculateBrowserDefinedValues=function(){var e=document.createElement("div");e.style.width="1000000000px",e.style.height="1000000000px",e.style.display="none";var t=document.createElement("div");t.style.width="100px",t.style.height="100px",t.style.overflow="scroll",t.style.position="absolute",t.style.top="-9999px",document.body.appendChild(t);let i=!1;u.isIE()||u.isEdge()?(this.m_maxDivHeightForScrolling=1e6,this.m_maxDivWidthForScrolling=1e6):(i=!0,document.body.appendChild(e),this.m_maxDivHeightForScrolling=parseInt(parseFloat(window.getComputedStyle(e).height)/2,10),this.m_maxDivWidthForScrolling=parseInt(parseFloat(window.getComputedStyle(e).width)/2,10)),this.scrollbarSize=t.offsetWidth-t.clientWidth,i&&document.body.removeChild(e),document.body.removeChild(t)},M.prototype.getScrollbarSize=function(){return-1===this.scrollbarSize&&this._calculateBrowserDefinedValues(),this.scrollbarSize},M.prototype.isTouchDevice=function(){return null==this.isTouch&&(this.isTouch=u.isMobileTouchDevice()),this.isTouch},M.prototype.isTouchDeviceNotIOS=function(){if(null==this.isTouchNotIOS){let e=this.isTouchDevice();this.isTouchNotIOS=!!e&&!u.isIos()}return this.isTouchNotIOS},M.prototype.addCSSClassName=function(e,t){null!=t&&""!==t&&null!=e&&null!=e.classList&&e.classList.add(t)},M.prototype.removeCSSClassName=function(e,t){null!=t&&""!==t&&null!=e&&null!=e.classList&&e.classList.remove(t)},M.prototype.containsCSSClassName=function(e,t){var i=!1;return null!=t&&null!=e&&null!=e.classList&&(i=e.classList.contains(t)),i},M.prototype.ctrlEquivalent=function(e){return u.isMac()?e.metaKey:e.ctrlKey},M.prototype.getElementScrollLeft=function(e){return Math.abs(e.scrollLeft)},M.prototype.setElementScrollLeft=function(e,t){_.setScrollLeft(e,t)},M.prototype.getMousewheelEvent=function(){return"wheel"},M.prototype.getMousewheelScrollDelta=function(e){var t=-1,i=e.deltaMode;return i===e.DOM_DELTA_PIXEL?t=-1:i!==e.DOM_DELTA_LINE&&i!==e.DOM_DELTA_PAGE||(t=-40),{deltaX:e.deltaX*t,deltaY:e.deltaY*t}},M.prototype.empty=function(e){for(;e.firstChild;)this.dataGrid._remove(e.firstChild)},M.prototype._isNodeEditableOrClickable=function(e,t){for(;null!=e&&e!==t;){var i=e.nodeName;if(3===e.nodeType)e=e.parentNode;else{var s=parseInt(e.getAttribute("tabIndex"),10),o=parseInt(e.getAttribute(this.dataGrid.getResources().getMappedAttribute("tabindex")),10);if(null!=s&&s>=0)return!(this.containsCSSClassName(e,this.dataGrid.getResources().getMappedStyle("cell"))||this.containsCSSClassName(e,this.dataGrid.getResources().getMappedStyle("headerlabel"))||this.containsCSSClassName(e,this.dataGrid.getResources().getMappedStyle("headercell"))||this.containsCSSClassName(e,this.dataGrid.getResources().getMappedStyle("endheadercell")));if(i.match(/^INPUT|SELECT|OPTION|BUTTON|^A\b|TEXTAREA/)&&(-1!==s||-1!==o))return!0;e=e.parentNode}}return!1},M.prototype.shouldOffsetOutline=function(){return!(!u.isMac()||!u.isWebkit())};const A=function(e){this.m_root=e,this.MAX_COLUMN_THRESHOLD=20,this.MAX_ROW_THRESHOLD=30,this.m_utils=new M(this),this.m_discontiguousSelection=!1,this.m_sizingManager=new F,this.m_keyboardHandler=new I(this),this.m_rowHeaderWidth=null,this.m_rowEndHeaderWidth=null,this.m_colHeaderHeight=null,this.m_colEndHeaderHeight=null,this.m_styleClassDimensionMap={width:{},height:{}},this.m_isEstimateRowCount=void 0,this.m_isEstimateColumnCount=void 0,this.m_stopRowFetch=!1,this.m_stopRowHeaderFetch=!1,this.m_stopRowEndHeaderFetch=!1,this.m_stopColumnFetch=!1,this.m_stopColumnHeaderFetch=!1,this.m_stopColumnEndHeaderFetch=!1,this.m_fetchingForUpdate=!1,this.m_initialized=!1,this.m_shouldFocus=null,this.m_renderCount=0,this.callbacks={},this._setupActions(),this.m_readinessStack=[],this.m_modelEvents=[],this.m_databodyMap=new Map};A.prototype.keyCodes={TAB_KEY:9,ENTER_KEY:13,SHIFT_KEY:16,CTRL_KEY:17,ALT_KEY:18,ESC_KEY:27,SPACE_KEY:32,PAGEUP_KEY:33,PAGEDOWN_KEY:34,END_KEY:35,HOME_KEY:36,LEFT_KEY:37,UP_KEY:38,RIGHT_KEY:39,DOWN_KEY:40,NUM5_KEY:53,V_KEY:86,X_KEY:88,C_KEY:67,D_KEY:68,R_KEY:82,F1_KEY:112,F2_KEY:113,F8_KEY:119,F10_KEY:121,F15_KEY:126,A_KEY:65},A.UPDATE_ANIMATION_FADE_INOUT=1,A.UPDATE_ANIMATION_SLIDE_INOUT=2,A.UPDATE_ANIMATION_DURATION=250,A.EXPAND_ANIMATION_DURATION=500,A.COLLAPSE_ANIMATION_DURATION=400,A.MAX_OVERSCROLL_PIXEL=50,A.BOUNCE_ANIMATION_DURATION=500,A.DECELERATION_FACTOR=6e-4,A.TAP_AND_SCROLL_RESET=300,A.MIN_SWIPE_DURATION=200,A.MAX_SWIPE_DURATION=400,A.MIN_SWIPE_DISTANCE=10,A.MIN_SWIPE_TRANSITION_DURATION=100,A.MAX_SWIPE_TRANSITION_DURATION=500,A.CONTEXT_MENU_TAP_HOLD_DURATION=750,A.HEADER_TAP_SHORT_HOLD_DURATION=300,A.FETCH_PIXEL_THRESHOLD=5,A.VISIBILITY_STATE_HIDDEN="hidden",A.VISIBILITY_STATE_REFRESH="refresh",A.VISIBILITY_STATE_RENDER="render",A.VISIBILITY_STATE_VISIBLE="visible",A.SPACER_DEFAULT_WIDTH=2,A.SKELETON_DEFAULT_COUNT=3,A.prototype.SetOptions=function(e,t){this.m_options=new z(e,t)},A.prototype.SetSortOriginalEvent=function(e){this.m_sortColumnInfo&&(this.m_sortColumnInfo.originalEvent=e)},A.prototype.UpdateOptions=function(e,t){var i,s,o=Object.keys(e);for(s=0;s<o.length;s++)(i=o[s])in this.m_options.options&&this.m_options.options[i]!==e[i]&&(this.m_options.options[i]=e[i]);for(s=0;s<o.length;s++)if(i=o[s],!this._updateDataGrid(i,t)){this.empty(),this.refresh(this.m_root);break}},A.prototype._updateDataGrid=function(e,t){var i;switch(e){case"bandingInterval":this._removeBanding(),this.updateColumnBanding(),this.updateRowBanding();break;case"currentCell":i=this.m_options.getCurrentCell(),this._updateActive(i,!0,!1);break;case"editMode":this.m_editMode=this.m_options.getEditMode();break;case"gridlines":this._updateGridlines();break;case"header":i=this.m_options.options.header,this._updateHeaderOptions(i,t);break;case"scrollPosition":i=this.m_options.getScrollPosition(),this._updateScrollPosition(i);break;case"selection":i=this.m_options.getSelection(),this._updateSelection(i);break;case"selectionMode":this._clearSelection(null);break;case"frozenColumnCount":i=this.m_options._getFreezeIndex("column"),this._updateFrozenSection(i,"column");break;case"frozenRowCount":i=this.m_options._getFreezeIndex("row"),this._updateFrozenSection(i,"row");break;case"hiddenColumns":i=this.m_options._getHiddenIndices("column"),this._updateHiddenSection(Array.from(i),"column");break;case"hiddenRows":i=this.m_options._getHiddenIndices("row"),this._updateHiddenSection(Array.from(i),"row");break;case"editCell":i=this.m_options.getEditCell(),this._setEditCell(i);break;default:return!1}return!0},A.prototype._updateSelection=function(e){null!=e&&this._isSelectionEnabled()&&this.SetSelection(e)},A.prototype._setEditCell=function(e){let t;if(this._isGridEditable()){let i=e?.indexes?this._getCellByIndex(e?.indexes):null;if("edit"===this._getCurrentMode()){let s=this._getActiveElement();if(i===s)return;let o=!1;if(this._handleExitEdit(t,s)?null===e&&(this.m_editCell=null,o=!0):(this.m_editCell={indexes:s[this.getResources().getMappedAttribute("context")].indexes},o=!0),o){let e={event:t,ui:{editCell:this.m_editCell}};return void this.fireEvent("editCell",e)}}let s={type:"cell",indexes:e?.indexes};this._updateActive(s,!0,!1),this._handleEditable(t,i),this._handleEdit(t,i)}},A.prototype._updateHeaderOptions=function(e,t){if(null!=t&&null!=t.subkey){var i,s=t.subkey.split("."),o=s[0],n=s[1];if("column"===o&&null!=this.m_colHeader&&null!=this.m_colHeader.firstChild?i=this.m_colHeader.firstChild.childNodes:"row"===o&&null!=this.m_rowHeader&&null!=this.m_rowHeader.firstChild?i=this.m_rowHeader.firstChild.childNodes:"columnEnd"===o&&null!=this.m_colEndHeader&&null!=this.m_colEndHeader.firstChild?i=this.m_colEndHeader.firstChild.childNodes:"rowEnd"===o&&null!=this.m_rowEndHeader&&null!=this.m_rowEndHeader.firstChild&&(i=this.m_rowEndHeader.firstChild.childNodes),null!=i)for(var r=0;r<i.length;r++){var l=i[r],a=l[this.getResources().getMappedAttribute("context")];if(a.index=this.getHeaderCellIndex(l),"resizable"===n)this._isHeaderResizeEnabled(o,a)?this._setAttribute(l,n,"true"):this._setAttribute(l,n,"false");else if("sortable"===n){const e=this.m_options.getHorizontalAlignment(o,a);var h=null!=this._getSortContainer(l);if(this._isSortEnabled(o,a)){if(!h){var d=this._buildSortIcon(a,l);this._shouldAppendIcon(e,o,a)?l.appendChild(d):l.insertBefore(d,l.childNodes[0])}this._setAttribute(l,n,"true")}else h&&this._remove(this._getSortContainer(l)),this._setAttribute(l,n,"false")}}}},A.prototype._updateGridlines=function(){var e=this.m_options.getHorizontalGridlines(),t=this.m_options.getVerticalGridlines(),i=this.getResources().isRTLMode()?"right":"left";if(this.m_databody&&this.m_databody.firstChild){let s=this.m_databody.firstChild.querySelectorAll("."+this.getMappedStyle("cell")),o=this._getLastAxis("row"),n=this._getLastAxis("column");for(let r=0;r<s.length;r++){let l=s[r],a=this.getCellIndexes(l);"hidden"===t||a.column===n&&(this.getRowHeaderWidth()+this.getElementDir(l,i)+this.getElementWidth(l)>=this.getWidth()||this.m_endRowEndHeader>-1)?this.m_utils.addCSSClassName(l,this.getMappedStyle("borderVerticalNone")):this.m_utils.removeCSSClassName(l,this.getMappedStyle("borderVerticalNone")),"hidden"===e||a.row===o&&(this.getRowBottom(l,null)>=this.getHeight()||this.m_endColEndHeader>-1)?this.m_utils.addCSSClassName(l,this.getMappedStyle("borderHorizontalNone")):this.m_utils.removeCSSClassName(l,this.getMappedStyle("borderHorizontalNone"))}}},A.prototype._updateEdgeCellBorders=function(e){if(null!=this.m_active&&"cell"===this.m_active.type){var t=this._getActiveElement();if(null!=t){if(this._isCellEditable()&&""===e||""!==e){let i="Edit",s=this.getResources().getMappedAttribute("metadata");"invalidShown"===t[s]?.metadata?.validity&&"navigation"!==this.m_currentMode&&(i="EditInvalid"),this._applyBorderClassesAroundRange(t,{startIndex:this.m_active.indexes},""===e,i)}this._isLastRow(this.m_active.indexes.row)&&("none"===e?this.m_utils.addCSSClassName(t,this.getMappedStyle("borderHorizontalNone")):this.m_utils.removeCSSClassName(t,this.getMappedStyle("borderHorizontalNone"))),this._isLastColumn(this.m_active.indexes.column)&&("none"===e?this.m_utils.addCSSClassName(t,this.getMappedStyle("borderVerticalNone")):this.m_utils.removeCSSClassName(t,this.getMappedStyle("borderVerticalNone")))}}},A.prototype.SetResources=function(e){this.m_resources=e},A.prototype.getResources=function(){return this.m_resources},A.prototype.getStartRowHeader=function(){return this.m_startRowHeader},A.prototype.getStartColumnHeader=function(){return this.m_startColHeader},A.prototype.getStartRowEndHeader=function(){return this.m_startRowEndHeader},A.prototype.getStartColumnEndHeader=function(){return this.m_startColEndHeader},A.prototype.getMappedStyle=function(e){return this.getResources().getMappedStyle(e)},A.prototype.SetDataSource=function(e){this.m_modelEvents=[],this.m_dataSource=e},A.prototype.getDataSource=function(){return this.m_dataSource},A.prototype.setVisibility=function(e){this.m_visibility=e},A.prototype.getVisibility=function(){return null==this.m_visibility&&(null!=this.m_root.offsetParent?this.setVisibility(A.VISIBILITY_STATE_VISIBLE):this.setVisibility(A.VISIBILITY_STATE_HIDDEN)),this.m_visibility},A.prototype.SetOptionCallback=function(e){this.m_setOptionCallback=e},A.prototype.SetContextCallback=function(e){this.m_contextCallback=e},A.prototype.SetCustomElementCallback=function(e){this.m_isCustomElementCallback=e},A.prototype.SetRemoveCallback=function(e){this.m_removeCallback=e},A.prototype.SetUniqueIdCallback=function(e){this._uniqueIdCallback=e},A.prototype.SetCompareValuesCallback=function(e){this._compareValuesCallback=e},A.prototype.SetSubtreeAttachedCallback=function(e){this.m_subtreeAttachedCallback=e},A.prototype.SetUpdateScrollPostionOnRefreshCallback=function(e){this.m_updateScrollPostionOnRefreshCallback=e},A.prototype._remove=function(e){null!=e&&(this._uniqueIdCallback(e,!0),this.m_removeCallback.call(null,e))},A.prototype._removeFromArray=function(e){for(var t=0;t<e.length;t++)this._remove(e[t])},A.prototype.SetNotReadyCallback=function(e){this.m_notReady=e},A.prototype.SetMakeReadyCallback=function(e){this.m_makeReady=e},A.prototype._signalTaskStart=function(){this.m_readinessStack&&(0===this.m_readinessStack.length&&this.m_notReady(),this.m_readinessStack.push(1))},A.prototype._signalTaskEnd=function(){this.m_readinessStack&&this.m_readinessStack.length>0&&(this.m_readinessStack.pop(),0===this.m_readinessStack.length&&this.m_makeReady())},A.prototype._indexes=function(e,t){var i=this,s=this.getDataSource().indexes(e);"function"==typeof s.then?(i._signalTaskStart(),s.then(function(s){t.call(i,s,e),i._signalTaskEnd()},function(){t.call(i,{row:-1,column:-1},e),i._signalTaskEnd()})):t.call(i,s,e)},A.prototype._keys=function(e,t){var i=this,s=this._getLocalKeys(e);if(void 0===s){var o=this.getDataSource().keys(e);"function"==typeof o.then?(i._signalTaskStart(),o.then(function(s){t.call(i,s,e),i._signalTaskEnd()},function(){t.call(i,{row:null,column:null},e),i._signalTaskEnd()})):t.call(i,o,e)}else t.call(i,s,e)},A.prototype._getLocalKeys=function(e){var t=this._getCellByIndex(e);if(t)return this.getCellKeys(t);var i,s,o=e.row,n=e.column;if(void 0!==o){if(-1===o)i=null;else{var r=this._getCellOrHeaderByIndex(o,"row");r&&(i=this._getKey(r,"row"))}if(void 0===i)return}if(void 0!==n){if(-1===n)s=null;else{var l=this._getCellOrHeaderByIndex(n,"column");l&&(s=this._getKey(l,"column"))}if(void 0===s)return}return this.createIndex(i,s)},A.prototype.SetCreateContextCallback=function(e){this.m_createContextCallback=e},A.prototype.SetFocusableCallback=function(e,t){this.m_focusInHandler=e,this.m_focusOutHandler=t},A.prototype.SetFixContextCallback=function(e){this.m_fixContextCallback=e},A.prototype.SetCustomElement=function(e){this.m_customElement=e},A.prototype._isHighWatermarkScrolling=function(){return"scroll"!==this.m_options.getScrollPolicy()},A.prototype.destroy=function(){delete this.m_fetching,this._removeDataSourceEventListeners(),this._removeDomEventListeners(),delete this.m_styleClassDimensionMap,this.m_styleClassDimensionMap={width:{},height:{}}},A.prototype._addDataSourceEventListeners=function(){this._removeDataSourceEventListeners(),null!=this.m_dataSource&&(this.m_handleModelEventListener=this.handleModelEvent.bind(this),this.m_handleExpandEventListener=this.handleExpandEvent.bind(this),this.m_handleCollapseEventListener=this.handleCollapseEvent.bind(this),this.m_dataSource.on("change",this.m_handleModelEventListener,this),this.m_dataSource.on("expand",this.m_handleExpandEventListener,this),this.m_dataSource.on("collapse",this.m_handleCollapseEventListener,this))},A.prototype._removeDataSourceEventListeners=function(){null!=this.m_dataSource&&(this.m_dataSource.off("change",this.m_handleModelEventListener),this.m_dataSource.off("expand",this.m_handleExpandEventListener),this.m_dataSource.off("collapse",this.m_handleCollapseEventListener))},A.prototype._addDomEventListeners=function(){this.m_handleDatabodyKeyDown||(this.m_handleDatabodyKeyDown=this.handleDatabodyKeyDown.bind(this)),this.m_handleDatabodyKeyUp||(this.m_handleDatabodyKeyUp=this.handleDatabodyKeyUp.bind(this)),this.m_handleRootFocus||(this.m_handleRootFocus=this.handleRootFocus.bind(this)),this.m_handleRootBlur||(this.m_handleRootBlur=this.handleRootBlur.bind(this)),this.m_handleContextMenuEvent||(this.m_handleContextMenuEvent=this.handleContextMenuEvent.bind(this)),this.m_root.addEventListener("keydown",this.m_handleDatabodyKeyDown,!1),this.m_root.addEventListener("keyup",this.m_handleDatabodyKeyUp,!1),this.m_root.addEventListener("focus",this.m_handleRootFocus,!0),this.m_root.addEventListener("blur",this.m_handleRootBlur,!0),this.m_root.addEventListener("contextmenu",this.m_handleContextMenuEvent,!0)},A.prototype._removeDomEventListeners=function(){document.removeEventListener("mousemove",this.m_docMouseMoveListener,!1),document.removeEventListener("mouseup",this.m_docMouseUpListener,!1),null!=this.m_root&&(this.m_handleDatabodyKeyDown&&this.m_root.removeEventListener("keydown",this.m_handleDatabodyKeyDown,!1),this.m_handleDatabodyKeyUp&&this.m_root.removeEventListener("keyup",this.m_handleDatabodyKeyUp,!1),this.m_handleRootFocus&&this.m_root.removeEventListener("focus",this.m_handleRootFocus,!0),this.m_handleRootBlur&&this.m_root.removeEventListener("blur",this.m_handleRootBlur,!0),this.m_handleContextMenuEvent&&this.m_root.removeEventListener("contextmenu",this.m_handleContextMenuEvent,!0))},A.prototype.getRootElement=function(){return this.m_root},A.prototype.getWidth=function(){return null==this.m_width&&(this.m_width=this.getRootElement().clientWidth),this.m_width},A.prototype.getHeight=function(){return null==this.m_height&&(this.m_height=this.getRootElement().clientHeight),this.m_height},A.prototype.getViewportWidth=function(){var e=this.getWidth();return Math.round(1.5*e)},A.prototype.getViewportHeight=function(){var e=this.getHeight();return Math.round(1.5*e)},A.prototype._getViewportTop=function(){return this.m_currentScrollTop},A.prototype._getViewportBottom=function(){var e=this._getViewportTop(),t=this.getElementHeight(this.m_databody),i=this.m_utils.getScrollbarSize();return this.m_hasHorizontalScroller?e+t-i:e+t},A.prototype._getViewportLeft=function(){return this.m_currentScrollLeft},A.prototype._getViewportRight=function(){var e=this._getViewportLeft(),t=this.getElementWidth(this.m_databody),i=this.m_utils.getScrollbarSize();return this.m_hasVerticalScroller?e+t-i:e+t},A.prototype.getFetchSize=function(e){return"row"===e?(null==this.m_rowFetchSize&&(this.m_rowFetchSize=Math.max(1,Math.round(this.getViewportHeight()/this.getDefaultRowHeight()))),this.m_rowFetchSize):"column"===e?(null==this.m_columnFetchSize&&(this.m_columnFetchSize=Math.max(1,Math.round(this.getViewportWidth()/this.getDefaultColumnWidth()))),this.m_columnFetchSize):0},A.prototype.getEmptyText=function(){var e=this.m_options.getEmptyText();null==e&&(e=this.getResources().getTranslatedText("msgNoData"));return e},A.prototype._buildEmptyText=function(){let e;if(null==this.getDataSource()){let t=this.getWidth(),i=this.getHeight();e=this.buildDatabody(!0)[0],this.setElementWidth(e,t),this.setElementHeight(e,i),this.m_root.insertBefore(e,this.m_status)}const t=this._getTemplateEngine(),i=this._getItemTemplateBySlotName("noData");if(e=this.m_databody,i&&null!=t){let s=document.createElement("div");return s.setAttribute(this.getResources().getMappedAttribute("container"),this.getResources().widgetName),s.setAttribute(this.getResources().getMappedAttribute("busyContext"),""),s.id=this.createSubId("noData"),this.m_utils.addCSSClassName(s,this.getMappedStyle("noDataContainer")),t.execute(this.getRootElement(),i,{},null,e).forEach(function(e){s.appendChild(e)}),this._removeFocusFromChildElements({},s),s}var s=this.getEmptyText(),o=document.createElement("div");return o.id=this.createSubId("empty"),o.className=this.getMappedStyle("emptytext"),o.textContent=s,this.m_empty=o,o},A.prototype.getRowThreshold=function(){return 0},A.prototype.getColumnThreshold=function(){return 0},A.prototype.setDefaultDimensions=function(){var e=document.createElement("div");e.style.visibilty="hidden";var t=this.getResources();e.className=t.getMappedStyle("rowheadercell")+" "+t.getMappedStyle("colheadercell")+" "+t.getMappedStyle("headercell"),this.m_root.appendChild(e),this.m_defaultColumnWidth=e.offsetWidth,this.m_defaultRowHeight=e.offsetHeight,this.getViewportWidth(),this.getViewportHeight(),this.m_root.removeChild(e)},A.prototype.getDefaultRowHeight=function(){return null==this.m_defaultRowHeight&&this.setDefaultDimensions(),this.m_defaultRowHeight},A.prototype.getDefaultColumnWidth=function(){return null==this.m_defaultColumnWidth&&this.setDefaultDimensions(),this.m_defaultColumnWidth},A.prototype._getHeaderDimension=function(e,t,i,s){var o=this.m_sizingManager.getSize(i,t);if(null!=o)return o;if(""!==e.style[s])return o=this.getElementDir(e,s),null!==t&&this.m_sizingManager.setSize(i,t,o),o;var n=e.className;return null==(o=this.m_styleClassDimensionMap[s][n])&&(o=this.getElementDir(e,s)),this.m_sizingManager.setSize(i,t,o),this.m_styleClassDimensionMap[s][n]=o,o},A.prototype._computeHeaderDimension=function(e,t,i){let{root:s,totalLevels:o}=this._getHeaderRootAndLevels(e,t),n=0;for(let e=0;e<s.firstChild.childElementCount;e++){let t=o>1?s.firstChild.childNodes[e].firstChild:s.firstChild.childNodes[e];n+=this.getElementDir(t,i)}return n},A.prototype._getHeaderRootAndLevels=function(e,t){let i,s;return"column"===e?(i=t?this.m_colHeaderFrozen:this.m_colHeader,s=this.m_columnHeaderLevelCount):"columnEnd"===e?(i=t?this.m_colEndHeaderFrozen:this.m_colEndHeader,s=this.m_columnEndHeaderLevelCount):"row"===e?(i=t?this.m_rowHeaderFrozen:this.m_rowHeader,s=this.m_rowHeaderLevelCount):"rowEnd"===e&&(i=t?this.m_rowEndHeaderFrozen:this.m_rowEndHeader,s=this.m_rowEndHeaderLevelCount),{root:i,totalLevels:s}},A.prototype.createSubId=function(e){return[this.getRootElement().id,e].join(":")},A.prototype.updateMaxYet=function(){let e=this._getMaxBottom(),t=this._getMaxRight();this.m_maxRowYet<e&&(this.m_maxRowYet=e),this.m_maxColYet<t&&(this.m_maxColYet=t)},A.prototype.isHeaderFetchComplete=function(){return!1===this.m_fetching.row&&!1===this.m_fetching.column},A.prototype.isFetchComplete=function(){return null!=this.m_fetching&&this.isHeaderFetchComplete()&&!1===this.m_fetching.cells},A.prototype._isLastRow=function(e){return this._isCountUnknown("row")?e===this.m_endRow&&this.m_stopRowFetch:e+1===this.getDataSource().getCount("row")},A.prototype._isLastColumn=function(e){return this._isCountUnknown("column")?e===this.m_endCol&&this.m_stopColumnFetch:e+1===this.getDataSource().getCount("column")},A.prototype._getLastAxis=function(e){return this._isCountUnknown(e)?("row"===e?this.m_stopRowFetch:this.m_stopColumnFetch)?"row"===e?this.m_endRow:this.m_endCol:"row"===e?this.m_endRow+1:this.m_endCol+1:this.getDataSource().getCount(e)-1},A.prototype.empty=function(){this.m_empty&&this._remove(this.m_empty),this.m_corner&&this._remove(this.m_corner),this.m_bottomCorner&&this._remove(this.m_bottomCorner),this.m_columnHeaderScrollbarSpacer&&this._remove(this.m_columnHeaderScrollbarSpacer),this.m_rowHeaderScrollbarSpacer&&this._remove(this.m_rowHeaderScrollbarSpacer),this.m_root.removeChild(this.m_placeHolder),this.m_root.removeChild(this.m_status),this.m_root.removeChild(this.m_accSummary),this.m_root.removeChild(this.m_accInfo),this.m_root.removeChild(this.m_stateInfo),this.m_root.removeChild(this.m_contextInfo),this._remove(this.m_colHeader),this._remove(this.m_rowHeader),this._remove(this.m_colEndHeader),this._remove(this.m_rowEndHeader),this._remove(this.m_databody),this._remove(this.m_databodyFrozenCol),this._remove(this.m_databodyFrozenRow),this._remove(this.m_databodyFrozenCorner),this._remove(this.m_colHeaderFrozen),this._remove(this.m_colEndHeaderFrozen),this._remove(this.m_rowHeaderFrozen),this._remove(this.m_rowEndHeaderFrozen),this._clearDatabodyMap()},A.prototype.refresh=function(e){this.resetInternal(),this.render(e)},A.prototype.resetInternal=function(){this.m_initialized=!1,this.m_readinessStack=[],this._signalTaskStart(),this._signalTaskEnd(),this._clearDatabodyMap(),this.m_cursor=null,this.m_corner=null,this.m_bottomCorner=null,this.m_columnHeaderScrollbarSpacer=null,this.m_rowHeaderScrollbarSpacer=null,this.m_colHeader=null,this.m_colEndHeader=null,this.m_rowHeader=null,this.m_rowEndHeader=null,this.m_databody=null,this.m_empty=null,this.m_accInfo=null,this.m_accSummary=null,this.m_contextInfo=null,this.m_placeHolder=null,this.m_stateInfo=null,this.m_status=null,this.m_headerLabels={row:[],column:[],rowEnd:[],columnEnd:[]},this.m_rowHeaderFrozen=null,this.m_rowEndHeaderFrozen=null,this.m_colHeaderFrozen=null,this.m_colEndHeaderFrozen=null,this.m_databodyFrozenCorner=null,this.m_databodyFrozenRow=null,this.m_databodyFrozenCol=null,this.m_isEstimateRowCount=void 0,this.m_isEstimateColumnCount=void 0,this.m_stopRowFetch=!1,this.m_stopRowHeaderFetch=!1,this.m_stopRowEndHeaderFetch=!1,this.m_stopColumnFetch=!1,this.m_stopColumnHeaderFetch=!1,this.m_stopColumnEndHeaderFetch=!1,this.m_rowFetchSize=null,this.m_columnFetchSize=null,this.m_fetching=null,this.m_processingModelEvent=!1,this.m_processingEventQueue=!1,this.m_animating=!1,this.m_fetchingForUpdate=!1,this.m_sizingManager.clear(),this.m_styleClassDimensionMap={width:{},height:{}},this.m_height=null,this.m_width=null,this.m_scrollHeight=null,this.m_scrollWidth=null,this.m_avgRowHeight=void 0,this.m_avgColWidth=void 0,this.m_defaultColumnWidth=null,this.m_defaultRowHeight=null,this.m_colHeaderHeight=null,this.m_colEndHeaderHeight=null,this.m_rowHeaderWidth=null,this.m_rowEndHeaderWidth=null,this.m_rowHeaderLevelWidths=[],this.m_rowEndHeaderLevelWidths=[],this.m_columnHeaderLevelHeights=[],this.m_columnEndHeaderLevelHeights=[],this.m_collisionResize=!1,this.m_active=null,this.m_prevActive=null,this.m_trueIndex={},this.m_headerDragState=!1,this.m_databodyDragState=!1,this.m_databodyMove=!1,this.m_moveRow=null,this.m_moveRowHeader=null,this.m_dropTarget=null,this.m_dropTargetHeader=null,this.m_floodFillDragState=!1,this.m_dataTransferAction=null,this.m_discontiguousSelection=!1,this.m_selectionFrontier=null,this.m_docMouseMoveListener=null,this.m_docMouseUpListener=null,this.m_modelEvents=[],this.m_hasHorizontalScroller=null,this.m_hasVerticalScroller=null,this.m_currentScrollLeft=null,this.m_currentScrollTop=null,this.m_prevScrollLeft=null,this.m_prevScrollTop=null,this.m_handleScrollOverflow=null,this._clearScrollPositionTimeout(),this._requiresInitPostScrollFillViewport=!1,this.m_resizing=!1,this.m_resizingElement=null,this.m_resizingElementSibling=null,this.m_resizingElementMin=null,this.m_startRow=null,this.m_startCol=null,this.m_endRow=null,this.m_maxRowYet=null,this.m_endCol=null,this.m_maxColYet=null,this.m_startRowPixel=null,this.m_startColPixel=null,this.m_endRowPixel=null,this.m_endColPixel=null,this.m_startRowHeader=null,this.m_startColHeader=null,this.m_endRowHeader=null,this.m_endColHeader=null,this.m_startRowHeaderPixel=null,this.m_startColHeaderPixel=null,this.m_endRowHeaderPixel=null,this.m_endColHeaderPixel=null,this.m_rowHeaderLevelCount=null,this.m_columnHeaderLevelCount=null,this.m_startRowEndHeader=null,this.m_startColEndHeader=null,this.m_endRowEndHeader=null,this.m_endColEndHeader=null,this.m_startRowEndHeaderPixel=null,this.m_startColEndHeaderPixel=null,this.m_endRowEndHeaderPixel=null,this.m_endColEndHeaderPixel=null,this.m_rowEndHeaderLevelCount=null,this.m_columnEndHeaderLevelCount=null,this.m_sortColumnInfo=null,this.m_sortRowInfo=null,this.m_expandCollapseInfo=null,this.m_resizeRequired=null,this.m_externalFocus=null,this.m_currentMode=null,this.m_editMode=null,this.m_editCell=null,this.m_hasCells=null,this.m_hasRowHeader=null,this.m_hasRowEndHeader=null,this.m_hasColHeader=null,this.m_hasColEndHeader=null,this.m_isLongScroll=null,this.m_longScrollRow=null,this.m_longScrollColumn=null,this.m_longScrollRowPixel=null,this.m_longScrollColumnPixel=null,this.m_addBorderBottom=null,this.m_addBorderRight=null,this.m_sortContainerWidth=null,this.m_sortContainerHeight=null,this.m_editCell=null,this._resetSkeletonProperties(),this._destroyEditableClone(),this._clearFocusoutTimeout(),this._clearFocusoutBusyState()},A.prototype._shouldInitialize=function(){return this.isFetchComplete()&&!this.m_initialized&&null!=this.m_databody.parentNode},A.prototype._handleInitialization=function(e){if(!0===e){if(this.resizeGrid(),this._databodyEmptyState()||0!==this.m_startRow||0!==this.m_startCol?this._requiresInitPostScrollFillViewport=!0:this.fillViewport(),this.isFetchComplete()){let e=!1;this._updateActive(this.m_options.getCurrentCell(),!!this.m_focusOnRefresh,!0,e);let t=this.m_options.getEditCell();t&&this._setEditCell(t),this.m_initialized=!0,this.fireEvent("ready",{}),this._runModelEventQueue()}}else this.m_initialized=!0,this.fireEvent("ready",{}),this._runModelEventQueue()},A.prototype._runModelEventQueue=function(e){var t;if(null!=this.m_modelEvents){if(this.m_processingEventQueue=!0,0===this.m_modelEvents.length)return this.m_processingEventQueue=!1,void(e&&this.fillViewport());"expand"===(t=this.m_modelEvents.shift()).operation?this.handleExpandEvent(t,!0):"collapse"===t.operation?this.handleCollapseEvent(t,!0):this.handleModelEvent(t,!0)}else this.m_processingEventQueue=!1,e&&this.fillViewport()},A.prototype.render=function(e){this.m_renderCount+=1,this.m_timingStart=new Date,this.m_fetching={},this.m_startRow=0,this.m_startCol=0,this.m_endRow=-1,this.m_maxRowYet=-1,this.m_endCol=-1,this.m_maxColYet=-1,this.m_startRowPixel=0,this.m_startColPixel=0,this.m_endRowPixel=0,this.m_endColPixel=0,this.m_startRowHeader=0,this.m_startColHeader=0,this.m_endRowHeader=-1,this.m_endColHeader=-1,this.m_startRowHeaderPixel=0,this.m_startColHeaderPixel=0,this.m_endRowHeaderPixel=0,this.m_endColHeaderPixel=0,this.m_startRowEndHeader=0,this.m_startColEndHeader=0,this.m_endRowEndHeader=-1,this.m_endColEndHeader=-1,this.m_startRowEndHeaderPixel=0,this.m_startColEndHeaderPixel=0,this.m_endRowEndHeaderPixel=0,this.m_endColEndHeaderPixel=0,this.m_currentScrollLeft=0,this.m_currentScrollTop=0,this.m_prevScrollLeft=0,this.m_prevScrollTop=0,this.m_handleScrollOverflow=!1,this.m_rowHeaderLevelWidths=[],this.m_rowEndHeaderLevelWidths=[],this.m_columnHeaderLevelHeights=[],this.m_columnEndHeaderLevelHeights=[],this.m_frozenColIndex=null,this.m_frozenRowIndex=null,this._resetSkeletonProperties();var t=this._loadTemplateEngine();t?(this._signalTaskStart("loading template engine"),t.then(()=>{this._signalTaskEnd(),this.m_renderCount-=1,0===this.m_renderCount&&this.buildGrid(e)})):(this.m_renderCount-=1,this.buildGrid(e))},A.prototype._loadTemplateEngine=function(){var e=this._getSlotMap();if(this._isDataGridProvider()&&Object.keys(e).length>1||null==this.getDataSource()&&Object.keys(e).length>0){var t={customElement:this.m_customElement};return new Promise(e=>{g.__getTemplateEngine(t).then(t=>{this.m_engine=t,e(t)},function(e){throw new Error("Error loading template engine: "+e)})})}return null},A.prototype._getTemplateEngine=function(){return this.m_engine},A.prototype._cleanTemplateNodes=function(e){var t=this._getTemplateEngine();null!=t&&t.clean(e,this.m_root)},A.prototype._isDataGridProvider=function(){return this.m_options.options.data&&this.m_options.options.data.fetchByOffset&&!this.m_options.options.data.fetchFirst},A.prototype._getSlotMap=function(){return p.CustomElementUtils.getSlotMap(this.m_root)},A.prototype._getItemTemplateBySlotName=function(e){var t=this._getSlotMap()[e];return t&&t.length>0&&"template"===t[0].tagName.toLowerCase()?t[0]:null},A.prototype.buildGrid=function(e){this.m_root=e,this.m_root.setAttribute("role","application"),this._isCellEditable()?this.m_utils.addCSSClassName(this.m_root,this.getMappedStyle("editable")):this.m_utils.addCSSClassName(this.m_root,this.getMappedStyle("readOnly")),this.setDefaultDimensions(),e.tabIndex=0;const t=this.buildAccSummary();e.appendChild(t),this.m_accSummary=t;const i=this.buildStatus();e.appendChild(i),this.m_status=i;const s=this.buildAccInfo();e.appendChild(s),this.m_accInfo=s;const o=this.buildStateInfo();e.appendChild(o),this.m_stateInfo=o;const n=this.buildContextInfo();e.appendChild(n),this.m_contextInfo=n;const r=this.buildPlaceHolder();if(e.appendChild(r),this.m_placeHolder=r,this.m_headerLabels={row:[],column:[],rowEnd:[],columnEnd:[]},null!=this.getDataSource()){this.m_empty=null;const t=this.getResources().isRTLMode();let s=this.buildHeaders("column",this.getMappedStyle("colheader"),this.getMappedStyle("colendheader"));const o=s.root,n=s.endRoot,r=s.frozenHeader,a=s.frozenEndHeader;e.insertBefore(o,i),e.insertBefore(n,i),r&&e.insertBefore(r,i),a&&e.insertBefore(a,i),s=this.buildHeaders("row",this.getMappedStyle("rowheader"),this.getMappedStyle("rowendheader"));const h=s.root,d=s.endRoot,m=s.frozenHeader,c=s.frozenEndHeader;e.insertBefore(h,i),e.insertBefore(d,i),m&&e.insertBefore(m,i),c&&e.insertBefore(c,i);const u=this.buildDatabody();for(let t=0;t<u.length;t++)e.insertBefore(u[t],i);const _=u[0];if(t&&(o.style.direction="rtl",_.style.direction="rtl"),this.m_isResizing=!1,this.m_resizingElement=null,this.m_resizingElementMin=null,this.m_databodyDragState=!1,this.m_docMouseMoveListener=this.handleMouseMove.bind(this),this.m_docMouseUpListener=this.handleMouseUp.bind(this),this.m_utils.isTouchDevice())_.addEventListener("touchstart",this.handleTouchStart.bind(this),{passive:!0}),_.addEventListener("touchmove",this.handleTouchMove.bind(this),{passive:!1}),_.addEventListener("touchend",this.handleTouchEnd.bind(this),!1),_.addEventListener("touchcancel",this.handleTouchCancel.bind(this),!1),o.addEventListener("touchstart",this.handleHeaderTouchStart.bind(this),{passive:!0}),o.addEventListener("touchmove",this.handleHeaderTouchMove.bind(this),{passive:!1}),o.addEventListener("touchend",this.handleHeaderTouchEnd.bind(this),!1),o.addEventListener("touchcancel",this.handleHeaderTouchCancel.bind(this),!1),h.addEventListener("touchstart",this.handleHeaderTouchStart.bind(this),{passive:!0}),h.addEventListener("touchmove",this.handleHeaderTouchMove.bind(this),{passive:!1}),h.addEventListener("touchend",this.handleHeaderTouchEnd.bind(this),!1),h.addEventListener("touchcancel",this.handleHeaderTouchCancel.bind(this),!1),n.addEventListener("touchstart",this.handleHeaderTouchStart.bind(this),{passive:!0}),n.addEventListener("touchmove",this.handleHeaderTouchMove.bind(this),{passive:!1}),n.addEventListener("touchend",this.handleHeaderTouchEnd.bind(this),!1),n.addEventListener("touchcancel",this.handleHeaderTouchCancel.bind(this),!1),d.addEventListener("touchstart",this.handleHeaderTouchStart.bind(this),{passive:!0}),d.addEventListener("touchmove",this.handleHeaderTouchMove.bind(this),{passive:!1}),d.addEventListener("touchend",this.handleHeaderTouchEnd.bind(this),!1),d.addEventListener("touchcancel",this.handleHeaderTouchCancel.bind(this),!1);else{var l=this.m_utils.getMousewheelEvent();_.addEventListener(l,this.handleDatabodyMouseWheel.bind(this),{passive:!1}),_.addEventListener("mousedown",this.handleDatabodyMouseDown.bind(this),!1),_.addEventListener("mousemove",this.handleDatabodyMouseMove.bind(this),!1),_.addEventListener("mouseup",this.handleDatabodyMouseUp.bind(this),!1),_.addEventListener("mouseout",this.handleDatabodyMouseOut.bind(this),!1),_.addEventListener("mouseover",this.handleDatabodyMouseOver.bind(this),!1),_.addEventListener("dblclick",this.handleDatabodyDoubleClick.bind(this),!1),h.addEventListener(l,this.handleDatabodyMouseWheel.bind(this),{passive:!1}),o.addEventListener(l,this.handleDatabodyMouseWheel.bind(this),{passive:!1}),h.addEventListener("mousedown",this.handleHeaderMouseDown.bind(this),!1),o.addEventListener("mousedown",this.handleHeaderMouseDown.bind(this),!1),h.addEventListener("mouseover",this.handleHeaderMouseOver.bind(this),!1),o.addEventListener("mouseover",this.handleHeaderMouseOver.bind(this),!1),h.addEventListener("mousemove",this.handleRowHeaderMouseMove.bind(this),!1),o.addEventListener("mousemove",this.handleColumnHeaderMouseMove.bind(this),!1),h.addEventListener("mouseup",this.handleHeaderMouseUp.bind(this),!1),o.addEventListener("mouseup",this.handleHeaderMouseUp.bind(this),!1),h.addEventListener("mouseout",this.handleHeaderMouseOut.bind(this),!1),o.addEventListener("mouseout",this.handleHeaderMouseOut.bind(this),!1),h.addEventListener("click",this.handleHeaderClick.bind(this),!1),h.addEventListener("dblclick",this.handleHeaderDoubleClick.bind(this),!1),o.addEventListener("click",this.handleHeaderClick.bind(this),!1),o.addEventListener("dblclick",this.handleHeaderDoubleClick.bind(this),!1),d.addEventListener(l,this.handleDatabodyMouseWheel.bind(this),{passive:!1}),n.addEventListener(l,this.handleDatabodyMouseWheel.bind(this),{passive:!1}),d.addEventListener("mousedown",this.handleHeaderMouseDown.bind(this),!1),n.addEventListener("mousedown",this.handleHeaderMouseDown.bind(this),!1),d.addEventListener("mouseover",this.handleHeaderMouseOver.bind(this),!1),n.addEventListener("mouseover",this.handleHeaderMouseOver.bind(this),!1),d.addEventListener("mousemove",this.handleRowHeaderMouseMove.bind(this),!1),n.addEventListener("mousemove",this.handleColumnHeaderMouseMove.bind(this),!1),d.addEventListener("mouseup",this.handleHeaderMouseUp.bind(this),!1),n.addEventListener("mouseup",this.handleHeaderMouseUp.bind(this),!1),d.addEventListener("mouseout",this.handleHeaderMouseOut.bind(this),!1),n.addEventListener("mouseout",this.handleHeaderMouseOut.bind(this),!1),d.addEventListener("click",this.handleHeaderClick.bind(this),!1),d.addEventListener("dblclick",this.handleHeaderDoubleClick.bind(this),!1),n.addEventListener("click",this.handleHeaderClick.bind(this),!1),n.addEventListener("dblclick",this.handleHeaderDoubleClick.bind(this),!1)}this._addDnDEventListener(h,d,o,n,_),this._addListenersOnFrozenSections(m,c,r,a),this._shouldInitialize()&&this._handleInitialization(!0)}else{var a=this._buildEmptyText();this.m_databody.firstChild.appendChild(a),this._handleInitialization(!1)}},A.prototype._addDnDEventListener=function(e,t,i,s,o){e&&(e.addEventListener("drag",this.handleRowDrag.bind(this),!1),e.addEventListener("dragstart",this.handleDragStart.bind(this),!1),e.addEventListener("dragend",this.handleRowDragEnd.bind(this),!1),e.addEventListener("dragover",this.handleRowDragOver.bind(this),!1),e.addEventListener("dragenter",this.handleRowDragEnter.bind(this),!1),e.addEventListener("dragleave",this.handleRowDragLeave.bind(this),!1),e.addEventListener("drop",this.handleRowDrop.bind(this),!1)),i&&(i.addEventListener("dragstart",this.handleDragStart.bind(this),!1),i.addEventListener("dragend",this.handleColumnDragEnd.bind(this),!1),i.addEventListener("dragover",this.handleColumnDragOver.bind(this),!1),i.addEventListener("dragenter",this.handleColumnDragEnter.bind(this),!1),i.addEventListener("dragleave",this.handleColumnDragLeave.bind(this),!1),i.addEventListener("drop",this.handleColumnDrop.bind(this),!1)),t&&(t.addEventListener("drag",this.handleRowDrag.bind(this),!1),t.addEventListener("dragstart",this.handleDragStart.bind(this),!1),t.addEventListener("dragend",this.handleRowDragEnd.bind(this),!1),t.addEventListener("dragover",this.handleRowDragOver.bind(this),!1),t.addEventListener("dragenter",this.handleRowDragEnter.bind(this),!1),t.addEventListener("dragleave",this.handleRowDragLeave.bind(this),!1),t.addEventListener("drop",this.handleRowDrop.bind(this),!1)),s&&(s.addEventListener("dragstart",this.handleDragStart.bind(this),!1),s.addEventListener("dragend",this.handleColumnDragEnd.bind(this),!1),s.addEventListener("dragover",this.handleColumnDragOver.bind(this),!1),s.addEventListener("dragenter",this.handleColumnDragEnter.bind(this),!1),s.addEventListener("dragleave",this.handleColumnDragLeave.bind(this),!1),s.addEventListener("drop",this.handleColumnDrop.bind(this),!1)),o&&(o.addEventListener("dragover",this.handleDatabodyDragOver.bind(this),!1),o.addEventListener("dragenter",this.handleDatabodyDragEnter.bind(this),!1),o.addEventListener("drop",this.handleDatabodyDrop.bind(this),!1))},A.prototype._addListenersOnFrozenSections=function(e,t,i,s){const o=this.m_utils.getMousewheelEvent();let n=[this.m_databodyFrozenCorner,this.m_databodyFrozenCol,this.m_databodyFrozenRow];n=n.filter(e=>e);for(let e=0;e<n.length;e++){let t=n[e];this.m_utils.isTouchDevice()?(t.addEventListener("touchstart",this.handleTouchStart.bind(this),{passive:!0}),t.addEventListener("touchmove",this.handleTouchMove.bind(this),{passive:!1}),t.addEventListener("touchend",this.handleTouchEnd.bind(this),!1),t.addEventListener("touchcancel",this.handleTouchCancel.bind(this),!1)):(t.addEventListener(o,this.handleDatabodyMouseWheel.bind(this),{passive:!1}),t.addEventListener("mousedown",this.handleDatabodyMouseDown.bind(this),!1),t.addEventListener("mousemove",this.handleDatabodyMouseMove.bind(this),!1),t.addEventListener("mouseup",this.handleDatabodyMouseUp.bind(this),!1),t.addEventListener("mouseout",this.handleDatabodyMouseOut.bind(this),!1),t.addEventListener("mouseover",this.handleDatabodyMouseOver.bind(this),!1),t.addEventListener("dblclick",this.handleDatabodyDoubleClick.bind(this),!1),t.addEventListener("dragover",this.handleDatabodyDragOver.bind(this),!1),t.addEventListener("dragenter",this.handleDatabodyDragEnter.bind(this),!1),t.addEventListener("drop",this.handleDatabodyDrop.bind(this),!1))}e&&(this.m_utils.isTouchDevice()?(e.addEventListener("touchstart",this.handleHeaderTouchStart.bind(this),{passive:!0}),e.addEventListener("touchmove",this.handleHeaderTouchMove.bind(this),{passive:!1}),e.addEventListener("touchend",this.handleHeaderTouchEnd.bind(this),!1),e.addEventListener("touchcancel",this.handleHeaderTouchCancel.bind(this),!1)):(e.addEventListener(o,this.handleDatabodyMouseWheel.bind(this),{passive:!1}),e.addEventListener("mousedown",this.handleHeaderMouseDown.bind(this),!1),e.addEventListener("mouseover",this.handleHeaderMouseOver.bind(this),!1),e.addEventListener("mousemove",this.handleRowHeaderMouseMove.bind(this),!1),e.addEventListener("mouseup",this.handleHeaderMouseUp.bind(this),!1),e.addEventListener("mouseout",this.handleHeaderMouseOut.bind(this),!1),e.addEventListener("click",this.handleHeaderClick.bind(this),!1),e.addEventListener("dblclick",this.handleHeaderDoubleClick.bind(this),!1))),i&&(this.m_utils.isTouchDevice()?(i.addEventListener("touchstart",this.handleHeaderTouchStart.bind(this),{passive:!0}),i.addEventListener("touchmove",this.handleHeaderTouchMove.bind(this),{passive:!1}),i.addEventListener("touchend",this.handleHeaderTouchEnd.bind(this),!1),i.addEventListener("touchcancel",this.handleHeaderTouchCancel.bind(this),!1)):(i.addEventListener(o,this.handleDatabodyMouseWheel.bind(this),{passive:!1}),i.addEventListener("mousedown",this.handleHeaderMouseDown.bind(this),!1),i.addEventListener("mouseover",this.handleHeaderMouseOver.bind(this),!1),i.addEventListener("mousemove",this.handleColumnHeaderMouseMove.bind(this),!1),i.addEventListener("mouseup",this.handleHeaderMouseUp.bind(this),!1),i.addEventListener("mouseout",this.handleHeaderMouseOut.bind(this),!1),i.addEventListener("click",this.handleHeaderClick.bind(this),!1),i.addEventListener("dblclick",this.handleHeaderDoubleClick.bind(this),!1))),t&&(this.m_utils.isTouchDevice()?(t.addEventListener("touchstart",this.handleHeaderTouchStart.bind(this),{passive:!0}),t.addEventListener("touchmove",this.handleHeaderTouchMove.bind(this),{passive:!1}),t.addEventListener("touchend",this.handleHeaderTouchEnd.bind(this),!1),t.addEventListener("touchcancel",this.handleHeaderTouchCancel.bind(this),!1)):(t.addEventListener(o,this.handleDatabodyMouseWheel.bind(this),{passive:!1}),t.addEventListener("mousedown",this.handleHeaderMouseDown.bind(this),!1),t.addEventListener("mouseover",this.handleHeaderMouseOver.bind(this),!1),t.addEventListener("mousemove",this.handleRowHeaderMouseMove.bind(this),!1),t.addEventListener("mouseup",this.handleHeaderMouseUp.bind(this),!1),t.addEventListener("mouseout",this.handleHeaderMouseOut.bind(this),!1),t.addEventListener("click",this.handleHeaderClick.bind(this),!1),t.addEventListener("dblclick",this.handleHeaderDoubleClick.bind(this),!1))),s&&(this.m_utils.isTouchDevice()?(s.addEventListener("touchstart",this.handleHeaderTouchStart.bind(this),{passive:!0}),s.addEventListener("touchmove",this.handleHeaderTouchMove.bind(this),{passive:!1}),s.addEventListener("touchend",this.handleHeaderTouchEnd.bind(this),!1),s.addEventListener("touchcancel",this.handleHeaderTouchCancel.bind(this),!1)):(s.addEventListener(o,this.handleDatabodyMouseWheel.bind(this),{passive:!1}),s.addEventListener("mousedown",this.handleHeaderMouseDown.bind(this),!1),s.addEventListener("mouseover",this.handleHeaderMouseOver.bind(this),!1),s.addEventListener("mousemove",this.handleColumnHeaderMouseMove.bind(this),!1),s.addEventListener("mouseup",this.handleHeaderMouseUp.bind(this),!1),s.addEventListener("mouseout",this.handleHeaderMouseOut.bind(this),!1),s.addEventListener("click",this.handleHeaderClick.bind(this),!1),s.addEventListener("dblclick",this.handleHeaderDoubleClick.bind(this),!1))),this._addDnDEventListener(e,t,i,s)},A.prototype.HandleResize=function(e,t){e=this.getRootElement().clientWidth,t=this.getRootElement().clientHeight,e===this.m_width&&t===this.m_height||(this.m_width=e,this.m_height=t,this.m_rowFetchSize=null,this.m_columnFetchSize=null,this.m_initialized&&(this.resizeGrid(),this.isFetchComplete()&&(this.m_resizeRequired=!0,this.fillViewport())))},A.prototype.resizeGrid=function(){var e=this.getWidth(),t=this.getHeight(),i=this.m_colHeader,s=this.m_colEndHeader,o=this.m_rowHeader,n=this.m_rowEndHeader,r=this.m_databody,l=r.firstChild;const a=this.m_databodyFrozenCol,h=this.m_databodyFrozenRow;let d=0,m=0;var c=this.getColumnHeaderHeight(),u=this.getColumnEndHeaderHeight(),_=this.getRowHeaderWidth(),g=this.getRowEndHeaderWidth();a&&(d=this.getElementWidth(a)),h&&(m=this.getElementHeight(h)),this._hasFrozenColumns()&&this._hasFrozenRows()&&(d||(d=this.getElementWidth(this.m_databodyFrozenCorner)),m||(m=this.getElementHeight(this.m_databodyFrozenCorner))),this.m_headerLabels.row&&this.m_headerLabels.row.length&&0===c&&(c=this._getCellDimension(this.m_headerLabels.row[0],0,null,"column","height"),this.m_colHeaderHeight=c),this.m_headerLabels.column&&this.m_headerLabels.column.length&&0===_&&(_=this._getCellDimension(this.m_headerLabels.column[0],0,null,"row","width"),this.m_rowHeaderWidth=_);var p=t-c-u-m,f=e-_-g-d;p<0&&(p=0),f<0&&(f=0);var C,y,w,E=this.m_utils.getScrollbarSize();this._databodyEmpty()&&(null==this.m_empty?(C=this._buildEmptyText(),y=this.getElementHeight(C),w=this.getElementWidth(C),l=r.firstChild,y>this.getElementHeight(l)&&this._setAllScrollableRegions("height",Math.max(y,p)),w>this.getElementWidth(l)&&this._setAllScrollableRegions("width",Math.max(w,f)),this.m_databody.firstChild.appendChild(C)):C=this.m_empty);var v,x,H,b,S,R=this.getElementWidth(r.firstChild),I=this.getElementHeight(r.firstChild),z=this.isDatabodyHorizontalScrollbarRequired(f);if(z)v=this.isDatabodyVerticalScrollbarRequired(p-E),r.style.overflow="auto";else if(v=this.isDatabodyVerticalScrollbarRequired(p))z=this.isDatabodyHorizontalScrollbarRequired(f-E),r.style.overflow="auto";else{this.m_handleScrollOverflow=!1;var F=this;setTimeout(function(){F.m_handleScrollOverflow||F.m_hasVerticalScroller||F.m_hasHorizontalScroller||(r.style.overflow="hidden",F.m_handleScrollOverflow=!0)},10)}this.m_hasHorizontalScroller=z,this.m_hasVerticalScroller=v,-1!==this.m_endColEndHeader?(x=Math.min(I+(z?E:0),p),H=z?x-E:x):(x=p,H=Math.min(I,z?x-E:x)),-1!==this.m_endRowEndHeader?(b=Math.min(R+(v?E:0),f),S=v?b-E:b):(b=f,S=Math.min(R,v?b-E:b));var M=_+S+d+(v?E:0),A=c+H+m+(z?E:0),D=this.getResources().isRTLMode()?"right":"left";this.setElementDir(o,0,D),this.setElementDir(o,c,"top"),this.setElementHeight(o,H),this.setElementDir(n,M,D),this.setElementDir(n,c,"top"),this.setElementHeight(n,H),this.setElementDir(i,_,D),this.setElementWidth(i,S),this.setElementDir(s,_,D),this.setElementDir(s,A,"top"),this.setElementWidth(s,S),[_,c]=this._setFrozenContainerDimension(b,x,_,g,c,u),this.setElementDir(r,c,"top"),this.setElementDir(r,_,D),this.setElementWidth(r,b),this.setElementHeight(r,x),this.m_scrollWidth=R-S,this.m_scrollHeight=I-H,this.buildCorners(),this._adjustHeaderBorders(),this._updateGridlines(),this.m_resizeRequired=!1},A.prototype._applyIosAccessibility=function(){this.m_root.querySelectorAll("[aria-flowto]").forEach(e=>{(this.m_utils.containsCSSClassName(e,this.getMappedStyle("cell"))||this.m_utils.containsCSSClassName(e,this.getMappedStyle("headercell"))||this.m_utils.containsCSSClassName(e,this.getMappedStyle("headerlabel")))&&e.removeAttribute("aria-flowto")});let e=document.getElementById(this.createSubId("summary"));const t=this._getEmptyElement();if(t)t.setAttribute("role","text"),this._applyAriaFlowTo(e,t.id),e=t;else{this._isHeaderLabelCollision()?(e=this._handleColumnHeaderIosAccessibility(e),e=this._handleRowLabelIosAccessibility(e),e=this._handleRowEndLabelIosAccessibility(e)):(e=this._handleRowLabelIosAccessibility(e),e=this._handleRowEndLabelIosAccessibility(e),e=this._handleColumnHeaderIosAccessibility(e));for(let t=this._getMaxTop();t<=this._getMaxBottom();t++){for(let i=0;i<this.m_rowHeaderLevelCount;i++){const s=this._getHeaderByIndex(t,"row",i);this._applyIosAccessibilityToElement(s,e),null===s.getAttribute("aria-flowto")&&(this._applyAriaFlowTo(e,s.id),e=s)}for(let i=this._getMaxLeft();i<=this._getMaxRight();i++){const s=this._getCellByIndex(this.createIndex(t,i));this._applyIosAccessibilityToElement(s,e),null===s.getAttribute("aria-flowto")&&(this._applyAriaFlowTo(e,s.id),e=s)}for(let i=this.m_rowEndHeaderLevelCount-1;i>=0;i--){const s=this._getHeaderByIndex(t,"rowEnd",i);this._applyIosAccessibilityToElement(s,e),null===s.getAttribute("aria-flowto")&&(this._applyAriaFlowTo(e,s.id),e=s)}}e=this._handleColumnEndHeaderIosAccessibility(e)}let i=document.getElementById(this.createSubId("lastitem"));i||(i=document.createElement("div"),i.setAttribute("role","text"),i.id=this.createSubId("lastitem"),i.textContent=this.getResources().getTranslatedText("accessibleEndOfDataGrid"),i.className=this.getMappedStyle("info"),this.m_root.appendChild(i)),this._applyAriaFlowTo(e,i.id)},A.prototype._applyIosAccessibilityToElement=function(e,t){if(null===e.getAttribute("role")){const i=t.id===this.createSubId("summary")?null:this._createActiveObject(t);e.setAttribute("role","text");const s=this._createActiveObject(e);e.setAttribute("aria-labelledby",this.getLabelledBy(s,i,e),!0);const o=this.m_stateInfo.textContent;e.setAttribute("aria-description",this._getActiveContext(s,i)+o)}},A.prototype._handleRowLabelIosAccessibility=function(e){let t=e;if(this.m_headerLabels.row.length>0)for(let e=0;e<this.m_rowHeaderLevelCount;e++){const i=this.m_headerLabels.row[e];i&&(this._applyIosAccessibilityToElement(i,t),this._applyAriaFlowTo(t,i.id),t=i)}return t},A.prototype._handleRowEndLabelIosAccessibility=function(e){let t=e;if(this.m_headerLabels.rowEnd.length>0)for(let e=this.m_rowEndHeaderLevelCount-1;e>=0;e--){const i=this.m_headerLabels.rowEnd[e];i&&(this._applyIosAccessibilityToElement(i,t),this._applyAriaFlowTo(t,i.id),t=i)}return t},A.prototype._handleColumnHeaderIosAccessibility=function(e){let t=e;for(let e=0;e<this.m_columnHeaderLevelCount;e++){const i=this._getHeadersByLevel("column",e,!1),s=this.m_headerLabels.column[e];s&&(this._applyIosAccessibilityToElement(s,t),this._applyAriaFlowTo(t,s.id),t=s);for(let e=0;e<i.length;e++){const s=i[e];this._applyIosAccessibilityToElement(s,t),this._applyAriaFlowTo(t,s.id),t=s}}return t},A.prototype._handleColumnEndHeaderIosAccessibility=function(e){let t=e;for(let e=this.m_columnEndHeaderLevelCount-1;e>=0;e--){const i=this._getHeadersByLevel("columnEnd",e,!1),s=this.m_headerLabels.columnEnd[e];s&&(this._applyIosAccessibilityToElement(s,t),this._applyAriaFlowTo(t,s.id),t=s);for(let e=0;e<i.length;e++){const s=i[e];this._applyIosAccessibilityToElement(s,t),this._applyAriaFlowTo(t,s.id),t=s}}return t},A.prototype._applyAriaFlowTo=function(e,t){null===e.getAttribute("aria-flowto")&&e.setAttribute("aria-flowto",t)},A.prototype._sizeDatabodyScroller=function(){var e=this.m_databody.firstChild,t=0,i=0;this._databodyEmptyState()?(t=Math.max(Math.max(this.m_endRowHeaderPixel,this.m_endRowEndHeaderPixel),1),i=Math.max(Math.max(this.m_endColHeaderPixel,this.m_endColEndHeaderPixel),1)):(t=this.m_endRowPixel,i=this.m_endColPixel),this._setScrollerDimension(e,t,i)},A.prototype._setAllScrollableRegions=function(e,t){const i=this.m_databody.firstElementChild;if("height"===e){if(this.setElementHeight(i,t),this.m_hasRowHeader){const e=this.m_rowHeader.firstElementChild;this.setElementHeight(e,t)}if(this.m_hasRowEndHeader){const e=this.m_rowEndHeader.firstElementChild;this.setElementHeight(e,t)}if(this._hasFrozenColumns()){const e=this.m_databodyFrozenCol.firstElementChild;this.setElementHeight(e,t)}this.m_initialized&&(this.m_scrollHeight=this.getElementHeight(i)-Math.min(this.getElementHeight(i),this.getElementHeight(this.m_databody)-(this.m_hasHorizontalScroller?this.m_utils.getScrollbarSize():0)))}else if("width"===e){if(this.setElementWidth(i,t),this.m_hasColHeader){const e=this.m_colHeader.firstElementChild;this.setElementWidth(e,t)}if(this.m_hasColEndHeader){const e=this.m_colEndHeader.firstElementChild;this.setElementWidth(e,t)}if(this._hasFrozenRows()){const e=this.m_databodyFrozenRow.firstElementChild;this.setElementWidth(e,t)}this.m_initialized&&(this.m_scrollWidth=this.getElementWidth(i)-Math.min(this.getElementWidth(i),this.getElementWidth(this.m_databody)-(this.m_hasVerticalScroller?this.m_utils.getScrollbarSize():0)))}},A.prototype._setAllScrollableRegions=function(e,t){const i=this.m_databody.firstElementChild;if("height"===e){if(this.setElementHeight(i,t),this.m_hasRowHeader){const e=this.m_rowHeader.firstElementChild;this.setElementHeight(e,t)}if(this.m_hasRowEndHeader){const e=this.m_rowEndHeader.firstElementChild;this.setElementHeight(e,t)}if(this._isHighWatermarkScrolling()&&this._hasFrozenColumns()){const e=this.m_databodyFrozenCol.firstElementChild;this.setElementHeight(e,t)}this.m_initialized&&(this.m_scrollHeight=this.getElementHeight(i)-Math.min(this.getElementHeight(i),this.getElementHeight(this.m_databody)-(this.m_hasHorizontalScroller?this.m_utils.getScrollbarSize():0)))}else if("width"===e){if(this.setElementWidth(i,t),this.m_hasColHeader){const e=this.m_colHeader.firstElementChild;this.setElementWidth(e,t)}if(this.m_hasColEndHeader){const e=this.m_colEndHeader.firstElementChild;this.setElementWidth(e,t)}if(this._isHighWatermarkScrolling()&&this._hasFrozenRows()){const e=this.m_databodyFrozenRow.firstElementChild;this.setElementWidth(e,t)}this.m_initialized&&(this.m_scrollWidth=this.getElementWidth(i)-Math.min(this.getElementWidth(i),this.getElementWidth(this.m_databody)-(this.m_hasVerticalScroller?this.m_utils.getScrollbarSize():0)))}},A.prototype._setScrollerDimension=function(e,t,i){let s=this._isHighWatermarkScrolling(),o=this.m_utils._getMaxDivHeightForScrolling(),n=this.m_utils._getMaxDivWidthForScrolling(),r=this.getDatabodyCount("row","count"),l=this.getDatabodyCount("column","count"),a=this.getDatabodyCount("row","maxCountKnown"),h=this.getDatabodyCount("column","maxCountKnown"),d=0,m=0;if(d=s?t:this.getDataSource().getCount("row")<0?a*this.m_avgRowHeight:r*this.m_avgRowHeight,m=s?i:this.getDataSource().getCount("column")<0?h*this.m_avgColWidth:l*this.m_avgColWidth,!s){if(this.m_utils.containsCSSClassName(e,this.getMappedStyle("databodyFrozenRow"))){let e=this.m_frozenRowIndex+1,i=this._getHiddenCountBeforeIndex(this.m_frozenRowIndex+1,"row");i&&(e=this.m_frozenRowIndex+1-i),d=e*(null!=this.m_avgRowHeight?this.m_avgRowHeight:t/e)}else if(this.m_utils.containsCSSClassName(e,this.getMappedStyle("databodyFrozenCol"))){let e=this.m_frozenColIndex+1,t=this._getHiddenCountBeforeIndex(this.m_frozenColIndex+1,"column");t&&(e=this.m_frozenColIndex+1-t),m=e*(null!=this.m_avgColWidth?this.m_avgColWidth:i/e)}else if(this.m_utils.containsCSSClassName(e,this.getMappedStyle("databodyFrozenCorner"))){let e=this.m_frozenRowIndex+1,s=this.m_frozenColIndex+1;d=e*(null!=this.m_avgRowHeight?this.m_avgRowHeight:t/e),m=s*(null!=this.m_avgColWidth?this.m_avgColWidth:i/s)}this.setElementHeight(e,Math.min(o,d)),this.setElementWidth(e,Math.min(n,m))}this._setAllScrollableRegions("height",Math.min(o,d)),this._setAllScrollableRegions("width",Math.min(n,m))},A.prototype.getDatabodyCount=function(e,t){const i="row"===e?this.m_hiddenRows:this.m_hiddenColumns,s="row"===e?this.m_frozenRowIndex:this.m_frozenColIndex,o="row"===e?this.m_maxRowYet:this.m_maxColYet,n=this.getDataSource().getCount(e);let r=n;return"count"===t?(r=n-i.length,("row"===e&&this._hasFrozenRows()||"column"===e&&this._hasFrozenColumns())&&(r-=s+1+this._getHiddenCountBeforeIndex(s+1,e))):"maxCountKnown"===t&&(r=o-this._getHiddenCountBeforeIndex(o,e),("row"===e&&this._hasFrozenRows()||"column"===e&&this._hasFrozenColumns())&&(r-=s+1+this._getHiddenCountBeforeIndex(s+1,e))),r},A.prototype._adjustLastHeadersAlongAxis=function(e,t,i,s,o,n,r){for(var l=0;l<t;){let t=this._getHeaderByIndex(e,r,l);n?this.m_utils.removeCSSClassName(t,o):this.m_utils.addCSSClassName(t,o),l+=this.getHeaderCellDepth(t)}},A.prototype._adjustHeaderBordersAlongAxis=function(e,t,i,s,o,n,r,l,a){null!=e&&i>=0&&(s?this.m_utils.addCSSClassName(o,n):this.m_utils.removeCSSClassName(o,n),t(i)&&this._adjustLastHeadersAlongAxis(i,r,e,l,n,s,a))},A.prototype._adjustHeaderBorders=function(){var e,t,i,s,o,n=this.m_utils.getScrollbarSize(),r=this.getWidth(),l=this.getHeight(),a=this.getColumnHeaderHeight(),h=this.getElementWidth(this.m_colHeader),d=this.getColumnEndHeaderHeight(),m=this.getRowHeaderWidth(),c=this.getElementHeight(this.m_rowHeader),u=m+h+this.getRowEndHeaderWidth()+(this.m_hasVerticalScroller?n:0)<r,_=a+c+d+(this.m_hasHorizontalScroller?n:0)<l;if(u&&this.m_endRowEndHeader>=0?(e=!0,this.m_addBorderRight=!0):!0===this.m_addBorderRight&&(e=!1),null!=e)for(t=this.getMappedStyle("borderVerticalSmall"),null!=this.m_columnHeaderScrollbarSpacer&&(e?this.m_utils.addCSSClassName(this.m_columnHeaderScrollbarSpacer,t):this.m_utils.removeCSSClassName(this.m_columnHeaderScrollbarSpacer,t)),null!=this.m_bottomCorner&&(e?this.m_utils.addCSSClassName(this.m_bottomCorner,t):this.m_utils.removeCSSClassName(this.m_bottomCorner,t)),s=Array.from(this.m_rowEndHeader.firstChild.childNodes),this.m_rowEndHeaderFrozen?.firstChild?.childNodes?.length&&s.push(...this.m_rowEndHeaderFrozen.firstChild.childNodes),i=0;i<s.length;i++)e?this.m_utils.addCSSClassName(s[i],t):this.m_utils.removeCSSClassName(s[i],t);else{t=this.getMappedStyle("borderVerticalNone"),o=this._isLastColumn.bind(this);let e=this.m_startColHeader,i=this.m_startColEndHeader;this._hasFrozenColumns()&&(e=this.m_frozenColIndex+1,i=e),this._adjustHeaderBordersAlongAxis(this.m_colHeader,o,this.m_endColHeader,u,this.m_columnHeaderScrollbarSpacer,t,this.m_columnHeaderLevelCount,e,"column"),this._adjustHeaderBordersAlongAxis(this.m_colEndHeader,o,this.m_endColEndHeader,u,this.m_bottomCorner,t,this.m_columnEndHeaderLevelCount,i,"columnEnd")}if(e=null,_&&this.m_endColEndHeader>=0?(this.m_addBorderBottom=!0,e=!0):!0===this.m_addBorderBottom&&(e=!1),null!=e){t=this.getMappedStyle("borderHorizontalSmall"),null!=this.m_rowHeaderScrollbarSpacer&&(e?this.m_utils.addCSSClassName(this.m_rowHeaderScrollbarSpacer,t):this.m_utils.removeCSSClassName(this.m_rowHeaderScrollbarSpacer,t)),null!=this.m_bottomCorner&&(e?this.m_utils.addCSSClassName(this.m_bottomCorner,t):this.m_utils.removeCSSClassName(this.m_bottomCorner,t)),s=Array.from(this.m_colEndHeader.firstChild.childNodes),this.m_colEndHeaderFrozen?.firstChild?.childNodes?.length&&s.push(...this.m_colEndHeaderFrozen.firstChild.childNodes);const o=this.getMappedStyle("groupingcontainer");for(i=0;i<s.length;i++){let n=s[i];n.classList.contains(o)&&(n=n.firstChild),e?this.m_utils.addCSSClassName(n,t):this.m_utils.removeCSSClassName(n,t)}}else{t=this.getMappedStyle("borderHorizontalNone"),o=this._isLastRow.bind(this);let e=this.m_startRowHeader,i=this.m_startRowEndHeader;null!==this.m_frozenRowIndex&&(e=this.m_frozenRowIndex+1,i=e),this._adjustHeaderBordersAlongAxis(this.m_rowHeader,o,this.m_endRowHeader,_,this.m_rowHeaderScrollbarSpacer,t,this.m_rowHeaderLevelCount,e,"row"),this._adjustHeaderBordersAlongAxis(this.m_rowEndHeader,o,this.m_endRowEndHeader,_,this.m_bottomCorner,t,this.m_rowEndHeaderLevelCount,i,"rowEnd")}},A.prototype._isHeaderLabelCollision=function(){return this.m_headerLabels.column[this.m_columnHeaderLevelCount-1]&&this.m_headerLabels.row[this.m_rowHeaderLevelCount-1]},A.prototype.buildCorners=function(){var e,t,i,s,o=this.m_utils.getScrollbarSize(),n=this.getWidth(),r=this.getHeight(),l=this.getColumnHeaderHeight(),a=this.getElementWidth(this.m_colHeader),h=this.getColumnEndHeaderHeight(),d=this.getRowHeaderWidth(),m=this.getRowEndHeaderWidth(),c=this.getElementHeight(this.m_rowHeader),u=this.getResources().isRTLMode()?"right":"left";let _,g,p,f,C,y,w=!0,E=l,v=d,x=0,H=0;const b=this.m_databodyFrozenCol,S=this.m_databodyFrozenRow;if(b&&(x=this.getElementWidth(b)),S&&(H=this.getElementHeight(S)),-1!==this.m_endRowHeader&&-1!==this.m_endColHeader?(g=this.m_headerLabels.column.length?this.m_columnHeaderLevelHeights[this.m_columnHeaderLevelCount-1]:this.m_colHeaderHeight,_=this.m_headerLabels.row.length?this.m_rowHeaderLevelWidths[this.m_rowHeaderLevelCount-1]:this.m_rowHeaderWidth,C=c+l+H,y=h+(this.m_hasHorizontalScroller?o:0),p=d+a+x,f=m+(this.m_hasVerticalScroller?o:0)):-1!==this.m_endRowHeader&&-1===this.m_endColHeader?(g=l,C=c+l+H,y=h+(this.m_hasHorizontalScroller?o:0),p=d,f=m+a+x+(this.m_hasVerticalScroller?o:0)):-1===this.m_endRowHeader&&-1!==this.m_endColHeader?(_=d,C=l,y=h+c+H+(this.m_hasHorizontalScroller?o:0),p=d+a+x,f=m+(this.m_hasVerticalScroller?o:0)):w=!1,w){if(null!=this.m_corner?e=this.m_corner:((e=document.createElement("div")).id=this.createSubId("corner"),e.className=this.getMappedStyle("topcorner")),this.setElementWidth(e,d),this.setElementHeight(e,l),null==this.m_corner){if(this._attachEventListenersOnCorner(e),this.m_root.appendChild(e),this.m_corner=e,g)for(s=0;s<this.m_headerLabels.row.length;s++)null!=(i=this.m_headerLabels.row[s])&&(this.setElementHeight(i,g),e.appendChild(i));if(_)for(s=0;s<this.m_headerLabels.column.length;s++)null!=(i=this.m_headerLabels.column[s])&&(this.setElementWidth(i,_),e.appendChild(i));if(this.m_subtreeAttachedCallback(e),this._isHeaderLabelCollision()){let e=this.m_headerLabels.row[this.m_rowHeaderLevelCount-1],t=this.getElementHeight(e);return this.m_colHeaderHeight+=t,this.m_columnHeaderLevelHeights[this.m_columnHeaderLevelCount-1]+=t,this.resizeColumnHeightsAndShift(t,this.m_columnHeaderLevelCount-1,!1),this.setElementHeight(this.m_colHeader,this.m_colHeaderHeight),this.m_colHeaderFrozen&&this.setElementHeight(this.m_colHeaderFrozen,this.m_colHeaderHeight),void this.manageResizeScrollbars()}}this._buildCornerOnHeaderAxisDisabled("row",u,0,C,v,y),this._buildCornerOnHeaderAxisDisabled("column",u,p,0,f,E)}else this.m_headerLabels.row=[],this.m_headerLabels.column=[];null!=this.m_corner&&null==e&&(this.m_root.removeChild(this.m_corner),this.m_corner=null),(this.m_hasHorizontalScroller&&this.m_hasVerticalScroller||this.m_hasVerticalScroller&&-1!==this.m_endColEndHeader||this.m_hasHorizontalScroller&&-1!==this.m_endRowEndHeader||-1!==this.m_endRowEndHeader&&-1!==this.m_endColEndHeader)&&(null!=this.m_bottomCorner?t=this.m_bottomCorner:((t=document.createElement("div")).id=this.createSubId("bcorner"),t.className=this.getMappedStyle("bottomcorner")),this.setElementDir(t,c+l+H,"top"),this.setElementDir(t,d+a+x,u),-1!==this.m_endRowEndHeader?this.setElementWidth(t,m+(this.m_hasVerticalScroller?o:0)):this.setElementWidth(t,n-a-d-x),-1!==this.m_endColEndHeader?this.setElementHeight(t,h+(this.m_hasHorizontalScroller?o:0)):this.setElementHeight(t,r-c-l-H),null==this.m_bottomCorner&&(this.m_root.appendChild(t),this.m_bottomCorner=t)),null!=this.m_bottomCorner&&null==t&&(this.m_root.removeChild(this.m_bottomCorner),this.m_bottomCorner=null)},A.prototype._attachEventListenersOnCorner=function(e){this.m_utils.isTouchDevice()?(e.addEventListener("touchstart",this.handleCornerMouseDown.bind(this),{passive:!0}),e.addEventListener("touchmove",this.handleHeaderLabelMouseMove.bind(this),!1),e.addEventListener("touchend",this.handleCornerMouseDown.bind(this),{passive:!0})):(e.addEventListener("mousedown",this.handleCornerMouseDown.bind(this),!1),e.addEventListener("mouseover",this.handleCornerMouseOver.bind(this),!1),e.addEventListener("mousemove",this.handleHeaderLabelMouseMove.bind(this),!1),e.addEventListener("mouseout",this.handleCornerMouseOut.bind(this),!1),e.addEventListener("dblclick",this.handleHeaderLabelDoubleClick.bind(this),!1)),this.m_options._isLabelCutEnabled()?this._attachDndListenersOnLabelSection(e):e.addEventListener("click",this.handleCornerClick.bind(this),!1)},A.prototype._attachDndListenersOnLabelSection=function(e){e.addEventListener("dragstart",this.handleCornerDragStart.bind(this),!1),e.addEventListener("dragend",this.handleCornerDragEnd.bind(this),!1),e.addEventListener("dragover",this.handleCornerDragOver.bind(this),!1),e.addEventListener("drop",this.handleCornerDrop.bind(this),!1),e.addEventListener("dragenter",this.handleCornerDragEnter.bind(this),!1)},A.prototype._buildCornerOnHeaderAxisDisabled=function(e,t,i,s,o,n){let r,l="column"===e?this.m_columnHeaderScrollbarSpacer:this.m_rowHeaderScrollbarSpacer,a=!1;if("column"===e?(this.m_hasVerticalScroller||-1!==this.m_endRowEndHeader)&&(a=!0,null!=this.m_columnHeaderScrollbarSpacer?r=this.m_columnHeaderScrollbarSpacer:(r=document.createElement("div"),r.id=this.createSubId("chSbSpacer"),r.className=this.getMappedStyle("colheaderspacer"))):"row"===e&&(this.m_hasHorizontalScroller||-1!==this.m_endColEndHeader)&&(a=!0,null!=this.m_rowHeaderScrollbarSpacer?r=this.m_rowHeaderScrollbarSpacer:(r=document.createElement("div"),r.id=this.createSubId("rhSbSpacer"),r.className=this.getMappedStyle("rowheaderspacer"))),a){let a,h;if(this.setElementDir(r,i,t),this.setElementDir(r,s,"top"),this.setElementWidth(r,o),this.setElementHeight(r,n),null==l){if(this.m_utils.isTouchDevice()?r.addEventListener("touchstart",this.handleCornerMouseDown.bind(this),{passive:!0}):(r.addEventListener("mousedown",this.handleCornerMouseDown.bind(this),!1),r.addEventListener("mouseover",this.handleCornerMouseOver.bind(this),!1),r.addEventListener("mouseout",this.handleCornerMouseOut.bind(this),!1),this._attachDndListenersOnLabelSection(r),"disable"!==this.isResizeEnabled()&&(r.addEventListener("mousedown",this.handleHeaderLabelMouseDown.bind(this),!1),r.addEventListener("mousemove",this.handleHeaderLabelMouseMove.bind(this),!1))),this.m_root.appendChild(r),"column"===e?(this.m_columnHeaderScrollbarSpacer=r,a=this.m_headerLabels.rowEnd):(this.m_rowHeaderScrollbarSpacer=r,a=this.m_headerLabels.columnEnd),a.length)for(let e=0;e<a.length;e++)h=a[e],null!=h&&r.appendChild(h);this.m_subtreeAttachedCallback(r)}}else"column"===e?(null!=this.m_columnHeaderScrollbarSpacer&&this.m_root.removeChild(this.m_columnHeaderScrollbarSpacer),this.m_columnHeaderScrollbarSpacer=null,this.m_headerLabels.rowEnd=[]):(null!=this.m_rowHeaderScrollbarSpacer&&this.m_root.removeChild(this.m_rowHeaderScrollbarSpacer),this.m_rowHeaderScrollbarSpacer=null,this.m_headerLabels.columnEnd=[])},A.prototype._updateScrollPosition=function(e){this._scrollToScrollPositionObject(e)},A.prototype._setScrollPosition=function(){this.m_setOptionCallback("scrollPosition",this._createScrollPositionObject(this.m_currentScrollLeft,this.m_currentScrollTop),{_context:{writeback:!0,internalSet:!0}})},A.prototype._clearScrollPositionKeys=function(){var e=this.m_options.getScrollPosition();e.rowKey=void 0,e.columnKey=void 0,this.m_setOptionCallback("scrollPosition",e,{_context:{internalSet:!0}})},A.prototype._createScrollPositionObject=function(e,t){var i={x:e,y:t},s=this.getResources().isRTLMode()?"right":"left",o=this._getCellAtPixel(e,t);if(null!=o)i.rowIndex=this._getIndex(o,"row"),i.columnIndex=this._getIndex(o,"column"),i.rowKey=this._getKey(o,"row"),i.columnKey=this._getKey(o,"column"),i.offsetX=e-this.getElementDir(o,s),i.offsetY=t-this.getElementDir(o,"top");else{var n=this._getHeaderAtPixel(t,"row");null!=n&&(i.rowIndex=this._getIndex(n),i.rowKey=this._getKey(n),i.offsetY=t-this.getElementDir(n,"top"));var r=this._getHeaderAtPixel(e,"column");null!=r&&(i.columnIndex=this._getIndex(r),i.columnKey=this._getKey(r),i.offsetX=e-this.getElementDir(r,s))}return i},A.prototype._getCellAtPixel=function(e,t){for(var i=this.m_databody.firstChild.querySelectorAll("."+this.getMappedStyle("cell")),s=this.getResources().isRTLMode()?"right":"left",o=0;o<i.length;o++){var n=i[o],r=this.getElementDir(n,s),l=r+this.getElementWidth(n);if(r<=e&&e<l){var a=this.getElementDir(n,"top"),h=a+this.getElementHeight(n);if(a<=t&&t<h)return n}}return null},A.prototype._getAxisInnerMostHeaders=function(e){var t,i,s=this.getMappedStyle("headercell");switch(e){case"row":t=this.m_rowHeader,i=this.m_rowHeaderLevelCount;break;case"column":t=this.m_colHeader,i=this.m_columnHeaderLevelCount;break;case"rowEnd":t=this.m_rowEndHeader,i=this.m_rowEndHeaderLevelCount;break;case"columnEnd":t=this.m_colEndHeader,i=this.m_columnEndHeaderLevelCount}var o=[];if(t)for(var n=t.getElementsByClassName(s),r=0;r<n.length;r++){var l=n[r],a=l[this.getResources().getMappedAttribute("context")];a.level+a.depth===i&&o.push(l)}return o},A.prototype._getHeaderAtPixel=function(e,t){var i,s,o,n,r=this;function l(t){for(var i=0;i<t.length;i++){var s=t[i],l=r.getElementDir(s,o),a=l+r.getElementDir(s,n);if(l<=e&&e<a)return s}}i=this._getAxisInnerMostHeaders(t),s=this._getAxisInnerMostHeaders(t+"End"),"row"===t?(o="top",n="height"):"column"===t&&(o=this.getResources().isRTLMode()?"right":"left",n="width");var a=l(i);return null==a&&(a=l(s)),a},A.prototype._checkScrollPosition=function(){null!=this.m_desiredScrollPositionObject?this._scrollToScrollPositionObject(this.m_desiredScrollPositionObject):this._setScrollPosition()},A.prototype._areKeysLocallyAvailable=function(e,t){var i=!0;return e&&null==this._getCellOrHeaderByKey(e,"row")&&(i=!1),t&&null==this._getCellOrHeaderByKey(t,"column")&&(i=!1),i},A.prototype._scrollToScrollPositionObject=function(e){var t=e.x,i=e.y,s=e.rowIndex,o=e.columnIndex,n=e.rowKey,r=e.columnKey,l=e.offsetX?e.offsetX:0,a=e.offsetY?e.offsetY:0,h=this.getResources().isRTLMode()?"right":"left",d=this.m_options.getScrollToKey();if("never"!==d||!n&&!r){if("always"!==d)if(this.getDataSource()instanceof H&&!this._areKeysLocallyAvailable(n,r)){var m=this.m_options.getProperty("data").getCapability("fetchFirst");if(null==m||"immediate"!==m.iterationSpeed)return}var c=this;this._getIndexFromKeyPromise(n,r).then(function(d){var m=Math.floor(c._getPositionEstimate("column",h,r,d.columnIndexFromKey,o,t,l,c.m_currentScrollLeft,c._getMaxRightPixel(),c.m_avgColWidth)),u=Math.floor(c._getPositionEstimate("row","top",n,d.rowIndexFromKey,s,i,a,c.m_currentScrollTop,c._getMaxBottomPixel(),c.m_avgRowHeight));m!==c.m_currentScrollLeft&&(c.m_currentScrollLeft!==c.m_scrollWidth||m<c.m_currentScrollLeft)||u!==c.m_currentScrollTop&&(c.m_currentScrollTop!==c.m_scrollHeight||u<c.m_currentScrollTop)?(null==c.m_desiredScrollPositionObject&&c._signalTaskStart("begin scrolling to new desired location"),c.m_desiredScrollPositionObject=e,c._setScrollPositionTimeout(),c._initiateScroll(m,u),c._requiresInitPostScrollFillViewport=!1):(null!=c.m_desiredScrollPositionObject&&c._signalTaskEnd("reached desired location"),c.m_desiredScrollPositionObject=null,c._setScrollPosition(),c._requiresInitPostScrollFillViewport&&(c._requiresInitPostScrollFillViewport=!1,c.fillViewport()))})}},A.prototype._setScrollPositionTimeout=function(){this.pendingScrollTimeout=setTimeout(function(){null!=this.m_desiredScrollPositionObject&&this._signalTaskEnd("reached desired location"),this.m_desiredScrollPositionObject=null,this._setScrollPosition()}.bind(this),300)},A.prototype._clearScrollPositionTimeout=function(){null!=this.pendingScrollTimeout&&(clearTimeout(this.pendingScrollTimeout),this.pendingScrollTimeout=null)},A.prototype._getPositionEstimate=function(e,t,i,s,o,n,r,l,a,h){var d,m,c=this._isHighWatermarkScrolling();if(null!=i&&-1!==s){if(null!=(m=this._getCellOrHeaderByKey(i,e)))d=this.getElementDir(m,t)+r;else if(c)d=a;else if(null!=s){d=h*(s-this._getHiddenCountBeforeIndex(s,e))+r}if(null!=d)return d}if(null!=o)if(null!=(m=this._getCellOrHeaderByIndex(o,e)))d=this.getElementDir(m,t)+r;else if(c)d=a;else{d=h*(o-this._getHiddenCountBeforeIndex(o,e))}else d=null!=n?n:l;return d},A.prototype.isDatabodyHorizontalScrollbarRequired=function(e){var t=this.m_databody.firstChild;return this.getElementWidth(t)>e},A.prototype.isDatabodyVerticalScrollbarRequired=function(e){var t=this.m_databody.firstChild;return this.getElementHeight(t)>e},A.prototype.buildStatus=function(){const e=document.createElement("div");return e.id=this.createSubId("status"),e.className=this.getMappedStyle("status"),e.setAttribute("role","status"),u.isIos()&&e.setAttribute("aria-hidden",!0),e},A.prototype.buildAccInfo=function(){const e=document.createElement("div");return e.id=this.createSubId("info"),e.className=this.getMappedStyle("info"),e.setAttribute("role","status"),u.isIos()&&e.setAttribute("aria-hidden",!0),e},A.prototype.buildAccSummary=function(){const e=document.createElement("div");return e.id=this.createSubId("summary"),e.className=this.getMappedStyle("info"),u.isIos()&&e.setAttribute("role","text"),e},A.prototype.buildStateInfo=function(){const e=document.createElement("div");return e.id=this.createSubId("state"),e.className=this.getMappedStyle("info"),u.isIos()&&e.setAttribute("aria-hidden",!0),e},A.prototype.buildContextInfo=function(){const e=document.createElement("div");return e.id=this.createSubId("context"),e.className=this.getMappedStyle("info"),u.isIos()&&e.setAttribute("aria-hidden",!0),e},A.prototype.buildPlaceHolder=function(){const e=document.createElement("div");return e.id=this.createSubId("placeHolder"),e.className=this.getMappedStyle("info"),u.isIos()&&e.setAttribute("aria-hidden",!0),e},A.prototype.populateAccInfo=function(){var e=this.getResources().getTranslatedText("accessibleSummaryExact",{rownum:this.m_endRow+1,colnum:this.m_endCol+1});this.getDataSource().getExpandedKeys&&(e=e+". "+this.getResources().getTranslatedText("accessibleSummaryExpanded",{num:this.getDataSource().getExpandedKeys().length}));e+=". ",this.m_accSummary.textContent=e},A.prototype.SetAccessibleContext=function(e){if(null!=e&&(null!=e.context&&(this.m_accessibleContext=e.context),null!=e.state&&(this.m_stateInfo.textContent=e.state),null!=e.ancestors&&this._isDatabodyCellActive())){var t="",i=e.ancestors,s=this.m_active.indexes.column;if(null!=s&&s>=0)for(var o=0;o<i.length;o++){o>0&&(t=t.concat(", "));var n=i[o],r=this._getAxisCellsByKey(n.key,"row");if(null!=r){var l=r[0].textContent;l=null!=l?l.replace(/\n|<br\s*\/?>/gi,"").trim():"",t=t.concat(n.label).concat(" ").concat(l)}}this.m_accessibleContext=t.concat(", ").concat(this.m_accessibleContext)}},A.prototype._updateStateInfo=function(e){for(var t=". ",i=0;i<e.length;i++){var s=this.getResources().getTranslatedText(e[i].key,e[i].args);null!=s&&(t=2===t.length?t+s:t+", "+s)}t=2===t.length?t:t+". ",this.m_stateInfo.textContent=t},A.prototype._getContextInfo=function(e,t){var i,s;e.indexes&&(i=e.indexes.row,s=e.indexes.column);var o=e.level,n=e.rowHeader,r=e.rowEndHeader,l=e.columnHeader,a=e.columnEndHeader,h=e.rowHeaderLabel,d=e.rowEndHeaderLabel,m=e.columnHeaderLabel,c=e.columnEndHeaderLabel,u="";return null!=this.m_accessibleContext||isNaN(i)||"row"===t||(u=this._updateAccessibleInfoString(u,"accessibleRowContext",{index:i+1})),isNaN(s)||"column"===t||(u=this._updateAccessibleInfoString(u,"accessibleColumnContext",{index:s+1})),isNaN(n)||(u=this._updateAccessibleInfoString(u,"accessibleRowHeaderContext",{index:n+1})),isNaN(l)||(u=this._updateAccessibleInfoString(u,"accessibleColumnHeaderContext",{index:l+1})),isNaN(r)||(u=this._updateAccessibleInfoString(u,"accessibleRowEndHeaderContext",{index:r+1})),isNaN(a)||(u=this._updateAccessibleInfoString(u,"accessibleColumnEndHeaderContext",{index:a+1})),isNaN(h)||(u=this._updateAccessibleInfoString(u,"accessibleRowHeaderLabelContext",{level:h+1})),isNaN(m)||(u=this._updateAccessibleInfoString(u,"accessibleColumnHeaderLabelContext",{level:m+1})),isNaN(d)||(u=this._updateAccessibleInfoString(u,"accessibleRowEndHeaderLabelContext",{level:d+1})),isNaN(c)||(u=this._updateAccessibleInfoString(u,"accessibleColumnEndHeaderLabelContext",{level:c+1})),isNaN(o)||(u=this._updateAccessibleInfoString(u,"accessibleLevelContext",{level:o+1})),u=0===u.length?u:u+". ",null!=this.m_accessibleContext&&(u+=this.m_accessibleContext,this.m_accessibleContext=null),u},A.prototype._updateAccessibleInfoString=function(e,t,i){var s=this.getResources().getTranslatedText(t,i);return null!=s?0===e.length?s:e+", "+s:e},A.prototype._isCountUnknown=function(e){var t=this.getDataSource();if("row"===e||"rowEnd"===e){var i=t.getCountPrecision("row"),s=t.getCount("row");return this.m_isEstimateRowCount="estimate"===i||s<0,this.m_isEstimateRowCount}if("column"===e||"columnEnd"===e){var o=t.getCountPrecision("column"),n=t.getCount("column");return this.m_isEstimateColumnCount="estimate"===o||n<0,this.m_isEstimateColumnCount}return!1},A.prototype._isCountUnknownOrHighwatermark=function(e){return this._isCountUnknown(e)||this._isHighWatermarkScrolling()},A.prototype._hideHeader=function(e){e.style.display="none"},A.prototype._showHeader=function(e){e.style.display=""},A.prototype.buildHeaders=function(e,t,i){var s=this.getMappedStyle("scroller");let o=this._createHeaderElement(e,t,s,!1),n=this._createHeaderElement(e,i,s,!0);const r=this.m_options._getFreezeIndex(e);let l,a;if("column"===e?(this.m_colHeader=o,this.m_colEndHeader=n):"row"===e&&(this.m_rowHeader=o,this.m_rowEndHeader=n),"column"===e&&null!==r&&(this.m_frozenColIndex=r,l=this._createHeaderElement("frozenColumn",this.getMappedStyle("colHeaderFrozen"),s,!1),this.m_colHeaderFrozen=l,this.m_colEndHeader&&(a=this._createHeaderElement("frozenColumn",this.getMappedStyle("colEndHeaderFrozen"),s,!0),this.m_colEndHeaderFrozen=a)),"row"===e&&null!==r&&(this.m_frozenRowIndex=r,l=this._createHeaderElement("frozenRow",this.getMappedStyle("rowHeaderFrozen"),s,!1),this.m_rowHeaderFrozen=l,this.m_rowEndHeader&&(a=this._createHeaderElement("frozenRow",this.getMappedStyle("rowEndHeaderFrozen"),s,!0),this.m_rowEndHeaderFrozen=a)),this._isHighWatermarkScrolling()){this.fetchHeaders(e,0,o,n,null,null)}else{var h=this,d=this.m_options.getScrollPosition();this._getIndexesFromScrollPosition(d).then(function(t){var i=t[e];("column"===e&&h._hasFrozenColumns()&&i<h.m_frozenColIndex+1||"row"===e&&h._hasFrozenRows()&&i<h.m_frozenRowIndex+1)&&(i=0),"column"===e?(h.m_startColHeader=i,h.m_startColEndHeader=i):"row"===e&&(h.m_startRowHeader=i,h.m_startRowEndHeader=i);h.m_fetching[e]=!1,h.fetchHeaders(e,i,o,n,null,null)}),this.m_fetching[e]=!0}return{root:o,endRoot:n,frozenHeader:l,frozenEndHeader:a}},A.prototype._createHeaderElement=function(e,t,i,s){let o=document.createElement("div");o.id=s?this.createSubId(e+"EndHeader"):this.createSubId(e+"Header");let n=s?this.getMappedStyle("endheader"):this.getMappedStyle("header");o.className=t+" "+n;let r=document.createElement("div");return r.className=i,o.appendChild(r),o},A.prototype.fetchHeaders=function(e,t,i,s,o,n){if(this.m_fetching[e])return;null==o&&(o=this.getFetchCount(e,t));var r={axis:e,start:t,count:o,header:i,endHeader:s};let l;if(!this._isHighWatermarkScrolling()&&("column"===e&&this._hasFrozenColumns()&&(this.m_startColHeader>0||this.m_startColEndHeader>0||t>0)||"row"===e&&this._hasFrozenRows()&&(this.m_startRowHeader>0||this.m_startRowEndHeader>0||t>0)))if("row"===e&&t<this.m_frozenRowIndex+1||"column"===e&&t<this.m_frozenColIndex+1){let i="row"===e?this.m_frozenRowIndex+1:this.m_frozenColIndex+1,s=t+o>i?i-t+1:o;l={axis:e,start:t,count:s,header:"row"===e?this.m_rowHeaderFrozen:this.m_colHeaderFrozen,endHeader:"row"===e?this.m_rowEndHeaderFrozen:this.m_colEndHeaderFrozen},s===o?r={}:r.count=o-i}else this.m_fetchingForInsert||this.m_fetchingForUpdate||(l={axis:e,start:0,count:"row"===e?this.m_frozenRowIndex+1:this.m_frozenColIndex+1,header:"row"===e?this.m_rowHeaderFrozen:this.m_colHeaderFrozen,endHeader:"row"===e?this.m_rowEndHeaderFrozen:this.m_colEndHeaderFrozen});var a;this.m_fetching[e]=r,a=null!=n&&null!=n.success?n.success:this.handleHeadersFetchSuccess,this.m_initialized&&this.isSkeletonSupport()||this.showStatusText(!this.isSkeletonSupport()),this._signalTaskStart(),this.getDataSource().fetchHeaders(r,{success:a,error:this.handleHeadersFetchError},{success:this,error:this},l)},A.prototype.isHeaderFetchResponseValid=function(e){var t=e.axis;return null!=this.m_fetching&&e===this.m_fetching[t]},A.prototype.isHeaderFetchResponseInViewport=function(e){if(!this.m_initialized)return!0;var t=e.axis,i=e.start;return("row"===t?this._getLongScrollStart(this.m_currentScrollTop,this.m_prevScrollTop,t):this._getLongScrollStart(this.m_currentScrollLeft,this.m_prevScrollLeft,t)).start===i},A.prototype.handleHeadersFetchSuccess=function(e,t,i,s,o,n,r){var l=this.m_options.getScrollPolicyOptions(),a=l?l.maxRowCount:null,h=l?l.maxColumnCount:null;let d=!1;if(!this.isHeaderFetchResponseValid(t))return void this._signalTaskEnd();var m=t.axis;if(this.isLongScroll()&&!this.isHeaderFetchResponseInViewport(t))return this.m_fetching[m]=!1,this.m_headerInvalid=!0,void this._signalTaskEnd();this.m_fetching[m]=!1;var c=t.header,u=t.endHeader,_=t.start,g=this.getDataSource().getCount(m);let p=this.m_options.getScrollPosition();if("column"===m){this.m_initialized||null!==this.m_frozenColIndex||(this.m_frozenColIndex=this.m_options._getFreezeIndex(m)),!this._hasFrozenColumns()||0!==e?.start&&0!==i?.start||!this._isHighWatermarkScrolling()&&(this._isHighWatermarkScrolling()||void 0!==p.columnIndex&&0!==p.columnIndex)||(o=e,r=i,void 0===n&&(n=t),d=!0);let s,l=t.start,a=t.start,f=e?.getCount(),C=i?.getCount();if(void 0!==n&&(s=this._buildFrozenHeaders(m,o,r,n,d),l=s.headerStart,a=s.endHeaderStart,f=s.headerFetchCount,C=s.endHeaderFetchCount),null!=e){let i;_=e.start,(this._isHighWatermarkScrolling()||!this._isHighWatermarkScrolling()&&!this._hasFrozenColumns()||d||0===p.rowIndex&&0===p.columnIndex)&&(_=l,i=f),this.buildColumnHeaders(c,e,_,g,!1,!1,i,!1),this.m_initialized&&!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&0===this.m_startColHeader&&(this.m_startColHeader=this.m_frozenColIndex+1),(e.getCount()<t.count||h&&h>0&&h===_+e.getCount())&&(this.m_stopColumnHeaderFetch=!0)}else this.m_stopColumnHeaderFetch=!0;if(this.m_endColHeader<0?(this._hideHeader(c),this.m_stopColumnHeaderFetch=!0,this.m_startColHeader=0):(this.m_hasColHeader=!0,this._buildHeaderLabels(m,e)),null!=i){let e;_=i.start,(this._isHighWatermarkScrolling()||d||!this._isHighWatermarkScrolling()&&!this._hasFrozenColumns())&&(_=a,e=C),this.buildColumnEndHeaders(u,i,_,g,!1,!1,e,!1),this.m_initialized&&!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&0===this.m_startColEndHeader&&(this.m_startColEndHeader=this.m_frozenColIndex+1),(i.getCount()<t.count||h&&h>0&&h===_+i.getCount())&&(this.m_stopColumnEndHeaderFetch=!0)}else this.m_stopColumnEndHeaderFetch=!0;this.m_endColEndHeader<0?(this._hideHeader(u),this.m_stopColumnEndHeaderFetch=!0,this.m_startColEndHeader=0):(this.m_hasColEndHeader=!0,this._buildHeaderLabels("columnEnd",i))}else if("row"===m){this.m_initialized||null!==this.m_frozenRowIndex||(this.m_frozenRowIndex=this.m_options._getFreezeIndex("row")),!this._hasFrozenRows()||0!==e?.start&&0!==i?.start||!this._isHighWatermarkScrolling()&&(this._isHighWatermarkScrolling()||void 0!==p.rowIndex&&0!==p.rowIndex)||(o=e,r=i,void 0===n&&(n=t),d=!0);let l,h=t.start,f=t.start,C=e?.getCount(),y=i?.getCount();if(void 0!==n&&(l=this._buildFrozenHeaders(m,o,r,n,d),h=l.headerStart,f=l.endHeaderStart,C=l.headerFetchCount,y=l.endHeaderFetchCount),null!=e){let i;_=e.start,(this._isHighWatermarkScrolling()||!this._isHighWatermarkScrolling()&&!this._hasFrozenRows()||d||0===p.rowIndex&&0===p.columnIndex)&&(_=h,i=C),this.buildRowHeaders(c,e,_,g,s,!1,i,!1),this.m_initialized&&!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&0===this.m_startRowHeader&&(this.m_startRowHeader=this.m_frozenRowIndex+1),(e.getCount()<t.count||a&&a>0&&a===_+e.getCount())&&(this.m_stopRowHeaderFetch=!0)}else this.m_stopRowHeaderFetch=!0;if(this.m_endRowHeader<0?(this._hideHeader(c),this.m_stopRowHeaderFetch=!0,this.m_startRowHeader=0):(this.m_hasRowHeader=!0,this._buildHeaderLabels(m,e)),null!=i){let e;_=i.start,(this._isHighWatermarkScrolling()||d||!this._isHighWatermarkScrolling()&&!this._hasFrozenRows())&&(e=y,_=f),this.buildRowEndHeaders(u,i,_,g,s,!1,e,!1),this.m_initialized&&!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&0===this.m_startRowEndHeader&&(this.m_startRowEndHeader=this.m_frozenRowIndex+1),(i.getCount()<t.count||a&&a>0&&a===_+i.getCount())&&(this.m_stopRowEndHeaderFetch=!0)}else this.m_stopRowEndHeaderFetch=!0;this.m_endRowEndHeader<0?(this._hideHeader(u),this.m_stopRowEndHeaderFetch=!0,this.m_startRowEndHeader=0):(this.m_hasRowEndHeader=!0,this._buildHeaderLabels("rowEnd",i))}this.updateMaxYet(),this.isFetchComplete()&&(this.hideStatusText(),this._shouldInitialize()&&!s&&this._handleInitialization(!0)),this.m_initialized&&(this.isSkeletonSupport()&&this.loadSkeletonsOnHeaderLoad(m,_,e,i),this._sizeDatabodyScroller()),this._signalTaskEnd()},A.prototype._calculateFrozenIndex=function(e,t){let i=e;if(t&&t.length){let e=0;for(let i=0;i<t.length;i++){let s=t[i];0===this._getAttribute(s,"level",10)&&(e+=this._getAttribute(s,"extent",10))}i=e}return i},A.prototype.handleHeadersFetchError=function(e,t){var i=t.axis;this.m_fetching[i]=!1,this._signalTaskEnd()},A.prototype.createHeaderContext=function(e,t,i,s,o,n,r,l,a){var h={axis:e,index:t,data:i};h.component=this,h.datasource=this.m_options.getProperty("data"),h.level=n,h.depth=l,h.extent=r,!a||"row"!==e&&"column"!==e||(h.contentElement=a),null!=o&&(h.parentElement=o);for(var d=Object.keys(s),m=0;m<d.length;m++){var c=d[m];h[c]=s[c]}return null!=this.m_createContextCallback&&this.m_createContextCallback.call(this,h),this.m_fixContextCallback.call(this,h)},A.prototype._createLabelContext=function(e,t,i,s,o,n){var r={axis:e,level:t,data:i};if(r.component=this,r.datasource=this.m_options.getProperty("data"),!n||"row"!==e&&"column"!==e||(r.contentElement=n),null!=s&&(r.parentElement=s),null!=this.m_createContextCallback&&this.m_createContextCallback.call(this,r),this._isDataGridProvider()&&null!=o)for(var l=Object.keys(o),a=0;a<l.length;a++){var h=l[a];r[h]=o[h]}return this.m_fixContextCallback.call(this,r)},A.prototype._buildHeaderLabels=function(e,t){if(0===this.m_headerLabels[e].length&&t&&t.getLabel){var i,s=t.getLevelCount();"rowEnd"===e?i=this.getResources().isRTLMode()?"left":"right":"row"===e?i=this.getResources().isRTLMode()?"right":"left":"column"===e?i="top":"columnEnd"===e&&(i="bottom");var o=0;if(s>0)for(var n=0;n<s;n++){var r,l=document.createElement("div"),a=t.getLabel(n);this._isDataGridProvider()&&(r=t.getLabelMetadata(n));var h=this._getLabelDimension(e,n);let s;if("row"!==e&&"column"!==e||(s=document.createElement("div"),s.classList.add(this.getMappedStyle("headerLabelCellContent"))),null!=a){var d=this._createLabelContext(e,n,a,l,r,s);l.setAttribute(this.getResources().getMappedAttribute("container"),this.getResources().widgetName),l.setAttribute(this.getResources().getMappedAttribute("busyContext"),""),this._createUniqueId(l),l[this.getResources().getMappedAttribute("context")]=d;const t=this.m_options.getHorizontalAlignment(e,d,!0),p=this.m_options.getVerticalAlignment(e,d,!0);if("auto"!==t){const e=this._getHorizontalAlignmentStyle(t);l.style.justifyContent=e.justifyContent,l.style.textAlign=e.textAlign}"auto"!==p&&(l.style.alignItems=this._getVerticalAlignmentStyle(p));var m=this.m_options.getInlineStyle(e,d,!0);null!=m&&u.applyMergedInlineStyles(l,m,""),l.className=this.getMappedStyle("headerlabel")+" "+this.getMappedStyle(e.toLowerCase()+"headerlabel");var c=this.m_options.getStyleClass(e,d,!0);null!=c&&(l.className+=" "+c),"row"===e||"rowEnd"===e?("rowEnd"===e&&(l.style.height="100%"),this.setElementWidth(l,h),this.setElementDir(l,o,i),this.setElementDir(l,0,"bottom")):("columnEnd"===e&&(l.style.width="100%"),this.setElementHeight(l,h),this.setElementDir(l,o,i),this.setElementDir(l,0,this.getResources().isRTLMode()?"left":"right")),"enable"!==this.m_options.isResizable(e,"width")&&"enable"!==this.m_options.isResizable(e,"height")||this._setAttribute(l,"resizable","true");var _=this.getRendererOrTemplate(e,!0);if(this._renderContent(_,d,l,a,this.buildLabelTemplateContext(d,r||{})),this.m_headerLabels[e][n]=l,this._isDataGridProvider()&&this._isSortEnabled(e,d,!0)){const i=this._shouldAppendIcon(t,e,d);if(null!=r.metadata.sortDirection&&"unsorted"!==r.metadata.sortDirection){const t={level:d.level,axis:e,direction:r.metadata.sortDirection};"column"===e&&null==this.m_sortRowInfo?(this.m_sortRowInfo=t,this.m_sortRowInfo.type="label"):"row"===e&&null==this.m_sortColumnInfo&&(this.m_sortColumnInfo=t,this.m_sortColumnInfo.type="label")}var g=this._buildLabelSortIcon(d,l,e);i?l.appendChild(g):l.prepend(g),this._setAttribute(l,"sortable","true")}}o+=h}}},A.prototype.buildLabelTemplateContext=function(e,t){return{item:{data:e.data,metadata:t.metadata},datasource:e.datasource}},A.prototype.buildHeaderTemplateContext=function(e,t){return{item:{data:e.data,depth:e.depth,extent:e.extent,index:e.index,level:e.level,metadata:t.metadata,axis:e.axis},datasource:e.datasource}},A.prototype.buildCellTemplateContext=function(e,t){return{item:{columnExtent:e.extents.column,columnIndex:e.indexes.column,data:e.data,metadata:t.metadata,rowExtent:e.extents.row,rowIndex:e.indexes.row},datasource:e.datasource,mode:e.mode}},A.prototype.getRendererOrTemplate=function(e,t){var i,s,o=this.m_options.getRenderer(e,t);return o||(i="cell"===e?"cellTemplate":t?e+"HeaderLabelTemplate":e+"HeaderTemplate",(s=this._getItemTemplateBySlotName(i))||(("row"===e||"column"===e)&&(i=t?e+"HeaderLabelContentTemplate":e+"HeaderContentTemplate",s=this._getItemTemplateBySlotName(i))?s:null))},A.prototype.buildColumnHeaders=function(e,t,i,s,o,n,r,l){if(null==this.m_columnHeaderLevelCount&&(this.m_columnHeaderLevelCount=t.getLevelCount()),0===this.m_columnHeaderLevelCount)return;let a=r;void 0===a&&(a=t.getCount());var h=i>this.m_endColHeader;var d=h?this.m_endColHeaderPixel:this.m_startColHeaderPixel,m=this.m_endColHeader,c=this.m_columnHeaderLevelCount,u=this.getMappedStyle("colheader")+" "+this.getMappedStyle("header"),_=this.getMappedStyle("headercell")+" "+this.getMappedStyle("colheadercell");l&&(_+=` ${this.getMappedStyle("frozenHeader")}`);var g=this.buildAxisHeaders(e,t,"column",i,a,h,false,null,d,m,c,u,_,false),p=g.totalHeaderDimension,f=g.totalLevelDimension;if(0===p||0!==this.m_avgColWidth&&null!=this.m_avgColWidth||(this.m_avgColWidth=p/g.visibleHeaderCount),this.m_colHeaderHeight||(this.m_colHeaderHeight=f,this.setElementHeight(e,this.m_colHeaderHeight)),!this._isHighWatermarkScrolling()&&l)return;h?(this.m_endColHeader=i+a-1,this.m_endColHeaderPixel+=p):(this.m_startColHeader-=a,this.m_startColHeaderPixel-=p),-1===s&&(s=this.m_endColHeader),!this._isCountUnknown("column")&&this._isHighWatermarkScrolling()&&this.m_endColHeader+1>=s?this.m_stopColumnHeaderFetch=!0:this.m_stopColumnHeaderFetch=g.stopFetch;let C=0;if(!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&(C=this.m_frozenColIndex+1),this.m_startColHeader===C&&0!==this.m_startColHeaderPixel&&(this._shiftHeadersAlongAxisInContainer(e.firstChild,C,-1*this.m_startColHeaderPixel,this.getResources().isRTLMode()?"right":"left",this.getMappedStyle("colheadercell")),this.m_endColHeaderPixel-=this.m_startColHeaderPixel,this.m_startColHeaderPixel=0),!this.m_initialized&&this.m_startColHeader>0){let t=this._getHiddenCountBeforeIndex(this.m_startColHeader,"column"),i=Math.round(this.m_avgColWidth*(this.m_startColHeader-t));!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&this.m_startColHeader===this.m_frozenColIndex+1&&(i=Math.round(this.m_avgColWidth*(this.m_startColHeader-t-(this.m_frozenColIndex+1)+this._getHiddenCountBeforeIndex(this.m_frozenColIndex+1,"column")))),this._shiftHeadersAlongAxisInContainer(e.firstChild,this.m_startColHeader,i-this.m_startColHeaderPixel,this.getResources().isRTLMode()?"right":"left",this.getMappedStyle("colheadercell")),this.m_endColHeaderPixel=i+p,this.m_startColHeaderPixel=i}},A.prototype.buildColumnEndHeaders=function(e,t,i,s,o,n,r,l){if(null==this.m_columnEndHeaderLevelCount&&(this.m_columnEndHeaderLevelCount=t.getLevelCount()),0===this.m_columnEndHeaderLevelCount)return;let a=r;void 0===a&&(a=t.getCount());var h=i>this.m_endColEndHeader;var d=h?this.m_endColEndHeaderPixel:this.m_startColEndHeaderPixel,m=this.m_endColEndHeader,c=this.m_columnEndHeaderLevelCount,u=this.getMappedStyle("colendheader")+" "+this.getMappedStyle("endheader"),_=this.getMappedStyle("endheadercell")+" "+this.getMappedStyle("colendheadercell");l&&(_+=` ${this.getMappedStyle("frozenHeader")}`);var g=this.buildAxisHeaders(e,t,"columnEnd",i,a,h,false,null,d,m,c,u,_,false),p=g.totalHeaderDimension,f=g.totalLevelDimension;if(0===p||0!==this.m_avgColWidth&&null!=this.m_avgColWidth||(this.m_avgColWidth=p/g.visibleHeaderCount),this.m_colEndHeaderHeight||(this.m_colEndHeaderHeight=f,this.setElementHeight(e,this.m_colEndHeaderHeight)),!this._isHighWatermarkScrolling()&&l)return void(this.m_endFrozenColEndHeaderPixel=p);h?(this.m_endColEndHeader=i+(a-1),this.m_endColEndHeaderPixel+=p):(this.m_startColEndHeader-=a,this.m_startColEndHeaderPixel-=p),-1===s&&(s=this.m_endColEndHeader),!this._isCountUnknown("column")&&this._isHighWatermarkScrolling()&&this.m_endColEndHeader+1>=s?this.m_stopColumnEndHeaderFetch=!0:this.m_stopColumnEndHeaderFetch=g.stopFetch;let C=0;if(!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&(C=this.m_frozenColIndex+1),this.m_startColEndHeader===C&&0!==this.m_startColEndHeaderPixel&&(this._shiftHeadersAlongAxisInContainer(e.firstChild,C,-1*this.m_startColEndHeaderPixel,this.getResources().isRTLMode()?"right":"left",this.getMappedStyle("colendheadercell")),this.m_endColEndHeaderPixel-=this.m_startColEndHeaderPixel,this.m_startColEndHeaderPixel=0),!this.m_initialized&&this.m_startColEndHeader>0){let t=this._getHiddenCountBeforeIndex(this.m_startColEndHeader,"columnEnd"),i=Math.round(this.m_avgColWidth*(this.m_startColEndHeader-t));!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&this.m_startColEndHeader===this.m_frozenColIndex+1&&(i=Math.round(this.m_avgColWidth*(this.m_startColEndHeader-t-(this.m_frozenColIndex+1)+this._getHiddenCountBeforeIndex(this.m_frozenColIndex+1,"column")))),this._shiftHeadersAlongAxisInContainer(e.firstChild,this.m_startColEndHeader,i-this.m_startColEndHeaderPixel,this.getResources().isRTLMode()?"right":"left",this.getMappedStyle("colendheadercell")),this.m_endColEndHeaderPixel=i+p,this.m_startColEndHeaderPixel=i}},A.prototype.buildRowHeaders=function(e,t,i,s,o,n,r,l){if(null==this.m_rowHeaderLevelCount&&(this.m_rowHeaderLevelCount=t.getLevelCount()),0===this.m_rowHeaderLevelCount)return;let a=r;void 0===a&&(a=t.getCount());var h,d=i>this.m_endRowHeader,m=d?this.m_endRowHeaderPixel:this.m_startRowHeaderPixel;o?(h=e.firstChild.childNodes[i-this.m_startRowHeader],m=this.getElementDir(h,"top")):h=null;var c=this.m_endRowHeader,u=this.m_rowHeaderLevelCount,_=this.getMappedStyle("rowheader")+" "+this.getMappedStyle("header"),g=this.getMappedStyle("headercell")+" "+this.getMappedStyle("rowheadercell");l&&(g+=` ${this.getMappedStyle("frozenHeader")}`);var p=this.buildAxisHeaders(e,t,"row",i,a,d,o,h,m,c,u,_,g,n),f=p.totalHeaderDimension,C=p.totalLevelDimension;if(n)return p;if(0===f||0!==this.m_avgRowHeight&&null!=this.m_avgRowHeight||(this.m_avgRowHeight=f/p.visibleHeaderCount),this.m_rowHeaderWidth||(this.m_rowHeaderWidth=C,this.setElementWidth(e,this.m_rowHeaderWidth)),!this._isHighWatermarkScrolling()&&l)return;if(d){if(-1!==this.m_endRowHeader&&0!==a){var y=e.firstChild.childNodes[this.m_endRowHeader-this.m_startRowHeader];null!=y&&this.m_utils.removeCSSClassName(y,this.getMappedStyle("borderHorizontalNone"))}this.m_endRowHeader=i+(a-1),this.m_endRowHeaderPixel+=f}else o?(i<this.m_startRowHeader&&(this.m_startRowHeader=i,this.m_startRowHeaderPixel=Math.max(0,this.m_startRowHeaderPixel-f)),this.m_endRowHeader+=a,this.m_endRowHeaderPixel=Math.max(0,this.m_endRowHeaderPixel+f),this.pushRowHeadersDown(h,f)):(this.m_startRowHeader=Math.max(0,this.m_startRowHeader-a),this.m_startRowHeaderPixel-=f);-1===s&&(s=this.m_endRowHeader),!this._isCountUnknown("row")&&this._isHighWatermarkScrolling()&&this.m_endRowHeader+1>=s?this.m_stopRowHeaderFetch=!0:this.m_stopRowHeaderFetch=p.stopFetch;let w=0;if(!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&(w=this.m_frozenRowIndex+1),this.m_startRowHeader===w&&0!==this.m_startRowHeaderPixel&&(this._shiftHeadersAlongAxisInContainer(e.firstChild,w,-1*this.m_startRowHeaderPixel,"top",this.getMappedStyle("rowheadercell")),this.m_endRowHeaderPixel-=this.m_startRowHeaderPixel,this.m_startRowHeaderPixel=0),!this.m_initialized&&this.m_startRowHeader>0){let t=this._getHiddenCountBeforeIndex(this.m_startRowHeader,"row"),i=Math.round(this.m_avgRowHeight*(this.m_startRowHeader-t));!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&this.m_startRowHeader===this.m_frozenRowIndex+1&&(i=Math.round(this.m_avgRowHeight*(this.m_startRowHeader-t-(this.m_frozenRowIndex+1)+this._getHiddenCountBeforeIndex(this.m_frozenRowIndex+1,"row")))),this._shiftHeadersAlongAxisInContainer(e.firstChild,this.m_startRowHeader,i-this.m_startRowHeaderPixel,"top",this.getMappedStyle("rowheadercell")),this.m_endRowHeaderPixel=i+f,this.m_startRowHeaderPixel=i}},A.prototype.buildRowEndHeaders=function(e,t,i,s,o,n,r,l){if(null==this.m_rowEndHeaderLevelCount&&(this.m_rowEndHeaderLevelCount=t.getLevelCount()),0===this.m_rowEndHeaderLevelCount)return;let a=r;void 0===a&&(a=t.getCount());var h,d=i>this.m_endRowEndHeader,m=d?this.m_endRowEndHeaderPixel:this.m_startRowEndHeaderPixel;o?(h=e.firstChild.childNodes[i-this.m_startRowEndHeader],m=this.getElementDir(h,"top")):h=null;var c=this.m_endRowEndHeader,u=this.m_rowEndHeaderLevelCount,_=this.getMappedStyle("rowendheader")+" "+this.getMappedStyle("endheader"),g=this.getMappedStyle("endheadercell")+" "+this.getMappedStyle("rowendheadercell");l&&(g+=` ${this.getMappedStyle("frozenHeader")}`);var p=this.buildAxisHeaders(e,t,"rowEnd",i,a,d,o,h,m,c,u,_,g,n);if(n)return p;var f=p.totalHeaderDimension,C=p.totalLevelDimension;if(!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&p.visibleHeaderCount>a&&(a=p.visibleHeaderCount),0===f||0!==this.m_avgRowHeight&&null!=this.m_avgRowHeight||(this.m_avgRowHeight=f/a),this.m_rowEndHeaderWidth||(this.m_rowEndHeaderWidth=C,this.setElementWidth(e,this.m_rowEndHeaderWidth)),!this._isHighWatermarkScrolling()&&l)return;if(d){if(-1!==this.m_endRowEndHeader&&0!==a){var y=e.firstChild.childNodes[this.m_endRowEndHeader-this.m_startRowEndHeader];null!=y&&this.m_utils.removeCSSClassName(y,this.getMappedStyle("borderHorizontalNone"))}this.m_endRowEndHeader=i+(a-1),this.m_endRowEndHeaderPixel+=f}else o?(i<this.m_startRowEndHeader&&(this.m_startRowEndHeader=i,this.m_startRowEndHeaderPixel=Math.max(0,this.m_startRowEndHeaderPixel-f)),this.m_endRowEndHeader+=a,this.m_endRowEndHeaderPixel=Math.max(0,this.m_endRowEndHeaderPixel+f),this.pushRowHeadersDown(h,f)):(this.m_startRowEndHeader=Math.max(0,this.m_startRowEndHeader-a),this.m_startRowEndHeaderPixel-=f);-1===s&&(s=this.m_endRowEndHeader),!this._isCountUnknown("row")&&this._isHighWatermarkScrolling()&&this.m_endRowEndHeader+1>=s?this.m_stopRowEndHeaderFetch=!0:this.m_stopRowEndHeaderFetch=p.stopFetch;let w=0;if(!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&(w=this.m_frozenRowIndex+1),this.m_startRowEndHeader===w&&0!==this.m_startRowEndHeaderPixel&&(this._shiftHeadersAlongAxisInContainer(e.firstChild,w,-1*this.m_startRowEndHeaderPixel,"top",this.getMappedStyle("rowendheadercell")),this.m_endRowEndHeaderPixel-=this.m_startRowEndHeaderPixel,this.m_startRowEndHeaderPixel=0),!this.m_initialized&&this.m_startRowEndHeader>0){let t=this._getHiddenCountBeforeIndex(this.m_startRowEndHeader,"rowEnd"),i=Math.round(this.m_avgRowHeight*(this.m_startRowEndHeader-t));!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&this.m_startRowEndHeader===this.m_frozenRowIndex+1&&(i=Math.round(this.m_avgRowHeight*(this.m_startRowEndHeader-t-(this.m_frozenRowIndex+1)+this._getHiddenCountBeforeIndex(this.m_frozenRowIndex+1,"row")))),this._shiftHeadersAlongAxisInContainer(e.firstChild,this.m_startRowEndHeader,i-this.m_startRowEndHeaderPixel,"top",this.getMappedStyle("rowendheadercell")),this.m_endRowEndHeaderPixel=i+f,this.m_startRowEndHeaderPixel=i}},A.prototype.buildAxisHeaders=function(e,t,i,s,o,n,r,l,a,h,d,m,c,u){var _,g,p=-1!==i.indexOf("column"),f=p?"height":"width",C=!1,y=0,w=0,E=0,v=0;let x=0;if(!u){if(0===o&&this._isCountUnknown(i))return{totalHeaderDimension:y,totalLevelDimension:w,stopFetch:C=!0};_=e.firstChild,-1===h&&""===e.className&&(e.className=m,e.style[f]="",_.style[f]="")}var H=this.getRendererOrTemplate(i),b=document.createDocumentFragment(),S=0;let R=0;for(;o-S>0;){n||r?(g=s+S,E=p?a+y:0,v=p?0:a+y):(g=s+(o-1-S),E=p?a-y:0,v=p?0:a-y),this.isHidden(i,g)&&(x+=1);var I=this.buildLevelHeaders(b,g,0,E,v,n,r,H,t,i,c,d);S+=I.count,R=Math.max(R,I.count),y+=I.totalHeaderDimension,I.totalLevelDimension>w&&(w=I.totalLevelDimension)}return u?b:(n?_.appendChild(b):r?_.insertBefore(b,l):_.insertBefore(b,_.firstChild),e.hasChildNodes()||r||e.appendChild(_),this.m_subtreeAttachedCallback(_),this._isHighWatermarkScrolling()||-1===c.split(" ").indexOf(this.getMappedStyle("frozenHeader"))||(o=R>o?R:o),{totalHeaderDimension:y,totalLevelDimension:w,stopFetch:C,visibleHeaderCount:o-x})},A.prototype._renderContent=function(e,t,i,s,o){let n=!1,r=t.contentElement;if(null!=e&&"function"==typeof e){const s=e.call(this,t);let o=i,l=s;null!=s?.insert?l=s.insert:null!=r&&(null!=s?.insertContent?(o=r,l=s.insertContent,n=!0):r.hasChildNodes()&&(n=!0),n&&i.appendChild(r)),u.applyRendererContent(o,l,!1,this.m_isCustomElementCallback()?null:this.m_subtreeAttachedCallback),this._removeFocusFromChildElements(t,i)}else if(null!=e&&"object"==typeof e&&this.m_engine){var l=this.m_engine.execute(this.m_root,e,o,null);n="columnHeaderContentTemplate"===e.slot||"rowHeaderContentTemplate"===e.slot||"columnHeaderLabelContentTemplate"===e.slot||"rowHeaderLabelContentTemplate"===e.slot;for(var a=0;a<l.length;a++)n?r.appendChild(l[a]):i.appendChild(l[a]);n&&i.appendChild(r),this._removeFocusFromChildElements(t,i)}else null!=s&&"object"==typeof s&&Object.prototype.hasOwnProperty.call(s,"data")&&(s=s.data),null==s&&(s=""),r?(r.appendChild(document.createTextNode(s.toString())),i.appendChild(r)):i.appendChild(document.createTextNode(s.toString()))},A.prototype._removeFocusFromChildElements=function(e,t){if("edit"!==e.mode){var i=this;this._signalTaskStart(),this.m_contextCallback(t).getBusyContext().whenReady().then(function(){u.disableAllFocusableElements(t),i._signalTaskEnd()})}},A.prototype.buildLevelHeaders=function(e,t,i,s,o,n,r,l,a,h,d,m){var c,_,g,p,f,C,y,w,E,v,x,H,b,S,R,I=0,z=0,F=0,M=0;let A;"row"===h?(c="row",_=this.m_rowHeader,g="width",p=this.m_rowHeaderLevelWidths,f="height",C="top",y=o,w=this.getResources().isRTLMode()?"right":"left",E=s,v=this.m_startRowHeader,x=this.m_endRowHeader,this._hasFrozenRows()&&t<=this.m_frozenRowIndex&&this.m_rowHeaderFrozen&&(_=this.m_rowHeaderFrozen)):"rowEnd"===h?(c="row",_=this.m_rowEndHeader,g="width",p=this.m_rowEndHeaderLevelWidths,f="height",C="top",y=o,w=this.getResources().isRTLMode()?"left":"right",E=s,v=this.m_startRowEndHeader,x=this.m_endRowEndHeader,this._hasFrozenRows()&&t<=this.m_frozenRowIndex&&this.m_rowEndHeaderFrozen&&(_=this.m_rowEndHeaderFrozen)):"column"===h?(c="column",_=this.m_colHeader,g="height",p=this.m_columnHeaderLevelHeights,f="width",C=this.getResources().isRTLMode()?"right":"left",y=s,w="top",E=o,v=this.m_startColHeader,x=this.m_endColHeader,this._hasFrozenColumns()&&t<=this.m_frozenColIndex&&this.m_colHeaderFrozen&&(_=this.m_colHeaderFrozen)):(c="column",_=this.m_colEndHeader,g="height",p=this.m_columnEndHeaderLevelHeights,f="width",C=this.getResources().isRTLMode()?"right":"left",y=s,w="bottom",E=o,v=this.m_startColEndHeader,x=this.m_endColEndHeader,this._hasFrozenColumns()&&t<=this.m_frozenColIndex&&this.m_colEndHeaderFrozen&&(_=this.m_colEndHeaderFrozen)),A=this.isHidden(h,t);var D=a.getExtent(t,i),L=D.extent,T=D.more.before,N=D.more.after,k=a.getDepth(t,i);let O;if(T&&t===x+1){for(H=this._getHeaderContainer(t-1,i,_,m),this._setAttribute(H,"extent",this._getAttribute(H,"extent",!0)+L),O=(b=H.firstChild)[this.getResources().getMappedAttribute("context")],O.extent+=L,I=this.getElementDir(b,g),S=0;S<L;)y+=(R="column"===h||"columnEnd"===h?this.buildLevelHeaders(H,t+S,i+k,y,E+I,n,r,l,a,h,d,m):this.buildLevelHeaders(H,t+S,i+k,E+I,y,n,r,l,a,h,d,m)).totalHeaderDimension,F+=R.totalHeaderDimension,M+=R.count,S+=R.count;this.setElementDir(b,this.getElementDir(b,f)+F,f),"none"===b.style.display&&0!==F&&(b.style.display="",this.deleteAndApplyHiddenIndicators())}else if(N&&t===v-1){for(H=this._getHeaderContainer(t+1,i,_,m),this._setAttribute(H,"extent",this._getAttribute(H,"extent",!0)+L),this._setAttribute(H,"start",this._getAttribute(H,"start",!0)-L),O=(b=H.firstChild)[this.getResources().getMappedAttribute("context")],O.extent+=L,O.index-=L,I=this.getElementDir(b,g),S=0;S<L;)y-=(R="column"===h||"columnEnd"===h?this.buildLevelHeaders(H,t-S,i+k,y,E+I,n,r,l,a,h,d,m):this.buildLevelHeaders(H,t-S,i+k,E+I,y,n,r,l,a,h,d,m)).totalHeaderDimension,F+=R.totalHeaderDimension,M+=R.count,S+=R.count;this.setElementDir(b,this.getElementDir(b,f)+F,f),"none"===b.style.display&&0!==F&&(b.style.display="",this.deleteAndApplyHiddenIndicators()),this.setElementDir(b,y,C)}else{var P=a.getData(t,i),W=a.getMetadata(t,i);let s;b=document.createElement("div"),"row"!==h&&"column"!==h||(s=document.createElement("div"),s.classList.add(this.getMappedStyle("headerCellContent"))),O=this.createHeaderContext(h,n||r?t:t-L+1,P,W,b,i,L,k,s),b.setAttribute(this.getResources().getMappedAttribute("container"),this.getResources().widgetName),b.setAttribute(this.getResources().getMappedAttribute("busyContext"),""),this._createUniqueId(b),b[this.getResources().getMappedAttribute("context")]=O,b[this.getResources().getMappedAttribute("metadata")]=W,b.extentInfo=D;var B=this.m_options.getInlineStyle(h,O),j=this.m_options.getStyleClass(h,O);null!=B&&u.applyMergedInlineStyles(b,B,""),b.className=d,b.className+=" "+this.getMappedStyle("depth")+k,null!=j&&(b.className+=" "+j),this.setElementDir(b,E,w),this.setElementDir(b,y,C);var K=this._getHeaderDimensions(b,f,g,p,i,c,O.key,k);I=K[g],this.setElementDir(b,I,g);var V=K[f];if(this._setAttribute(b,"depth",k),i!==m-1&&((H=document.createElement("div")).className=this.getMappedStyle("groupingcontainer"),H.appendChild(b),this._setAttribute(H,"start",n||r?t:t-L+1),this._setAttribute(H,"extent",L),this._setAttribute(H,"level",i)),i+k===m)A&&(V=0,b.style.display="none"),this.setElementDir(b,V,f),F+=V,M+=1,z=I,n||r||(y-=V,this.setElementDir(b,y,C));else{for(S=0;S<L;S++){var U=n||r?t+S:t-S;V=(R="column"===h||"columnEnd"===h?this.buildLevelHeaders(H,U,i+k,y,E+I,n,r,l,a,h,d,m):this.buildLevelHeaders(H,U,i+k,E+I,y,n,r,l,a,h,d,m)).totalHeaderDimension,y=n||r?y+V:y-V,F+=V,M+=R.count,S+=R.count-1}z=I,R&&!isNaN(R.totalLevelDimension)&&(z+=R.totalLevelDimension),n||r||this.setElementDir(b,y,C),this.setElementDir(b,F,f),this.isHeaderHidden(b)&&(b.style.display="none")}"columnEnd"===h&&this.m_addBorderBottom&&this.m_utils.addCSSClassName(b,this.getMappedStyle("borderHorizontalSmall")),"rowEnd"===h&&this.m_addBorderRight&&this.m_utils.addCSSClassName(b,this.getMappedStyle("borderVerticalSmall")),this._isHeaderResizeEnabled(h,O)&&this._setAttribute(b,"resizable","true"),this.m_isCustomElementCallback()||(null!=H?this.m_root.appendChild(H):this.m_root.appendChild(b));const o=this.m_options.getHorizontalAlignment(h,O),_=this.m_options.getVerticalAlignment(h,O);if(this._renderContent(l,O,b,P,this.buildHeaderTemplateContext(O,W)),"auto"!==o){const e=this._getHorizontalAlignmentStyle(o);b.style.justifyContent=e.justifyContent,b.style.textAlign=e.textAlign}"auto"!==_&&(b.style.alignItems=this._getVerticalAlignmentStyle(_));const v=this._shouldAppendIcon(o,h,O);if(this._isRequired(O)){var Y=document.createElement("span");this.m_utils.addCSSClassName(Y,this.getMappedStyle("iconContainer")),this.m_utils.addCSSClassName(Y,this.getMappedStyle("requiredIcon")),Y.setAttribute("title",this.getResources().getTranslatedText("tooltipRequired")),b.appendChild(Y)}if(("column"===h||this._isDataGridProvider())&&this._isSortEnabled(h,O)){this._isDataGridProvider()?null!=W.sortDirection&&("column"===h&&null==this.m_sortColumnInfo||"row"===h&&null==this.m_sortRowInfo)&&("row"===h?(this.m_sortRowInfo={},this.m_sortRowInfo.key=W.key,this.m_sortRowInfo.direction=W.sortDirection,this.m_sortRowInfo.axis=h,this.m_sortRowInfo.type="header"):(this.m_sortColumnInfo={},this.m_sortColumnInfo.key=W.key,this.m_sortColumnInfo.direction=W.sortDirection,this.m_sortColumnInfo.axis=h,this.m_sortColumnInfo.type="header")):null!=W.sortDirection&&null==this.m_sortColumnInfo&&(this.m_sortColumnInfo={},this.m_sortColumnInfo.key=W.key,this.m_sortColumnInfo.direction=W.sortDirection,this.m_sortColumnInfo.axis=h);var G=this._buildSortIcon(O,b,h);v?b.appendChild(G):b.insertBefore(G,b.childNodes[0]),this._setAttribute(b,"sortable","true")}if("column"===h&&this._isFilterEnabled(h,O)){const e=this._buildFilterIcon(O,b,h);v?b.appendChild(e):b.insertBefore(e,b.childNodes[0]),this._setAttribute(b,"filterable","true")}if(this._isParentNode(O)){const e=this._buildDisclosureIcon(O);this._isHierarchicalGroup(O)?this.m_utils.addCSSClassName(b,this.getMappedStyle("hierarchicalGroup")):this.m_utils.addCSSClassName(b,this.getMappedStyle("hierarchicalTree")),b.prepend(e);const t=this._buildSpacer(O);b.prepend(t)}else if(this._isLeafNode(O)){this.m_utils.addCSSClassName(b,this.getMappedStyle("hierarchical"));const e=this._buildSpacer(O);b.prepend(e)}n||r?null!=H?e.appendChild(H):e.appendChild(b):null!=H?e.firstChild?this.m_utils.containsCSSClassName(e.firstChild,this.getMappedStyle("groupingcontainer"))?e.insertBefore(H,e.firstChild):(this.m_utils.containsCSSClassName(e.firstChild,this.getMappedStyle("headercell"))||this.m_utils.containsCSSClassName(e.firstChild,this.getMappedStyle("endheadercell")))&&e.insertBefore(H,e.firstChild.nextSibling):e.appendChild(H):this.m_utils.containsCSSClassName(e,this.getMappedStyle("groupingcontainer"))?e.insertBefore(b,e.firstChild.nextSibling):e.insertBefore(b,e.firstChild)}return"column"===h||"columnEnd"===h?this._isLastColumn(t+(L-1))&&this.m_utils.addCSSClassName(b,this.getMappedStyle("borderVerticalNone")):this._isLastRow(t+(L-1))&&!r&&this.m_utils.addCSSClassName(b,this.getMappedStyle("borderHorizontalNone")),{totalLevelDimension:z,totalHeaderDimension:F,count:M}},A.prototype._getHeaderDimensions=function(e,t,i,s,o,n,r,l){for(var a={},h=0,d=0;d<l;d++){var m=s[o+d];if(null==m){h=null;break}h+=m}null==h?a=this._computeElementWidthAndHeight(e):a[i]=h,1===l&&(s[o]=a[i]);var c=this.m_sizingManager.getSize(n,r);if(null!=c)return a[t]=c,a;if(""!==e.style[t])return null==a[t]&&(a[t]=this.getElementDir(e,t)),this.m_sizingManager.setSize(n,r,a[t]),a;var u=e.className;return null==a[t]&&(a[t]=this.m_styleClassDimensionMap[t][u],null==a[t]&&(a[t]=this.getElementDir(e,t))),this.m_sizingManager.setSize(n,r,a[t]),this.m_styleClassDimensionMap[t][u]=a[t],a},A.prototype._getHeaderLevelDimension=function(e,t,i,s,o){for(var n=0,r=0;r<o;r++){var l=i[e+r];if(null==l){n=null;break}n+=l}return null!=n||(n=this.getElementDir(t,s),1===o&&(i[e]=n)),n},A.prototype._getHeaderContainer=function(e,t,i,s){const o=i.querySelectorAll(`.${this.getMappedStyle("groupingcontainer")}`);for(let i=0;i<o.length;i++){const n=this._getAttribute(o[i],"start",!0),r=this._getAttribute(o[i],"extent",!0),l=this._getAttribute(o[i],"level",!0),a=this._getAttribute(o[i].firstChild,"depth",!0);if(e>=n&&e<n+r&&(t>=l&&t<l+a||t===s-1&&t===l+a))return o[i]}return null},A.prototype._getChildElementCountByClassName=function(e,t){if(null==e)return 0;let i=0;return t&&(i+=Array.from(e.children).filter(e=>this.m_utils.containsCSSClassName(e,t)).length),i},A.prototype._getHeaderPreviousSibling=function(e){if(!e||!e.previousSibling)return null;const t=this.getMappedStyle("headercell"),i=this.getMappedStyle("endheadercell"),s=this.getMappedStyle("groupingcontainer"),o=e.previousSibling;return o.classList.contains(t)||o.classList.contains(i)||o.classList.contains(s)?o:this._getHeaderPreviousSibling(o)},A.prototype._getHeaderLastChild=function(e){let t=e.lastChild;const i=this.getMappedStyle("headercell"),s=this.getMappedStyle("endheadercell"),o=this.getMappedStyle("groupingcontainer");if(!t)return null;for(;t&&!(t.classList.contains(i)||t.classList.contains(s)||t.classList.contains(o));)t=t.previousSibling;return t},A.prototype._getHeaderByIndex=function(e,t,i){let s=this._getHeaderDetails(e,t),o=s.root,n=s.totalLevels,r=s.startIndex;return this._getHeaderByIndexFromRoot(e,i,o,n,r)},A.prototype._getHeaderDetails=function(e,t){let i,s,o,n,r,l;return"column"===t?(i=this.m_colHeader,s=this.m_columnHeaderLevelCount,o=this.m_startColHeader,n=this.m_colHeaderFrozen,r=this._hasFrozenColumns(),l=this.m_frozenColIndex):"columnEnd"===t?(i=this.m_colEndHeader,s=this.m_columnEndHeaderLevelCount,o=this.m_startColEndHeader,n=this.m_colEndHeaderFrozen,r=this._hasFrozenColumns(),l=this.m_frozenColIndex):"row"===t?(i=this.m_rowHeader,s=this.m_rowHeaderLevelCount,o=this.m_startRowHeader,n=this.m_rowHeaderFrozen,r=this._hasFrozenRows(),l=this.m_frozenRowIndex):"rowEnd"===t&&(i=this.m_rowEndHeader,s=this.m_rowEndHeaderLevelCount,o=this.m_startRowEndHeader,n=this.m_rowEndHeaderFrozen,r=this._hasFrozenRows(),l=this.m_frozenRowIndex),r&&(this._isHighWatermarkScrolling()||!this._isHighWatermarkScrolling()&&("column"===t||"columnEnd"===t)&&0===this.m_startCol||("row"===t||"rowEnd"===t)&&0===this.m_startRow?e<=l?i=n:o+=l+1:e<=l&&(i=n,o=0)),{root:i,totalLevels:s,startIndex:o}},A.prototype._getHeadersByIndex=function(e,t){let i=[],s=this._getHeaderDetails(e,t),o=s.root,n=s.totalLevels,r=s.startIndex,l=1;for(let t=n-1;t>=0;t-=l){let s=this._getHeaderByIndexFromRoot(e,t,o,n,r);s&&(l=this.getHeaderCellDepth(s),i.push(s))}return i},A.prototype._getHeaderByIndexFromRoot=function(e,t,i,s,o){let n;if(t<0)return null;const r=i.querySelectorAll(`.${this.getMappedStyle("headercell")},.${this.getMappedStyle("endheadercell")}`);if(1===s)return n=e-o,r[n];for(let i=0;i<r.length;i++){const s=r[i][this.getResources().getMappedAttribute("context")],o=s.index,n=s.extent,l=s.depth,a=s.level;if(e>=o&&e<o+n&&t>=a&&t<a+l)return r[i]}return null},A.prototype._getAttribute=function(e,t,i){var s=e.getAttribute(this.getResources().getMappedAttribute(t));return i?parseInt(s,10):s},A.prototype._setAttribute=function(e,t,i){e.setAttribute(this.getResources().getMappedAttribute(t),i)},A.prototype.buildDatabody=function(e){let t,i,s,o=this._createDatabodyElement("databody");if(this.m_databody=o,this._hasFrozenColumns()&&this._hasFrozenRows()&&(s=this._createDatabodyElement("databodyFrozenCorner"),this.m_databodyFrozenCorner=s),this._hasFrozenColumns()&&(t=this._createDatabodyElement("databodyFrozenCol"),this.m_databodyFrozenCol=t),this._hasFrozenRows()&&(i=this._createDatabodyElement("databodyFrozenRow"),this.m_databodyFrozenRow=i),!e)if(o.addEventListener("scroll",this.handleScroll.bind(this),!1),this._isHighWatermarkScrolling()){this.fetchCells(o,0,0)}else{var n=this,r=this.m_options.getScrollPosition();this._getIndexesFromScrollPosition(r).then(function(e){var t=e.row,i=e.column;n._hasFrozenColumns()&&i<n.m_frozenColIndex+1&&(i=0),n._hasFrozenRows()&&t<n.m_frozenRowIndex+1&&(t=0),n.m_startRow=t,n.m_startCol=i,n.m_fetching.cells=!1,n.fetchCells(o,t,i,null,null)}),this.m_fetching.cells=!0}let l=[];return l.push(o),t&&l.push(t),i&&l.push(i),s&&l.push(s),l},A.prototype._createDatabodyElement=function(e){var t=document.createElement("div");t.id=this.createSubId(e),t.className=this.getMappedStyle(e)+" "+this.getMappedStyle("scrollbarForce"),t.tabIndex="-1";var i=document.createElement("div");return i.className=this.getMappedStyle("scroller"),t.appendChild(i),t},A.prototype._getIndexFromPosition=function(e,t){let i,s;"row"===e?(i=this.getDefaultRowHeight(),s={down:!0}):(i=this.getDefaultColumnWidth(),s={right:!0});let o=Math.round(t/i);return o+=this._getHiddenCountBeforeIndex(o,e),this.getVisibleCellIndexInDirection(e,o,s)},A.prototype._getIndexFromKeyPromise=function(e,t){var i=this;return new Promise(function(s){null!=e||null!=t?i._indexes({row:e,column:t},function(e){s({rowIndexFromKey:e.row,columnIndexFromKey:e.column})}):s({rowIndexFromKey:null,columnIndexFromKey:null})})},A.prototype._getIndexesFromScrollPosition=function(e){var t=this,i=e.rowKey,s=e.columnKey;return this._getIndexFromKeyPromise(i,s).then(function(i){var s={};return null!=i.rowIndexFromKey&&i.rowIndexFromKey>0?s.row=t.getVisibleCellIndexInDirection("row",i.rowIndexFromKey,{down:!0}):null!=e.rowIndex?s.row=t.getVisibleCellIndexInDirection("row",e.rowIndex,{down:!0}):null!=e.y?s.row=t._getIndexFromPosition("row",e.y):s.row=0,null!=i.columnIndexFromKey&&i.columnIndexFromKey>0?s.column=t.getVisibleCellIndexInDirection("column",i.columnIndexFromKey,{right:!0}):null!=e.columnIndex?s.column=t.getVisibleCellIndexInDirection("column",e.columnIndex,{right:!0}):null!=e.x?s.column=t._getIndexFromPosition("column",e.x):s.column=0,s})},A.prototype.getFetchCount=function(e,t){var i=this.getFetchSize(e);if(this._isHighWatermarkScrolling()){var s="row"===e?"maxRowCount":"maxColumnCount",o=this.m_options.getScrollPolicyOptions();o&&null!=o[s]&&o[s]>0&&(i=Math.max(Math.min(i,o[s]-t),0))}return i},A.prototype.fetchCells=function(e,t,i,s,o,n){var r;if(this.m_fetching.cells)return;null==s&&(s=this.getFetchCount("row",t)),null==o&&(o=this.getFetchCount("column",i));var l={axis:"row",start:t,count:s},a={axis:"column",start:i,count:o,databody:e};let h=this.m_options.getScrollPosition(),d={},m={},c={};if(!this._isHighWatermarkScrolling()&&(this.m_startRow>0||this.m_startCol>0||t>0||i>0)){let r=this._getRangesForFetchVirtualScroll(e,t,i,s,o,n,h);l=void 0!==r.rowRange?r.rowRange:l,a=void 0!==r.columnRange?r.columnRange:a,d=r.frozenRowRange,m=r.frozenColRange,c=r.frozenCornerRange}this.m_fetching.cells={rowRange:l,columnRange:a},r=null!=n&&null!=n.success?n.success:this.handleCellsFetchSuccess,this.isSkeletonSupport()||this.showStatusText(!this.isSkeletonSupport()),this._signalTaskStart(),this.getDataSource().fetchCells([l,a],{success:r,error:this.handleCellsFetchError},{success:this,error:this},[d,m,c])},A.prototype._getRangesForFetchVirtualScroll=function(e,t,i,s,o,n,r){let l,a,h={},d={},m={};if(this.m_fetchingForInsert)[l,a,h,d,m]=this._fetchCellsForFrozenVirtualScrollInsert(e,t,i,s,o,n);else{if((void 0!==r.rowIndex&&0!==r.rowIndex||void 0!==r.y&&0!==r.y||!this.m_initialized&&t>0)&&(this.m_initialized&&this._hasFrozenRows()||!this.m_initialized&&(this.m_options.isFreezeEnabled("row")||this.m_options.options.frozenRowCount>0))){let n=this.m_frozenRowIndex+1,r=s;if(this.m_initialized&&t<n){let a=0;t+s>n&&(r=n-t,a=s-r);let d=i,m=o;if(this._hasFrozenColumns()){let e=this.m_frozenColIndex+1;i+o>e?(d=i<e?e:i,m=i<e?o-(e-i):o,h={axis:"row",rowStart:t,rowCount:r,colStart:d,colCount:m}):a=0}else h={axis:"row",rowStart:t,rowCount:r,colStart:d,colCount:m};l={axis:"row",start:this.m_frozenRowIndex+1,count:a,databody:e}}else if(this.m_fetchingForUpdate)this._hasFrozenColumns()&&i+o>this.m_frozenColIndex+1&&(l={axis:"row",start:t<this.m_frozenRowIndex+1?this.m_frozenRowIndex+1:t,count:s,databody:e});else{let e=i,r=o;if(this._hasFrozenColumns()&&i+o>this.m_frozenColIndex+1){let t=this.m_frozenColIndex+1;e=i<t?t:i,r=i<t?o-(t-i):o}(i<this.m_startCol||i+o-1>this.m_endCol)&&(h={axis:"row",rowStart:0,rowCount:n,colStart:e,colCount:r}),t<n&&(t=n,s-=n),l={axis:"row",start:t,count:s}}this.m_initialized&&this._hasFrozenColumns()&&!Object.keys(d).length&&this._hasFrozenRows()&&t>this.m_frozenRowIndex&&(t<this.m_startRow||t+s-1>this.m_endRow)&&(d={axis:"column",rowStart:t,rowCount:s,colStart:0,colCount:this.m_frozenColIndex+1,databody:this.m_databodyFrozenCol})}if((void 0!==r.columnIndex&&0!==r.columnIndex||void 0!==r.x&&0!==r.x||!this.m_initialized&&i>0)&&(this.m_initialized&&this._hasFrozenColumns()||!this.m_initialized&&(this.m_options.isFreezeEnabled("column")||this.m_options.options.frozenColumnCount>0))){let n=this.m_frozenColIndex+1,r=o;if(this.m_initialized&&i<n){let l=0;i+o>n&&(r=n-i,l=o-r);let h=t,m=s;if(this._hasFrozenRows()){let e=this.m_frozenRowIndex+1;t+s>e?(h=t<e?e:t,m=t<e?s-(e-t):s,d={axis:"column",rowStart:h,rowCount:m,colStart:i,colCount:r,databody:this.m_databodyFrozenCol}):l=0}else d={axis:"column",rowStart:h,rowCount:m,colStart:i,colCount:r,databody:this.m_databodyFrozenCol};a={axis:"column",start:this.m_frozenColIndex+1,count:l,databody:e}}else if(this.m_fetchingForUpdate)this._hasFrozenRows()&&t+s>this.m_frozenRowIndex+1&&(a={axis:"column",start:i<this.m_frozenColIndex+1?this.m_frozenColIndex+1:i,count:o,databody:e});else{let r=t,l=s;if(this._hasFrozenRows()&&t+s>this.m_frozenRowIndex+1){let e=this.m_frozenRowIndex+1;r=t<e?e:t,l=t<e?s-(e-t):s}(t<this.m_startRow||t+s-1>this.m_endRow)&&(d={axis:"column",rowStart:r,rowCount:l,colStart:0,colCount:n,databody:this.m_databodyFrozenCol}),i<n&&(i=n,o-=n),a={axis:"column",start:i,count:o,databody:e}}this.m_initialized&&this._hasFrozenRows()&&!Object.keys(h).length&&this._hasFrozenColumns()&&i>this.m_frozenColIndex&&(i<this.m_startCol||i+o-1>this.m_endCol)&&(h={axis:"row",rowStart:0,rowCount:this.m_frozenRowIndex+1,colStart:i,colCount:o})}if(this._hasFrozenRows()&&this._hasFrozenColumns()&&(void 0!==r.rowIndex&&0!==r.rowIndex||void 0!==r.y&&0!==r.y||void 0!==r.columnIndex&&0!==r.columnIndex||void 0!==r.x&&0!==r.x||!this.m_initialized&&(t>0||i>0)))if(m={axis:"corner",databody:this.m_databodyFrozenCorner},this.m_initialized&&!this.m_fetchingForUpdate)m={};else{let e=this.m_frozenRowIndex+1,n=this.m_frozenColIndex+1,r=h?.rowStart?h.rowStart:0,l=d?.colStart?d.colStart:0;this.m_initialized&&(i<n||t<e)?(i<n?(i+o>=n?n-=i:n=o,l=i):n=0,t<e?(t+s>=e?e-=t:e=s,r=t):e=0,e=0===n?0:e,n=0===e?0:n,m.rowStart=r,m.colStart=l,m.colCount=n,m.rowCount=e):(m.rowStart=0,m.colStart=0,m.colCount=this.m_frozenColIndex+1,m.rowCount=this.m_frozenRowIndex+1)}}return{rowRange:l,columnRange:a,frozenRowRange:h,frozenColRange:d,frozenCornerRange:m}},A.prototype._fetchCellsForFrozenVirtualScrollInsert=function(e,t,i,s,o,n){let r={axis:"row",start:t,count:s},l={axis:"column",start:i,count:o,databody:e},a=this.m_options.getScrollPosition(),h={},d={},m={};if(void 0!==a.rowIndex&&0!==a.rowIndex&&this._hasFrozenRows()){let e=this.m_frozenRowIndex+1;if(t<e){let n=i,l=o;this._hasFrozenColumns()?o>1?(n=this.m_frozenColIndex+1,l=o-n,i===n&&(l=o),h={axis:"row",rowStart:t,rowCount:s,colStart:n,colCount:l},r.count=0):s>1&&(i<this.m_frozenColIndex+1?(d={axis:"column",rowStart:e,rowCount:s-e,colStart:i,colCount:o,databody:this.m_databodyFrozenCol},r.count=0):(h={axis:"row",rowStart:t,rowCount:e,colStart:i,colCount:o},r.start=e,r.count=s-e)):(h={axis:"row",rowStart:t,rowCount:e,colStart:i,colCount:o},s>1?r={axis:"row",start:e,count:s-e}:o>1&&(h.rowCount=s))}else{if(this._hasFrozenColumns()&&o>1){d={axis:"column",rowStart:t,rowCount:s,colStart:0,colCount:this.m_frozenColIndex+1}}r={axis:"row",start:t,count:s}}}if(void 0!==a.columnIndex&&0!==a.columnIndex&&this._hasFrozenColumns()){let n=this.m_frozenColIndex+1;if(i<n){let r=t,a=s;this._hasFrozenRows()?s>1?(r=this.m_frozenRowIndex+1,a=s-r,t===r&&(a=s),d={axis:"column",rowStart:r,rowCount:a,colStart:i,colCount:o,databody:this.m_databodyFrozenCol},l.count=0):o>1&&(t<this.m_frozenRowIndex+1?(h={axis:"row",rowStart:t,rowCount:s,colStart:n,colCount:o-n},l.count=0):(d={axis:"column",rowStart:t,rowCount:s,colStart:i,colCount:n,databody:this.m_databodyFrozenCol},l.start=n,l.count=o-n)):(d={axis:"column",rowStart:t,rowCount:s,colStart:i,colCount:n,databody:this.m_databodyFrozenCol},s>1?d.colCount=o:o>1&&(l={axis:"column",start:n,count:o-n,databody:e}))}else{if(this._hasFrozenRows()&&s>1){h={axis:"row",rowStart:0,rowCount:this.m_frozenRowIndex+1,colStart:i,colCount:o}}l={axis:"column",start:i,count:o,databody:e}}}if(this._hasFrozenRows()&&this._hasFrozenColumns()){let e=this.m_frozenRowIndex+1,n=this.m_frozenColIndex+1;m={axis:"corner",rowStart:t,colStart:i,rowCount:e,colCount:n,databody:this.m_databodyFrozenCorner},i<n&&t<e?(s<e&&(m.rowCount=s),o<n&&(m.colCount=o)):(o>1&&(m.colStart=0,m.rowCount=1),s>1&&(m.rowStart=0,m.colCount=1))}return[r,l,h,d,m]},A.prototype.isCellFetchResponseValid=function(e){if(null==this.m_fetching)return!1;var t=e[0],i=e[1],s=this.m_fetching.cells;return t===s.rowRange&&i===s.columnRange},A.prototype.isLongScroll=function(){return this.m_isLongScroll},A.prototype.isCellFetchResponseInViewport=function(e,t){if(isNaN(this.m_avgRowHeight)||isNaN(this.m_avgColWidth)||null!=this.m_empty||!this.m_initialized)return!0;var i=t[0].start,s=t[1].start,o=this._getLongScrollStart(this.m_currentScrollTop,this.m_prevScrollTop,"row"),n=this._getLongScrollStart(this.m_currentScrollLeft,this.m_prevScrollLeft,"column");let r=!1;return(o.start===i&&n.start===s||n.start!==s&&!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&s===this.m_frozenColIndex+1||o.start!==i&&!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&i===this.m_frozenRowIndex+1)&&(r=!0),r},A.prototype.handleCellsFetchSuccess=function(e,t,i,s,o,n,r){var l=this.m_options.getScrollPolicyOptions(),a=l?l.maxRowCount:null,h=l?l.maxColumnCount:null,d=this.getDataSource().getCount("row"),m=this.getDataSource().getCount("column");let c=this.m_options.getScrollPosition();if(void 0===i){if(i=!1,!this.isCellFetchResponseValid(t))return void this._signalTaskEnd();if(this.isLongScroll()&&(!this.isCellFetchResponseInViewport(e,t)||this.m_headerInvalid))return this.m_fetching.cells=!1,this.m_headerInvalid=!1,this.handleLongScroll(this.m_currentScrollLeft,this.m_currentScrollTop),void this._signalTaskEnd();this.m_isLongScroll=!1,this.m_longScrollRow=null,this.m_longScrollColumn=null,this.m_longScrollRowPixel=null,this.m_longScrollColumnPixel=null}var _=t[0],g=_.start,p=e.getCount("row"),f=p>0&&(g>this.m_endRow||g+p<=this.m_startRow);let C=this.m_frozenRowIndex;this.m_initialized&&this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&g<C&&this.m_rowHeaderFrozen&&(g=C+1),(0===p&&this._isCountUnknown("row")&&_.count>0||f&&this._isHighWatermarkScrolling()&&!this._isCountUnknown("row")&&this.m_endRow+p+1>=d||p<_.count||this._isHighWatermarkScrolling()&&a&&a>0&&g+p===a)&&(this.m_stopRowFetch=!0);var y=t[1],w=y.start,E=e.getCount("column");let v=this.m_frozenColIndex;this.m_initialized&&this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&w<v&&this.m_colHeaderFrozen&&(w=v+1);var x=E>0&&(w>this.m_endCol||w+E===this.m_startCol);let H=s?.length?s[0]:void 0,b=H?.rowStart,S=r?.getCount("row"),R=o?.getCount("row"),I=o?.columnStart,z=o?.getCount("column");(this._isHighWatermarkScrolling()||!this._isHighWatermarkScrolling()&&void 0===o&&0===this.m_startRow)&&this._hasFrozenRows()&&(H=_,b=g,R=this.m_frozenRowIndex+1,o=e,I=w);let F=s?.length?s[1]:void 0,M=F?.colStart,A=r?.getCount("column"),D=n?.getCount("column"),L=n?.rowStart,T=n?.getCount("row");(this._isHighWatermarkScrolling()||!this._isHighWatermarkScrolling()&&void 0===n&&0===this.m_startCol)&&this._hasFrozenColumns()&&(F=y,M=w,D=this.m_frozenColIndex+1,n=e,L=g,T=p),(this._isHighWatermarkScrolling()||!this._isHighWatermarkScrolling()&&void 0===r&&0===this.m_startRow&&0===this.m_startCol)&&this._hasFrozenColumns()&&this._hasFrozenRows()&&(A=this.m_frozenColIndex+1,S=this.m_frozenRowIndex+1,r=e),(0===E&&this._isCountUnknown("column")&&y.count>0||x&&this._isHighWatermarkScrolling()&&!this._isCountUnknown("column")&&this.m_endCol+E+1>=m||E<y.count||this._isHighWatermarkScrolling()&&h&&h>0&&w+E===h)&&(this.m_stopColumnFetch=!0);var N=this.m_databody;null==N&&(N=y.databody);var k,O,P,W,B,j,K,V,U,Y=N.firstChild;if(f||i){if(k=!(i||!(g>=this.m_startRow)))O=this.m_endRowPixel;else if(i){var G=this._getCellByIndex({row:g+p,column:this.m_startCol});O=this.getElementDir(G,"top")}else O=this.m_startRowPixel;P=w>=this.m_startCol?this.m_startColPixel:this.m_endColPixel;let t=w,s=g,l=p,a=E;if(!1===this.m_initialized)this._hasFrozenRows()&&this._hasFrozenColumns()&&null!==this.m_colHeaderFrozen&&null!==this.m_rowHeaderFrozen&&(B=this._populateFrozenContainer(this.m_databodyFrozenCorner.firstChild,r,0,O,0,P,Math.min(p,S),Math.min(E,A)),!this._isHighWatermarkScrolling()&&(this._isHighWatermarkScrolling()||0!==c.rowIndex&&void 0!==c.rowIndex||void 0!==c.y&&0!==c.y||void 0!==c.x&&0!==c.x||void 0!==c.columnIndex&&0!==c.columnIndex)||(I=this.m_frozenColIndex+1,L=this.m_frozenRowIndex+1,p=l-(this.m_frozenRowIndex+1),E=a-(this.m_frozenColIndex+1)),0===E&&(this.m_endRowPixel+=B.totalRowHeight)),this._hasFrozenRows()&&null!==this.m_rowHeaderFrozen&&(!this._isHighWatermarkScrolling()&&(this._isHighWatermarkScrolling()||void 0!==c.rowIndex&&0!==c.rowIndex||void 0!==c.y&&0!==c.y)||(z=E,b=s,p=l-(this.m_frozenRowIndex+1),g=this.m_frozenRowIndex+1),B=this._populateFrozenContainer(this.m_databodyFrozenRow.firstChild,o,b,O,I,P,R,z)),this._hasFrozenColumns()&&null!==this.m_colHeaderFrozen&&(!this._isHighWatermarkScrolling()&&(this._isHighWatermarkScrolling()||void 0!==c.columnIndex&&0!==c.columnIndex||void 0!==c.x&&0!==c.x)||(T=p,M=t,w=this.m_frozenColIndex+1,E=a-(v+1)),B=this._populateFrozenContainer(this.m_databodyFrozenCol.firstChild,n,L,O,M,P,T,D),0===E&&(this.m_endRowPixel+=B.totalRowHeight));else if(!this._hasFrozenColumns()||null===this.m_colHeaderFrozen||void 0===n||!this.m_databodyFrozenCol.firstChild.childElementCount&&this._isHighWatermarkScrolling()){if(this._hasFrozenRows()&&null!==this.m_rowHeaderFrozen&&void 0!==o&&(this.m_databodyFrozenRow.firstChild.childElementCount||!this._isHighWatermarkScrolling())){let e=0;B=this._populateFrozenContainer(this.m_databodyFrozenRow.firstChild,o,0,e,I,P,R,z)}}else{let e=0;if(B=this._populateFrozenContainer(this.m_databodyFrozenCol.firstChild,n,L,O,0,e,T,D),(this._isHighWatermarkScrolling()||!this._isHighWatermarkScrolling()&&(void 0===c.columnIndex||0===c.columnIndex)&&(void 0===c.x||0===c.x)||w<this.m_frozenColIndex+1)&&(E=a-(this.m_frozenColIndex+1),w=v+1),0===E&&(this.m_endRowPixel+=B.totalRowHeight),x&&this._hasFrozenRows()&&null!==this.m_rowHeaderFrozen&&void 0!==o){!this._isHighWatermarkScrolling()&&(this._isHighWatermarkScrolling()||void 0!==c.rowIndex&&0!==c.rowIndex||void 0!==c.y&&0!==c.y)||(z=E);let e=0;B=this._populateFrozenContainer(this.m_databodyFrozenRow.firstChild,o,0,e,I,P,R,z)}}W=document.createDocumentFragment(),j=(B=this._addCellsToFragment(W,e,g,O,w,P,p,E)).totalColumnWidth,K=B.totalRowHeight,V=B.avgWidth,U=K/p,this._populateDatabody(Y,W),this.m_initialized&&!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&0===this.m_startRow&&(this.m_startRow=this.m_frozenRowIndex+1),k?(-1!==this.m_endRow&&0!==p&&this._highlightCellsAlongAxis(this.m_endRow,"row","index","remove",["borderHorizontalNone"]),this.m_endRow=g+(p-1),this.m_endRowPixel+=K):i?(g<this.m_startRow&&(this.m_startRow=g,this.m_startRowPixel=Math.max(0,this.m_startRowPixel-K)),this.m_endRow+=p,this.m_endRowPixel+=K,this.pushRowsDown(g+p,K)):(this.m_startRow-=p,this.m_startRowPixel-=K)}else if(x){if(P=(k=w>=this.m_startCol)?this.m_endColPixel:this.m_startColPixel,O=g>=this.m_startRow?this.m_startRowPixel:this.m_endRowPixel,!this.m_databody.firstChild.childElementCount&&k&&this._hasFrozenRows()&&this.m_initialized){const e=this.getResources().isRTLMode()?"right":"left",t=this.m_databodyFrozenRow.firstChild.lastChild;P=this.getElementDir(t,e)+this.getElementWidth(t)}if(this._hasFrozenRows()&&null!==this.m_rowHeaderFrozen&&void 0!==o){let e=0;B=this._populateFrozenContainer(this.m_databodyFrozenRow.firstChild,o,0,e,I,P,R,z),(this._isHighWatermarkScrolling()||!this._isHighWatermarkScrolling()&&(void 0===c.rowIndex||0===c.rowIndex)&&(void 0===c.y||0===c.y)||g<this.m_frozenRowIndex+1)&&(p-=C+1,g=C+1)}W=document.createDocumentFragment(),B=this._addCellsToFragment(W,e,g,O,w,P,p,E),this._populateDatabody(Y,W),j=B.totalColumnWidth}null==V||0!==this.m_avgColWidth&&null!=this.m_avgColWidth||(this.m_avgColWidth=V),null==U||0!==this.m_avgRowHeight&&null!=this.m_avgRowHeight||(this.m_avgRowHeight=U),x&&(this.m_initialized&&!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&0===this.m_startCol&&(this.m_startCol=this.m_frozenColIndex+1),w<this.m_startCol?(this.m_startCol-=E,this.m_startColPixel-=j):(this.m_endCol=w+(E-1),this.m_endColPixel+=j)),this.updateMaxYet(),this._sizeDatabodyScroller(),this.m_endCol>=0&&this.m_endRow>=0?this.m_hasCells=!0:(this.m_startCol=0,this.m_startRow=0);let q=0,X=0;var $;if(!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&(q=this.m_frozenRowIndex+1),!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&(X=this.m_frozenColIndex+1),this.m_startCol===X&&0!==this.m_startColPixel&&(this._shiftCellsAlongAxis("column",-this.m_startColPixel,X,!0),!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&this._shiftFrozenCellsAlongAxis("column",-this.m_startColPixel,X,!0),this.m_endColPixel-=this.m_startColPixel,this.m_startColPixel=0),this.m_startRow===q&&0!==this.m_startRowPixel&&(this._shiftCellsAlongAxis("row",-this.m_startRowPixel,q,!0),!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&this._shiftFrozenCellsAlongAxis("row",-this.m_startRowPixel,q,!0),this.m_endRowPixel-=this.m_startRowPixel,this.m_startRowPixel=0),!this.m_initialized&&this.m_startCol>0){let e=this._getHiddenCountBeforeIndex(this.m_startCol,"column");$=Math.round(this.m_avgColWidth*(this.m_startCol-e)),!this._isHighWatermarkScrolling()&&(this._isHighWatermarkScrolling()||!this._hasFrozenColumns()||void 0===c.columnIndex&&0===c.columnIndex||void 0===c.x&&0===c.x)||($=Math.round(this.m_avgColWidth*(this.m_startCol-e-(this.m_frozenColIndex+1)+this._getHiddenCountBeforeIndex(this.m_frozenColIndex+1,"column")))),this._shiftCellsAlongAxis("column",$-this.m_startColPixel,this.m_startCol,!0),!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&this._shiftFrozenCellsAlongAxis("column",$-this.m_startColPixel,this.m_startCol,!0),this.m_endColPixel=$+j,this.m_startColPixel=$}if(!this.m_initialized&&this.m_startRow>0){let e=this._getHiddenCountBeforeIndex(this.m_startRow,"row");$=Math.round(this.m_avgRowHeight*(this.m_startRow-e)),!this._isHighWatermarkScrolling()&&(this._isHighWatermarkScrolling()||!this._hasFrozenRows()||void 0===c.rowIndex&&0===c.rowIndex||void 0===c.y&&0===c.y)||($=Math.round(this.m_avgRowHeight*(this.m_startRow-e-(this.m_frozenRowIndex+1)+this._getHiddenCountBeforeIndex(this.m_frozenRowIndex+1,"row")))),this._shiftCellsAlongAxis("row",$-this.m_startRowPixel,this.m_startRow,!0),!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&this._shiftFrozenCellsAlongAxis("row",$-this.m_startRowPixel,this.m_startRow,!0),this.m_endRowPixel=$+K,this.m_startRowPixel=$}if(this.m_fetching.cells=!1,this.isFetchComplete())if(this.hideStatusText(),this.m_initialized?this._checkScroll&&this._checkScrollPosition():this._updateScrollPosition(this.m_options.getScrollPosition()),null!=this.m_scrollIndexAfterFetch?this.scrollToIndex(this.m_scrollIndexAfterFetch):null!=this.m_scrollHeaderAfterFetch?this.scrollToHeader(this.m_scrollHeaderAfterFetch):this.isActionableMode()||null==this._getActiveElement()||this.m_utils.containsCSSClassName(this._getActiveElement(),this.getMappedStyle("focus"))||(!0!==this.m_shouldFocus&&(this.m_shouldFocus=!1),this._highlightActive(),this._manageMoveCursor()),this._isSelectionEnabled()&&this.applySelection(g,g+p,w,w+E),this.populateAccInfo(),this._shouldInitialize())this._handleInitialization(!0);else if(this.m_initialized){var Q;(!0===this.m_resizeRequired||this.m_endRowPixel-K<this.getElementHeight(N))&&this.resizeGrid(),f?k?Q="top":i||(Q="bottom"):x&&(Q=w===this.m_startCol?"right":"left"),this._cleanupViewport(Q),this.fillViewport(),this.isFetchComplete()&&this.fireEvent("ready",{})}this._isSelectionEnabled()&&this.isMultipleSelection()&&this._resetHeaderHighLight();let J,Z=this.getActiveDatabodyIndicators();f&&x||(f?J="row":x&&(J="column")),this.deleteAndApplyHiddenIndicators(Z,J),u.isIos()&&this._applyIosAccessibility(),this._signalTaskEnd(),this._runModelEventQueue()},A.prototype._setZIndexBefore=function(e,t,i,s){if("row"===e)for(var o=this.m_startRow,n=this.m_currentScrollTop,r=t;r>=o;r--){var l,a=this._getAxisCellsByIndex(r,e);if(this.getElementDir(a[0],"top")<n)break;for(var h=0;h<a.length;h++)a[h].style.zIndex=10;i&&(l=this._getHeaderByIndex(r,"row",0))&&(l.style.zIndex=10),s&&(l=this._getHeaderByIndex(r,"rowEnd",0))&&(l.style.zIndex=10)}},A.prototype._onEndEvent=function(e,t,i,s){var o;function n(){o&&(clearTimeout(o),o=void 0),t.removeEventListener(e,n),i()}t.addEventListener(e,n),o=setTimeout(n,s+100)},A.prototype._insertRowsWithAnimation=function(e,t,i,s,o,n,r,l){var a,h,d,m,c,u,_,g,p,f,C=this,y=0,w=0,E=0;C._signalTaskStart();var v=s>this.m_endRow,x=this.m_databody.firstChild,H=null!=t,b=null!=i;for(s>0&&(E=s-1,f=this._getAxisCellsByIndex(s-1,"row"),y=(w=this.getElementDir(f[0],"top"))+this.getElementHeight(f[0])),this._setZIndexBefore("row",E,H,b),H&&(d=(h=this.m_rowHeader.firstChild).childNodes[s-this.m_startRow-1]),b&&(c=(m=this.m_rowEndHeader.firstChild).childNodes[s-this.m_startRow-1]),a=0;a<e.childNodes.length;a++){var S=e.childNodes[a];g=w-(_=y+this.getElementDir(S,"top"))-this.getElementHeight(S),this.setElementDir(S,_,"top"),this.addTransformMoveStyle(S,0,0,"linear",0,g,0)}if(H)for(a=0;a<t.childNodes.length;a++)u=t.childNodes[a],g=w-(_=y+this.getElementDir(u,"top"))-this.getElementHeight(u),this.setElementDir(u,_,"top"),this.addTransformMoveStyle(u,0,0,"linear",0,g,0);if(b)for(a=0;a<i.childNodes.length;a++)p=i.childNodes[a],g=w-(_=y+this.getElementDir(p,"top"))-this.getElementHeight(p),this.setElementDir(p,_,"top"),this.addTransformMoveStyle(p,0,0,"linear",0,g,0);for(a=s;a<=this.m_endRow;a++){var R=this._getAxisCellsByIndex(a-this.m_startRow,"row");_=n+this.getElementDir(R[0],"top"),g=-n;for(var I=0;I<R.length;I++)this.setElementDir(R[I],_,"top"),this.addTransformMoveStyle(R[I],0,0,"linear",0,g,0);H&&(u=h.childNodes[a],this.setElementDir(u,_,"top"),this.addTransformMoveStyle(u,0,0,"linear",0,g,0)),b&&(p=m.childNodes[a],this.setElementDir(p,_,"top"),this.addTransformMoveStyle(p,0,0,"linear",0,g,0))}this._modifyAxisCellContextIndex("row",s,this.m_endRow-s+1,o),this.m_endRow+=o,this.m_maxRowYet+=o,this.m_endRowPixel+=n,H&&(this.m_endRowHeader+=t.childNodes.length,this.m_endRowHeaderPixel+=n),b&&(this.m_endRowEndHeader+=i.childNodes.length,this.m_endRowEndHeaderPixel+=n),x.appendChild(e),v?(H&&h.appendChild(t),b&&m.appendChild(i)):(H&&h.insertBefore(t,d.nextSibling),b&&m.insertBefore(i,c.nextSibling)),this._setAllScrollableRegions("height",this.getElementHeight(x)+n),this.resizeGrid(),this.updateRowBanding(),this._refreshDatabodyMap(),this._isSelectionEnabled()&&this.applySelection(s,s+o,r,r+l);var z=this._getCellByIndex(this.createIndex(s+(o-1),this.m_endCol));this.m_animating=!0;var F=C.m_processingEventQueue?1:A.EXPAND_ANIMATION_DURATION;this._onEndEvent("transitionend",z,function(){C._handleAnimationEnd()},F),setTimeout(function(){for(var e=A.EXPAND_ANIMATION_DURATION,t="ease-out",i=s;i<=C.m_endRow;i++){for(var o=C._getAxisCellsByIndex(i,"row"),n=0;n<o.length;n++)C.addTransformMoveStyle(o[n],e+"ms",0,t,0,0,0);H&&C.addTransformMoveStyle(h.childNodes[i],e+"ms",0,t,0,0,0),b&&C.addTransformMoveStyle(m.childNodes[i],e+"ms",0,t,0,0,0)}},0)},A.prototype._addCellsToFragment=function(e,t,i,s,o,n,r,l){var a=this.getResources().isRTLMode()?"right":"left";const h=this.getResources().getMappedAttribute("context");let d=0;var m=this.getRendererOrTemplate("cell"),c=this.m_options.getColumnBandingInterval(),_=this.m_options.getRowBandingInterval(),g=this.m_options.getHorizontalGridlines(),p=this.m_options.getVerticalGridlines();null==r&&(r=t.getCount("row")),null==l&&(l=t.getCount("column"));let f=i>=this.m_startRow,C=o>=this.m_startCol,y=this.m_options._getFreezeIndex("row"),w=this.m_options._getFreezeIndex("column");!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&i<=y&&(f=!0),!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&o<=w&&(C=!0);for(var E=0,v=s,x=[],H=[],b=0;b<r;b+=1){for(var S,R,I,z,F=n,M=f?i+b:i+(r-1-b),A=Math.floor(M/_)%2==1,D=0;D<l;D+=R.column){var L=0;if(S=0,this.m_activeEdit&&b+i===this.m_active.indexes.row&&D+o===this.m_active.indexes.column)L=this.getElementWidth(this.m_activeEdit),F=C?F+L:F-L,R=this.m_activeEdit[h].extents;else{var T,N=C?o+D:o+(l-1-D);R={row:(T=t.getExtent?t.getExtent(this.createIndex(M,N)):{row:{extent:1,more:{before:!1,after:!1}},column:{extent:1,more:{before:!1,after:!1}}}).row.extent,column:T.column.extent},C||(N=N-R.column+1);var k=f?M:M-R.row+1,O=this.createIndex(k,N);if(x[b]&&x[b][D])L=x[b][D].width,F=C?F+L:F-L;else{var P=this._patchExistingCells(T,N,k,x);if(P)L=P.width;else{var W=t.getData(this.createIndex(k,N)),B=t.getMetadata(this.createIndex(k,N));I=document.createElement("div"),z=this.createCellContext(O,W,B,I,R),I.setAttribute(this.getResources().getMappedAttribute("container"),this.getResources().widgetName),I.setAttribute(this.getResources().getMappedAttribute("busyContext"),""),this._createUniqueId(I),I[this.getResources().getMappedAttribute("context")]=z,I[this.getResources().getMappedAttribute("metadata")]=B;const i=this.m_options.getHorizontalAlignment("cell",z),s=this.m_options.getVerticalAlignment("cell",z);if("auto"!==i){const e=this._getHorizontalAlignmentStyle(i);I.style.justifyContent=e.justifyContent,I.style.textAlign=e.textAlign}if("auto"!==s&&(I.style.alignItems=this._getVerticalAlignmentStyle(s)),void 0!==B.metadata?.validity){if("invalidShown"===B.metadata.validity){let e=document.createElement("div");this.m_utils.addCSSClassName(e,this.getMappedStyle("validationError")),I.appendChild(e),I.setAttribute("aria-invalid",!0)}}var j=this.m_options.getInlineStyle("cell",z);null!=j&&u.applyMergedInlineStyles(I,j,""),""!==I.style.height&&(I.style.height=""),""!==I.style.width&&(I.style.width=""),this.m_utils.addCSSClassName(I,this.getMappedStyle("cell")),this.m_utils.addCSSClassName(I,this.getMappedStyle("formcontrol")),(this._hasFrozenColumns()&&N<=this.m_frozenColIndex||this._hasFrozenRows()&&k<=this.m_frozenRowIndex)&&this.m_utils.addCSSClassName(I,this.getMappedStyle("frozenCell")),(A||Math.floor(N/c)%2==1)&&this.m_utils.addCSSClassName(I,this.getMappedStyle("banded"));var K,V=this.m_options.getStyleClass("cell",z);if(null!=V&&(I.className+=" "+V),this._isGridEditable()){"disable"===this.m_options.isEditable("cell",z)&&(this._setAttribute(I,"readOnly",!0),this.m_utils.addCSSClassName(I,this.getMappedStyle("readOnly")))}for(K=0;K<R.row;K++){var U=0===K?z.keys.row:this._getKey(this._getHeaderByIndex(k+K,"row",0),"row");H[b+K]=this._getCellDimension(I,k+K,U,"row","height"),this.isHidden("row",k)&&(H[b+K]=0,I.style.display="none"),S+=H[b+K]}for(this.setElementHeight(I,S),K=0;K<R.column;K++){var Y=0===K?z.keys.column:this._getKey(this._getHeaderByIndex(N+K,"column",0),"column");L+=this._getCellDimension(I,N,Y,"column","width")}this.isHidden("column",N)&&(L=0,I.style.display="none",d+=1),this.setElementWidth(I,L),!I.classList.contains(this.getMappedStyle("frozenCell"))&&("hidden"===p||this._isLastColumn(N+(R.column-1))&&(this.getRowHeaderWidth()+F+L>=this.getWidth()||-1!==this.m_endRowEndHeader))&&this.m_utils.addCSSClassName(I,this.getMappedStyle("borderVerticalNone")),("hidden"===g||this._isLastRow(k+(R.row-1))&&(this.getRowBottom(I,v+S)>=this.getHeight()||-1!==this.m_endColEndHeader)&&!I.classList.contains(this.getMappedStyle("frozenCell")))&&this.m_utils.addCSSClassName(I,this.getMappedStyle("borderHorizontalNone")),f?this.setElementDir(I,v,"top"):this.setElementDir(I,v-S,"top"),C?this.setElementDir(I,F,a):this.setElementDir(I,F-L,a),this.m_isCustomElementCallback()&&this.m_root.appendChild(I),this._renderContent(m,z,I,W,this.buildCellTemplateContext(z,B)),e.appendChild(I)}this._updateTempArray(x,{width:L},b,D,R.row,R.column),F=C?F+L:F-L,0===b&&(E+=L)}}}S=H[b],v=f?v+S:v-S,S}return{avgWidth:E/(l-d),totalRowHeight:H.reduce(function(e,t){return e+t},0),totalColumnWidth:E}},A.prototype._updateCellDimension=function(e,t,i,s,o,n,r,l){var a,h,d=0,m="width"===r?"height":"width",c=this._getCellByIndex(this.createIndex(s,i)),u=this.getElementDir(c,r),_=c[this.getResources().getMappedAttribute("context")];_.extents[n]+=e,"row"===n?a=s:"column"===n&&(a=i);for(var g=1;g<=e;g++){var p=this._getKey(this._getHeaderByIndex(l?a-g:a+g,n,0),n);d+=this._getCellDimension(c,l?a-g:a+g,p,n,r);for(var f=0;f<t;f++){var C,y;"row"===n?(C=l?s-g:s+g,y=i+f):(C=s+f,y=l?i-g:i+g),this._addIndexToDatabodyMap(this.createIndex(C,y),c.id)}}l&&(h="width"===r?this.getResources().isRTLMode()?"right":"left":"top",this.setElementDir(c,this.getElementDir(c,h)-d,h),_.indexes[n]-=e);this.setElementDir(c,u+d,r);var w={};return w[r]=d,w[m]=this.getElementDir(c,m),w.cell=c,w},A.prototype._patchExistingCells=function(e,t,i,s){var o=e.column.extent,n=e.row.extent,r=e.row.more.before,l=e.row.more.after,a=e.column.more.before,h=e.column.more.after;return t-1===this.m_endCol&&a?this._updateCellDimension(o,n,this.m_endCol,i,s,"column","width",!1):i-1===this.m_endRow&&r?this._updateCellDimension(n,o,t,this.m_endRow,s,"row","height",!1):t+o===this.m_startCol&&h?this._updateCellDimension(o,n,this.m_startCol,i,s,"column","width",!0):!(i+n!==this.m_startRow||!l)&&this._updateCellDimension(n,o,t,this.m_startRow,s,"row","height",!0)},A.prototype._updateTempArray=function(e,t,i,s,o,n){for(var r=0;r<o;r++){null==e[i+r]&&(e[i+r]=[]);for(var l=0;l<n;l++)e[i+r][s+l]=t}},A.prototype._getCellDimension=function(e,t,i,s,o){var n,r,l;if("row"===s?(n=this.getMappedStyle("rowheadercell")+" "+this.getMappedStyle("headercell"),r=this.m_endRowHeader):"column"===s&&(n=this.getMappedStyle("colheadercell")+" "+this.getMappedStyle("headercell"),r=this.m_endColHeader),-1===r){var a=this.createHeaderContext(s,t,null,{key:i},null,0,0,1),h=this.m_options.getInlineStyle(s,a),d=this.m_options.getStyleClass(s,a);l=document.createElement("div"),null!=h&&u.applyMergedInlineStyles(l,h,""),l.className=n+" "+d}else l=e;return this._getHeaderDimension(l,i,s,o)},A.prototype._getLabelDimension=function(e,t){let i,s,o;"column"===e?(i=this.m_columnHeaderLevelHeights,s="height",o=this.m_startColHeader):"columnEnd"===e?(i=this.m_columnEndHeaderLevelHeights,s="height",o=this.m_startColEndHeader):"row"===e?(i=this.m_rowHeaderLevelWidths,s="width",o=this.m_startRowHeader):(i=this.m_rowEndHeaderLevelWidths,s="width",o=this.m_startRowEndHeader);let n=i[t];if(null!=n)return n;const r=this._getHeaderByIndex(o,e,t),l=r[this.getResources().getMappedAttribute("context")],a=l.level,h=l.depth,d=this.getElementDir(r,s);let m=0,c=0;for(let e=a;e<a+h;e++){let t=i[e];null!=t?m+=t:c+=1}return 0===c?d:(n=Math.max(0,Math.round((d-m)/c)),i[t]=n,n)},A.prototype._modifyAndPushCells=function(e,t,i,s,o,n,r,l){let a=this.getResources().isRTLMode()?"right":"left",h="row"===i?"top":a,d=this.getResources().getMappedAttribute("context"),m=r?1:-1,c=function(i,s,o){i.forEach(i=>{let n=s(i),a=0;if(r)n>=e[0]&&(a=e.length);else for(;a<e.length&&!(e[a]>=n);a++);if(0===e.length&&l>0&&(a+=l),a>0){let s=t.length?t.slice(0,a).reduce((e,t)=>e+t):0;s*=m,a*=m,l&&e.length&&(a+=l*m),o(i,s,a,n)}})},u=s.firstChild.querySelectorAll("."+this.getMappedStyle("cell"));if(u=[...u].filter(e=>!(e===this.m_activeEdit)),c(u,e=>e[d].indexes[i],(e,t,s)=>{if(0!==t){let i=this.getElementDir(e,h)+t;this.setElementDir(e,i,h)}e[d].indexes[i]+=s}),o){c(o.querySelectorAll("."+this.getMappedStyle("headercell")),e=>e[d].index,(e,t,i)=>{if(0!==t){let i=this.getElementDir(e,h)+t;this.setElementDir(e,i,h)}e[d].index+=i}),c(o.querySelectorAll("."+this.getMappedStyle("groupingcontainer")),e=>this._getAttribute(e,"start",!0),(e,t,i,s)=>{this._setAttribute(e,"start",s+i)})}if(n){c(n.querySelectorAll("."+this.getMappedStyle("endheadercell")),e=>e[d].index,(e,t,i)=>{if(0!==t){let i=this.getElementDir(e,h)+t;this.setElementDir(e,i,h)}e[d].index+=i}),c(n.querySelectorAll("."+this.getMappedStyle("groupingcontainer")),e=>this._getAttribute(e,"start",!0),(e,t,i,s)=>{this._setAttribute(e,"start",s+i)})}},A.prototype.pushRowsDown=function(e,t){for(;e<=this.m_endRow;){var i=this._getAxisCellsByIndex(e,"row");if(i.length>0)for(var s=0;s<i.length;s++){var o=i[s],n=this.getElementDir(o,"top")+t;o.style.top=n+"px"}e+=1}},A.prototype.pushRowsUp=function(e,t){this.pushRowsDown(e,-t)},A.prototype.pushRowHeadersDown=function(e,t){for(;e;){var i=this.getElementDir(e,"top")+t;e.style.top=i+"px",e=e.nextSibling}},A.prototype.pushRowHeadersUp=function(e,t){this.pushRowHeadersDown(e,-t)},A.prototype.createCellContext=function(e,t,i,s,o){var n={parentElement:s,indexes:e,cell:t};this._isDataGridProvider()?n.data=t:n.data=null!=t&&"object"==typeof t&&Object.prototype.hasOwnProperty.call(t,"data")?t.data:t,n.component=this,n.datasource=this.m_options.getProperty("data"),n.mode="navigation",n.extents=o;for(var r=Object.keys(i),l=0;l<r.length;l++){var a=r[l];n[a]=i[a]}return null!=this.m_createContextCallback&&this.m_createContextCallback.call(this,n),this.m_fixContextCallback.call(this,n)},A.prototype._createUniqueId=function(e){return this._uniqueIdCallback(e,!1)},A.prototype.getRowHeaderWidth=function(){return null===this.m_rowHeaderWidth?0:this.m_rowHeaderWidth},A.prototype.getColumnHeaderHeight=function(){return null===this.m_colHeaderHeight?0:this.m_colHeaderHeight},A.prototype.getRowEndHeaderWidth=function(){return-1===this.m_endRowEndHeader?0:this.m_rowEndHeaderWidth},A.prototype.getColumnEndHeaderHeight=function(){return-1===this.m_endColEndHeader?0:this.m_colEndHeaderHeight},A.prototype.getRowBottom=function(e,t){var i=this.getColumnHeaderHeight();if(null!=t)return i+t;var s=this.getElementDir(e,"top"),o=this.calculateRowHeight(e);return isNaN(s)||isNaN(o)?i:i+s+o},A.prototype.handleCellsFetchError=function(e,t){if(this.m_fetching.cells=!1,this.hideStatusText(),null!=this.m_databody.firstChild&&this.m_initialized){var i=t[0],s=t[1];s.start+(s.count-1)>this.m_endCol&&(this.m_stopColumnFetch=!0,this.m_stopColumnHeaderFetch=!0,this.m_stopColumnEndHeaderFetch=!0),i.start+(i.count-1)>this.m_endRow&&(this.m_stopRowFetch=!0,this.m_stopRowHeaderFetch=!0,this.m_stopRowEndHeaderFetch=!0)}else this._shouldInitialize()&&this._handleInitialization(!1);this._signalTaskEnd()},A.prototype._isFocusableElementBeforeCell=function(e){if(null==e||e===this.getRootElement()||this.m_utils.containsCSSClassName(e,this.getMappedStyle("cell")))return!1;var t=e.tagName;return!!("INPUT"===t||"TEXTAREA"===t||"SELECT"===t||"BUTTON"===t||"A"===t||this.m_utils.containsCSSClassName(e,this.getMappedStyle("active"))||null!=e.getAttribute("tabIndex")&&parseInt(e.getAttribute("tabIndex"),10)>=0&&this.findCell(e)!==e)||this._isFocusableElementBeforeCell(e.parentNode)},A.prototype._setFocusToFirstFocusableElement=function(e,t,i,s){u.enableAllFocusableElements(e);let o=u.getFocusableElementsInNode(e)[0];if(s?.locator){let t=e.querySelector(s.locator);t&&(o=t)}if(o){"focusAndOpen"===s?.action&&null!=o.UNSAFE_focusAndOpenDropdown?o.UNSAFE_focusAndOpenDropdown():o.focus();let e=document.activeElement;if(t&&t.preventDefault(),e.setSelectionRange&&e.value)try{e.setSelectionRange(e.value.length,e.value.length)}catch(e){}return!0===i&&"function"==typeof e.select&&e.select(),!0}return!1},A.prototype.handleScroll=function(e){if(this._clearScrollPositionTimeout(),this.m_handleScrollOverflow||(this.m_hasVerticalScroller||this.m_hasHorizontalScroller||(this.m_databody.style.overflow="hidden"),this.m_handleScrollOverflow=!0),this.m_animating)e.preventDefault();else if(!0!==this.m_silentScroll){var t=e.target,i=this.m_utils.getElementScrollLeft(t),s=t.scrollTop;this._closeToolTip(),this.scrollTo(i,s)}else this.m_silentScroll=!1},A.prototype._getMaxScrollWidth=function(){return this._isCountUnknownOrHighwatermark("column")&&!this.m_stopColumnFetch?Number.MAX_VALUE:this.m_scrollWidth},A.prototype._getMaxScrollHeight=function(){return this._isCountUnknownOrHighwatermark("row")&&!this.m_stopRowFetch?Number.MAX_VALUE:this.m_scrollHeight},A.prototype.scroll=function(e){if(null!=e.position){var t={};t.x=Math.max(0,Math.min(this.m_scrollWidth,e.position.scrollX)),t.y=Math.max(0,Math.min(this.m_scrollHeight,e.position.scrollY)),this._scrollToScrollPositionObject(t)}},A.prototype.scrollDelta=function(e,t){this._adjustScrollerSize();var i=Math.max(0,Math.min(this._getMaxScrollWidth(),this.m_currentScrollLeft-e)),s=Math.max(0,Math.min(this._getMaxScrollHeight(),this.m_currentScrollTop-t));this._initiateScroll(i,s)},A.prototype.adjustTouchScroll=function(e,t){return this.m_utils.isTouchDevice()&&0!==e&&0!==t&&(Math.abs(e)>Math.abs(t)?(t=0,this.m_extraScrollOverY=null):(e=0,this.m_extraScrollOverX=null)),[e,t]},A.prototype._initiateScroll=function(e,t){this.m_utils.setElementScrollLeft(this.m_databody,e),this.m_databody.scrollTop=t,this.m_databody.firstChild.childElementCount||!this._hasFrozenColumns()&&!this._hasFrozenRows()||this.scrollTo(e,t)},A.prototype._initiateScrollOnAttached=function(){this._initiateScroll(this.m_currentScrollLeft,this.m_currentScrollTop)},A.prototype._shouldLongScroll=function(e,t){return!this._isHighWatermarkScrolling()&&(e+this.getViewportWidth()<this._getMaxLeftPixel()||t+this.getViewportHeight()<this._getMaxTopPixel()||e>this._getMaxRightPixel()||t>this._getMaxBottomPixel())},A.prototype.scrollTo=function(e,t){if(this.m_prevScrollLeft=this.m_currentScrollLeft,this.m_currentScrollLeft=e,this.m_prevScrollTop=this.m_currentScrollTop,this.m_currentScrollTop=t,this._checkScroll=!1,this._shouldLongScroll(e,t)?this.handleLongScroll(e,t):this.fillViewport(),this._checkScroll=!0,this._syncScroller(),this._adjustScrollerSize(),null!=this.m_cellToFocus){var i=this.m_cellToFocus;this.m_cellToFocus=null,this._setActive(i,this._createActiveObject(i),null,!1,!1,!0)}if(null!=this.m_scrollIndexAfterFetch&&this._isInViewport(this.m_scrollIndexAfterFetch)===A.INSIDE&&(this._isDatabodyCellActive()&&this.m_scrollIndexAfterFetch.row===this.m_active.indexes.row&&this.m_scrollIndexAfterFetch.column===this.m_active.indexes.column&&this._highlightActive(),this.m_scrollIndexAfterFetch=null),null!=this.m_scrollHeaderAfterFetch){let e="row";const t=this.m_scrollHeaderAfterFetch.index;"column"!==this.m_scrollHeaderAfterFetch.axis&&"columnEnd"!==this.m_scrollHeaderAfterFetch.axis||(e="column"),this._isAxisIndexInViewport(t,e)===A.INSIDE&&(this._isDatabodyCellActive()||this.m_scrollHeaderAfterFetch.axis!==this.m_active.axis||this.m_scrollHeaderAfterFetch.index!==this.m_active.index||this.m_scrollHeaderAfterFetch.level!==this.m_active.level||this._highlightActive(),this.m_scrollHeaderAfterFetch=null)}this.m_prevScrollTop===t&&this.m_prevScrollLeft===e||this.fireEvent("scroll",{event:null,ui:{scrollX:e,scrollY:t}}),this.isFetchComplete()&&this._checkScrollPosition()},A.prototype._scrollTransitionEnd=function(){this._isSelectionEnabled()&&this._scrollTouchSelectionAffordance(),this.fireEvent("scroll",{event:null,ui:{scrollX:this.m_currentScrollLeft,scrollY:this.m_currentScrollTop}}),this._shouldLongScroll(this.m_currentScrollLeft,this.m_currentScrollTop)?this.handleLongScroll(this.m_currentScrollLeft,this.m_currentScrollTop):this.fillViewport(),this._checkScroll=!0,this.isFetchComplete()&&this._checkScrollPosition()},A.prototype._syncScroller=function(){const e=this.m_currentScrollLeft,t=this.m_currentScrollTop,i=this.m_colHeader.firstChild,s=this.m_rowHeader.firstChild,o=this.m_colEndHeader.firstChild,n=this.m_rowEndHeader.firstChild,r=this.m_databodyFrozenCol?this.m_databodyFrozenCol.firstChild:null,l=this.m_databodyFrozenRow?this.m_databodyFrozenRow.firstChild:null,a=this.getResources().isRTLMode()?"right":"left";this.setElementDir(i,-e,a),this.setElementDir(o,-e,a),this.setElementDir(s,-t,"top"),this.setElementDir(n,-t,"top"),l&&this.setElementDir(l,-e,a),r&&this.setElementDir(r,-t,"top")},A.prototype._adjustScrollerSize=function(){var e=this.m_databody.firstChild,t=this.getElementHeight(e),i=this.getElementWidth(e),s=this._getEmptyElement(),o=0,n=0;s&&(o=this.getElementHeight(s),n=this.getElementWidth(s)),(this._getMaxBottomPixel()>t||this.getDataSource().getCount("row")===this._getMaxBottom()+1&&!this._isCountUnknown("row")&&this._getMaxBottom()>-1)&&this._setAllScrollableRegions("height",Math.max(this._getMaxBottomPixel(),o)),(this._getMaxRightPixel()>i||this.getDataSource().getCount("column")===this._getMaxRight()+1&&!this._isCountUnknown("column")&&this._getMaxRight()>-1)&&this._setAllScrollableRegions("width",Math.max(this._getMaxRightPixel(),n))},A.prototype._getLongScrollStart=function(e,t,i){var s,o,n,r,l,a,h,d,m;let c;if(t!==e){"row"===i?(s=this.getElementHeight(this.m_databody.firstChild),o=this.m_utils._getMaxDivHeightForScrolling(),n=this._getMaxScrollHeight(),r=this.m_avgRowHeight,m=this.m_hiddenRows,l=this.m_hasHorizontalScroller?this.m_utils.getScrollbarSize():0,d=Math.max(this.getDataSource().getCount(i)-m.length,this.m_endRow,this.m_maxRowYet,0),c={down:!0}):"column"===i&&(s=this.getElementWidth(this.m_databody.firstChild),o=this.m_utils._getMaxDivWidthForScrolling(),n=this._getMaxScrollWidth(),r=this.m_avgColWidth,m=this.m_hiddenColumns,l=this.m_hasVerticalScroller?this.m_utils.getScrollbarSize():0,d=Math.max(this.getDataSource().getCount(i)-m.length,this.m_endCol,this.m_maxColYet,0),c={right:!0});var u=Math.max(Math.min(e/s,1),0),_=this.getFetchSize(i);if(o>s){let t=Math.floor(e/r);m.forEach(e=>{e<t&&(t+=1)}),a=this.getVisibleCellIndexInDirection(i,t,c)}else o<=s&&(a=Math.floor(d*u));if(h=Math.min(e,n),!this._isHighWatermarkScrolling()&&0===a&&("row"===i&&this._hasFrozenRows()||"column"===i&&this._hasFrozenColumns())&&(a="row"===i?this.m_frozenRowIndex+1:this.m_frozenColIndex+1),1===u||e+_*r>s-l){let e="column"===i?Math.max(this.getDataSource().getCount(i),this.m_endCol,this.m_maxColYet,0):Math.max(this.getDataSource().getCount(i),this.m_endRow,this.m_maxRowYet,0),t=e-_,s=m.filter(i=>i>=t&&i<e).length,o=t-s;for(;o>0&&m.includes(o);)o-=1;a=Math.max(o,0);let n=this._getHiddenCountBeforeIndex(a,i);if(h=Math.max((a-n)*r,0),!this._isHighWatermarkScrolling()&&"row"===i&&this._hasFrozenRows()){let e=this._getHiddenCountBeforeIndex(this.m_frozenRowIndex+1,i);h=Math.max((a-n-(this.m_frozenRowIndex+1)-e)*r,0)}if(!this._isHighWatermarkScrolling()&&"column"===i&&this._hasFrozenColumns()){let e=this._getHiddenCountBeforeIndex(this.m_frozenColIndex+1,i);h=Math.max((a-n-(this.m_frozenColIndex+1)-e)*r,0)}}}else"row"===i?(a=null!=this.m_longScrollRow?this.m_longScrollRow:this.m_startRow,h=null!=this.m_longScrollRowPixel?this.m_longScrollRowPixel:this.m_startRowPixel):"column"===i&&(a=null!=this.m_longScrollColumn?this.m_longScrollColumn:this.m_startCol,h=null!=this.m_longScrollColumnPixel?this.m_longScrollColumnPixel:this.m_startColPixel);return{start:a,startPixel:h}},A.prototype.handleLongScroll=function(e,t){this.m_isLongScroll=!0;const i=this._getLongScrollStart(t,this.m_prevScrollTop,"row");this.m_longScrollRow=i.start,this.m_longScrollRowPixel=i.startPixel;const s=this._getLongScrollStart(e,this.m_prevScrollLeft,"column");if(this.m_longScrollColumn=s.start,this.m_longScrollColumnPixel=s.startPixel,this.isSkeletonSupport()&&this.loadSkeletons(t,e,this.m_longScrollRow,this.m_longScrollColumn,this.m_longScrollRowPixel,this.m_longScrollColumnPixel),this.isFetchComplete()&&this._isScrollBackToEditable(!0)){const e=this.m_longScrollRow,t=this.m_longScrollRowPixel,i=this.m_longScrollColumn,s=this.m_longScrollColumnPixel;let o=!0,n=()=>{o&&(o=!1,this.m_resizeRequired=!0,this.m_hasCells&&(this.m_startRow=e,this.m_endRow=-1,this.m_startRowPixel=t,this.m_endRowPixel=t,this.m_startCol=i,this.m_endCol=-1,this.m_startColPixel=s,this.m_endColPixel=s),this.m_hasRowHeader&&(this.m_startRowHeader=e,this.m_endRowHeader=-1,this.m_startRowHeaderPixel=t,this.m_endRowHeaderPixel=t),this.m_hasRowEndHeader&&(this.m_startRowEndHeader=e,this.m_endRowEndHeader=-1,this.m_startRowEndHeaderPixel=t,this.m_endRowEndHeaderPixel=t),this.m_hasColHeader&&(this.m_startColHeader=i,this.m_endColHeader=-1,this.m_startColHeaderPixel=s,this.m_endColHeaderPixel=s),this.m_hasColEndHeader&&(this.m_startColEndHeader=i,this.m_endColEndHeader=-1,this.m_startColEndHeaderPixel=s,this.m_endColEndHeaderPixel=s),this.m_stopRowFetch=!1,this.m_stopRowHeaderFetch=!1,this.m_stopRowEndHeaderFetch=!1,this.m_stopColumnFetch=!1,this.m_stopColumnHeaderFetch=!1,this.m_stopColumnEndHeaderFetch=!1)};this.fetchHeaders("row",e,this.m_rowHeader,this.m_rowEndHeader,void 0,{success:function(e,t,i,s,o,r,l){n(),this.handleHeadersFetchSuccessForLongScroll(e,t,i,s,o,r,l)}}),this.fetchHeaders("column",i,this.m_colHeader,this.m_colEndHeader,void 0,{success:function(e,t,i,s,o,r,l){n(),this.handleHeadersFetchSuccessForLongScroll(e,t,i,s,o,r,l)}}),this.fetchCells(this.m_databody,e,i,null,null,{success:function(o,r,l,a,h,d,m){n(),this.handleCellsFetchSuccessForLongScroll(o,r,e,i,t,s,l,a,h,d,m)}})}},A.prototype.handleHeadersFetchSuccessForLongScroll=function(e,t,i,s,o,n,r){let l=this.m_rowHeader.firstChild,a=this.m_rowEndHeader.firstChild;"column"===t.axis&&(l=this.m_colHeader.firstChild,a=this.m_colEndHeader.firstChild),null!=l&&this._removeAllNonSkeletonContainerNodes(l),null!=a&&this._removeAllNonSkeletonContainerNodes(a),this.handleHeadersFetchSuccess(e,t,i,s,o,n,r)},A.prototype.handleCellsFetchSuccessForLongScroll=function(e,t,i,s,o,n,r,l,a,h,d){const m=this.m_databody.firstChild;if(null!=m&&!this._getEmptyElement()){this._getAllNonSkeletonContainerNodes(m).forEach(e=>{this._remove(e)})}if(this._hasFrozenColumns()&&this.m_currentScrollTop!==this.m_prevScrollTop){this._getAllNonSkeletonContainerNodes(this.m_databodyFrozenCol.firstChild).forEach(e=>{this._remove(e)})}if(this._hasFrozenRows()&&this.m_currentScrollLeft!==this.m_prevScrollLeft){this._getAllNonSkeletonContainerNodes(this.m_databodyFrozenRow.firstChild).forEach(e=>{this._remove(e)})}this.handleCellsFetchSuccess(e,t,r,l,a,h,d)},A.prototype._cleanupViewport=function(e){if(!this._isHighWatermarkScrolling()&&this._isScrollBackToEditable()){null==e&&(this.m_prevScrollLeft>this.m_currentScrollLeft?e="right":this.m_prevScrollLeft<this.m_currentScrollLeft?e="left":this.m_prevScrollTop>this.m_currentScrollTop?e="bottom":this.m_prevScrollTop<this.m_currentScrollTop&&(e="top"));var t=this._getViewportLeft(),i=this._getViewportRight(),s=this._getViewportTop(),o=this._getViewportBottom();"top"===e&&s>this._getMaxTopPixel()?(this.removeRowsFromTop(this.m_databody),this.removeRowHeadersFromTop()):"bottom"===e&&o<this._getMaxBottomPixel()?(this.removeRowsFromBottom(this.m_databody),this.removeRowHeadersFromBottom()):"left"===e&&t>this._getMaxLeftPixel()?(this.removeColumnsFromLeft(this.m_databody),this.removeColumnHeadersFromLeft()):"right"===e&&i<this._getMaxRightPixel()&&(this.removeColumnsFromRight(this.m_databody),this.removeColumnHeadersFromRight())}},A.prototype.fillViewport=function(){var e,t;const i=this._getLongScrollStart(this.m_currentScrollTop,this.m_prevScrollTop,"row"),s=this._getLongScrollStart(this.m_currentScrollLeft,this.m_prevScrollLeft,"column");if(this.isSkeletonSupport()&&this.loadSkeletons(this.m_currentScrollTop,this.m_currentScrollLeft,i.start,s.start,i.startPixel,s.startPixel),this.isFetchComplete()){var o=this._getViewportLeft(),n=this._getViewportRight()+A.FETCH_PIXEL_THRESHOLD,r=this._getViewportTop(),l=this._getViewportBottom()+A.FETCH_PIXEL_THRESHOLD;let i=this._isHighWatermarkScrolling();if(this._getMaxBottomPixel()<=l&&(!this.m_stopRowHeaderFetch||!this.m_stopRowEndHeaderFetch||!this.m_stopRowFetch))return e=Math.max(0,this._getMaxBottom()+1),t=Math.max(0,this.getFetchCount("row",e)),this.fetchHeaders("row",e,this.m_rowHeader,this.m_rowEndHeader,t),void this.fetchCells(this.m_databody,e,this.m_startCol,t,this.m_endCol-this.m_startCol+1);if((this._getMaxTopPixel()>r||0===this.m_currentScrollTop)&&(this._getMaxTop()>0&&(!this._hasFrozenRows()||this._hasFrozenRows()&&i)||this._hasFrozenRows()&&this._getMaxTop()>this.m_frozenRowIndex+1&&!i))return e=Math.max(0,this._getMaxTop()-this.getFetchSize("row")),!i&&this._hasFrozenRows()&&e<this.m_frozenRowIndex+1&&(e=this.m_frozenRowIndex+1),t=Math.max(0,this._getMaxTop()-e),this.fetchHeaders("row",e,this.m_rowHeader,this.m_rowEndHeader,t),void this.fetchCells(this.m_databody,e,this.m_startCol,t,this.m_endCol-this.m_startCol+1);if(this._getMaxRightPixel()<=n&&(!this.m_stopColumnHeaderFetch||!this.m_stopColumnEndHeaderFetch||!this.m_stopColumnFetch))return e=Math.max(0,this._getMaxRight()+1),t=Math.max(0,this.getFetchCount("column",e)),this.fetchHeaders("column",e,this.m_colHeader,this.m_colEndHeader,t),void this.fetchCells(this.m_databody,this.m_startRow,e,this.m_endRow-this.m_startRow+1,t);(this._getMaxLeftPixel()>o||0===this.m_currentScrollLeft)&&(this._getMaxLeft()>0&&(!this._hasFrozenColumns()||this._hasFrozenColumns()&&i)||this._hasFrozenColumns()&&this._getMaxLeft()>this.m_frozenColIndex+1&&!i)&&(e=Math.max(0,this._getMaxLeft()-this.getFetchSize("column")),!i&&this._hasFrozenColumns()&&e<this.m_frozenColIndex+1&&(e=this.m_frozenColIndex+1),t=Math.max(0,this._getMaxLeft()-e),this.fetchHeaders("column",e,this.m_colHeader,this.m_colEndHeader,t),this.fetchCells(this.m_databody,this.m_startRow,e,this.m_endRow-this.m_startRow+1,t))}},A.prototype._getMaxRight=function(){return Math.max(this.m_endCol,this.m_endColHeader,this.m_endColEndHeader)},A.prototype._getMaxLeft=function(){return Math.max(this.m_startCol,this.m_startColHeader,this.m_startColEndHeader)},A.prototype._getMaxRightPixel=function(){return Math.max(this.m_endColPixel,this.m_endColHeaderPixel,this.m_endColEndHeaderPixel)},A.prototype._getMaxLeftPixel=function(){return Math.max(this.m_startColPixel,this.m_startColHeaderPixel,this.m_startColEndHeaderPixel)},A.prototype._getMaxBottom=function(){return Math.max(this.m_endRow,this.m_endRowHeader,this.m_endRowEndHeader)},A.prototype._getMaxTop=function(){return Math.max(this.m_startRow,this.m_startRowHeader,this.m_startRowEndHeader)},A.prototype._getMaxBottomPixel=function(){return Math.max(this.m_endRowPixel,this.m_endRowHeaderPixel,this.m_endRowEndHeaderPixel)},A.prototype._getMaxTopPixel=function(){return Math.max(this.m_startRowPixel,this.m_startRowHeaderPixel,this.m_startRowEndHeaderPixel)},A.prototype._isScrollBackToEditable=function(e){var t=this._getCurrentMode(),i=this._getActiveElement();return"edit"!==t||!e&&!this._isCellGoingToBeRemoved(i)||this._handleExitEdit(null,i)},A.prototype._isCellGoingToBeRemoved=function(e){if(!this._isHighWatermarkScrolling()){if(this.m_endRow-this.m_startRow>this.MAX_ROW_THRESHOLD){var t=this.getElementDir(e.parentNode,"top");if(t+this.getElementHeight(e)<this.m_currentScrollTop||t<this.m_currentScrollTop+this.getViewportHeight())return!0}if(this.m_endCol-this.m_startCol>this.MAX_COLUMN_THRESHOLD){var i=this.getElementDir(e,"left");if(i+this.getElementWidth(e)<this.m_currentScrollLeft||i<this.m_currentScrollLeft+this.getViewportHeight())return!0}}},A.prototype._removeCellsAlongAxis=function(e,t,i){var s,o,n,r,l,a,h,d,m,c,u,_,g=0,p=0;let f;"row"===e?(o=this.m_startRow,n=this.m_endRow,r=this.m_rowHeaderLevelCount,l="height",a=this.m_startRowPixel,h=this.m_endRowPixel,d=this.m_currentScrollTop,m="column",c=this.m_startCol,u=this.m_endCol,_="top",s=i?n:o,f=this.m_frozenColIndex):(o=this.m_startCol,n=this.m_endCol,r=this.m_columnHeaderLevelCount,l="width",a=this.m_startColPixel,h=this.m_endColPixel,d=this.m_currentScrollLeft,m="row",c=this.m_startRow,u=this.m_endRow,_=this.getResources().isRTLMode()?"right":"left",s=i?n:o,f=this.m_frozenRowIndex);let C=[];for(;s<=n&&s>=o;){var y,w=this._getKey(this._getHeaderByIndex(s,e,r-1),e);if(null==w&&(w=this._getKey(this._getCellByIndex("column"===e?this.createIndex(this.m_startRow,s):this.createIndex(s,this.m_startCol)),e)),this.isHidden(e,s)?(y=0,C.push(s)):y=this._getCellDimension(null,s,w,e,l),!(i?h-y-g>t:a+y+g<d-t))break;for(var E,v=c;v<=u;v+=E)E=this._removeCells(v,s,e,m,l,y,_,i);if(!this._isHighWatermarkScrolling()&&0!==c&&("row"===e&&this._hasFrozenColumns()||"column"===e&&this._hasFrozenRows()))for(let t=0;t<=f;t+=E)E=this._removeCells(t,s,e,m,l,y,_,i);g+=y,p+=1,s=i?s-1:s+1}return this.deleteHiddenIndicators(C,this.m_databody.firstChild),{dimensionChange:g,extentChange:p}},A.prototype._removeCells=function(e,t,i,s,o,n,r,l){let a,h=this._getCellByIndex("column"===i?this.createIndex(e,t):this.createIndex(t,e)),d=h[this.getResources().getMappedAttribute("context")],m=d.extents[i];a=d.extents[s],1===m?this._remove(h):(d.extents[i]-=1,this.setElementDir(h,this.getElementDir(h,o)-n,o),l||(d.indexes[i]+=1,this.setElementDir(h,this.getElementDir(h,r)+n,r)));for(let s=0;s<a;s++){let o="column"===i?this.createIndex(e+s,t):this.createIndex(t,e+s);this._removeIndexFromDatabodyMap(o)}return a},A.prototype.removeHeadersFromStartOfContainer=function(e,t,i,s,o,n,r,l){const a=this.getResources().getMappedAttribute("context");var h=0,d=0;let m=Array.from(e.children).filter(e=>this.m_utils.containsCSSClassName(e,o)||this.m_utils.containsCSSClassName(e,this.getMappedStyle("groupingcontainer")));var c=null==t?m[0]:t.nextSibling;if(null==c)return{extentChange:0,dimensionChange:0};var u=this.m_utils.containsCSSClassName(c,o),_=u?c:c.firstChild,g=this.getElementDir(_,n);let p=[];for(;i+g<l-s;){if(this._remove(c),u){let e=c[a].axis,t=c[a].index;this.isHidden(e,t)&&p.push(t)}if(m.shift(),d+=g,h+=u?1:this._getAttribute(c,"extent",!0),i+=g,null==(c=null==t?m[0]:t.nextSibling))return{extentChange:h,dimensionChange:d};_=(u=this.m_utils.containsCSSClassName(c,o))?c:c.firstChild,g=this.getElementDir(_,n)}if(this.deleteHiddenIndicators(p,e),!u){var f=this.removeHeadersFromStartOfContainer(c,c.firstChild,i,s,o,n,r,l);this._setAttribute(c,"start",this._getAttribute(c,"start",!0)+f.extentChange),this._setAttribute(c,"extent",this._getAttribute(c,"extent",!0)-f.extentChange),this.setElementDir(_,this.getElementDir(_,r)+f.dimensionChange,r),this.setElementDir(_,this.getElementDir(_,n)-f.dimensionChange,n),_[a].index+=f.extentChange,_[a].extent-=f.extentChange,h+=f.extentChange,d+=f.dimensionChange}return{extentChange:h,dimensionChange:d}},A.prototype.removeHeadersFromEndOfContainer=function(e,t,i,s,o){const n=this.getResources().getMappedAttribute("context");var r=0,l=0;let a=Array.from(e.children).filter(e=>this.m_utils.containsCSSClassName(e,s)||this.m_utils.containsCSSClassName(e,this.getMappedStyle("groupingcontainer"))),h=a[a.length-1];var d=this.m_utils.containsCSSClassName(h,s),m=d?h:h.firstChild,c=this.getElementDir(m,o);let u=[];for(;t-c>i;){if(this._remove(h),d){let e=h[n].axis,t=h[n].index;this.isHidden(e,t)&&u.push(t)}a.pop(),l+=c,r+=d?1:this._getAttribute(h,"extent",!0),t-=c,h=a[a.length-1],m=(d=this.m_utils.containsCSSClassName(h,s))?h:h.firstChild,c=this.getElementDir(m,o)}if(this.deleteHiddenIndicators(u,e),!d){var _=this.removeHeadersFromEndOfContainer(h,t,i,s,o);this._setAttribute(h,"extent",this._getAttribute(h,"extent",!0)-_.extentChange),this.setElementDir(m,this.getElementDir(m,o)-_.dimensionChange,o),m[n].extent-=_.extentChange,r+=_.extentChange,l+=_.dimensionChange}return{extentChange:r,dimensionChange:l}},A.prototype.removeColumnHeadersFromLeft=function(){var e,t;if(this.m_endColHeader-this.m_startColHeader>this.MAX_COLUMN_THRESHOLD){var i=this.m_colHeader.firstChild;e=this.getColumnThreshold(),this.m_startColHeaderPixel<=this.m_currentScrollLeft-e&&(t=this.removeHeadersFromStartOfContainer(i,null,this.m_startColHeaderPixel,e,this.getMappedStyle("colheadercell"),"width",this.getResources().isRTLMode()?"right":"left",this.m_currentScrollLeft),this.m_startColHeaderPixel+=t.dimensionChange,this.m_startColHeader+=t.extentChange)}if(this.m_endColEndHeader-this.m_startColEndHeader>this.MAX_COLUMN_THRESHOLD){var s=this.m_colEndHeader.firstChild;e=this.getColumnThreshold(),this.m_startColEndHeaderPixel<this.m_currentScrollLeft-e&&(t=this.removeHeadersFromStartOfContainer(s,null,this.m_startColEndHeaderPixel,e,this.getMappedStyle("colendheadercell"),"width",this.getResources().isRTLMode()?"right":"left",this.m_currentScrollLeft),this.m_startColEndHeaderPixel+=t.dimensionChange,this.m_startColEndHeader+=t.extentChange)}},A.prototype.removeColumnsFromLeft=function(e){if(this.m_endCol-this.m_startCol>this.MAX_COLUMN_THRESHOLD){var t=e.firstChild.querySelectorAll("."+this.getMappedStyle("cell")),i=this.getColumnThreshold();if(t.length<1)return;var s=this._removeCellsAlongAxis("column",i,!1);this.m_startColPixel+=s.dimensionChange,this.m_startCol+=s.extentChange}},A.prototype.removeColumnHeadersFromRight=function(){var e,t,i=this.m_currentScrollLeft+this.getViewportWidth()+this.getColumnThreshold();this.m_endColHeader-this.m_startColHeader>this.MAX_COLUMN_THRESHOLD&&(e=this.m_colHeader.firstChild,this.m_endColHeaderPixel>i&&e.childNodes.length&&(this.m_stopColumnHeaderFetch&&(this.m_stopColumnHeaderFetch=!1),t=this.removeHeadersFromEndOfContainer(e,this.m_endColHeaderPixel,i,this.getMappedStyle("colheadercell"),"width"),this.m_endColHeaderPixel-=t.dimensionChange,this.m_endColHeader-=t.extentChange)),this.m_endColEndHeader-this.m_startColEndHeader>this.MAX_COLUMN_THRESHOLD&&(e=this.m_colEndHeader.firstChild,this.m_endColEndHeaderPixel>i&&(this.m_stopColumnEndHeaderFetch&&(this.m_stopColumnEndHeaderFetch=!1),t=this.removeHeadersFromEndOfContainer(e,this.m_endColEndHeaderPixel,i,this.getMappedStyle("colendheadercell"),"width"),this.m_endColEndHeaderPixel-=t.dimensionChange,this.m_endColEndHeader-=t.extentChange))},A.prototype.removeColumnsFromRight=function(e){if(this.m_endCol-this.m_startCol>this.MAX_COLUMN_THRESHOLD){var t=e.firstChild.querySelectorAll("."+this.getMappedStyle("cell")),i=this.m_currentScrollLeft+this.getViewportWidth()+this.getColumnThreshold();if(this.m_endColPixel<=i||t.length<1)return;this.m_stopColumnFetch&&(this.m_stopColumnFetch=!1);var s=this._removeCellsAlongAxis("column",i,!0);this.m_endColPixel-=s.dimensionChange,this.m_endCol-=s.extentChange}},A.prototype.removeRowHeadersFromTop=function(){var e,t;if(this.m_endRowHeader-this.m_startRowHeader>this.MAX_ROW_THRESHOLD){var i=this.m_rowHeader.firstChild;t=this.getRowThreshold(),this.m_startRowHeaderPixel>=this.m_currentScrollTop-t||(e=this.removeHeadersFromStartOfContainer(i,null,this.m_startRowHeaderPixel,t,this.getMappedStyle("rowheadercell"),"height","top",this.m_currentScrollTop),this.m_startRowHeaderPixel+=e.dimensionChange,this.m_startRowHeader+=e.extentChange)}if(this.m_endRowEndHeader-this.m_startRowEndHeader>this.MAX_ROW_THRESHOLD){var s=this.m_rowEndHeader.firstChild;t=this.getRowThreshold(),this.m_startRowEndHeaderPixel>=this.m_currentScrollTop-t||(e=this.removeHeadersFromStartOfContainer(s,null,this.m_startRowEndHeaderPixel,t,this.getMappedStyle("rowendheadercell"),"height","top",this.m_currentScrollTop),this.m_startRowEndHeaderPixel+=e.dimensionChange,this.m_startRowEndHeader+=e.extentChange)}},A.prototype.removeRowsFromTop=function(e){if(this.m_endRow-this.m_startRow>this.MAX_ROW_THRESHOLD){var t=this.getRowThreshold();if(this.m_startRowPixel>=this.m_currentScrollTop-t)return;var i=this._removeCellsAlongAxis("row",t,!1);this.m_startRowPixel+=i.dimensionChange,this.m_startRow+=i.extentChange}},A.prototype.removeRowHeadersFromBottom=function(){var e,t=this.m_currentScrollTop+this.getViewportHeight()+this.getRowThreshold();if(this.m_endRowHeader-this.m_startRowHeader>this.MAX_ROW_THRESHOLD){var i=this.m_rowHeader.firstChild;this.m_endRowHeaderPixel<=t||(this.m_stopRowHeaderFetch&&(this.m_stopRowHeaderFetch=!1),e=this.removeHeadersFromEndOfContainer(i,this.m_endRowHeaderPixel,t,this.getMappedStyle("rowheadercell"),"height"),this.m_endRowHeaderPixel-=e.dimensionChange,this.m_endRowHeader-=e.extentChange)}if(this.m_endRowEndHeader-this.m_startRowEndHeader>this.MAX_ROW_THRESHOLD){var s=this.m_rowEndHeader.firstChild;this.m_endRowEndHeaderPixel<=t||(this.m_stopRowEndHeaderFetch&&(this.m_stopRowEndHeaderFetch=!1),e=this.removeHeadersFromEndOfContainer(s,this.m_endRowEndHeaderPixel,t,this.getMappedStyle("rowendheadercell"),"height"),this.m_endRowEndHeaderPixel-=e.dimensionChange,this.m_endRowEndHeader-=e.extentChange)}},A.prototype.removeRowsFromBottom=function(e){if(this.m_endRow-this.m_startRow>this.MAX_ROW_THRESHOLD){var t=this.m_currentScrollTop+this.getViewportHeight()+this.getRowThreshold();if(this.m_endRowPixel<=t)return;this.m_stopRowFetch&&(this.m_stopRowFetch=!1);var i=this._removeCellsAlongAxis("row",t,!0);this.m_endRowPixel-=i.dimensionChange,this.m_endRow-=i.extentChange}},A.prototype.handleContextMenuGesture=function(e,t,i){let s,o,n;const r="disable",l=e.originalEvent.target;let a=!1,h=!1,d=!1,m=this.findCell(l);if(m&&(d=!0),null===m&&(m=this.findHeader(l),m&&(a=!0)),null===m&&(m=this.findLabel(l),m&&(h=!0)),"touch"===t&&null!=m){s=a||h?this.getHeaderCellIndex(m):this.getCellIndexes(m);let t=a||h?this._isHeaderInsideSelection(s,this.getHeaderCellAxis(m)):this._isContainSelection(s);(!this.isMultipleSelection()||!t||this._isDatabodyCellActive()&&s.row!==this.m_active.indexes.row&&s.column!==this.m_active.indexes.column)&&(this._isSelectionEnabled()?this.handleDatabodyClickSelection(e.originalEvent):this.handleDatabodyClickActive(e.originalEvent))}if(!this.m_utils._isNodeEditableOrClickable(l,this.m_root)){if(m&&d)s=this.getCellIndexes(m),this.isMultipleSelection()&&this._isContainSelection(s)?(n=this._getActiveElement(),this._isDatabodyCellActive()?(null==n&&(n=m),o=this._getCellCapability(n)):o=this._getHeaderOrLabelCapability(n,m)):(n=m,o=this._getCellCapability(n)),this.m_selectionFrontier&&"row"===this.m_selectionFrontier.axis?o.resizeWidth=r:this.m_selectionFrontier&&"column"===this.m_selectionFrontier.axis&&(o.resizeHeight=r);else if(m&&(a||h)){o=this._getHeaderOrLabelCapability(m);const e=this.getHeaderCellAxis(m);"column"!==e&&"columnEnd"!==e||!this.m_selectionFrontier||"column"!==this.m_selectionFrontier.axis?"row"!==e&&"rowEnd"!==e||!this.m_selectionFrontier||"row"!==this.m_selectionFrontier.axis||(o.resizeWidth=r):o.resizeHeight=r,n=m}else o={resize:r,resizeWidth:r,resizeHeight:r,sortRow:r,sortCol:r,cut:r,paste:r,sortColAsc:r,sortColDsc:r,sortRowAsc:r,sortRowDsc:r,filterCol:r},n=m;i.call(null,{capabilities:o,launcher:n},e,t)}},A.prototype._getCellCapability=function(e){const t="disable",i="enable",s={resize:t,resizeWidth:t,resizeHeight:t,sortRow:t,sortCol:t,cut:t,cutCells:t,copyCells:t,paste:t,pasteCells:t,autoFill:t,sortColAsc:t,sortColDsc:t,sortRowAsc:t,sortRowDsc:t,freezeRow:t,freezeCol:t,unfreezeRow:t,unfreezeCol:t,hideCol:t,unhideCol:t,hideRow:t,unhideRow:t,filterCol:t,resizeFitToContent:i};this.m_options.isCopyEnabled()&&(s.copyCells=i),this.m_options.isCutEnabled()&&(s.cutCells=i),this.m_options.isPasteEnabled()&&(s.pasteCells=i);const o=this.m_selection,n=this.m_options.options.selectionMode,r=n.cell,l=n.row;if("single"===r||"none"===r&&"none"===l)s.resizeFitToContent=t;else{const e=new Set;if(this._populateSelectedHeaderSet(e),0===e.size)s.resizeFitToContent=t;else{const i=this.getResources().getMappedAttribute("context");e.forEach(e=>{("row"===e[i].axis&&"disable"===this.m_options.isResizable("row","height")||"column"===e[i].axis&&"disable"===this.m_options.isResizable("column","width"))&&(s.resizeFitToContent=t)})}}let a=!1,h=!0;if(!this.m_discontiguousSelection&&o&&1===o.length){const e=o[0].startIndex.row,t=o[0].startIndex.column,i=o[0].endIndex.row,s=o[0].endIndex.column;e===i&&t===s||(a=!0),e!==i&&t!==s&&(h=!1)}this.m_options.isFloodFillEnabled()&&a&&h&&(s.autoFill=i);const d=this.getResources().getMappedAttribute("context");if(this.m_options.isFreezeEnabled("column")&&(s.freezeCol=i,e[d].indexes.column===this.m_frozenColIndex&&(s.freezeCol=t),s.unfreezeCol=t,this._hasFrozenColumns()&&(s.unfreezeCol=i)),this.m_options.isHideEnabled("row")){const t=this._getCellHidabilityContextMenuCapability(e,"row");t.canHide&&(s.hideRow=i),t.canUnhide&&(s.unhideRow=i)}if(this.m_options.isHideEnabled("column")){const t=this._getCellHidabilityContextMenuCapability(e,"column");t.canHide&&(s.hideCol=i),t.canUnhide&&(s.unhideCol=i)}this.m_options.isFreezeEnabled("row")&&(s.freezeRow=i,e[d].indexes.row===this.m_frozenRowIndex&&(s.freezeRow=t),s.unfreezeRow=t,this._hasFrozenRows()&&(s.unfreezeRow=i));const m=this.getHeaderFromCell(e,"row"),c=this.getHeaderFromCell(e,"column"),u=this.getResources().getMappedAttribute("resizable"),_=this.getResources().getMappedAttribute("sortable");if(null!=c&&("true"===c.getAttribute(u)&&(s.resize=i,s.resizeWidth=i),"true"===c.getAttribute(_))){s.sortCol=i,s.sortColAsc=i,s.sortColDsc=i;const e=c.getAttribute(this.getResources().getMappedAttribute("sortDir"));"ascending"===e?s.sortColAsc=t:"descending"===e&&(s.sortColDsc=t)}return null!=m&&(this._isMoveEnabled("row")&&(s.cut=i,s.paste=i),"true"===m.getAttribute(_)&&(s.sortRow=i,s.sortRowAsc=i,s.sortRowDsc=i),null!=m&&("true"===m.getAttribute(u)&&(s.resize=i,s.resizeHeight=i),"true"===m.getAttribute(_)&&(s.sortRow=i))),s},A.prototype._getHeaderOrLabelCapability=function(e){const t="disable",i="enable",s=this.findLabel(e),o={resize:t,resizeWidth:t,resizeHeight:t,sortRow:t,sortCol:t,cut:t,paste:t,sortColAsc:t,sortColDsc:t,sortRowAsc:t,sortRowDsc:t,freezeRow:t,freezeCol:t,unfreezeRow:t,unfreezeCol:t,hideCol:t,unhideCol:t,hideRow:t,unhideRow:t,filterCol:t,resizeFitToContent:i},n=this.getHeaderCellAxis(e)||this.getHeaderLabelAxis(e),r=this.getResources().getMappedAttribute("resizable"),l=this.getResources().getMappedAttribute("sortable"),a=this.getResources().getMappedAttribute("filterable"),h=this.getResources().getMappedAttribute("context");if(null!==e){if("column"===n||"columnEnd"===n){if("true"===e.getAttribute(r)?(o.resizeWidth=i,o.resize=i):o.resizeFitToContent=t,o.resizeHeight=this.m_options.isResizable(n,"height"),"true"===e.getAttribute(l)&&!s){o.sortCol=i,o.sortColAsc=i,o.sortColDsc=i;var d=e.getAttribute(this.getResources().getMappedAttribute("sortDir"));"ascending"===d?o.sortColAsc=t:"descending"===d&&(o.sortColDsc=t)}if("true"===e.getAttribute(l)&&s){o.sortRow=i,o.sortRowAsc=i,o.sortRowDsc=i;let s=e.getAttribute(this.getResources().getMappedAttribute("sortDir"));"ascending"===s?o.sortRowAsc=t:"descending"===s&&(o.sortRowDsc=t)}this.m_options.isFreezeEnabled("column")&&!s&&(o.freezeCol=i,e[h].index===this.m_frozenColIndex&&(o.freezeCol=t),o.unfreezeCol=t,this._hasFrozenColumns()&&(o.unfreezeCol=i)),s&&this.m_options._isLabelCutEnabled()&&(o.cutCells=i),"true"===e.getAttribute(a)&&(o.filterCol=i)}else{if(this._isMoveEnabled("row")&&(o.cut=i,o.paste=i),"true"===e.getAttribute(r)?(o.resize=i,o.resizeHeight=i):o.resizeFitToContent=t,o.resizeWidth=this.m_options.isResizable(n,"width"),"true"===e.getAttribute(l)&&!s){o.sortRow=i,o.sortRowAsc=i,o.sortRowDsc=i;let s=e.getAttribute(this.getResources().getMappedAttribute("sortDir"));"ascending"===s?o.sortRowAsc=t:"descending"===s&&(o.sortRowDsc=t)}if("true"===e.getAttribute(l)&&s){o.sortCol=i,o.sortColAsc=i,o.sortColDsc=i;let s=e.getAttribute(this.getResources().getMappedAttribute("sortDir"));"ascending"===s?o.sortColAsc=t:"descending"===s&&(o.sortColDsc=t)}this.m_options.isFreezeEnabled("row")&&!s&&(o.freezeRow=i,e[h].index===this.m_frozenRowIndex&&(o.freezeRow=t),o.unfreezeRow=t,this._hasFrozenRows()&&(o.unfreezeRow=i)),s&&this.m_options._isLabelCutEnabled()&&(o.cutCells=i)}if(this.m_options.isHideEnabled(n)){const t=this._getHeaderHidabilityContextMenuCapability(e,n);t.canHide&&("column"===n||"columnEnd"===n?o.hideCol=i:"row"!==n&&"rowEnd"!==n||(o.hideRow=i)),t.canUnhide&&("column"===n||"columnEnd"===n?o.unhideCol=i:"row"!==n&&"rowEnd"!==n||(o.unhideRow=i))}}return o.resize=o.resizeHeight===i||o.resizeWidth===i?i:t,o},A.prototype.handleContextMenuReturn=function(e,t,i){var s,o;if(null!=this.m_active&&(s=this._getActiveElement()),t===this.m_resources.getMappedCommand("resizeHeight")||t===this.m_resources.getMappedCommand("resizeWidth"))this.isResizeEnabled()&&this.handleContextMenuResize(e,t,i,s);else if(t===this.m_resources.getMappedCommand("resizeFitToContent")){let t=this.findCell(e.target);t||(t=this.findHeader(e.target)),t||(t=this.findLabel(e.target)),t&&(this.m_resizingElement=t),this.isResizeEnabled()&&this._getHeadersForResizeFitToContent(e)}else t===this.m_resources.getMappedCommand("sortColAsc")||t===this.m_resources.getMappedCommand("sortColDsc")?(o=t===this.m_resources.getMappedCommand("sortColAsc")?"ascending":"descending",this.m_utils.containsCSSClassName(s,this.getMappedStyle("cell"))&&(s=this.getHeaderFromCell(s,"column")),this._isDOMElementSortable(s)&&(this.m_utils.containsCSSClassName(s,this.getMappedStyle("headerlabel"))?this._handleHeaderLabelSort(s,this.findLabel(s),o):this._handleCellSort(e,o,s))):t===this.m_resources.getMappedCommand("sortRowAsc")||t===this.m_resources.getMappedCommand("sortRowDsc")?(o=t===this.m_resources.getMappedCommand("sortRowAsc")?"ascending":"descending",this.m_utils.containsCSSClassName(s,this.getMappedStyle("cell"))&&(s=this.getHeaderFromCell(s,"row")),this._isDOMElementSortable(s)&&(this.m_utils.containsCSSClassName(s,this.getMappedStyle("headerlabel"))?this._handleHeaderLabelSort(s,this.findLabel(s),o):this._handleCellSort(e,o,s))):t===this.m_resources.getMappedCommand("cut")?this._handleCut(e,s):t===this.m_resources.getMappedCommand("paste")?this._handlePaste(e,s):t===this.m_resources.getMappedCommand("cutCells")?this._handleCutCells(e,s):t===this.m_resources.getMappedCommand("copyCells")?this._handleCopyCells(e,s):t===this.m_resources.getMappedCommand("pasteCells")?this._handlePasteCells(e,s):t===this.m_resources.getMappedCommand("autoFill")?this._handleAutofill(e,s):t===this.m_resources.getMappedCommand("discontiguousSelection")?this.setDiscontiguousSelectionMode(i):t===this.m_resources.getMappedCommand("freezeRow")?this._handleFreezeRow(e,s):t===this.m_resources.getMappedCommand("freezeCol")?this._handleFreezeCol(e,s):t===this.m_resources.getMappedCommand("unfreezeCol")?this._handleUnFreeze("column",e):t===this.m_resources.getMappedCommand("unfreezeRow")?this._handleUnFreeze("row",e):t===this.m_resources.getMappedCommand("hideCol")?this._handleHideAxis(e,"column"):t===this.m_resources.getMappedCommand("unhideCol")?this._handleUnhideAxis(e,"column"):t===this.m_resources.getMappedCommand("hideRow")?this._handleHideAxis(e,"row"):t===this.m_resources.getMappedCommand("unhideRow")?this._handleUnhideAxis(e,"row"):t===this.m_resources.getMappedCommand("filterCol")&&this._handleHeaderFilter(e,"column")},A.prototype._isSortEnabled=function(e,t,i=!1){var s=this.getDataSource().getCapability("sort");let o=this.m_options.isSortable(e,t,i);return!("enable"!==o&&"auto"!==o||"full"!==s&&s!==e)&&(!this._isDataGridProvider()||null!=t.metadata.sortDirection)},A.prototype._isParentNode=function(e){return!!this._isDataGridProvider()&&(e.metadata.expanded&&null!==e.metadata.expanded)},A.prototype._isRequired=function(e){return!!this._isDataGridProvider()&&!0===e.metadata.showRequired},A.prototype._isFilterEnabled=function(e,t){return!("disable"===this.m_options.isFilterEnabled(e,t)||!this._isDataGridProvider())&&null!=t.metadata.filter},A.prototype._isHierarchicalGroup=function(e){return null==e.metadata.treeDepth},A.prototype._isLeafNode=function(e){if(!e.metadata)return!1;const t=e.metadata.treeDepth;return!!this._isDataGridProvider()&&(null!=t&&0!==t)},A.prototype._isDOMElementSortable=function(e){if(null==e)return!1;let t=this.findHeader(e)||this.findLabel(e);return null!=t&&"true"===t.getAttribute(this.getResources().getMappedAttribute("sortable"))},A.prototype._isSelectionEnabled=function(){return"none"!==this.m_options.getSelectionCardinality()},A.prototype.isMultipleSelection=function(){return"multiple"===this.m_options.getSelectionCardinality()},A.prototype.isResizeEnabled=function(){return this.m_options.isResizable("row","width")||this.m_options.isResizable("row","height")||this.m_options.isResizable("column","width")||this.m_options.isResizable("column","height")||this.m_options.isResizable("rowEnd","width")||this.m_options.isResizable("rowEnd","height")||this.m_options.isResizable("columnEnd","width")||this.m_options.isResizable("columnEnd","height")},A.prototype._isHeaderResizeEnabled=function(e,t){return"column"===e||"columnEnd"===e?"enable"===this.m_options.isResizable(e,"width",t):("row"===e||"rowEnd"===e)&&"enable"===this.m_options.isResizable(e,"height",t)},A.prototype.handleMouseMove=function(e){this.isResizeEnabled()&&!1===this.m_databodyDragState&&this.handleResize(e)},A.prototype.handleRowHeaderMouseMove=function(e){0===e.buttons&&this.handleMouseUp(e),this.m_databodyMove&&!this._isDataGridProvider()?this._handleMove(e):this.m_headerDragState&&(this.m_selectionFrontier&&this.m_selectionFrontier.axis&&-1!==this.m_selectionFrontier.axis.indexOf("row")||this.m_deselectInfo&&this.m_deselectInfo.axis&&-1!==this.m_deselectInfo.axis.indexOf("row"))?this.extendSelectionHeader(e.target,e,!0,this.m_deselectInProgress):this.m_isResizing||this.handleMouseMove(e)},A.prototype.handleColumnHeaderMouseMove=function(e){0===e.buttons&&this.handleMouseUp(e),this.m_headerDragState&&(this.m_selectionFrontier&&this.m_selectionFrontier.axis&&-1!==this.m_selectionFrontier.axis.indexOf("column")||this.m_deselectInfo&&this.m_deselectInfo.axis&&-1!==this.m_deselectInfo.axis.indexOf("column"))?this.extendSelectionHeader(e.target,e,!0,this.m_deselectInProgress):this.m_isResizing||this.handleMouseMove(e)},A.prototype.handleHeaderLabelMouseMove=function(e){this.m_isResizing||this.handleMouseMove(e)},A.prototype.handleHeaderMouseDown=function(e){var t;this.deleteDatabodyHiddenVisualIndicators();const i=this.findHeader(e.target);if(null==i)return;this.m_shouldFocus=!1;var s=e.target;const o=this._getActiveElement();if(!this._isEditOrEnter()||!1!==this._leaveEditing(e,o,!1)){var n=this.m_options.getSelectionMode();if(0===e.button){if(this._isSortIcon(s)&&this._isDOMElementSortable(s))return this.handleHeaderClickActive(e,null,!0),void this._handleSortIconMouseDown(s,i);if(this._isFilterIcon(s)&&this._isDOMElementFilterable(s))return void this.handleHeaderClickActive(e,null,!0);if(this._isDisclosureIcon(s))return void this.handleHeaderClickActive(e,null,!0);this.isResizeEnabled()&&(t=this.handleResizeMouseDown(e),this._highlightResizeMouseDown());var r=this.m_utils.ctrlEquivalent(e);this._isDataGridProvider()||this.m_isResizing||r||!this._isMoveOnElementEnabled(this.findHeader(s))||(this.m_databodyMove=!0,this.m_currentX=e.pageX,this.m_currentY=e.pageY,t=!0);let o=this.getHeaderCellAxis(i);if(this.m_utils.containsCSSClassName(i,this.getMappedStyle("draggableItem"))&&this.m_utils.addCSSClassName(i,this.getMappedStyle("dragging")),this._isDataGridProvider()&&this.m_options._isDragEnabled(o)&&this.shouldHoverHeader(i)&&this.m_selection&&this.m_selection.length&&this._setHeaderDraggable(i))return}if(!this.m_isResizing&&"default"===this.manageHeaderCursor(e,!1)){this.m_root.contains(document.activeElement)&&document.activeElement!==this.m_root||(this.m_externalFocus=!0);var l=i[this.getResources().getMappedAttribute("context")];!this._isSelectionEnabled()||!this.isMultipleSelection()||"row"===n&&-1===l.axis.indexOf("row")||this.m_databodyMove?"row"===n&&-1!==l.axis.indexOf("row")&&this._isSelectionEnabled()?this.handleHeaderClickSelection(e):this.handleHeaderClickActive(e,null,!0):(0===e.button&&(this.m_headerDragState=!0),this.handleHeaderClickSelection(e))}this.m_options.isFloodFillEnabled()&&this.m_bottomFloodFillIconContainer&&this.m_bottomFloodFillIconContainer.parentNode&&(this.m_bottomFloodFillIconContainer.parentNode.removeChild(this.m_bottomFloodFillIconContainer),this.m_bottomFloodFillIconContainer.removeEventListener("mouseover",this.handleDatabodyMouseMove)),!0===t&&e.preventDefault()}},A.prototype.handleHeaderLabelMouseDown=function(e){var t;const i=this.find(e.target,"headerlabel"),s=this.getResources().getMappedAttribute("context");0!==e.button&&"touchend"!==e.type||this._isSortIcon(e.target)&&this._isDOMElementSortable(e.target)&&(this._handleSortIconMouseDown(e.target,i),this._handleHeaderLabelSort(e,i)),i&&this.m_options._isDragEnabledOnLabel(i[s].axis)&&i.setAttribute("draggable",!0),i&&this.isResizeEnabled()&&(t=this.handleResizeMouseDown(e),this._highlightResizeMouseDown()),!0===t&&e.preventDefault()},A.prototype.handleMouseUp=function(e){this.m_headerDragState=!1,this.m_databodyDragState=!1,this.m_deselectInProgress=!1,this.m_databodyMove?this._handleMoveMouseUp(e,!1):this.isResizeEnabled()&&this.handleResizeMouseUp(e),this.m_databodyMove=!1},A.prototype.shouldHoverHeader=function(e){const t=null==e?null:this.getHeaderCellAxis(e),i=null===e?null:this.getHeaderCellLevel(e),s="row"===t||"rowEnd"===t,o=this.m_options.getSelectionMode();return this._isSelectionEnabled()&&(this.isMultipleSelection()&&"cell"===o||"row"===o&&s&&(this.isMultipleSelection()||null!==i&&i===this.m_rowHeaderLevelCount-1))},A.prototype.handleHeaderMouseOver=function(e){var t=e.target,i=this.findHeader(t);if(this._isDOMElementSortable(e.target)){const e=this._getSortContainer(i);e&&e.classList.remove(this.getMappedStyle("iconHidden"))}if(this._isDOMElementFilterable(e.target)){const e=this._getFilterContainer(i);e&&e.classList.remove(this.getMappedStyle("iconHidden"))}!this.m_isResizing&&"default"===this.manageHeaderCursor(e,!1)&&this.shouldHoverHeader(i)&&this.m_utils.addCSSClassName(i,this.getMappedStyle("hover"));let s=this.getHeaderCellAxis(i);if(this._isDataGridProvider()&&this.shouldHoverHeader(i)&&this.m_options._isDragEnabled(s)&&this.m_selection&&this.m_selection.length&&this._setHeaderDraggable(i),i){const t=this._getToolTipDescription(i,!1);null!=t&&this._setToolTipOpenTimeout(e,i,t)}},A.prototype.handleHeaderMouseOut=function(e){var t=e.target;this._setToolTipCloseTimeout(e),this.m_utils.removeCSSClassName(this.findHeader(t),this.getMappedStyle("hover")),!this.m_isResizing&&this.m_resizingElement&&(this.m_resizingElement.style.cursor="",null!=this.m_resizingElementSibling&&(this.m_resizingElementSibling.style.cursor="")),this._isDOMElementSortable(e.target)&&this._handleSortMouseOut(e),this._isDOMElementFilterable(e.target)&&this._handleFilterMouseOut(e)},A.prototype.handleHeaderMouseUp=function(e){this.handleDragAnchorChange(e),this.m_headerDragState=!1,this.m_databodyDragState=!1,this.m_deselectInProgress=!1,this.m_floodFillDragState&&(this.unhighlightFloodFillRange(),this.m_selectionRange=null,this.m_floodFillRange=null,this.m_floodFillDirection=null,this.m_databody.style.cursor="default",this.m_cursor="default"),this.m_databodyMove&&this._handleMoveMouseUp(e,!0);let t=this.findHeader(e.target),i=this.getHeaderCellAxis(t);this._isDataGridProvider()&&this.m_options._isDragEnabled(i)&&this.shouldHoverHeader(t)&&this.m_selection&&this.m_selection.length&&this._setHeaderDraggable(t),this.m_utils.containsCSSClassName(t,this.getMappedStyle("dragging"))&&this.m_utils.removeCSSClassName(t,this.getMappedStyle("dragging"))},A.prototype.handleCornerMouseDown=function(e){this.deleteDatabodyHiddenVisualIndicators();let t,i=e.target,s=this.m_utils.containsCSSClassName(i,this.getMappedStyle("rowendheaderlabel"))||this.m_utils.containsCSSClassName(i,this.getMappedStyle("columnendheaderlabel")),o=this.findLabel(i);null!=o&&(t=s,this.m_options._isDragEnabledOnLabel()&&(t=!0),this._setActive(o,this._createActiveObject(o),e,t),this.handleHeaderLabelMouseDown(e))},A.prototype.handleCornerMouseOver=function(e){var t=e.target;let i=this.findLabel(t);if(i&&this.m_options._isDragEnabledOnLabel(i[this.getResources().getMappedAttribute("context")].axis)?(this.m_utils.addCSSClassName(i,this.getMappedStyle("draggableItem")),i.setAttribute("draggable",!0)):this._isSelectionEnabled()&&this.isMultipleSelection()&&(i?this.m_utils.addCSSClassName(i,this.getMappedStyle("hover")):this.m_utils.addCSSClassName(this.find(t,"topcorner"),this.getMappedStyle("hover"))),this._isDOMElementSortable(t)){const e=this._getSortContainer(i);e&&e.classList.remove(this.getMappedStyle("iconHidden"))}if(i){const t=this._getToolTipDescription(i,!0);null!=t&&this._setToolTipOpenTimeout(e,i,t)}this.m_isResizing||null===i||this.handleMouseMove(e)},A.prototype.handleCornerMouseMove=function(e){var t=e.target;let i=this.findLabel(t);this.m_isResizing||null===i||this.handleMouseMove(e)},A.prototype.handleCornerMouseOut=function(e){this._setToolTipCloseTimeout(e);var t=e.target;let i=this.findLabel(t);i?(this._isDOMElementSortable(t)&&this._handleSortMouseOut(e),this.m_utils.removeCSSClassName(i,this.getMappedStyle("hover")),this.m_utils.removeCSSClassName(i,this.getMappedStyle("draggableItem")),i.setAttribute("draggable",!1)):this.m_utils.removeCSSClassName(this.find(t,"topcorner"),this.getMappedStyle("hover"))},A.prototype.handleCornerClick=function(e){this.m_resizing||"default"!==this.manageHeaderCursor(e,!0)||this._handleSelectAll(e)},A.prototype.handleHeaderClick=function(e){var t=e.target;this._isSortIcon(t)&&this._isDOMElementSortable(t)?(this._removeTouchSelectionAffordance(),this._handleHeaderSort(e),e.preventDefault()):this._isFilterIcon(t)&&this._isDOMElementFilterable(t)?(this._removeTouchSelectionAffordance(),this._handleHeaderFilter(e),e.preventDefault()):this._isDisclosureIcon(e.target)&&(this._removeTouchSelectionAffordance(),this._handleExpandCollapseRequest(e),e.preventDefault())},A.prototype.handleHeaderDoubleClick=function(e){if(document.contains(e.target)){let t,i=!1,s=this.m_utils.containsCSSClassName(e.target,this.getMappedStyle("colHeaderHiddenIndicator")),o=this.m_utils.containsCSSClassName(e.target,this.getMappedStyle("rowHeaderHiddenIndicator"));if(s?t="column":o&&(t="row"),s||o){let i=this._getAttribute(e.target,"hiddenIndicatorIndex",!0);return void this._handleUnhideAxis(e,t,i)}this.m_cursor=this.manageHeaderCursor(e,i),("col-resize"===this.m_cursor||"row-resize"===this.m_cursor)&&(this.m_resizingElement||(this.m_resizingElement=this.findHeader(e.target)),this.isResizeEnabled()&&this._getHeadersForResizeFitToContent(e))}},A.prototype.handleHeaderLabelDoubleClick=function(e){if(this.isResizeEnabled()){this.m_cursor=this.manageHeaderCursor(e,!0),("col-resize"===this.m_cursor||"row-resize"===this.m_cursor)&&(this.m_resizingElement||(this.m_resizingElement=this.findLabel(e.target)),this._getHeadersForResizeFitToContent(e))}},A.prototype._getHeadersForResizeFitToContent=function(e){let t=this.getHeaderCellAxis(this.m_resizingElement);const i=this.m_resizingElement[this.getResources().getMappedAttribute("context")],s=this._getSelectionAxis(t),o=new Set;let n=!1,r=!1,l=!1,a=this.findCell(this.m_resizingElement);if(a&&(l=!0),null===a&&(a=this.findHeader(this.m_resizingElement),a&&(n=!0)),null===a&&(a=this.findLabel(this.m_resizingElement),a&&(r=!0)),n){if("contextmenu"!==e.type&&"column"===s&&"row-resize"===this.m_cursor||"row"===s&&"col-resize"===this.m_cursor){const s=i.level;t=i.axis;const o=this._getHeadersByLevel(t,s,!0);return void(o.length>0&&this.handleResizeFitToContent(e,o[0],!0,o))}if(this._isSelectionEnabled()&&this.isMultipleSelection()&&0!==this.m_selection.length&&this._isHeaderSelected(i,s)||this._isSelectAllAlongAxis(s))this.m_selection.forEach(e=>{this._getHeadersWithinSelection(e,e.startIndex[s],t).forEach(e=>o.add(e))});else if("column"===t&&this.m_columnHeaderLevelCount>1&&i.level<this.m_columnHeaderLevelCount||"row"===t&&this.m_rowHeaderLevelCount>1&&i.level<this.m_rowHeaderLevelCount||"columnEnd"===t&&this.m_columnEndHeaderLevelCount>1&&i.level<this.m_columnEndHeaderLevelCount||"rowEnd"===t&&this.m_rowEndHeaderLevelCount>1&&i.level<this.m_rowEndHeaderLevelCount){let e;switch(t){case"column":e=this.m_columnHeaderLevelCount-1;break;case"row":e=this.m_rowHeaderLevelCount-1;break;case"columnEnd":e=this.m_columnEndHeaderLevelCount-1;break;default:e=this.m_rowEndHeaderLevelCount-1}o.add(this._getHeaderByIndex(i.index+i.extent-1,s,e))}else o.add(this.m_resizingElement)}else{if(r){let s;t=this._getSelectionAxis(i.axis),"contextmenu"===e.type?s=i.level:(t="col-resize"===this.m_cursor?"row":"column","column"===i.axis||"columnEnd"===i.axis?s="col-resize"===this.m_cursor?this.m_rowHeaderLevelCount-1:i.level:"row"!==i.axis&&"rowEnd"!==i.axis||(s="row-resize"===this.m_cursor?this.m_columnHeaderLevelCount-1:i.level));const o=this._getHeadersByLevel(t,s,!0);return void(o.length>0&&this.handleResizeFitToContent(e,o[0],r,o))}l&&this._populateSelectedHeaderSet(o)}o.forEach(t=>{this.handleResizeFitToContent(e,t,r)})},A.prototype._isSelectAllAlongAxis=function(e){let t=!1;return this.GetSelection().forEach(i=>{-1===i.endIndex[e]&&(t=!0)}),t},A.prototype._populateSelectedHeaderSet=function(e){const t=this.m_options.options.selectionMode.cell;this.m_selection.forEach(t=>{this._getHeadersWithinSelection(t,t.startIndex.row,"row").forEach(t=>e.add(t))}),"multiple"===t&&this.m_selection.forEach(t=>{this._getHeadersWithinSelection(t,t.startIndex.column,"column").forEach(t=>e.add(t))})},A.prototype._getHeadersByLevel=function(e,t,i){const s=[];return("column"===e||"columnEnd"===e&&i)&&(this._hasFrozenColumns()&&s.push(...this.m_colHeaderFrozen.querySelectorAll(`.${this.getMappedStyle("colheadercell")}`)),s.push(...this.m_colHeader.querySelectorAll(`.${this.getMappedStyle("colheadercell")}`))),("columnEnd"===e||"column"===e&&i)&&(this._hasFrozenColumns()&&s.push(...this.m_colEndHeaderFrozen.querySelectorAll(`.${this.getMappedStyle("colendheadercell")}`)),s.push(...this.m_colEndHeader.querySelectorAll(`.${this.getMappedStyle("colendheadercell")}`))),("row"===e||"rowEnd"===e&&i)&&(this._hasFrozenRows()&&s.push(...this.m_rowHeaderFrozen.querySelectorAll(`.${this.getMappedStyle("rowheadercell")}`)),s.push(...this.m_rowHeader.querySelectorAll(`.${this.getMappedStyle("rowheadercell")}`))),("rowEnd"===e||"row"===e&&i)&&(this._hasFrozenRows()&&s.push(...this.m_rowEndHeaderFrozen.querySelectorAll(`.${this.getMappedStyle("rowendheadercell")}`)),s.push(...this.m_rowEndHeader.querySelectorAll(`.${this.getMappedStyle("rowendheadercell")}`))),s.filter(e=>e[this.getResources().getMappedAttribute("context")].level===t)},A.prototype._getHeadersWithinSelection=function(e,t,i){let s,o,n,r,l=[];if("column"===i?(s=this.m_columnHeaderLevelCount-1,o="column"):"columnEnd"===i?(s=this.m_columnEndHeaderLevelCount-1,o="column"):"row"===i?(s=this.m_rowHeaderLevelCount-1,o="row"):(s=this.m_rowEndHeaderLevelCount-1,o="row"),0===e.startIndex.column&&-1===e.endIndex.column&&0===e.startIndex.row&&-1===e.endIndex.row){n=0,r="row"===o?this.m_endRowHeader-this.m_startRowHeader:this.m_endColHeader-this.m_startColHeader}else 0===e.startIndex.column&&-1===e.endIndex.column||void 0===e.startIndex.column?e.startIndex.row<=t&&t<=e.endIndex.row&&("row"===i||"rowEnd"===i)&&(n=e.startIndex.row,r=e.endIndex.row):(0===e.startIndex.row&&-1===e.endIndex.row||void 0===e.startIndex.row)&&e.startIndex.column<=t&&t<=e.endIndex.column&&("column"===i||"columnEnd"===i)&&(n=e.startIndex.column,r=e.endIndex.column);for(let e=n;e<=r;e++){let t=this._getHeaderByIndex(e,i,s);t&&l.push(t)}return l},A.prototype._setHeaderDraggable=function(e){let t=!1;if(this.m_selection&&this.m_selection.length){if(this._isSelectionAcrossAxis())return!1;this.m_utils.containsCSSClassName(e,this.getMappedStyle("selected"))&&(t=!0)}return t&&(this.m_utils.addCSSClassName(e,this.getMappedStyle("draggableItem")),e.setAttribute("draggable",!0)),t},A.prototype._isSelectionAcrossAxis=function(){let e,t=!1;for(let i=0;i<this.m_selection.length;i++){let s=this.m_selection[i];if(e&&(-1===s.endIndex.row&&"column"!==e||-1===s.endIndex.column&&"row"!==e)){t=!0;break}-1===s.endIndex.row?e="column":-1===s.endIndex.column&&(e="row")}return t},A.prototype.handleDatabodyMouseDown=function(e){this.deleteDatabodyHiddenVisualIndicators();var t=e.target,i=this.findCell(t);if(null==i&&!this._getEmptyElement())return void(this.m_scrollbarFocus=!0);this.m_shouldFocus=!1;const s=this._getActiveElement();if(this._isEditOrEnter()){if(i===s)return;if(!1===this._leaveEditing(e,s,!1))return}var o=this.m_utils.ctrlEquivalent(e);0!==e.button||o||this._isMoveOnElementEnabled(i)&&(this.m_databodyMove=!0,this.m_currentX=e.pageX,this.m_currentY=e.pageY),this.m_root.contains(document.activeElement)&&document.activeElement!==this.m_root||(this.m_externalFocus=!0),this._isGridEditable()&&(this.m_shouldFocus=!this._isFocusableElementBeforeCell(t)),this._isSelectionEnabled()?(this.isMultipleSelection()&&0===e.button&&(this.m_databodyDragState=!0),this.handleDatabodyClickSelection(e)):this.handleDatabodyClickActive(e)},A.prototype.handleDatabodyMouseOut=function(e){if(!this.m_databodyMove){var t=e.target,i=this.findCell(t);this._setCellHover(i,"remove")}},A.prototype.handleDatabodyMouseOver=function(e){if(!this.m_databodyMove){var t=e.target,i=this.findCell(t);this._setCellHover(i,"add")}},A.prototype._setCellHover=function(e,t){if(null!=e&&this._isSelectionEnabled()){var i=this.m_options.getSelectionMode();if("cell"===i)"add"===t?this.m_utils.addCSSClassName(e,this.getMappedStyle("hover")):this.m_utils.removeCSSClassName(e,this.getMappedStyle("hover"));else if("row"===i){for(var s=this._getIndex(e,"row"),o=this._getSelectionStartAndEnd(this.createIndex(s,this.m_startCol),this.createIndex(s,this.m_endCol),0),n=o.min.row;n<=o.max.row;n++)this._highlightCellsAlongAxis(n,"row","index",t,["hover"]);if(!this._isHighWatermarkScrolling()&&this._hasFrozenColumns())for(let e=o.min.row;e<=o.max.row;e++)this._highlightCellsAlongAxis(e,"row","index",t,["hover"])}}},A.prototype.handleDatabodyDoubleClick=function(e){if(this._isGridEditable()){var t=e.target,i=this.findCell(t);if("edit"===this._getCurrentMode()){var s=this._getActiveElement();if(i===s)return;if(!this._handleExitEdit(e,s))return}this._handleEditable(e,i),this._handleEdit(e,i)}},A.prototype.handleDatabodyMouseMove=function(e){0===e.buttons&&this.handleMouseUp(e),this.m_databodyMove?this._handleMove(e):this.m_databodyDragState?this.m_floodFillDragState?this._isSelectionEnabled()&&!this.m_discontiguousSelection&&(this.m_selectionRange||(this.m_selectionRange=this.GetSelection()),this.handleDatabodyFloodFillDrag(e)):this.handleDatabodySelectionDrag(e):this.m_headerDragState&&(this.m_selectionFrontier&&this.m_selectionFrontier.axis&&(-1!==this.m_selectionFrontier.axis.indexOf("row")||-1!==this.m_selectionFrontier.axis.indexOf("column"))||this.m_deselectInfo&&this.m_deselectInfo.axis&&(-1!==this.m_deselectInfo.axis.indexOf("row")||-1!==this.m_deselectInfo.axis.indexOf("column")))&&this.extendSelectionHeader(e.target,e,!0,this.m_deselectInProgress)},A.prototype.handleDatabodyMouseUp=function(e){this.m_databodyDragState=!1,this.m_headerDragState=!1,this.m_deselectInProgress=!1,this.m_databodyMove&&this._handleMoveMouseUp(e,!0),this.m_options.isFloodFillEnabled()&&this.m_floodFillDragState&&(this._handleFloodFillMouseUp(e),this.m_floodFillDragState=!1)},A.prototype.handleDatabodyKeyUp=function(e){this.m_deselectInProgress&&(this.m_deselectInProgress=e.shiftKey)},A.prototype.handleDatabodyKeyDown=function(e){let t;const i=this.m_utils.ctrlEquivalent(e);if(e.defaultPrevented&&i&&(this.keyCodes.LEFT_KEY||this.keyCodes.RIGHT_KEY)||this.m_animating)return;const s=this.m_root.getAttribute("id"),o=document.querySelector("#"+s+"contextmenu"),n=e.key||e.keyCode;if(o&&u.isContextMenuKeyEvent(n,e.shiftKey)&&this.handleContextMenuEvent(),t=null!=this.m_active&&"header"===this.m_active.type?this._getActionFromKeyDown(e,this.m_active.axis,!1):null!=this.m_active&&"label"===this.m_active.type?this._getActionFromKeyDown(e,this.m_active.axis,!0):null!=this.m_active&&"empty"===this.m_active.type?this._getActionFromNoDataKeydown(e):this._getActionFromKeyDown(e,"cell",!1),null!=t){const i=this._getActiveElement();t.call(this,e,i)&&e.preventDefault()}},A.prototype.findPos=function(e){if(e){const t=e.getBoundingClientRect();return[t.x,t.y]}return[0,0]},A.prototype._findHeaderOffset=function(e,t,i){if(i||(i=[0,0]),e!==t){for(;!e.offsetParent;)e=e.parentElement;return e.offsetLeft&&(i[0]+=parseInt(e.offsetLeft,10)),e.offsetTop&&(i[1]+=parseInt(e.offsetTop,10)),this._findHeaderOffset(e.offsetParent,t,i)}return i},A.prototype.handleDatabodyMouseWheel=function(e){var t,i=this.find(e.target,"header");if(null==i&&(i=this.find(e.target,"endheader")),i&&(t=i===this.m_rowHeader||i===this.m_rowEndHeader?"row":"column"),!this.m_animating){var s=this.m_utils.getMousewheelScrollDelta(e),o=s.deltaX,n=s.deltaY;if(null===i&&e.target.classList.contains(this.getMappedStyle("frozenCell"))){let t=this._getCellContainer(e.target);t.classList.contains(this.getMappedStyle("databodyFrozenRow"))?n=0:t.classList.contains(this.getMappedStyle("databodyFrozenCol"))?o=0:t.classList.contains(this.getMappedStyle("databodyFrozenCorner"))&&(o=0,n=0)}"row"===t?o=0:"column"===t&&(n=0);var r=Math.max(0,Math.min(this._getMaxScrollHeight(),this.m_currentScrollTop-n));this._getMaxScrollHeight()!==r&&0!==r&&(this.find(e.target,"header")||this.find(e.target,"databodyFrozenCol"))&&e.preventDefault(),(Math.abs(o)>Math.abs(n)&&0!==this.m_currentScrollLeft&&this.m_currentScrollLeft!==this.m_scrollWidth||Math.abs(o)<Math.abs(n)&&0!==this.m_currentScrollTop&&this.m_currentScrollTop!==this.m_scrollHeight)&&e.preventDefault(),this.scrollDelta(o,n)}},A.prototype.handleTouchStart=function(e){var t=e.touches.length,i=e.touches[0].target;if(1===t){if(this.m_startX=e.touches[0].pageX,this.m_startY=e.touches[0].pageY,this.m_currentX=this.m_startX,this.m_currentY=this.m_startY,this.m_prevX=this.m_startX,this.m_prevY=this.m_startY,this.m_startTime=(new Date).getTime(),this.m_touchActive=!0,this.isMultipleSelection()){i.classList.contains(this.getMappedStyle("selectaffordance"))&&(i=i.parentNode);var s=null;if(i===this.m_topSelectIconContainer?s="top":i===this.m_bottomSelectIconContainer&&(s="bottom"),s){this.m_touchMultipleSelect=!0;var o=this.GetSelection();this.m_touchSelectAnchor="top"===s?o[o.length-1].endIndex:o[o.length-1].startIndex}}!this.m_touchMultipleSelect&&this._isMoveOnElementEnabled(this.findCell(i))&&(this.m_databodyMove=!0)}else this.handleTouchCancel(e)},A.prototype.handleTouchMove=function(e){if(this.m_touchActive){e.cancelable&&e.preventDefault(),this.m_currentX=e.touches[0].pageX,this.m_currentY=e.touches[0].pageY;var t=this.m_currentX-this.m_prevX,i=this.m_currentY-this.m_prevY,s=this.adjustTouchScroll(t,i);t=s[0],i=s[1],this.getResources().isRTLMode()&&(t*=-1),this.m_touchMultipleSelect?(this.handleDatabodySelectionDrag(e),e.preventDefault()):this.m_databodyMove?(this._removeTouchSelectionAffordance(),this._handleMove(e),e.preventDefault()):this._handleNonSwipeScroll(t,i),this.m_prevX=this.m_currentX,this.m_prevY=this.m_currentY}else this.handleTouchCancel(e)},A.prototype.handleTouchEnd=function(e){var t,i=e.target;if(this._isEditOrEnter()){if(t=this._getActiveElement(),this.findCell(i)===t)return void this.handleTouchCancel(e);this._leaveEditing(e,t,!1)}if(this.m_shouldFocus=!1,null!=this.m_lastTapTime&&this.m_startTime-this.m_lastTapTime<250&&this.m_lastTapTarget===i?(this.m_lastTapTime=null,this.m_lastTapTarget=null,null!=(t=this.findCell(i))&&(this._handleEditable(e,t),this._handleEdit(e,t),e.cancelable&&e.preventDefault())):(this.m_lastTapTarget=e.target,this.m_lastTapTime=(new Date).getTime()),this.m_touchActive&&!e.defaultPrevented)if(this.m_touchMultipleSelect)e.cancelable&&e.preventDefault(),this.m_touchMultipleSelect=!1;else{var s=this.m_lastTapTime-this.m_startTime;if(this.m_currentX===this.m_startX&&this.m_currentY===this.m_startY)return this.m_databodyMove=!1,this._isSelectionEnabled()&&s<A.CONTEXT_MENU_TAP_HOLD_DURATION?void this.handleDatabodyClickSelection(e):void this.handleDatabodyClickActive(e);if(this.m_databodyMove)return e.cancelable&&e.preventDefault(),this.m_databodyMove=!1,void this._handleMoveMouseUp(e,!0)}this.handleTouchCancel(e)},A.prototype._calculateMomentum=function(e,t,i,s,o,n){var r,l=e-t,a=Math.abs(l)/i,h=a*a/(2*A.DECELERATION_FACTOR)*(l<0?-1:1),d=a/A.DECELERATION_FACTOR;return n&&(h*=-1),s-h>o?(r=Math.max(-1*A.MAX_OVERSCROLL_PIXEL,h),h=s-o,d=(l=o-s)/a):s-h<0&&(r=Math.min(A.MAX_OVERSCROLL_PIXEL,h),h=s,d=(l=s)/a),{destination:Math.round(h),duration:Math.min(Math.max(A.MIN_SWIPE_TRANSITION_DURATION,d),A.MAX_SWIPE_TRANSITION_DURATION),overScroll:r}},A.prototype.handleTouchCancel=function(e){this.m_databodyMove&&(this._handleMoveMouseUp(e,!1),this.m_databodyMove=!1),this.m_touchSelectAnchor=null,this.m_touchMultipleSelect=!1,this.m_touchActive=!1,this.m_startX=0,this.m_startY=0,this.m_prevX=0,this.m_prevY=0,this.m_currentX=0,this.m_currentY=0,this.m_startTime=0},A.prototype.handleHeaderTouchStart=function(e){this.m_touchStart=(new Date).getTime();var t=e.touches.length,i=e.target;if(1===t){this.m_startX=e.touches[0].pageX,this.m_startY=e.touches[0].pageY,this.m_currentX=this.m_startX,this.m_currentY=this.m_startY,this.m_prevX=this.m_startX,this.m_prevY=this.m_startY,this.m_touchActive=!0;var s=this.findHeader(i);this.isResizeEnabled()&&(this.handleResize(e),this.handleResizeMouseDown(e),this._highlightResizeMouseDown()),!this.m_isResizing&&this._isMoveOnElementEnabled(s)&&(this.m_databodyMove=!0);let t=this.getHeaderCellAxis(s);this._isDataGridProvider()&&this.m_options._isDragEnabled(t)&&(this.m_utils.addCSSClassName(s,this.getMappedStyle("draggableItem")),s.setAttribute("draggable",!0))}else this.handleHeaderTouchCancel(e)},A.prototype.handleHeaderTouchMove=function(e){if(this.m_touchActive){e.cancelable&&e.preventDefault(),this.m_currentX=e.touches[0].pageX,this.m_currentY=e.touches[0].pageY;var t=this.m_currentX-this.m_prevX,i=this.m_currentY-this.m_prevY;if(this.m_isResizing&&this.isResizeEnabled())this.handleResize(e);else if(this.m_databodyMove)this._removeTouchSelectionAffordance(),this._handleMove(e);else if(this.m_databodyReorder)this._removeTouchSelectionAffordance();else{var s=e.target,o=this.findHeader(s),n=this.getHeaderCellAxis(o);"column"===n||"columnEnd"===n?this._handleNonSwipeScroll(t,0):this._handleNonSwipeScroll(0,i)}this.m_prevX=this.m_currentX,this.m_prevY=this.m_currentY}else this.handleTouchCancel(e)},A.prototype.handleHeaderTouchEnd=function(e){var t;const i=this._getActiveElement();if(!this._isEditOrEnter()||!1!==this._leaveEditing(e,i,!1)){if(this.m_touchActive&&!e.defaultPrevented){var s=e.target;if(this.m_isResizing&&this.isResizeEnabled())this.handleResizeMouseUp(e),this.m_currentX!==this.m_startX&&this.m_currentY!==this.m_startY&&e.cancelable&&e.preventDefault();else if(this.m_currentX===this.m_startX&&this.m_currentY===this.m_startY){var o=this.m_options.getSelectionMode(),n=(t=this.findHeader(s))[this.getResources().getMappedAttribute("context")],r=this.m_root.getAttribute("id"),l=document.querySelector("#"+r+"contextmenu");null===l&&(l=this._getSlotMap()?.contextMenu?.[0]),l&&"none"===l.style.display&&(this._isSortIcon(s)&&this._isDOMElementSortable(s)?(e.cancelable&&e.preventDefault(),this._removeTouchSelectionAffordance(),this._handleSortIconMouseDown(s,t),this._handleHeaderSort(e)):this._isFilterIcon(s)&&this._isDOMElementFilterable(s)?(e.cancelable&&e.preventDefault(),this._removeTouchSelectionAffordance(),this._handleHeaderFilter(e)):this._isDisclosureIcon(s)?(this._removeTouchSelectionAffordance(),this._handleExpandCollapseRequest(e),e.preventDefault()):!this._isSelectionEnabled()||!this.isMultipleSelection()||"row"===o&&-1===n.axis.indexOf("row")||this.m_databodyMove?"row"===o&&-1!==n.axis.indexOf("row")&&this._isSelectionEnabled()?this.handleHeaderClickSelection(e):this.handleHeaderClickActive(e,null,!0):(0===e.button&&(this.m_headerDragState=!0),this.handleHeaderClickSelection(e)))}else if(this.m_databodyMove)e.cancelable&&e.preventDefault(),this.m_databodyMove=!1,this._handleMoveMouseUp(e,!0);else if(this.m_databodyReorder){e.cancelable&&e.preventDefault(),this.m_databodyReorder=!1,t=this.findHeader(s),"row"===this.getHeaderCellAxis(t)?this.handleRowDragEnd(e):this.handleColumnDragEnd(e)}else t=this.findHeader(s),this._handleSwipe(e,this.getHeaderCellAxis(t))}this.handleHeaderTouchCancel(e)}},A.prototype.handleHeaderTouchCancel=function(e){this.m_databodyMove&&(this._handleMoveMouseUp(e,!1),this.m_databodyMove=!1),this.m_touchActive=!1,this.m_startX=0,this.m_startY=0,this.m_prevX=0,this.m_prevY=0,this.m_currentX=0,this.m_currentY=0},A.prototype._handleNonSwipeScroll=function(e,t){var i=(new Date).getTime(),s=this.adjustTouchScroll(e,t);e=s[0],t=s[1],this.scrollDelta(e,t),i-this.m_startTime>A.TAP_AND_SCROLL_RESET&&(this.m_startX=this.m_currentX,this.m_startY=this.m_currentY,this.m_startTime=(new Date).getTime())},A.prototype._handleSwipe=function(e,t){var i=(new Date).getTime()-this.m_startTime,s=this.getResources().isRTLMode(),o=this.m_currentX-this.m_startX,n=this.m_currentY-this.m_startY;if(s&&(o*=-1),Math.abs(o)<A.MIN_SWIPE_DISTANCE&&Math.abs(n)<A.MIN_SWIPE_DISTANCE&&i<A.MIN_SWIPE_DURATION)e.cancelable&&e.preventDefault(),this._isSelectionEnabled()&&this._scrollTouchSelectionAffordance();else if(i<A.MAX_SWIPE_DURATION){var r,l;e.cancelable&&e.preventDefault(),"row"!==t&&"rowEnd"!==t?(r=this._calculateMomentum(this.m_currentX,this.m_startX,i,this.m_currentScrollLeft,this.m_scrollWidth,s),isNaN(r.overScroll)||(r.overScroll>0||this.m_stopColumnFetch)&&(this.m_extraScrollOverX=-1*r.overScroll)):(r={duration:0,destination:0},o=0),"column"!==t&&"columnEnd"!==t?(l=this._calculateMomentum(this.m_currentY,this.m_startY,i,this.m_currentScrollTop,this.m_scrollHeight),isNaN(l.overScroll)||(l.overScroll>0||this.m_stopRowFetch)&&(this.m_extraScrollOverY=-1*l.overScroll)):(l={duration:0,destination:0},n=0),o+=r.destination,n+=l.destination;var a=this.adjustTouchScroll(o,n);o=a[0],n=a[1],this.scrollDelta(o,n)}},A.prototype.fireEvent=function(e,t){if(null!=e&&null!=t){var i=this.callbacks[e];return null==i||i(t)}},A.prototype.addListener=function(e,t){this.callbacks[e]=t},A.prototype.setElementHeight=function(e,t){e.style.height=t+"px"},A.prototype.getElementHeight=function(e){return this.getElementDir(e,"height")},A.prototype.setElementWidth=function(e,t){e.style.width=t+"px"},A.prototype.getElementWidth=function(e){return this.getElementDir(e,"width")},A.prototype.setElementDir=function(e,t,i){e.style[i]=t+"px"},A.prototype.getElementDir=function(e,t){var i;return e.style[t].indexOf("px")>-1&&-1===e.style[t].indexOf("e")?parseFloat(e.style[t]):(document.body.contains(e)?i=Math.round(e["offset"+t.charAt(0).toUpperCase()+t.slice(1)]):(e.style.visibility="hidden",this.m_root.appendChild(e),i=Math.round(e["offset"+t.charAt(0).toUpperCase()+t.slice(1)]),this.m_root.removeChild(e),e.style.visibility=""),i)},A.prototype._computeElementWidthAndHeight=function(e){var t={};return e.style.width.indexOf("px")>-1&&-1===e.style.width.indexOf("e")&&(t.width=parseFloat(e.style.width)),e.style.height.indexOf("px")>-1&&-1===e.style.height.indexOf("e")&&(t.height=parseFloat(e.style.height)),null!=t.width&&null!=t.height||(document.body.contains(e)?(t.width=Math.round(e.offsetWidth),t.height=Math.round(e.offsetHeight)):(e.style.visibility="hidden",this.m_root.appendChild(e),t.width=Math.round(e.offsetWidth),t.height=Math.round(e.offsetHeight),this.m_root.removeChild(e),e.style.visibility="")),t},A.BEFORE=1,A.AFTER=2,A.INSIDE=3,A.prototype._isInViewport=function(e){var t=e.row,i=e.column;return-1===t&&-1===i?-1:-1===t?this._isColumnIndexInViewport(i):-1===i?this._isRowIndexInViewport(t):i>=this.m_startCol&&i<=this.m_endCol&&t>=this.m_startRow&&t<=this.m_endRow?A.INSIDE:-1},A.prototype._isAxisIndexInViewport=function(e,t){if(-1===e)return-1;let i=-1;return i=!this._isHighWatermarkScrolling()&&("row"===t&&this._hasFrozenRows()||"column"===t&&this._hasFrozenColumns())?"row"===t?this._isRowIndexInViewportWithinFrozen(e):this._isColumnIndexInViewportWithinFrozen(e):"column"===t?this._isColumnIndexInViewport(e):this._isRowIndexInViewport(e),i},A.prototype._isColumnIndexInViewport=function(e){return e<this.m_startCol?A.BEFORE:e>this.m_endCol?A.AFTER:A.INSIDE},A.prototype._isRowIndexInViewport=function(e){return e<this.m_startRow?A.BEFORE:e>this.m_endRow?A.AFTER:A.INSIDE},A.prototype._isColumnIndexInViewportWithinFrozen=function(e){return e<this.m_startCol&&e>this.m_frozenColIndex?A.BEFORE:e>this.m_endCol?A.AFTER:A.INSIDE},A.prototype._isRowIndexInViewportWithinFrozen=function(e){return e<this.m_startRow&&e>this.m_frozenRowIndex?A.BEFORE:e>this.m_endRow?A.AFTER:A.INSIDE},A.prototype._isCellBoundaryInViewport=function(e,t,i,s){var o=this._getViewportTop(),n=this._getViewportBottom(),r=this._getViewportLeft(),l=this._getViewportRight();return(s<=n&&s>o||i>=o&&i<n)&&(t<=l&&t>r||e>=r&&e<l)},A.prototype.queueModelEvent=function(e){return!this.m_initialized||this.m_processingEventQueue||this.m_animating||this.m_processingModelEvent||!this.isFetchComplete()||this._isEditOrEnter()&&("refresh"===e.operation||this._isActiveWithinUpdateRange(e))?(null==this.m_modelEvents&&(this.m_modelEvents=[]),this.m_modelEvents.push(e),!0):(this.m_modelEvents.length&&this.m_modelEvents.push(e),!1)},A.prototype._isActiveWithinUpdateRange=function(e){const t=e.detail?.ranges;if(null!=this.m_active&&t.length){const e=this.m_active.type;if("label"===e||"empty"===e)return!1;for(let i=0;i<t.length;i++){let s=t[i];if("cell"===e){if(this.m_active.indexes.column>=s.columnOffset&&this.m_active.indexes.row>=s.rowOffset&&(-1===s.columnCount||this.m_active.indexes.column<s.columnOffset+s.columnCount)&&(-1===s.rowCount||this.m_active.indexes.row<s.rowOffset+s.rowCount))return!0}else if("header"===e){if(0===s.columnOffset&&-1===s.columnCount&&this.m_active.index>=s.rowOffset&&this.m_active.index<s.rowOffset+s.rowCount)return!0;if(0===s.rowOffset&&-1===s.rowCount&&this.m_active.index>=s.columnOffset&&this.m_active.index<s.columnOffset+s.columnCount)return!0}}}return!1},A.prototype.handleModelEvent=function(e,t){if(void 0===t&&this.queueModelEvent(e))return;var i=e.operation,s=e.keys,o=e.indexes,n=e.result,r=e.header,l=e.endheader,a=!1;this.m_processingModelEvent=!0;let h=!0;if(e.detail)"delete"===i&&this._handleDeleteRangeEvent(e.detail),"insert"===i&&(this._databodyEmptyState()?this._handleModelRefreshEvent():(this._handleInsertRangeEvent(e.detail),h=!1)),"update"===i&&(this._handleUpdateRangeEvent(e.detail),h=!1),"refresh"===i&&this._handleModelRefreshEvent(e.detail);else if("insert"===i)this._adjustActive(i,o),this.m_shouldFocus=!0,this._adjustSelectionOnModelChange(i,s,o),null!=n?(this._handleModelInsertRangeEvent(n,r,l),a=!0):this._handleModelInsertEvent(o,s);else if("update"===i)this._handleModelUpdateEvent(o,s,n),a=!0;else if("delete"===i){let t;if(this._isEditOrEnter()&&(t=this._getCellByIndex(this.m_active.indexes)),t){let i=this.getCellIndexes(t),s=!1;o.forEach(e=>{e.row!==i.row&&e.column!==i.column||(s=!0)}),s&&(this._handleExitEditable(e,t),this._handleExitEdit(e,t))}this._adjustSelectionOnModelChange(i,s,o),Array.isArray(s)||(s=new Array(s)),this._handleModelDeleteEventWithAnimation(e,s),s.length>0&&(a=!0)}else"refresh"===i||"reset"===i?this._handleModelRefreshEvent():"sync"===i&&this._handleModelSyncEvent(e);h&&(this.m_processingModelEvent=!1),a||!t||this.m_processingModelEvent||this._runModelEventQueue()},A.prototype._adjustActive=function(e,t){var i,s;if(null!=this.m_active){if("cell"===this.m_active.type)s=!1,i=this.m_active.indexes.row;else{if("header"!==this.m_active.type||"row"!==this.m_active.axis)return;s=!0,i=this.m_active.index}if(Array.isArray(t)||(t=new Array(t)),!0===this.m_moveActive){if("insert"===e)return void(s?this.m_active.index=t[0].row:this.m_active.indexes.row=t[0].row);if("delete"===e&&t[0].row===i)return}for(var o="insert"===e?1:-1,n=0;n<t.length;n++){var r=this._isDataGridProvider()?t[n]:t[n].row;r<i&&this.m_active?s?this.m_active.index+=o:this.m_active.indexes.row+=o:r===i&&"delete"===e&&this._setActive(null,null)}}},A.prototype._adjustSelectionOnModelChange=function(e,t,i){Array.isArray(t)||(t=new Array(t)),Array.isArray(i)||(i=new Array(i));var s=this.GetSelection();if(null!=t&&null!=i&&t.length===i.length&&0!==s.length)for(var o="insert"===e?1:-1,n=0;n<t.length;n++)for(var r,l=t[n].row,a=i[n].row,h=s.length-1;h>=0;h--){var d=s[h],m=d.startKey.row,c=d.endKey.row,u=d.startIndex.row,_=d.endIndex.row;if(m===l){if(c===l&&"delete"===e){s.splice(h,1);continue}r=this._getKey(this._getAxisCellsByIndex(d.startIndex.row+1,"row")[0],"row"),d.startKey.row=r,d.endIndex.row+=o}else c===l?(r=this._getKey(this._getAxisCellsByIndex(d.startIndex.row-1,"row")[0],"row"),d.endKey.row=r,d.endIndex.row+=o):a<=u?(d.startIndex.row+=o,d.endIndex.row+=o):a<_&&(d.endIndex.row+=o)}else if(this.m_moveActive&&"insert"===e){var g;if(this._isSelectionEnabled()&&this._isDatabodyCellActive())g="cell"===this.m_options.getSelectionMode()?this.createRange(this.m_active.indexes,this.m_active.indexes,t[0],t[0]):this.createRange(i[0],i[0],t[0],t[0]),this.m_selectionFrontier=this.m_active.indexes,s.push(g);this.m_moveActive=!1}},A.prototype._simpleAdjustSelectionOnChange=function(e,t,i){let s=this.GetSelection(),o="insert"===e?1:-1;for(let n=0;n<t.length;n++){let r=t[n];for(let t=s.length-1;t>=0;t--){let n=s[t],l=n.startIndex[i],a=n.endIndex[i];if(l===r){if(a===r&&"delete"===e){s.splice(t,1);continue}if("delete"===e){let e=this._getKey(this._getAxisCellsByIndex(n.startIndex[i]+1,i)[0],i);n.startKey[i]=e}else n.startIndex[i]+=o;n.endIndex[i]+=o}else if(a===r){if("delete"===e){let e=this._getKey(this._getAxisCellsByIndex(n.endIndex[i]-1,i)[0],i);void 0===n.endKey&&(n.endKey={row:null,column:null}),n.endKey[i]=e}n.endIndex[i]+=o}else r<l?(n.startIndex[i]+=o,n.endIndex[i]+=o):r<a&&(n.endIndex[i]+=o)}}},A.prototype._handleInsertRangeEvent=function(e){let t=e.axis,i=e.ranges;if(0===i.length)return this.m_processingModelEvent=!1,this.m_fetchingForInsert=!1,void this._runModelEventQueue(!0);i.sort(function(e,t){return e.offset-t.offset});let s=i.shift(),o=s.offset,n=s.count,r=this._isAxisIndexInViewport(o,t);if(r===A.INSIDE){let i=o,r=n,l=this.m_startCol,a=this.m_endCol-this.m_startCol+1;"column"===t&&(i=this.m_startRow,r=this.m_endRow-this.m_startRow+1,l=o,a=n);let h,d=document.createDocumentFragment(),m=document.createDocumentFragment(),c=new Promise(function(e){h=e}),u={axis:t,range:s,headerFragment:d,endHeaderFragment:m,totalDimension:0,promiseResolve:h,update:!1};this.m_fetchingForInsert=!0;let _=o,g=n;!this._isHighWatermarkScrolling()&&("row"===t&&this._hasFrozenRows()&&o<=this.m_frozenRowIndex+1||"column"===t&&this._hasFrozenColumns()&&o<=this.m_frozenColIndex+1)?("row"===t&&this.fetchHeaders("row",o,d,m,n,{success:this._handleInsertRangeHeaderFetchSuccess.bind(this,u),error:this.handleCellsFetchError}),"column"===t&&this.fetchHeaders("column",o,d,m,n,{success:this._handleInsertRangeHeaderFetchSuccess.bind(this,u),error:this.handleCellsFetchError})):this.fetchHeaders(t,_,d,m,g,{success:this._handleInsertRangeHeaderFetchSuccess.bind(this,u),error:this.handleCellsFetchError}),this.fetchCells(this.m_databody,i,l,r,a,{success:this._handleInsertRangeCellFetchSuccess.bind(this,u),error:this.handleCellsFetchError}),c.then(this._handleInsertRangeEvent.bind(this,e))}else if(r===A.BEFORE){let i=this.m_avgRowHeight,s=i*n,r=this.m_rowHeader,l=this.m_rowEndHeader;"row"===t?(this.m_endRow>=0&&(this.m_startRow+=n,this.m_endRow+=n,this.m_startRowPixel+=s,this.m_endRowPixel+=s),this.m_endRowHeader>=0&&(this.m_startRowHeader+=n,this.m_endRowHeader+=n,this.m_startRowHeaderPixel+=s,this.m_endRowHeaderPixel+=s),this.m_endRowEndHeader>=0&&(this.m_startRowEndHeader+=n,this.m_endRowEndHeader+=n,this.m_startRowEndHeaderPixel+=s,this.m_endRowEndHeaderPixel+=s),(this.m_endRow>=0||this.m_endRowHeader>=0||this.m_endRowEndHeader>=0)&&(this.m_maxRowYet+=n)):(i=this.m_avgColWidth,s=i*n,r=this.m_colHeader,l=this.m_colEndHeader,this.m_endCol>=0&&(this.m_startCol+=n,this.m_endCol+=n,this.m_startColPixel+=s,this.m_endColPixel+=s),this.m_endColHeader>=0&&(this.m_startColHeader+=n,this.m_endColHeader+=n,this.m_startColHeaderPixel+=s,this.m_endColHeaderPixel+=s),this.m_endColEndHeader>=0&&(this.m_startColEndHeader+=n,this.m_endColEndHeader+=n,this.m_startColEndHeaderPixel+=s,this.m_endColEndHeaderPixel+=s),(this.m_endCol>=0||this.m_endColHeader>=0||this.m_endColEndHeader>=0)&&(this.m_maxColYet+=n));let a=new Array(n).fill(o).map((e,t)=>e+t),h=new Array(n).fill(i);this._modifyAndPushCells(a,h,t,this.m_databody,r,l,!0),this._refreshDatabodyMap(),this._handleInsertRangeEvent(e)}else r===A.AFTER&&("row"===t?(this.m_stopRowFetch=!1,this.m_stopRowHeaderFetch=!1,this.m_stopRowEndHeaderFetch=!1):(this.m_stopColumnFetch=!1,this.m_stopColumnHeaderFetch=!1,this.m_stopColumnEndHeaderFetch=!1),this._handleInsertRangeEvent(e))},A.prototype._handleUpdateRangeEvent=function(e){let t=e.ranges;if(0===t.length)return this.m_activeEdit||this._resetEditableClone(),this.applySelection(),this._resetHeaderHighLight(),this.m_activeEdit=null,this.m_processingModelEvent=!1,void this._runModelEventQueue(!0);t.sort(function(e,t){return e.offset-t.offset});let i=t.shift(),s=i.rowOffset,o=i.columnOffset,n=-1===i.rowCount?this._getMaxBottom()+1:i.rowCount,r=-1===i.columnCount?this._getMaxRight()+1:i.columnCount,l=s+n-1,a=o+r-1,h=this._isAxisIndexInViewport(s,"row"),d=this._isAxisIndexInViewport(l,"row"),m=this._isAxisIndexInViewport(o,"column"),c=this._isAxisIndexInViewport(a,"column");if(h!==A.AFTER&&d!==A.BEFORE&&m!==A.AFTER&&c!==A.BEFORE){let t;h===A.BEFORE&&(s=this._getMaxTop()),d===A.AFTER&&(l=this._getMaxBottom()),m===A.BEFORE&&(o=this._getMaxLeft()),c===A.AFTER&&(a=this._getMaxRight()),n=l-s+1,r=a-o+1;let u,_,g=!1;-1!==i.rowCount&&-1!==i.columnCount||(g=!0,t=-1===i.rowCount?"column":"row"),"row"===t?(u=s,_=n):"column"===t&&(u=o,_=r);const p=document.createDocumentFragment(),f=document.createDocumentFragment();let C;const y=new Promise(function(e){C=e}),w={axis:t,range:i,headerFragment:p,endHeaderFragment:f,totalDimension:0,promiseResolve:C,update:!0};this.m_fetchingForUpdate=!0,g?(w.editHeader=!0,this.fetchHeaders(t,u,p,void 0,_,{success:this._handleInsertRangeHeaderFetchSuccess.bind(this,w),error:this.handleHeadersFetchError}),this.fetchCells(this.m_databody,s,o,n,r,{success:this._handleUpdateEditableHeader.bind(this,w),error:this.handleCellsFetchError})):this.fetchCells(this.m_databody,s,o,n,r,{success:this._handleUpdateRangeFetchSuccess.bind(this,w),error:this.handleCellsFetchError}),y.then(this._handleUpdateRangeEvent.bind(this,e))}else this._handleUpdateRangeEvent(e)},A.prototype._handleUpdateEditableHeader=function(e,t,i){this.m_fetchingForUpdate=!1;let s,o,n=e,r=n.range,l=n.axis,a=n.editHeader;"column"===l?(s=r.columnOffset,o=r.columnCount):"row"===l&&(s=r.rowOffset,o=r.rowCount);let h={axis:l,ranges:[{offset:s,count:o}],editHeader:a},d=this.m_root.contains(document.activeElement);this.m_activeEdit=null,this._handleDeleteRangeEvent(h,!0),delete n.range,n.range={offset:s,count:o},n.update=!0,this._handleInsertRangeCellFetchSuccess(n,t,i,()=>{this._isActiveWithinUpdateRange({detail:{ranges:[r]}})&&(d||(this.m_shouldFocus=!1),this._highlightActive())})},A.prototype._handleInsertRangeHeaderFetchSuccess=function(e,t,i,s,o,n,r,l){const a=void 0!==i?.axis?i.axis:r.axis;this._signalTaskEnd(),this.m_fetching[a]=!1;const h=this.getResources().isRTLMode()?"right":"left",d=void 0!==i?.start?i.start:r.start,m=e.range.count,c=e.headerFragment,u=e.endHeaderFragment,_="row"===a?"top":h;let g=e.update||!1,p=null;this._hasFrozenRows()&&(p=g?this.m_options._getFreezeIndex("row"):this.m_frozenRowIndex);let f,C,y,w=null;this._hasFrozenColumns()&&(w=g?this.m_options._getFreezeIndex("column"):this.m_frozenColIndex),this.updateHiddenAxisForInsertion(d,m,a);let E,v,x,H,b,S,R,I=0,z=0;if(null!=t){for(x=this.getMappedStyle("headercell"),"row"===a?(b=this.m_rowHeaderLevelCount,x+=" "+this.getMappedStyle("rowheadercell")):(b=this.m_columnHeaderLevelCount,x+=" "+this.getMappedStyle("colheadercell")),f=this._getHeaderByIndex(d,a,b-1),C=this.getElementDir(f,_),"column"===a&&this._hasFrozenColumns()&&!this.m_fetchingForUpdate&&d===w+1&&g?this.m_colHeaderFrozen?C=this.getElementWidth(this.m_colHeaderFrozen):this.m_colEndHeaderFrozen&&(C=this.getElementWidth(this.m_colEndHeaderFrozen)):"row"===a&&this._hasFrozenRows()&&!this.m_fetchingForUpdate&&d===p+1&&g&&(this.m_rowHeaderFrozen?C=this.getElementHeight(this.m_rowHeaderFrozen):this.m_rowEndHeaderFrozen&&(C=this.getElementHeight(this.m_rowEndHeaderFrozen))),y=t.getCount(),H=this.getRendererOrTemplate(a);y-I>0;)"row"===a?(S=0,R=C+z):(S=C+z,R=0),E=d+I,("column"===a&&this._hasFrozenColumns()&&E<=w||"row"===a&&this._hasFrozenRows()&&E<=p)&&(x=`${x} ${this.getMappedStyle("frozenHeader")}`),v=this.buildLevelHeaders(c,E,0,S,R,!1,!0,H,t,a,x,b),I+=v.count,z+=v.totalHeaderDimension;z>e.totalDimension&&(e.totalDimension=z)}if(z=0,I=0,null!=s){x=this.getMappedStyle("endheadercell"),"row"===a?(b=this.m_rowEndHeaderLevelCount,x+=" "+this.getMappedStyle("rowendheadercell")):(b=this.m_columnEndHeaderLevelCount,x+=" "+this.getMappedStyle("colendheadercell"));const t=`${a}End`;for(f=this._getHeaderByIndex(d,t,b-1),C=this.getElementDir(f,_),y=s.getCount(),H=this.getRendererOrTemplate(t);y-I>0;)"row"===a?(S=0,R=C+z):(S=C+z,R=0),E=d+I,v=this.buildLevelHeaders(u,E,0,S,R,!0,!1,H,s,t,x,b),I+=v.count,z+=v.totalHeaderDimension;z>e.totalDimension&&(e.totalDimension=z)}this._isHighWatermarkScrolling()||null==r||this._handleInsertRangeFrozenHeaderFetchSuccess(e,n,l,r)},A.prototype._handleInsertRangeFrozenHeaderFetchSuccess=function(e,t,i,s){const o=s.axis,n=s.start,r=this.getResources().isRTLMode()?"right":"left",l=e.headerFragment,a=e.endHeaderFragment,h="row"===o?"top":r;let d,m,c,u,_,g,p,f,C,y,w=0,E=0;if(null!=t){for(g=this.getMappedStyle("headercell"),"row"===o?(f=this.m_rowHeaderLevelCount,g+=` ${this.getMappedStyle("rowheadercell")} ${this.getMappedStyle("rowHeaderFrozen")}`):(f=this.m_columnHeaderLevelCount,g+=` ${this.getMappedStyle("colheadercell")} ${this.getMappedStyle("colHeaderFrozen")}`),d=this._getHeaderByIndex(n,o,f-1),m=this.getElementDir(d,h),"column"===o&&this._hasFrozenColumns()&&n===this.m_frozenColIndex+1?this.m_colHeaderFrozen?m=this.getElementWidth(this.m_colHeaderFrozen):this.m_colEndHeaderFrozen&&(m=this.getElementWidth(this.m_colEndHeaderFrozen)):"row"===o&&this._hasFrozenRows()&&n===this.m_frozenRowIndex+1&&(this.m_rowHeaderFrozen?m=this.getElementHeight(this.m_rowHeaderFrozen):this.m_rowEndHeaderFrozen&&(m=this.getElementHeight(this.m_rowEndHeaderFrozen))),c=t.getCount(),p=this.getRendererOrTemplate(o);c-w>0;)"row"===o?(C=0,y=m+E):(C=m+E,y=0),u=n+w,("column"===o&&this._hasFrozenColumns()&&u<=this.m_frozenColIndex+1||"row"===o&&this._hasFrozenRows()&&u<=this.m_frozenRowIndex+1)&&(g=`${g} ${this.getMappedStyle("frozenHeader")}`),_=this.buildLevelHeaders(l,u,0,C,y,!1,!0,p,t,o,g,f),w+=_.count,E+=_.totalHeaderDimension;E>e.totalDimension&&(e.totalDimension=E)}if(E=0,w=0,null!=i){g=this.getMappedStyle("endheadercell"),"row"===o?(f=this.m_rowEndHeaderLevelCount,g+=` ${this.getMappedStyle("rowendheadercell")} ${this.getMappedStyle("rowEndHeaderFrozen")} `):(f=this.m_columnEndHeaderLevelCount,g+=` ${this.getMappedStyle("colendheadercell")} ${this.getMappedStyle("colEndHeaderFrozen")}`);let t="column"===o?"columnEnd":"rowEnd";for(d=this._getHeaderByIndex(n,t,f-1),m=this.getElementDir(d,h),c=i.getCount(),p=this.getRendererOrTemplate(t);c-w>0;)"row"===o?(C=0,y=m+E):(C=m+E,y=0),u=n+w,_=this.buildLevelHeaders(a,u,0,C,y,!0,!1,p,i,t,g,f),w+=_.count,E+=_.totalHeaderDimension;E>e.totalDimension&&(e.totalDimension=E)}},A.prototype._handleInsertRangeCellFetchSuccess=function(e,t,i,s,o,n,r,l){const a=e.range,h=e.axis,d=e.editHeader,m=e.headerFragment,c=e.endHeaderFragment;let u=e.totalDimension;const _=this.getResources().isRTLMode()?"right":"left";let g=document.createDocumentFragment(),p=document.createDocumentFragment(),f=document.createDocumentFragment(),C=document.createDocumentFragment(),y=this.m_rowHeader,w=this.m_rowEndHeader,E=this.m_databodyFrozenRow,v=this.m_rowHeaderFrozen,x=this.m_rowEndHeaderFrozen,H=e.update||!1,b=null;this._hasFrozenRows()&&(b=H?this.m_options._getFreezeIndex("row"):this.m_frozenRowIndex);let S=null;if(this._hasFrozenColumns()&&(S=H?this.m_options._getFreezeIndex("column"):this.m_frozenColIndex),"column"===h&&(y=this.m_colHeader,w=this.m_colEndHeader,E=this.m_databodyFrozenCol,v=this.m_colHeaderFrozen,x=this.m_colEndHeaderFrozen),this._signalTaskEnd(),this.m_fetching.cells=!1,d||this.unhighlightSelection(),this._isHighWatermarkScrolling()||!this._hasFrozenColumns()&&!this._hasFrozenRows()||void 0===n&&void 0===r&&void 0===l){if(t){let e=i[0].start;let s=i[1].start,o=t.getCount("row"),n=t.getCount("column");const r=this._getCellByIndex(this.createIndex(e,s));let l,a;if(r?(l="row"===h?this.getElementDir(r,"top"):this.m_startRowPixel,a="row"===h?this.m_startColPixel:this.getElementDir(r,_),"column"===h&&this._hasFrozenColumns()&&s===S&&H&&(a=this.getElementWidth(this.m_databodyFrozenCol)),"row"===h&&this._hasFrozenRows()&&e===b&&H&&(l=this.getElementHeight(this.m_databodyFrozenRow))):(l="row"===h?this._getMaxBottomPixel():this.m_startRowPixel,a="row"===h?this.m_startColPixel:this._getMaxRightPixel()),"column"===h)if(this._hasFrozenColumns()&&s<S+1){this.m_databodyFrozenCorner&&(this._addCellsToFragment(C,t,e,l,s,a,b+1,null),e=b+1,o-=b+1);const i=this._addCellsToFragment(p,t,e,l,s,a,o,n);u=Math.max(u,i.totalColumnWidth)}else{this._hasFrozenRows()&&(this._addCellsToFragment(f,t,e,l,s,a,b+1,null),e=b+1,o-=b+1);const i=this._addCellsToFragment(g,t,e,l,s,a,o,null);u=Math.max(u,"row"===h?i.totalRowHeight:i.totalColumnWidth)}else if("row"===h)if(this._hasFrozenRows()&&e<b+1){this.m_databodyFrozenCorner&&(this._addCellsToFragment(C,t,e,l,s,a,null,S+1),s=S+1,n-=S+1);const i=this._addCellsToFragment(f,t,e,l,s,a,o,n);u=Math.max(u,i.totalRowHeight)}else{this._hasFrozenColumns()&&(this._addCellsToFragment(p,t,e,l,s,a,null,S+1),s=S+1,n-=S+1);const i=this._addCellsToFragment(g,t,e,l,s,a,null,n);u=Math.max(u,i.totalRowHeight)}}}else[C,f,p,g,u]=this._handleInsertRangeCellFetchSuccessVirtualScroll(e,t,i,s,o,n,r,l);let R=this.getMappedStyle("frozenCell");if(C.childNodes&&C.childNodes.length)for(let e=0;e<=C.childNodes.length;e++){let t=C.childNodes[e];this.m_utils.addCSSClassName(t,R)}if(p.childNodes&&p.childNodes.length)for(let e=0;e<=p.childNodes.length;e++){let t=p.childNodes[e];this.m_utils.addCSSClassName(t,R)}if(f.childNodes&&f.childNodes.length)for(let e=0;e<=f.childNodes.length;e++){let t=f.childNodes[e];this.m_utils.addCSSClassName(t,R)}const I=a.offset,z=a.count;let F=new Array(z).fill(I).map((e,t)=>e+t),M=0,A=0;(this._hasFrozenColumns()||this._hasFrozenRows())&&("column"===h&&this._hasFrozenColumns()&&I<S+1||"row"===h&&this._hasFrozenRows()&&I<b+1)?A=new Array(z).fill(u/z):M=new Array(z).fill(u/z);let D=g.childNodes.length||f.childNodes.length||p.childNodes.length,L=m.childNodes.length,T=c.childNodes.length;const N=this.m_databody.firstChild;let k,O,P=[];for(let e=F.length-1;e>=0;e--){let t=F[e];("column"===h&&this._hasFrozenColumns()&&t<S+1||"row"===h&&this._hasFrozenRows()&&t<b+1)&&(P.push(t),F.splice(e,1))}if(this._modifyAndPushCells(F,M,h,this.m_databody,y,w,!0,P.length),"column"===h&&this.m_databodyFrozenRow?this._modifyAndPushCells(F,M,h,this.m_databodyFrozenRow,null,null,!0,P.length):"row"===h&&this.m_databodyFrozenCol&&this._modifyAndPushCells(F,M,h,this.m_databodyFrozenCol,null,null,!0,P.length),P.length)if(this._modifyAndPushCells(P,A,h,E,v,x,!0),this.m_databodyFrozenCorner&&this._modifyAndPushCells(P,A,h,this.m_databodyFrozenCorner,null,null,!0),"column"===h){this.m_frozenColIndex+=P.length;let e={event:null,ui:{frozenCount:this.m_frozenColIndex+1}};this.fireEvent("columnFreeze",e)}else{this.m_frozenRowIndex+=P.length;let e={event:null,ui:{frozenCount:this.m_frozenRowIndex+1}};this.fireEvent("rowFreeze",e)}d||this._simpleAdjustSelectionOnChange("insert",F,h);let W=!1;if(g.childNodes.length&&(N.appendChild(g),W=!0),p.childNodes.length&&(k=this.m_databodyFrozenCol.firstChild,k.appendChild(p),W=!0),f.childNodes.length&&(O=this.m_databodyFrozenRow.firstChild,O.appendChild(f),W=!0),C.childNodes.length&&(this.m_databodyFrozenCorner.firstChild.appendChild(C),W=!0),W&&this._refreshDatabodyMap(),this._insertHeaders(h,I,m,c),this.hideStatusText(),"row"===h){let e=!1;if(D&&((this._isHighWatermarkScrolling()||!this._isHighWatermarkScrolling()&&!this._hasFrozenRows()||!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&(I>this.m_frozenRowIndex+1&&this.m_startRow>0||0===this.m_startRow))&&(this.m_endRow+=z,e=!0),(!this._hasFrozenRows()||this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&I>this.m_frozenRowIndex||!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&I>this.m_frozenRowIndex+1)&&(this.m_endRowPixel+=u),!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&I<=this.m_frozenRowIndex&&this.m_startRow>0&&(this.m_startRow+=z),this.m_stopRowFetch=!1),L&&((this._isHighWatermarkScrolling()||!this._isHighWatermarkScrolling()&&!this._hasFrozenRows()||!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&(I>this.m_frozenRowIndex+1&&this.m_startRowHeader>0||0===this.m_startRowHeader))&&(this.m_endRowHeader+=z,e=!0),(!this._hasFrozenRows()||this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&I>this.m_frozenRowIndex||!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&I>this.m_frozenRowIndex+1)&&(this.m_endRowHeaderPixel+=u),!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&I<=this.m_frozenRowIndex&&this.m_startRowHeader>0&&(this.m_startRowHeader+=z),this.m_stopRowHeaderFetch=!1),T&&((this._isHighWatermarkScrolling()||!this._isHighWatermarkScrolling()&&!this._hasFrozenRows()||!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&(I>this.m_frozenRowIndex+1&&this.m_startRowEndHeader>0||0===this.m_startRowEndHeader))&&(this.m_endRowEndHeader+=z,e=!0),(!this._hasFrozenRows()||this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&I>this.m_frozenRowIndex||!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&I>this.m_frozenRowIndex+1)&&(this.m_endRowEndHeaderPixel+=u),!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&I<=this.m_frozenRowIndex&&this.m_startRowEndHeader>0&&(this.m_startRowEndHeader+=z),this.m_stopRowEndHeaderFetch=!1),(D||L||T)&&e&&(this.m_maxRowYet+=z),this._hasFrozenRows()&&I<this.m_frozenRowIndex+1){let e=this.getElementHeight(this.m_databodyFrozenRow)+u;this.setElementHeight(this.m_databodyFrozenRow,e),this.m_databodyFrozenCorner&&this.setElementHeight(this.m_databodyFrozenCorner,e)}else{let e=k?this.getElementHeight(k)+u:this.getElementHeight(N)+u;this._setAllScrollableRegions("height",e),k&&this.setElementHeight(k.parentElement,e)}this.updateRowBanding()}else if("column"===h){let e=!1;if(D&&((this._isHighWatermarkScrolling()||!this._isHighWatermarkScrolling()&&!this._hasFrozenColumns()||!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&(I>this.m_frozenColIndex+1&&this.m_startCol>0||0===this.m_startCol))&&(this.m_endCol+=z,e=!0),(!this._hasFrozenColumns()||this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&I>this.m_frozenColIndex||!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&I>this.m_frozenColIndex+1)&&(this.m_endColPixel+=u),!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&I<=this.m_frozenColIndex&&this.m_startCol>0&&(this.m_startCol+=z),this.m_stopColumnFetch=!1),L&&((this._isHighWatermarkScrolling()||!this._isHighWatermarkScrolling()&&!this._hasFrozenColumns()||!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&(I>this.m_frozenColIndex+1&&this.m_startColHeader>0||0===this.m_startColHeader))&&(this.m_endColHeader+=z,e=!0),(!this._hasFrozenColumns()||this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&I>this.m_frozenColIndex||!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&I>this.m_frozenColIndex+1)&&(this.m_endColHeaderPixel+=u),!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&I<=this.m_frozenColIndex&&this.m_startColHeader>0&&(this.m_startColHeader+=z),this.m_stopColumnHeaderFetch=!1),T&&((this._isHighWatermarkScrolling()||!this._isHighWatermarkScrolling()&&!this._hasFrozenColumns()||!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&(I>this.m_frozenColIndex+1&&this.m_startColEndHeader>0||0===this.m_startColEndHeader))&&(this.m_endColEndHeader+=z,e=!0),(!this._hasFrozenColumns()||this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&I>this.m_frozenColIndex||!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&I>this.m_frozenColIndex+1)&&(this.m_endColEndHeaderPixel+=u),!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&I<=this.m_frozenColIndex&&this.m_startColEndHeader>0&&(this.m_startColEndHeader+=z),this.m_stopColumnEndHeaderFetch=!1),(D||L||T)&&e&&(this.m_maxColYet+=z),this._hasFrozenColumns()&&I<this.m_frozenColIndex+1){let e=this.getElementWidth(this.m_databodyFrozenCol)+u;this.setElementWidth(this.m_databodyFrozenCol,e),this.m_databodyFrozenCorner&&this.setElementWidth(this.m_databodyFrozenCorner,e)}else{let e=O?this.getElementWidth(O)+u:this.getElementWidth(N)+u;this._setAllScrollableRegions("width",e),O&&this.setElementWidth(O.parentElement,e)}this.updateColumnBanding()}this.deleteAndApplyHiddenIndicators(),d||(this.applySelection(),this._resetHeaderHighLight(),this.resizeGrid()),s&&s(),e.promiseResolve()},A.prototype._insertHeaders=function(e,t,i,s){let o=this.m_rowHeader,n=this.m_rowEndHeader;this._hasFrozenRows()&&t<=this.m_frozenRowIndex&&(o=this.m_rowHeaderFrozen,n=this.m_rowEndHeaderFrozen);let r,l=this.m_rowHeaderLevelCount,a=this.m_rowEndHeaderLevelCount,h=this.m_startRowHeader,d=this.m_startRowEndHeader,m="height",c="top";"column"===e&&(o=this.m_colHeader,n=this.m_colEndHeader,this._hasFrozenColumns()&&t<=this.m_frozenColIndex&&(o=this.m_colHeaderFrozen,n=this.m_colEndHeaderFrozen),l=this.m_columnHeaderLevelCount,a=this.m_columnEndHeaderLevelCount,h=this.m_startColHeader,d=this.m_startColEndHeader,m="width",c=this.getResources().isRTLMode()?"right":"left");let u=(e,t,i,s,o,n,r)=>{for(;e.childNodes.length;){let l,a=e.firstChild;if(this.m_utils.containsCSSClassName(a,this.getMappedStyle("groupingcontainer"))){if(l=a.firstChild,null==l||this.m_utils.containsCSSClassName(l,this.getMappedStyle("groupingcontainer"))){e.removeChild(a);continue}}else l=a;let h=l.extentInfo,d=h.more.before,m=h.more.after,c=l[this.getResources().getMappedAttribute("context")],_=c.index,g=c.extent,p=c.level;if(d){let e=this._getHeaderContainer(_-1,p,t,i),s=e.firstChild,r=s[this.getResources().getMappedAttribute("context")];c.extent+=r.extent,c.index=r.index;let a=this._getAttribute(e,"extent",!0);this._setAttribute(e,"extent",a+g);let h=this.getElementDir(s,o),d=this.getElementDir(l,o);this.setElementDir(l,h+d,o);let m=this.getElementDir(s,n);this.setElementDir(l,m,n),e.replaceChild(l,s)}else if(m){let e=this._getHeaderContainer(_+g,p,t,i),s=e.firstChild,r=s[this.getResources().getMappedAttribute("context")];c.extent+=r.extent,c.index=r.index-g;let a=this._getAttribute(e,"extent",!0);this._setAttribute(e,"extent",a+g);let h=this._getAttribute(e,"start",!0);this._setAttribute(e,"start",h-g);let d=this.getElementDir(s,o),m=this.getElementDir(l,o);this.setElementDir(l,d+m,o);let u=this.getElementDir(s,n);this.setElementDir(l,u-m,n),e.replaceChild(l,s)}else{let e=this._getHeaderContainer(_,p,t,i);if(e){let t=this._getHeaderByIndex(_-1,r,p);if(null===t||t.parentNode!==e){let t=p===i-1?e.childNodes[1]:e.childNodes[0];e.insertBefore(l,t)}else t.nextSibling&&t.nextSibling.parentNode===e?e.insertBefore(l,t.nextSibling):e.appendChild(l)}else{let e=this._getHeaderContainer(_-1,p,t,i);if(null===e){let e=t.firstChild;e.firstChild?e.insertBefore(a,e.firstChild):e.appendChild(a)}else e.nextSibling?e.parentNode.insertBefore(a,e.nextSibling):e.parentNode.appendChild(a)}}if(d||m){let e=a.querySelector("."+this.getMappedStyle("groupingcontainer"));e&&u(e,t,i,s,o,n,r)}}};if(i.childNodes.length&&(1===l?(r=this._getHeaderByIndex(t,e,l-1),o.firstChild.insertBefore(i,r)):u(i,o,l,h,m,c,e)),s.childNodes.length){let i=e+"End";1===a?(r=this._getHeaderByIndex(t,i,l-1),n.firstChild.insertBefore(s,r)):u(s,n,a,d,m,c,i)}},A.prototype._handleInsertRangeCellFetchSuccessVirtualScroll=function(e,t,i,s,o,n,r,l){const a=e.range,h=e.axis;let d=e.totalDimension;const m=this.getResources().isRTLMode()?"right":"left",c=document.createDocumentFragment(),u=document.createDocumentFragment(),_=document.createDocumentFragment(),g=document.createDocumentFragment();let p=i[0].start,f=i[1].start,C=o[0],y=C?.rowStart,w=n?.columnStart,E=o[1],v=E?.colStart,x=r?.rowStart;if("row"===h)if(n&&n.rowEnd>=n.rowStart&&a.offset<=this.m_frozenRowIndex+1){const e=this._getCellByIndex(this.createIndex(y,w));let t,i;e&&(t=this.getElementDir(e,"top"),i=this.getElementDir(e,m),y===this.m_frozenRowIndex+1&&(t=this.getElementHeight(this.m_databodyFrozenRow))),l&&l.rowEnd>=l.rowStart&&this._addCellsToFragment(g,l,l.rowStart,t,l.columnStart,0,l.rowCount,l.columnCount);const s=this._addCellsToFragment(_,n,n.rowStart,t,n.columnStart,i,n.rowCount,n.columnCount);d=Math.max(d,s.totalRowHeight)}else{let e,i;if(r&&r.columnEnd>=r.columnStart){const t=this._getCellByIndex(this.createIndex(x,v));t&&(e=this.getElementDir(t,"top"),i=this.getElementDir(t,m)),this._addCellsToFragment(u,r,r.rowStart,e,r.columnStart,i,r.rowCount,r.columnCount)}const s=this._getCellByIndex(this.createIndex(p,f));s&&(e=this.getElementDir(s,"top"),i=this.getElementDir(s,m));const o=this._addCellsToFragment(c,t,t.rowStart,e,t.columnStart,i,t.rowCount,t.columnCount);d=Math.max(d,o.totalRowHeight)}else if("column"===h)if(r&&r.columnEnd>=r.columnStart&&a.offset<=this.m_frozenColIndex+1){const e=this._getCellByIndex(this.createIndex(x,v));let t,i;e&&(t=this.getElementDir(e,"top"),i=v===this.m_frozenColIndex+1?this.getElementWidth(this.m_databodyFrozenCol):this.getElementDir(e,m)),l&&l.columnEnd>=l.columnStart&&this._addCellsToFragment(g,l,l.rowStart,0,l.columnStart,i,l.rowCount,l.columnCount);const s=this._addCellsToFragment(u,r,r.rowStart,t,r.columnStart,i,r.rowCount,r.columnCount);d=Math.max(d,s.totalColumnWidth)}else{let e,i;if(n&&n.rowEnd>=n.rowStart){const t=this._getCellByIndex(this.createIndex(y,w));t&&(e=0,i=this.getElementDir(t,m)),this._addCellsToFragment(_,n,n.rowStart,e,n.columnStart,i,n.rowCount,n.columnCount)}const s=this._getCellByIndex(this.createIndex(p,f));s&&(e=0,i=this.getElementDir(s,m));const o=this._addCellsToFragment(c,t,t.rowStart,e,t.columnStart,i,t.rowCount,t.columnCount);d=Math.max(d,o.totalColumnWidth)}return[g,_,u,c,d]},A.prototype._handleModelInsertEvent=function(e,t){var i=this._isInViewport(e);if(i===A.INSIDE||i===A.AFTER&&e.row===this.m_endRow+1)null!=t.row&&(this._databodyEmpty()?(this.empty(),this.refresh(this.m_root)):(this._modifyAxisCellContextIndex("row",e.row,this.m_endRow-e.row+1,1),this._refreshDatabodyMap(),this.fetchHeaders("row",e.row,this.m_rowHeader,this.m_rowEndHeader,1,{success:this._handleHeaderInsertsFetchSuccess}),this.fetchCells(this.m_databody,e.row,this.m_startCol,1,this.m_endCol-this.m_startCol+1,{success:this._handleCellInsertsFetchSuccess})));else{if(i===A.BEFORE){this._modifyAxisCellContextIndex("row",0,this.m_endRow+1,1),this._refreshDatabodyMap(),this.m_startRow+=1,this.m_startRowHeader+=1,this.m_endRow+=1,this.m_maxRowYet+=1,this.m_endRowHeader+=1,this.m_startRowPixel+=this.m_avgRowHeight,this.m_startRowHeaderPixel+=this.m_avgRowHeight,this.m_endRowPixel+=this.m_avgRowHeight,this.m_endRowHeaderPixel+=this.m_avgRowHeight;var s=this.m_databody.firstChild.firstChild;null!=s&&this.pushRowsDown(s,this.m_avgRowHeight);var o=this.m_rowHeader.firstChild.firstChild;null!=o&&this.pushRowsDown(o,this.m_avgRowHeight);var n=this.m_rowEndHeader.firstChild.firstChild;null!=n&&this.pushRowsDown(n,this.m_avgRowHeight)}this.scrollToIndex(e)}},A.prototype._handleCellInsertsFetchSuccess=function(e,t){this.m_resizeRequired=!0;var i=t[0].start;i<this.m_maxRowYet&&(this.m_maxRowYet+=1),this.handleCellsFetchSuccess(e,t,this.m_endRow>=t[0].start),this._scrollRowIntoViewport(i),this._isHighWatermarkScrolling()||this._cleanupViewport("top"),this.updateRowBanding(),this.m_stopRowFetch=!1,-1!==this.m_endRowHeader&&(this.m_stopRowHeaderFetch=!1),-1!==this.m_endRowEndHeader&&(this.m_stopRowEndHeaderFetch=!1),this.fillViewport()},A.prototype._handleHeaderInsertsFetchSuccess=function(e,t,i){this.m_resizeRequired=!0,this.handleHeadersFetchSuccess(e,t,i,this.m_endRowHeader>=t.start)},A.prototype._scrollRowIntoViewport=function(e){var t=this._getAxisCellsByIndex(e,"row");if(null!=t){var i=this._getViewportTop(),s=this._getViewportBottom(),o=this.getElementDir(t[0],"top"),n=i-o;(n>0||(n=s-o)<0)&&this.scrollDelta(0,n)}},A.prototype._handleModelInsertRangeEvent=function(e,t,i){var s,o,n,r,l,a,h,d,m=this._getEmptyElement(),c=e.getStart("row"),u=e.getStart("column"),_=e.getCount("column");if(!(c>this.m_endRow+1))if(m)this.empty(),this.refresh(this.m_root);else{if(null!=t){s=document.createDocumentFragment();var g=t.getCount();for(r=0,o=0,a=this.getMappedStyle("headercell")+" "+this.getMappedStyle("rowheadercell"),h=this.getRendererOrTemplate("row");g-o>0;)n=c+o,o+=(l=this.buildLevelHeaders(s,n,0,0,r,!0,c!==this.m_endRowHeader+1,h,t,"row",a,this.m_rowHeaderLevelCount)).count,r+=l.totalHeaderDimension}if(null!=i){d=document.createDocumentFragment();var p=i.getCount();for(r=0,o=0,a=this.getMappedStyle("endheadercell")+" "+this.getMappedStyle("rowendheadercell"),h=this.getRendererOrTemplate("rowEnd");p-o>0;)n=c+o,o+=(l=this.buildLevelHeaders(d,n,0,0,r,!0,c!==this.m_endRowEndHeader+1,h,i,"rowEnd",a,this.m_rowEndHeaderLevelCount)).count,r+=l.totalHeaderDimension}var f=document.createDocumentFragment();if(l=this._addCellsToFragment(f,e,c,0,u,0),!(0!==f.childNodes.length||null!=s&&0!==s.childNodes.length||null!=d&&0!==d.childNodes.length))return;this._insertRowsWithAnimation(f,s,d,c,e.getCount("row"),l.totalRowHeight,u,_)}},A.prototype._handleModelUpdateEvent=function(e,t,i){if(this._isInViewport(e)===A.INSIDE)if(null!=i){var s=this.getRendererOrTemplate("cell"),o=this.m_options.getColumnBandingInterval();this._updateCellsInRow(i,i.getStart("row"),s,this.m_startCol,o)}else-1!==this.m_endRowHeader&&this.fetchHeaders("row",e.row,this.m_rowHeader,this.m_rowEndHeader,1,{success:this._handleHeaderUpdatesFetchSuccess,error:this.handleHeadersFetchError}),this.fetchCells(this.m_databody,e.row,this.m_startCol,1,this.m_endCol-this.m_startCol+1,{success:this._handleCellUpdatesFetchSuccess,error:this.handleCellsFetchError})},A.prototype._handleHeaderUpdatesFetchSuccess=function(e,t,i){var s=t.axis;this.m_fetching[s]=!1;var o=t.start;this._replaceHeaders(this.buildRowHeaders.bind(this),e,this.m_rowHeader,o,this.m_startRowHeader),this._replaceHeaders(this.buildRowEndHeaders.bind(this),i,this.m_rowEndHeader,o,this.m_startRowEndHeader);var n=this.m_rowHeader.firstChild.childNodes[o-this.m_startRowHeader];null==this.m_active||"header"!==this.m_active.type||"row"!==this.m_active.axis&&"rowEnd"!==this.m_active.axis||this._getKey(n,"row")!==this.m_active.key||this._highlightActive(),this._signalTaskEnd()},A.prototype._replaceHeaders=function(e,t,i,s,o){if(null!=t){var n=e(i,t,s,1,!0,!0),r=i.firstChild,l=r.childNodes[s-o];r.replaceChild(n,l)}},A.prototype._handleCellUpdatesFetchSuccess=function(e,t){this.m_fetching.cells=!1;var i=t[0].start,s=this.getRendererOrTemplate("cell"),o=this.m_options.getColumnBandingInterval();this._updateCellsInRow(e,i,s,this.m_startCol,o),u.isIos()&&this._applyIosAccessibility(),this._signalTaskEnd()},A.prototype._getUpdateAnimationDuration=function(){return A.UPDATE_ANIMATION_DURATION},A.prototype._updateCellsInRow=function(e,t,i,s,o){var n,r=this._getUpdateAnimationDuration(),l=this._getAxisCellsByIndex(t,"row"),a=this.getElementDir(l[0],"top");if(0===r)this._removeFromArray(l),n=document.createDocumentFragment(),this._addCellsToFragment(n,e,t,a,s,this.m_startColPixel),this._populateDatabody(this.m_databody.firstChild,n),this._isSelectionEnabled()&&this.applySelection(),this._highlightActive(),this.hideStatusText();else{var h=this;h._signalTaskStart(),this._removeFromArray(l),n=document.createDocumentFragment(),this._addCellsToFragment(n,e,t,a,s,this.m_startColPixel),l=n.childNodes;for(var d=this.getElementWidth(this.m_databody),m=0;m<l.length;m++)this.addTransformMoveStyle(l[m],0,0,"linear",d,0,0);this._populateDatabody(this.m_databody.firstChild,n),l=this._getAxisCellsByIndex(t,"row"),this.hideStatusText();this._onEndEvent("transitionend",l[l.length-1],function(){for(var e=0;e<l.length;e++)h.removeTransformMoveStyle(l[e]);h._isSelectionEnabled()&&h.applySelection(),h._highlightActive(),h._signalTaskEnd(),h._runModelEventQueue()},r),setTimeout(function(){for(var e=0;e<l.length;e++)h.addTransformMoveStyle(l[e],r+"ms",0,"linear",0,0,0)},0)}},A.prototype._handleUpdateRangeFetchSuccess=function(e,t,i,s,o,n,r,l){this.m_fetching.cells=!1,this.m_fetchingForUpdate=!1;const a=i[0].start,h=a+t.getCount("row")-1,d=i[1].start,m=d+t.getCount("column")-1,c=this.m_root.contains(document.activeElement);if("cell"===this.m_active?.type&&this._isEditOrEnter()){let e=this._getCellByIndex(this.m_active.indexes);e&&(this.m_activeEdit=e)}this._splitRange(t,a,h,d,m,n,r,l),this.hideStatusText(),null!=this.m_active&&"cell"===this.m_active.type&&this._isActiveWithinUpdateRange({detail:{ranges:[e.range]}})&&!this.m_activeEdit&&(c||(this.m_shouldFocus=!1),this._highlightActive()),u.isIos()&&this._applyIosAccessibility(),this._signalTaskEnd(),e.promiseResolve()},A.prototype._splitRange=function(e,t,i,s,o,n,r,l){if(this._isHighWatermarkScrolling()||void 0===n&&void 0===r&&void 0===l){let n=i<this.m_frozenRowIndex?i:this.m_frozenRowIndex,r=o<this.m_frozenColIndex?o:this.m_frozenColIndex;null!==this.m_frozenRowIndex&&null!==this.m_frozenColIndex&&t<=this.m_frozenRowIndex&&s<=this.m_frozenColIndex?(this._fetchAndMutateCellsByRange(e,this.m_databodyFrozenCorner,t,n,s,r),i>this.m_frozenRowIndex&&this._fetchAndMutateCellsByRange(e,this.m_databodyFrozenCol,this.m_frozenRowIndex+1,i,s,r),o>this.m_frozenColIndex&&this._fetchAndMutateCellsByRange(e,this.m_databodyFrozenRow,t,n,this.m_frozenColIndex+1,o),i>this.m_frozenRowIndex&&(t=this.m_frozenRowIndex+1),o>this.m_frozenColIndex&&(s=this.m_frozenColIndex+1)):this.m_databodyFrozenCol&&null!==this.m_frozenColIndex&&s<=this.m_frozenColIndex?(this._fetchAndMutateCellsByRange(e,this.m_databodyFrozenCol,t,i,s,r),s=this.m_frozenColIndex+1):this.m_databodyFrozenRow&&null!==this.m_frozenRowIndex&&t<=this.m_frozenRowIndex&&(this._fetchAndMutateCellsByRange(e,this.m_databodyFrozenRow,t,n,s,o),t=this.m_frozenRowIndex+1);let l=null!==this.m_frozenColIndex&&-1!==this.m_frozenColIndex,a=null!==this.m_frozenRowIndex&&-1!==this.m_frozenRowIndex;(!l&&!a||(l||a)&&(!a||i>this.m_frozenRowIndex)&&(!l||o>this.m_frozenColIndex))&&this._fetchAndMutateCellsByRange(e,this.m_databody,t,i,s,o)}else this._splitFrozenRange(e,t,i,s,o,n,r,l)},A.prototype._splitFrozenRange=function(e,t,i,s,o,n,r,l){this._hasFrozenColumns()&&this._hasFrozenRows()&&void 0!==l&&l.rowEnd>=l.rowStart&&l.columnEnd>=l.columnStart?(this._fetchAndMutateCellsByRange(l,this.m_databodyFrozenCorner,l.rowStart,l.rowEnd,l.columnStart,l.columnEnd),void 0!==r&&r.rowEnd>=r.rowStart&&this._fetchAndMutateCellsByRange(r,this.m_databodyFrozenCol,r.rowStart,r.rowEnd,r.columnStart,r.columnEnd),void 0!==n&&n.columnEnd>=n.columnStart&&this._fetchAndMutateCellsByRange(n,this.m_databodyFrozenRow,n.rowStart,n.rowEnd,n.columnStart,n.columnEnd)):this.m_databodyFrozenCol&&this._hasFrozenColumns()&&void 0!==r?this._fetchAndMutateCellsByRange(r,this.m_databodyFrozenCol,r.rowStart,r.rowEnd,r.columnStart,r.columnEnd):this.m_databodyFrozenRow&&this._hasFrozenRows()&&void 0!==n&&this._fetchAndMutateCellsByRange(n,this.m_databodyFrozenRow,n.rowStart,n.rowEnd,n.columnStart,n.columnEnd),void 0!==e&&i>=t&&o>=s&&this._fetchAndMutateCellsByRange(e,this.m_databody,t,i,s,o)},A.prototype._fetchAndMutateCellsByRange=function(e,t,i,s,o,n){let r=this._getCellsInRange(i,o,s,n);const l=this.getElementDir(r[0],"top"),a=this.getResources().isRTLMode()?"right":"left",h=this.getElementDir(r[0],a),d=s-i+1,m=n-o+1;this.m_activeEdit&&(r=[...r].filter(e=>!(e===this.m_activeEdit))),this._removeFromArray(r),this.m_activeEdit&&this._populateDatabody(t.firstChild,this.m_activeEdit);let c=document.createDocumentFragment();this._addCellsToFragment(c,e,i,l,o,h,d,m),this._populateDatabody(t.firstChild,c)},A.prototype._removeAndModifyCells=function(e,t){e.forEach(e=>{let i=e[this.getResources().getMappedAttribute("context")];1===i.extents[t]?this._remove(e):i.extent[t]-=1})},A.prototype._removeAndModifyHeaders=function(e,t,i,s,o){e.forEach(e=>{let n=e[this.getResources().getMappedAttribute("context")],r=n.extent,l=e.parentNode;if(1===r)this._remove(e),0!==l.childNodes.length||l.classList.contains(this.getMappedStyle("scroller"))||this._remove(l);else{let r=this.getElementDir(e,i);this.setElementDir(e,r-t,i),n.extent-=1;let a=n.index;if(a===o){n.index+=1;let i=this.getElementDir(e,s);this.setElementDir(e,i+t,s)}if(l.classList.contains(this.getMappedStyle("groupingcontainer"))){let e=this._getAttribute(l,"extent",!0),t=this._getAttribute(l,"start",!0);this._setAttribute(l,"extent",e-1),a===o&&this._setAttribute(l,"start",t+1)}}})},A.prototype._handleDeleteRangeEvent=function(e,t){let i=e.ranges,s=new Set,o=e.axis,n=e.editHeader,r=this.getResources().isRTLMode()?"right":"left",l=this.m_selection;for(let e=0;e<l.length;e++)this._applyBorderClassesAroundRange(this.getElementsInRange(l[e]),l[e],!1,"Selected");i.forEach(function(e){let t=e.offset,i=e.count;for(var o=0;o<i;o++)s.add(t+o)});let a=Array.from(s);a.sort(function(e,t){return t-e});let h=0,d=0,m=0,c=0,_=0,g=0,p=this.m_databodyFrozenRow,f=this.m_rowHeader,C=this.m_rowHeaderFrozen,y=this.m_rowEndHeader,w=this.m_rowEndHeaderFrozen,E=this.m_avgRowHeight,v=-1!==this.m_endRow,x=-1!==this.m_endRowHeader,H=-1!==this.m_endRowEndHeader,b="height",S="top";"column"===o&&(p=this.m_databodyFrozenCol,f=this.m_colHeader,C=this.m_colHeaderFrozen,y=this.m_colEndHeader,w=this.m_colEndHeaderFrozen,E=this.m_avgColWidth,v=-1!==this.m_endCol,x=-1!==this.m_endColHeader,H=-1!==this.m_endColEndHeader,b="width",S=r);let R,I=[],z=[];const F=this.getResources().getMappedAttribute("context");if(this._isEditOrEnter()&&(R=this._getCellByIndex(this.m_active.indexes)),R)if(t)this.m_activeEdit=R;else{let t=this.getCellIndexes(R),i=!1;a.forEach(e=>{("row"===o&&e===t.row||"column"===o&&e===t.column)&&(i=!0)}),i&&(this._handleExitEditable(e,R),this._handleExitEdit(e,R))}for(let e=0;e<a.length;e++){let t=a[e],i=0,s=this._isAxisIndexInViewport(t,o);if(s===A.BEFORE||s===A.INSIDE){if(s===A.BEFORE)m+=1,i=E,h+=i,g+=i;else if(s===A.INSIDE){c+=1,i=this.getElementDir(this._getCellOrHeaderByIndex(t,o),b);let e=this._getAxisCellsByIndex(t,o);if(null!=e){this.m_selectionRange&&this.m_selectionRange.length&&this.unhighlightFloodFillRange(this.m_selectionRange[0]);let t=e;R&&(t=e.filter(e=>!(e[F].indexes.row===R[F].indexes.row&&e[F].indexes.column===R[F].indexes.column))),this._removeAndModifyCells(t,o)}let s,n=this._getHeadersByIndex(t,o);n.length&&this._removeAndModifyHeaders(n,i,b,S,t),"column"===o?s=this._getHeadersByIndex(t,"columnEnd"):"row"===o&&(s=this._getHeadersByIndex(t,"rowEnd")),s.length&&this._removeAndModifyHeaders(s,i,b,S,t),"column"===o&&this._hasFrozenColumns()&&t<=this.m_frozenColIndex||"row"===o&&this._hasFrozenRows()&&t<=this.m_frozenRowIndex?_+=i:g+=i}"column"===o&&this._hasFrozenColumns()&&t<=this.m_frozenColIndex||"row"===o&&this._hasFrozenRows()&&t<=this.m_frozenRowIndex?(z.unshift(i),this._isHighWatermarkScrolling()||(c-=1,("row"===o&&this.m_startRow>0||"column"===o&&this.m_startCol>0)&&(m+=1))):(d+=i,I.unshift(i))}else s===A.AFTER&&"scroll"===this.m_options.getScrollPolicy()&&(g+=i)}this.updateHiddenAxisForDeletion(a,o),a.reverse();let M=[];for(let e=a.length-1;e>=0;e--){let t=a[e];("column"===o&&this._hasFrozenColumns()&&t<=this.m_frozenColIndex||"row"===o&&this._hasFrozenRows()&&t<=this.m_frozenRowIndex)&&(M.push(t),a.splice(e,1))}if(M.reverse(),this._modifyAndPushCells(a,I,o,this.m_databody,f,y,!1,M.length),"column"===o&&this.m_databodyFrozenRow?this._modifyAndPushCells(a,I,o,this.m_databodyFrozenRow,null,null,!1,M.length):"row"===o&&this.m_databodyFrozenCol&&this._modifyAndPushCells(a,I,o,this.m_databodyFrozenCol,null,null,!1,M.length),M.length)if(this._modifyAndPushCells(M,z,o,p,C,w,!1),this.m_databodyFrozenCorner&&this._modifyAndPushCells(M,z,o,this.m_databodyFrozenCorner,null,null,!1),"column"===o){if(this.m_frozenColIndex-=M.length,!t){let e={event:null,ui:{frozenCount:this.m_frozenColIndex+1}};this.fireEvent("columnFreeze",e)}}else if(this.m_frozenRowIndex-=M.length,!t){let e={event:null,ui:{frozenCount:this.m_frozenRowIndex+1}};this.fireEvent("rowFreeze",e)}if(this._refreshDatabodyMap(),!n){let t;this._adjustActive("delete",a),this._simpleAdjustSelectionOnChange("delete",a.reverse(),o);let i={};if(this.m_active&&"cell"===this.m_active.type&&(Object.assign(i,this.m_active.indexes),t=this._getCellByIndex(i),"row"===o))for(;!t&&i.row-1>0;)i.row-=1,t=this._getCellByIndex(i);t&&(this._setActiveByIndex(i,e),this._highlightActive())}var D=this.m_databody.firstChild;if("row"===o){v&&(this.m_startRow-=m,this.m_endRow=this.m_endRow-m-c,this.m_startRowPixel-=h,this.m_endRowPixel=this.m_endRowPixel-h-d,this.m_stopRowFetch=!1),x&&(this.m_startRowHeader-=m,this.m_endRowHeader=this.m_endRowHeader-m-c,this.m_startRowHeaderPixel-=h,this.m_endRowHeaderPixel=this.m_endRowHeaderPixel-h-d,this.m_stopRowHeaderFetch=!1),H&&(this.m_startRowEndHeader-=m,this.m_endRowEndHeader=this.m_endRowEndHeader-m-c,this.m_startRowEndHeaderPixel-=h,this.m_endRowEndHeaderPixel=this.m_endRowEndHeaderPixel-h-d,this.m_stopRowEndHeaderFetch=!1),(v||x||H)&&(this.m_maxRowYet=this.m_maxRowYet-m-c);var L=this.getElementHeight(D)-g;if(this._setAllScrollableRegions("height",L),this.m_databodyFrozenCol&&this.setElementHeight(this.m_databodyFrozenCol,L),this.m_databodyFrozenRow){var T=this.getElementHeight(this.m_databodyFrozenRow)-_;this.setElementHeight(this.m_databodyFrozenRow,T),this.m_databodyFrozenCorner&&this.setElementHeight(this.m_databodyFrozenCorner,T)}this.updateRowBanding()}else if("column"===o){v&&(this.m_startCol-=m,this.m_endCol=this.m_endCol-m-c,this.m_startColPixel-=h,this.m_endColPixel=this.m_endColPixel-h-d,this.m_stopColumnFetch=!1),x&&(this.m_startColHeader-=m,this.m_endColHeader=this.m_endColHeader-m-c,this.m_startColHeaderPixel-=h,this.m_endColHeaderPixel=this.m_endColHeaderPixel-h-d,this.m_stopColumnHeaderFetch=!1),H&&(this.m_startColEndHeader-=m,this.m_endColEndHeader=this.m_endColEndHeader-m-c,this.m_startColEndHeaderPixel-=h,this.m_endColEndHeaderPixel=this.m_endColEndHeaderPixel-h-d,this.m_stopColumnEndHeaderFetch=!1),(v||x||H)&&(this.m_maxColYet=this.m_maxColYet-m-c);var N=this.getElementWidth(D)-g;if(this._setAllScrollableRegions("width",N),this.m_databodyFrozenRow&&this.setElementWidth(this.m_databodyFrozenRow,N),this.m_databodyFrozenCol){var k=this.getElementWidth(this.m_databodyFrozenCol)-_;this.setElementWidth(this.m_databodyFrozenCol,k),this.m_databodyFrozenCorner&&this.setElementWidth(this.m_databodyFrozenCorner,k)}this.updateColumnBanding()}if(!n){this.applySelection(),this.m_utils.isTouchDevice()&&(this.GetSelection().length?this._moveTouchSelectionAffordance():this._removeTouchSelectionAffordance(!0)),this.resizeGrid(),this.deleteAndApplyHiddenIndicators(),this.m_resizeRequired=!0;let e=this;Promise.resolve().then(()=>{null!=e.m_modelEvents&&0===e.m_modelEvents.length&&e.fillViewport()})}u.isIos()&&this._applyIosAccessibility()},A.prototype._handleModelDeleteEventWithAnimation=function(e,t){this._collapseRowsWithAnimation(e,t)},A.prototype._collapseRowsWithAnimation=function(e,t){var i,s,o,n,r,l,a,h;let d=e.indexes;if(0!==t.length){var m=this;m._signalTaskStart();var c=this.m_processingEventQueue?1:A.COLLAPSE_ANIMATION_DURATION,u=[],_=0,g=-1!==this.m_endRowHeader,p=-1!==this.m_endRowEndHeader,f=this._getIndex(this._getAxisCellsByKey(t[0].row,"row")[0],"row")-1;for(s=f;s>=this.m_startRow&&(i=this._getAxisCellsByIndex(s,"row"),!(this.getElementDir(i[0],"top")+this.getElementHeight(i[0])<this.m_currentScrollTop));s--)for(o=0;o<i.length;o++)i[o].style.zIndex=10;if(g)for(r=[],n=this._findHeaderByKey(t[0].row,this.m_rowHeader,this.getMappedStyle("rowheadercell")).previousSibling;n&&!(this.getElementDir(n,"top")+this.getElementHeight(n)<this.m_currentScrollTop);)n.style.zIndex=10,n=n.previousSibling;if(p)for(l=[],n=this._findHeaderByKey(t[0].row,this.m_rowEndHeader,this.getMappedStyle("rowendheadercell")).previousSibling;n&&!(this.getElementDir(n,"top")+this.getElementHeight(n)<this.m_currentScrollTop);)n.style.zIndex=10,n=n.previousSibling;for(s=0;s<t.length;s++){var C=t[s].row;if((i=this._getAxisCellsByKey(C,"row")).length)for(u.push(i),_+=this.getElementHeight(i[0]),o=0;o<i.length;o++)this.setElementDir(i[o],this.getElementDir(i[o],"top")-_,"top"),this.addTransformMoveStyle(i[o],0,0,"linear",0,_,0);g&&null!=(a=this._findHeaderByKey(C,this.m_rowHeader,this.getMappedStyle("rowheadercell")))&&(r.push(a),this.setElementDir(a,this.getElementDir(a,"top")-_,"top"),this.addTransformMoveStyle(a,0,0,"linear",0,_,0)),p&&null!=(h=this._findHeaderByKey(C,this.m_rowEndHeader,this.getMappedStyle("rowendheadercell")))&&(l.push(h),this.setElementDir(h,this.getElementDir(h,"top")-_,"top"),this.addTransformMoveStyle(h,0,0,"linear",0,_,0))}for(s=f+t.length+1;s<=this.m_endRow;s++){for(i=this._getAxisCellsByIndex(s,"row"),o=0;o<i.length;o++)this.setElementDir(i[o],this.getElementDir(i[o],"top")-_,"top"),this.addTransformMoveStyle(i[o],0,0,"linear",0,_,0);g&&(a=a.nextSibling,this.setElementDir(a,this.getElementDir(a,"top")-_,"top"),this.addTransformMoveStyle(a,0,0,"linear",0,_,0)),p&&(h=h.nextSibling,this.setElementDir(h,this.getElementDir(h,"top")-_,"top"),this.addTransformMoveStyle(h,0,0,"linear",0,_,0))}var y=this._getCellByIndex(this.createIndex(this.m_endRow,this.m_endCol));m._onEndEvent("transitionend",y,function(){u.length&&m._modifyAxisCellContextIndex("row",f+t.length+1,m.m_endRow-(f+t.length),-1*t.length),g&&r.length&&m._modifyAxisHeaderContextIndex("row",f+t.length+1,m.m_endRow-(f+t.length),-1*t.length),p&&l.length&&m._modifyAxisHeaderContextIndex("rowEnd",f+t.length+1,m.m_endRow-(f+t.length),-1*t.length);for(var e=0;e<u.length;e++){for(var i=0;i<u[e].length;i++)m._remove(u[e][i]);g&&m._remove(r[e]),p&&m._remove(l[e])}m._adjustActive("delete",d),m._refreshDatabodyMap(),m._isEditOrEnter()&&(m._highlightActiveObject(m.m_active,m.m_prevActive),m._updateEdgeCellBorders("")),m.m_endRow-=u.length,m.m_maxRowYet-=u.length,m.m_endRowPixel-=_,m.m_stopRowFetch=!1,g&&(m.m_endRowHeader-=r.length,m.m_endRowHeaderPixel-=_,m.m_stopRowHeaderFetch=!1),p&&(m.m_endRowEndHeader-=r.length,m.m_endRowEndHeaderPixel-=_,m.m_stopRowEndHeaderFetch=!1),m._setAllScrollableRegions("height",m.m_endRowPixel-m.m_startRowPixel),m.resizeGrid(),m.updateRowBanding(),null==m.m_modelEvents||0!==m.m_modelEvents.length||m.m_moveActive||m.fillViewport(),m._handleAnimationEnd()},c),this.m_animating=!0,setTimeout(function(){for(s=f+1;s<=m.m_endRow;s++){for(i=m._getAxisCellsByIndex(s,"row"),o=0;o<i.length;o++)m.addTransformMoveStyle(i[o],c+"ms",0,"ease-out",0,0,0);g&&(a=m._getHeaderByIndex(s,"row",0),m.addTransformMoveStyle(a,c+"ms",0,"ease-out",0,0,0)),p&&(h=m._getHeaderByIndex(s,"rowEnd",0),m.addTransformMoveStyle(h,c+"ms",0,"ease-out",0,0,0))}},0)}},A.prototype._handleAnimationEnd=function(){var e,t=this.m_databody.firstChild,i=this.m_rowHeader.firstChild,s=this.m_rowEndHeader.firstChild;for(e=0;e<t.childNodes.length;e++)this.removeTransformMoveStyle(t.childNodes[e]),t.childNodes[e].style.zIndex="";if(-1!==this.m_endRowHeader)for(e=0;e<i.childNodes.length;e++)this.removeTransformMoveStyle(i.childNodes[e]),i.childNodes[e].style.zIndex="";if(-1!==this.m_endRowEndHeader)for(e=0;e<s.childNodes.length;e++)this.removeTransformMoveStyle(s.childNodes[e]),s.childNodes[e].style.zIndex="";this.m_animating=!1,this._runModelEventQueue(),this._signalTaskEnd()},A.prototype._getCellOrHeaderByKey=function(e,t){var i=null,s=this._getAxisCellsByKey(e,t,!0);return null!=s&&s.length>0&&(i=s[0]),null==i&&("row"===t?null==(i=this._findHeaderByKey(e,this.m_rowHeader,this.getMappedStyle("rowheadercell")))&&(i=this._findHeaderByKey(e,this.m_rowEndHeader,this.getMappedStyle("rowendheadercell"))):"column"===t&&null==(i=this._findHeaderByKey(e,this.m_colHeader,this.getMappedStyle("colheadercell")))&&(i=this._findHeaderByKey(e,this.m_colEndHeader,this.getMappedStyle("colendheadercell")))),i},A.prototype._findHeaderByKey=function(e,t,i){if(null==t)return null;var s=[],o=[];if(s.push(t),this._hasFrozenRows()&&(t===this.m_rowHeader||t===this.m_rowEndHeader)){let e=t===this.m_rowHeader?this.m_rowHeaderFrozen:this.m_rowEndHeaderFrozen;s.push(e)}if(this._hasFrozenColumns()&&(t===this.m_colHeader||t===this.m_colEndHeader)){let e=t===this.m_colHeader?this.m_colHeaderFrozen:this.m_colEndHeaderFrozen;s.push(e)}for(let e=0;e<s.length;e++)o.push(...s[e].getElementsByClassName(i));for(var n=0;n<o.length;n++){var r=o[n],l=this._getKey(r);if(this._shallowThenDeepCompare(l,e))return r}return null},A.prototype._handleModelRefreshEvent=function(e){let t,i;if(null!=e){const s={ranges:[]};let o=!0;if(null!=e.disregardAfterColumnOffset&&this._getCellOrHeaderByIndex(e.disregardAfterColumnOffset,"column")){s.axis="column";const t=e.disregardAfterColumnOffset+1;s.ranges.push({offset:t,count:this.m_endCol-e.disregardAfterColumnOffset}),o=!1}if(null!=e.disregardAfterRowOffset&&this._getCellOrHeaderByIndex(e.disregardAfterRowOffset,"row")){s.axis="row";const t=e.disregardAfterRowOffset+1;s.ranges.push({offset:t,count:this.m_endRow-e.disregardAfterRowOffset}),o=!1}if(e.preserved&&("columns"===e.preserved&&(t=this.m_currentScrollLeft),"rows"===e.preserved&&(i=this.m_currentScrollTop)),!o)return void this._handleDeleteRangeEvent(s)}var s=this.getVisibility();this.m_focusOnRefresh=this.m_root.contains(document.activeElement),this.m_updateScrollPostionOnRefreshCallback(t,i),s===A.VISIBILITY_STATE_VISIBLE?(this.empty(),null!=this.m_root.offsetParent?this.refresh(this.m_root):this.setVisibility(A.VISIBILITY_STATE_REFRESH)):s===A.VISIBILITY_STATE_HIDDEN&&(this.empty(),this.setVisibility(A.VISIBILITY_STATE_REFRESH))},A.prototype._handleModelSyncEvent=function(e){var t=e.pageSize;this.m_fetching={},this.m_startRow=0,this.m_endRow=-1,this.m_maxRowYet=-1,this.m_startRowHeader=0,this.m_endRowHeader=-1,this.m_startRowEndHeader=0,this.m_endRowEndHeader=-1,this.m_startRowPixel=0,this.m_endRowPixel=0,this.m_startRowHeaderPixel=0,this.m_endRowHeaderPixel=0,this.m_startRowEndHeaderPixel=0,this.m_endRowEndHeaderPixel=0,this.m_startCol=0,this.m_endCol=-1,this.m_maxColYet=-1,this.m_startColHeader=0,this.m_endColHeader=-1,this.m_startColEndHeader=0,this.m_endColEndHeader=-1,this.m_startColPixel=0,this.m_endColPixel=0,this.m_startColHeaderPixel=0,this.m_endColHeaderPixel=0,this.m_startColEndHeaderPixel=0,this.m_endColEndHeaderPixel=0,this.m_rowHeaderLevelCount=void 0,this.m_columnHeaderLevelCount=void 0,this.m_rowEndHeaderLevelCount=void 0,this.m_columnEndHeaderLevelCount=void 0,this.m_avgRowHeight=void 0,this.m_avgColWidth=void 0,this.m_isEstimateRowCount=void 0,this.m_isEstimateColumnCount=void 0,this.m_stopRowFetch=!1,this.m_stopRowHeaderFetch=!1,this.m_stopRowEndHeaderFetch=!1,this.m_stopColumnFetch=!1,this.m_stopColumnHeaderFetch=!1,this.m_stopColumnEndHeaderFetch=!1,this._clearScrollPositionKeys(),this.m_selection=null,this.m_selectionRange=null,this.m_active=null,this.m_prevActive=null,this.m_trueIndex={},null!=this.m_empty&&(this.m_databody.firstChild.removeChild(this.m_empty),this.m_empty=null),this._showHeader(this.m_rowHeader),this._showHeader(this.m_colHeader),this._showHeader(this.m_rowEndHeader),this._showHeader(this.m_colEndHeader),this._emptyHeaders(),this._emptyHeaderLabels();var i=this.m_databody.firstChild;null!=i&&this._emptyDatabody(i),this.m_initialized=!1,this.fetchHeaders("row",0,this.m_rowHeader,this.m_rowEndHeader,t,{success:function(e,t,i){this.handleHeadersFetchSuccess(e,t,i,!1)}}),this.fetchHeaders("column",0,this.m_colHeader,this.m_colEndHeader,void 0,{success:function(e,t,i){this.handleHeadersFetchSuccess(e,t,i,!1)}}),this.fetchCells(this.m_databody,0,0,t,null,{success:function(e,t){this.handleCellsFetchSuccess(e,t)}})},A.prototype._emptyHeaders=function(){var e=this.m_rowHeader.firstChild,t=this.m_rowEndHeader.firstChild;null!=e&&this.m_utils.empty(e),null!=t&&this.m_utils.empty(t);var i=this.m_colHeader.firstChild,s=this.m_colEndHeader.firstChild;null!=i&&this.m_utils.empty(i),null!=s&&this.m_utils.empty(s)},A.prototype._emptyHeaderLabels=function(){var e=this.m_headerLabels.row,t=this.m_headerLabels.rowEnd,i=this.m_headerLabels.column,s=this.m_headerLabels.columnEnd;e&&e.length&&e.forEach(e=>{this.m_utils.empty(e)}),t&&t.length&&t.forEach(e=>{this.m_utils.empty(e)}),i&&i.length&&i.forEach(e=>{this.m_utils.empty(e)}),s&&s.length&&s.forEach(e=>{this.m_utils.empty(e)})},A.prototype._setActiveByIndex=function(e,t,i,s,o){let n=this._getCellByIndex(e);return this._setActive(n,{type:"cell",indexes:e},t,i,s,o)},A.prototype._updateActive=function(e,t,i,s=!0){var o;if(null==e)this._setActive(null,null,null,s,!1,i);else if(null!=e.keys)o=this._getCellByKeys(e.keys);else if(null!=e.indexes)o=this._getCellByIndex(e.indexes);else if(null!=e.axis){var n=null==e.level?0:e.level;"column"===e.axis?null!=e.key?o=this._findHeaderByKey(e.key,this.m_colHeader,this.getMappedStyle("colheadercell")):null!=e.index?o=this._getHeaderByIndex(e.index,e.axis,n):"label"===e.type&&(o=this._getLabel(e.axis,e.level)):"row"===e.axis?null!=e.key?o=this._findHeaderByKey(e.key,this.m_rowHeader,this.getMappedStyle("rowheadercell")):null!=e.index?o=this._getHeaderByIndex(e.index,e.axis,n):"label"===e.type&&(o=this._getLabel(e.axis,e.level)):"columnEnd"===e.axis?null!=e.key?o=this._findHeaderByKey(e.key,this.m_colEndHeader,this.getMappedStyle("colendheadercell")):null!=e.index?o=this._getHeaderByIndex(e.index,e.axis,n):"label"===e.type&&(o=this._getLabel(e.axis,e.level)):"rowEnd"===e.axis&&(null!=e.key?o=this._findHeaderByKey(e.key,this.m_rowEndHeader,this.getMappedStyle("rowendheadercell")):null!=e.index?o=this._getHeaderByIndex(e.index,e.axis,n):"label"===e.type&&(o=this._getLabel(e.axis,e.level)))}null!=o&&(t||(this.m_shouldFocus=!1),this._setActive(o,e,null,s,!1,i))},A.prototype._setActive=function(e,t,i,s,o,n,r){var l;if(null==t||n||this._scrollToActive(t),null!=e)if(l=this._createActiveObject(e),this._compareActive(l,this.m_active)){if(o||this._fireBeforeCurrentCellEvent(l,this.m_active,i)){this.m_prevActive=this.m_active,this.m_active=l;const t=this._getElementFromActiveObject(this.m_prevActive);return t&&u.disableAllFocusableElements(t),!i||"mousedown"!==i.type&&"touchend"!==i.type||(this.m_trueIndex=null),s&&this._isSelectionEnabled()&&this._clearSelection(i),this.deleteDatabodyHiddenVisualIndicators(),this._unhighlightActiveObject(this.m_prevActive),this._highlightActiveObject(this.m_active,this.m_prevActive,null,n),this._manageMoveCursor(),this._isGridEditable()&&"cell"===l.type&&(this._setEditableClone(e),this._updateEdgeCellBorders("")),o||this._fireCurrentCellEvent(l,i),this.m_options.isFloodFillEnabled()&&this._isSelectionEnabled()&&!this.m_discontiguousSelection&&"cell"===this.m_active.type&&i&&(this._addFloodfillAffordance(i),this._moveFloodFillAffordance()),!0}}else this._highlightActive(null,r);else if(!this.m_scrollIndexAfterFetch&&!this.m_scrollHeaderAfterFetch)return(o||this._fireBeforeCurrentCellEvent(l,this.m_active,i))&&(this.m_prevActive=this.m_active,this.m_active=null,this._unhighlightActiveObject(this.m_prevActive),o||this._fireCurrentCellEvent(l,i)),!0;return!1},A.prototype._createActiveObject=function(e){var t=e[this.getResources().getMappedAttribute("context")];return this.m_utils.containsCSSClassName(e,this.getMappedStyle("headercell"))||this.m_utils.containsCSSClassName(e,this.getMappedStyle("endheadercell"))?{type:"header",axis:t.axis,index:this.getHeaderCellIndex(e),key:t.key,level:t.level}:this.m_utils.containsCSSClassName(e,this.getMappedStyle("headerlabel"))?{type:"label",axis:t.axis,level:t.level}:this.m_utils.containsCSSClassName(e,this.getMappedStyle("noDataContainer"))||this.m_utils.containsCSSClassName(e,this.getMappedStyle("emptytext"))?{type:"empty"}:{type:"cell",indexes:{row:t.indexes.row,column:t.indexes.column},keys:{row:t.keys.row,column:t.keys.column},extents:{row:t.extents.row,column:t.extents.column}}},A.prototype._getActiveElement=function(){return this._getElementFromActiveObject(this.m_active)},A.prototype._getElementFromActiveObject=function(e){if(null!=e){if("header"!==e.type)return"label"===e.type?this._getLabel(e.axis,e.level):"empty"===e.type?this._getEmptyElement():this._getCellByIndex(e.indexes);if("row"===e.axis){let t=this.m_rowHeader;return this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&e.index<=this.m_frozenRowIndex&&(t=this.m_rowHeaderFrozen),this._findHeaderByKey(e.key,t,this.getMappedStyle("rowheadercell"))}if("column"===e.axis){let t=this.m_colHeader;return this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&e.index<=this.m_frozenColIndex&&(t=this.m_colHeaderFrozen),this._findHeaderByKey(e.key,t,this.getMappedStyle("colheadercell"))}if("rowEnd"===e.axis){let t=this.m_rowEndHeader;return this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&e.index<=this.m_frozenRowIndex&&(t=this.m_rowEndHeaderFrozen),this._findHeaderByKey(e.key,t,this.getMappedStyle("rowendheadercell"))}if("columnEnd"===e.axis){let t=this.m_colEndHeader;return this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&e.index<=this.m_frozenColIndex&&(t=this.m_colEndHeaderFrozen),this._findHeaderByKey(e.key,t,this.getMappedStyle("colendheadercell"))}}return null},A.prototype._compareActive=function(e,t){if(null==e&&null==t)return!1;if(null==e&&null!=t||null!=e&&null==t)return!0;if(e.type!==t.type)return!0;if("empty"===e.type)return!0;if("header"===e.type){if(e.index!==t.index||e.key!==t.key||e.axis!==t.axis||e.level!==t.level)return!0}else if("label"===e.type){if(e.axis!==t.axis||e.level!==t.level)return!0}else if(e.indexes.row!==t.indexes.row||e.indexes.column!==t.indexes.column||e.keys.row!==t.keys.row||e.keys.column!==t.keys.column)return!0;return!1},A.prototype._fireBeforeCurrentCellEvent=function(e,t,i){var s={event:i,ui:{currentCell:e,previousCurrentCell:t}};return this.fireEvent("beforeCurrentCell",s)},A.prototype._fireCurrentCellEvent=function(e,t){var i={event:t,ui:e};return this.fireEvent("currentCell",i)},A.prototype._isDatabodyCellActive=function(){return null!=this.m_active&&"cell"===this.m_active.type},A.prototype._getActiveContext=function(e,t){var i,s,o,n={};if("header"===e.type){i=e.axis;var r=e.index;return s=e.level,"row"===e.axis?(this.m_rowHeaderLevelCount>1&&(null!=t&&s===t.level&&i===t.axis||(n.level=s)),null!=t&&r===t.index&&i===t.axis||(n.rowHeader=r)):"column"===i?(this.m_columnHeaderLevelCount>1&&(null!=t&&s===t.level&&i===t.axis||(n.level=s)),null!=t&&r===t.index&&i===t.axis||(n.columnHeader=r)):"rowEnd"===e.axis?(this.m_rowEndHeaderLevelCount>1&&(null!=t&&s===t.level&&i===t.axis||(n.level=s)),null!=t&&r===t.index&&i===t.axis||(n.rowEndHeader=r)):"columnEnd"===i&&(this.m_columnEndHeaderLevelCount>1&&(null!=t&&s===t.level&&i===t.axis||(n.level=s)),null!=t&&r===t.index&&i===t.axis||(n.columnEndHeader=r)),this._getContextInfo(n,o)}return"cell"===e.type?(null==t||"cell"!==t.type||null==e||this.m_externalFocus||(e.indexes.row===t.indexes.row?o="row":e.indexes.column===t.indexes.column&&(o="column")),this._getContextInfo(e,o)):"label"===e.type?(i=e.axis,s=e.level,(null==t||"label"!==t.type||"label"===t.type&&t.axis!==i||this.m_externalFocus)&&("column"===i?n.columnHeaderLabel=s:"row"===i?n.rowHeaderLabel=s:"rowEnd"===i?n.rowEndHeaderLabel=s:"columnEnd"===i&&(n.columnEndHeaderLabel=s)),this._getContextInfo(n,o)):null},A.prototype.handleDatabodyClickActive=function(e){var t=e.target,i=this.findCell(t);null!=i&&this._setActive(i,this._createActiveObject(i),e,null,null,!0);const s=this._getEmptyElement();s&&this._setActive(s,this._createActiveObject(s),e)},A.prototype.handleHeaderClickActive=function(e,t,i){var s=e.target,o=this.findHeader(s);null!=o&&(t||this._clearSelection(e),this._setActive(o,this._createActiveObject(o),e,null,null,i))},A.prototype._scrollToActive=function(e){"header"===e.type?this.scrollToHeader(e):"cell"===e.type&&this.scrollToIndex(e.indexes)},A.prototype._getCellByKeys=function(e){if(null==e||null==e.row||null==e.column||null==this.m_databody||null==this.m_databody.firstChild)return null;for(var t=this.m_databody.firstChild.getElementsByClassName(this.getMappedStyle("cell")),i=0;i<t.length;i++){var s=t[i],o=this._getKey(s,"row");if(this._shallowThenDeepCompare(o,e.row)){var n=this._getKey(s,"column");if(this._shallowThenDeepCompare(n,e.column))return s}}return null},A.prototype._shallowThenDeepCompare=function(e,t){return e===t||this._compareValuesCallback(e,t)},A.prototype.getCellKeys=function(e){var t=e[this.getResources().getMappedAttribute("context")];return this.createIndex(t.keys.row,t.keys.column)},A.prototype.getCellIndexes=function(e){var t=e[this.getResources().getMappedAttribute("context")];return this.createIndex(t.indexes.row,t.indexes.column)},A.prototype.getCellExtents=function(e){var t=e[this.getResources().getMappedAttribute("context")];return this.createIndex(t.extents.row,t.extents.column)},A.prototype.getCellEndIndexes=function(e){var t=this.getCellIndexes(e),i=this.getCellExtents(e);return this.createIndex(t.row+(i.row-1),t.column+(i.column-1))},A.prototype._getIndex=function(e,t){if(null!=e){if(null==t||!this.m_utils.containsCSSClassName(e,this.getMappedStyle("cell")))return this.getHeaderCellIndex(e);var i=e[this.getResources().getMappedAttribute("context")];if("row"===t)return i.indexes.row;if("column"===t)return i.indexes.column}return null},A.prototype._getExtent=function(e,t){if(null!=e){if(null==t||!this.m_utils.containsCSSClassName(e,this.getMappedStyle("cell")))return parseInt(this._getAttribute(e,"extent",!0),10);var i=e[this.getResources().getMappedAttribute("context")];if("row"===t)return i.extents.row;if("column"===t)return i.extents.column}return null},A.prototype.getHeaderCellIndex=function(e){var t,i,s;let o,n=e,r=this.getMappedStyle("headercell");var l=this.getHeaderCellAxis(e);switch(l){case"column":t=this.m_columnHeaderLevelCount,i=this.m_startColHeader,this._hasFrozenColumns()&&(o=this.m_colHeaderFrozen);break;case"row":t=this.m_rowHeaderLevelCount,i=this.m_startRowHeader,this._hasFrozenRows()&&(o=this.m_rowHeaderFrozen);break;case"columnEnd":t=this.m_columnEndHeaderLevelCount,i=this.m_startColEndHeader,this._hasFrozenColumns()&&(o=this.m_colEndHeaderFrozen),r=this.getMappedStyle("endheadercell");break;case"rowEnd":t=this.m_rowEndHeaderLevelCount,i=this.m_startRowEndHeader,this._hasFrozenRows()&&(o=this.m_rowEndHeaderFrozen),r=this.getMappedStyle("endheadercell");break;default:return-1}if(t>1){if(s=this._getAttribute(e.parentNode,"start",!0),e===e.parentNode.firstChild)return s;s-=1}else s=i;for(this._isHighWatermarkScrolling()||void 0===o||null===o.querySelector(`#${e.id}`)||1!==t||(s=0),n=this._getHeaderPreviousSibling(n);n;)s+=1,n=this._getHeaderPreviousSibling(n);return!this._isHighWatermarkScrolling()&&(this._isHighWatermarkScrolling()||("column"!==l&&"columnEnd"!==l||0!==this.m_startCol)&&("row"!==l&&"rowEnd"!==l||0!==this.m_startRow))||1!==t||void 0===o||null!==o.querySelector(`#${e.id}`)||(s+=this._getChildElementCountByClassName(o.firstChild,r)),s},A.prototype.getHeaderCellAxis=function(e){return this.m_utils.containsCSSClassName(e,this.getMappedStyle("colheadercell"))?"column":this.m_utils.containsCSSClassName(e,this.getMappedStyle("rowheadercell"))?"row":this.m_utils.containsCSSClassName(e,this.getMappedStyle("rowendheadercell"))?"rowEnd":this.m_utils.containsCSSClassName(e,this.getMappedStyle("colendheadercell"))?"columnEnd":null},A.prototype.getHeaderCellLevel=function(e){if(this.m_utils.containsCSSClassName(e,this.getMappedStyle("colheadercell"))){if(1===this.m_columnHeaderLevelCount)return 0}else if(this.m_utils.containsCSSClassName(e,this.getMappedStyle("rowheadercell"))){if(1===this.m_rowHeaderLevelCount)return 0}else if(this.m_utils.containsCSSClassName(e,this.getMappedStyle("colendheadercell"))){if(1===this.m_columnEndHeaderLevelCount)return 0}else if(this.m_utils.containsCSSClassName(e,this.getMappedStyle("rowendheadercell"))&&1===this.m_rowEndHeaderLevelCount)return 0;var t=this._getAttribute(e.parentNode,"level",!0);return e===e.parentNode.firstChild?t:t+this.getHeaderCellDepth(e.parentNode.firstChild)},A.prototype.getHeaderCellDepth=function(e){return this._getAttribute(e,"depth",!0)},A.prototype.getHeaderLabelLevel=function(e){let t=e[this.getResources().getMappedAttribute("context")];return t?t.level:null},A.prototype.getHeaderLabelAxis=function(e){let t=e[this.getResources().getMappedAttribute("context")];return t?t.axis:null},A.prototype._getResizeHeaderMode=function(e){var t="row";return(this.m_utils.containsCSSClassName(e,this.getMappedStyle("colheadercell"))||this.m_utils.containsCSSClassName(e,this.getMappedStyle("colendheadercell"))||this.m_utils.containsCSSClassName(e,this.getMappedStyle("columnheaderlabel"))||this.m_utils.containsCSSClassName(e,this.getMappedStyle("columnendheaderlabel")))&&(t="column"),t},A.prototype.findCellOrHeader=function(e){var t=this.findCell(e);return null==t&&(t=this.findHeader(e)),t},A.prototype.findCell=function(e){return this.find(e,"cell")},A.prototype.findLabel=function(e){return this.find(e,"headerlabel")},A.prototype.find=function(e,t,i){return null==e||e===this.getRootElement()?null:(null==i&&(i=this.getMappedStyle(t)),null==i?null:this.m_utils.containsCSSClassName(e,i)?e:this.find(e.parentNode,t,i))},A.prototype._highlightActive=function(e,t){this._highlightActiveObject(this.m_active,this.m_prevActive,e,null,t)},A.prototype._unhighlightActive=function(e){this._unhighlightActiveObject(this.m_active,e)},A.prototype._highlightActiveObject=function(e,t,i,s,o){if(null==i&&this.m_utils.shouldOffsetOutline()&&(i=["offsetOutline"]),null!=e){var n=this._getElementFromActiveObject(e);null!=n&&(o||this.m_focusInHandler(n),null!=i&&this._highlightElement(n,i),this._isCellEditable()&&"cell"===e.type&&this._applyBorderClassesAroundRange(n,{startIndex:e.indexes},!0,"Edit"),this._setAriaProperties(e,t,n,s))}},A.prototype._unhighlightActiveObject=function(e,t){if(null==t&&this.m_utils.shouldOffsetOutline()&&(t=["offsetOutline"]),null!=e){var i=this._getElementFromActiveObject(e);null!=i&&(this.m_focusOutHandler(i),null!=t&&this._unhighlightElement(i,t),this._isGridEditable()&&"cell"===e.type&&this._applyBorderClassesAroundRange(i,{startIndex:e.indexes},!1,"Edit"),this._unsetAriaProperties(i))}},A.prototype._highlightCellsAlongAxis=function(e,t,i,s,o){for(var n="key"===i?this._getAxisCellsByKey(e,t):this._getAxisCellsByIndex(e,t),r=0;r<n.length;r++)"add"===s?this._highlightElement(n[r],o):this._unhighlightElement(n[r],o)},A.prototype._highlightElement=function(e,t){for(var i=0;i<t.length;i++){var s=this.getMappedStyle(t[i]);this.m_utils.addCSSClassName(e,s)}},A.prototype._unhighlightElement=function(e,t){for(var i=0;i<t.length;i++){var s=this.getMappedStyle(t[i]);this.m_utils.removeCSSClassName(e,s)}},A.prototype._unhighlightElementsByClassName=function(e,t){if(e.length&&t.length)for(var i=0;i<e.length;i++)this._unhighlightElement(e[i],t)},A.prototype._setAriaProperties=function(e,t,i,s){var o=this.getLabelledBy(e,t,i,!1);const n=this._getActiveContext(e,t);null!==n&&(this.m_contextInfo.textContent=n),i.setAttribute("tabIndex",0),i.setAttribute("aria-labelledby",o),i.setAttribute("role","application"),null!=this.m_cellToFocus&&this.m_cellToFocus===i||!1===this.m_shouldFocus||i.focus({preventScroll:s}),this.m_shouldFocus=null},A.prototype._unsetAriaProperties=function(e){null!=e&&(e.setAttribute("tabIndex",-1),e.removeAttribute("aria-labelledby"),e.removeAttribute("role"),u.isIos()&&e.setAttribute("role","text"))},A.prototype.getLabelledBy=function(e,t,i,s){var o,n,r,l,a="",h=[];const d=i[this.getResources().getMappedAttribute("metadata")];if("header"===e.type){if(null==t||"header"!==t.type||this.m_externalFocus||(o=this._getHeaderByIndex(t.index,t.axis,t.level)),a=s?[this._getHeaderAndParentIds(i,o)].join(" "):[this.createSubId("context"),this._getHeaderAndParentIds(i,o)].join(" "),d&&d.metadata){"expanded"===d.metadata.expanded?h.push({key:"accessibleExpanded",args:{}}):"collapsed"===d.metadata.expanded&&h.push({key:"accessibleCollapsed",args:{}});const t=d.metadata.treeDepth;if(null!=t){let i,s,o,n,r;"row"===e.axis?(i=this.m_stopRowHeaderFetch&&this.m_stopRowEndHeaderFetch&&this.m_stopRowFetch,s=this.m_endRowHeader,o=this.m_startRowHeader):"column"===e.axis&&(s=this.m_endColHeader,o=this.m_startColHeader,i=this.m_stopColumnHeaderFetch&&this.m_stopColumnEndHeaderFetch&&this.m_stopColumnFetch),h.push({key:"accessibleLevelHierarchicalContext",args:{level:t+1}});let l="";const a=[...this.m_root.querySelectorAll(".oj-datagrid-"+e.axis+"-header-cell")];if(t>0){let h,d;a.forEach(i=>{const s=i[this.getResources().getMappedAttribute("context")],o=s.metadata;o.treeDepth<t&&s.index>e.index&&(!d||s.index<d)&&(d=s.index),o.treeDepth===t-1&&s.index<e.index&&(!h||s.index>h)&&(h=s.index)}),null!=h&&null!=d?l="Full":null!=h&&null==d?(d=s+1,l=i?"Full":"Partial"):null==h&&null!=d?(h=o-1,l="Unknown"):(h=o-1,d=s+1,l="Unknown"),n=0,r=0,a.forEach(i=>{const s=i[this.getResources().getMappedAttribute("context")];s.metadata.treeDepth===t&&(s.index<=e.index&&s.index>h&&(r+=1),s.index>h&&s.index<d&&(n+=1))})}else{n=0,r=1;l=0===this.m_startRowHeader?i?"Full":"Partial":"Unknown",a.forEach(i=>{const s=i[this.getResources().getMappedAttribute("context")];s.metadata.treeDepth===t&&(n+=1,s.index<e.index&&(r+=1))})}const d=this._getHierarchicalTranslationKey(l,e.axis);h.push({key:d,args:{posInSet:r,setSize:n}})}"filtered"===d.metadata.filter?h.push({key:"accessibleFiltered",args:{}}):"filterable"===d.metadata.filter&&h.push({key:"accessibleFilterable",args:{}})}const r=i.getAttribute(this.getResources().getMappedAttribute("sortDir"));"ascending"===r?n="accessibleSortAscending":"descending"===r?n="accessibleSortDescending":this._getAttribute(i,"sortable")&&(n="accessibleSortable"),null!=n&&h.push({key:n,args:{id:""}}),d&&d.metadata&&d.metadata.showRequired&&h.push({key:"tooltipRequired",args:{}}),0!==h.length&&(a=a+" "+this.createSubId("state")),i.setAttribute("tabIndex",0)}else if("label"===e.type)a=s?[i.id].join(" "):[this.createSubId("context"),i.id].join(" ");else if("empty"===e.type)a=this._getActiveElement().id;else{null!=t&&("header"===t.type?(r="row"===t.axis?t.index:null,l="column"===t.axis?t.index:null):"cell"===t.type&&(r=t.indexes.row,l=t.indexes.column));var m=this._getHeaderLabelledBy("row",this.m_rowHeaderLevelCount,this.m_endRowHeader,e.indexes.row,r,i),c=this._getHeaderLabelledBy("rowEnd",this.m_rowEndHeaderLevelCount,this.m_endRowEndHeader,e.indexes.row,r,i),_=this._getHeaderLabelledBy("column",this.m_columnHeaderLevelCount,this.m_endColHeader,e.indexes.column,l,i),g=this._getHeaderLabelledBy("columnEnd",this.m_columnEndHeaderLevelCount,this.m_endColEndHeader,e.indexes.column,l,i),p=e.extents.row,f=e.extents.column;p>1&&h.push({key:"accessibleRowSpanContext",args:{extent:p}}),f>1&&h.push({key:"accessibleColumnSpanContext",args:{extent:f}}),a=(a=s?[m,c,_,g,i.id,this.createSubId("state")].join(" "):[this.createSubId("context"),m,c,_,g,i.id,this.createSubId("state")].join(" ")).replace(/ +(?= )/g,"")}!0===this.m_externalFocus&&(null!=this.m_root.id&&(a=[this.m_root.id,a].join(" ")),a=[this.createSubId("summary"),a].join(" "),this.m_externalFocus=!1);let C=u.getActionableElementsInNode(i);return C&&C.length>0&&h.push({key:"accessibleContainsControls"}),this._updateStateInfo(h),a},A.prototype._getHierarchicalTranslationKey=function(e,t){return"accessible"+(t.charAt(0).toUpperCase()+t.slice(1))+"Hierarchical"+e},A.prototype.getHeaderFromCell=function(e,t,i){var s,o,n;return"row"===t?null!=this.m_rowHeader&&(s=this._getIndex(e,"row"),o=this._getExtent(e,"row"),n=this.m_rowHeaderLevelCount-1):"column"===t?null!=this.m_colHeader&&(s=this._getIndex(e,"column"),o=this._getExtent(e,"column"),n=this.m_columnHeaderLevelCount-1):"rowEnd"===t?null!=this.m_rowEndHeader&&(s=this._getIndex(e,"row"),o=this._getExtent(e,"row"),n=this.m_rowEndHeaderLevelCount-1):"columnEnd"===t&&null!=this.m_colEndHeader&&(s=this._getIndex(e,"column"),o=this._getExtent(e,"column"),n=this.m_columnEndHeaderLevelCount-1),null!=s&&null!=n&&s>-1?(i&&(s+=o-1),this._getHeaderByIndex(s,t,n)):null},A.prototype._trimRangeForSelectionMode=function(e){return"row"===this.m_options.getSelectionMode()?this.createRange(this.createIndex(e.startIndex.row),this.createIndex(e.endIndex.row)):e},A.prototype.createRange=function(e,t,i,s){var o,n,r,l,a,h,d,m;return t&&(e.row<t.row||-1===t.row?(o=e.row,n=t.row,i&&(a=i.row,h=s.row)):(o=t.row,n=e.row,i&&(a=s.row,h=i.row)),isNaN(e.column)||isNaN(t.column)?(e={row:o},t={row:n},i&&(i={row:a,column:d},s={row:h,column:m})):(e.column<t.column||-1===t.column?(r=e.column,l=t.column,i&&(d=i.column,m=s.column)):(r=t.column,l=e.column,i&&(d=s.column,m=i.column)),e={row:o,column:r},t={row:n,column:l},i&&(i={row:a,column:d},s={row:h,column:m}))),i?{startIndex:e,endIndex:t,startKey:i,endKey:s}:{startIndex:e,endIndex:t}},A.prototype._createRangeWithKeys=function(e,t,i){this._keys(e,this._createRangeStartKeyCallback.bind(this,t,i))},A.prototype._createRangeStartKeyCallback=function(e,t,i,s){null!=e&&null!=s&&e.row===s.row&&e.column===s.column?this._createRangeEndKeyCallback(i,s,t,i,s):e?this._keys(e,this._createRangeEndKeyCallback.bind(this,i,s,t)):t.call(this,{startIndex:s,endIndex:s,startKey:i,endKey:i})},A.prototype._createRangeEndKeyCallback=function(e,t,i,s,o){i.call(this,this.createRange(t,o,e,s))},A.prototype.getEndIndex=function(e){return null==e.endIndex?e.startIndex:e.endIndex},A.prototype.getElementsInRange=function(e,t,i,s,o){var n,r,l,a,h;null==t&&(t=this.m_startRow),null==i&&(i=this.m_endRow+1);var d=e.startIndex,m=this.getEndIndex(e),c=d.row,u=m.row;if(-1===u&&(u=Number.MAX_VALUE),!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&(this.m_startRow===this.m_frozenRowIndex+1||c<this.m_frozenRowIndex+1)&&(t=0),!this._isHighWatermarkScrolling()&&this._hasFrozenRows()){if(i<c||u>this.m_frozenRowIndex&&u<t)return null}else if(i<c||u<t)return null;let _=this.m_startCol;if(!isNaN(d.column)&&!isNaN(m.column))if(n=d.column,-1===(r=m.column)&&(r=Number.MAX_VALUE),!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&(this.m_startCol===this.m_frozenColIndex+1||n<this.m_frozenColIndex+1)&&(_=0),!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()){if(this.m_endCol+1<n||r>this.m_frozenColIndex&&r<_)return null}else if(this.m_endCol+1<n||r<this.m_startCol)return null;var g=[];if(null==this.m_databody.firstChild)return null;if(c=this._isHighWatermarkScrolling()?Math.max(this.m_startRow,c):Math.max(t,c),u=Math.min(this.m_endRow,u),isNaN(n)||isNaN(r)){for(n=Math.max(0,this.m_startCol),r=Math.max(n,this.m_endCol),l=c;l<=u;l+=1)for(a=n;a<=r;a+=1)null!=(h=this._getCellByIndex(this.createIndex(l,a)))&&-1===g.indexOf(h)&&g.push(h);if(!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&isNaN(d.column)&&isNaN(m.column))for(l=c;l<=u;l+=1)for(a=0;a<=this.m_frozenColIndex;a+=1)null!=(h=this._getCellByIndex(this.createIndex(l,a)))&&-1===g.indexOf(h)&&g.push(h)}else for(n=this._isHighWatermarkScrolling()?Math.max(this.m_startCol,n):Math.max(_,n),r=Math.min(this.m_endCol,r),l=c;l<=u;l+=1)for(a=n;a<=r;a+=1)null!=(h=this._getCellByIndex(this.createIndex(l,a)))&&-1===g.indexOf(h)&&g.push(h);return g},A.prototype._getRangeInView=function(e){let t=e.startIndex,i=this.getEndIndex(e),s=t.row,o=i.row,n=t.column,r=i.column;-1===o&&(o=Number.MAX_VALUE),-1===r&&(r=Number.MAX_VALUE);let l=this.m_startRow;!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&(this.m_startRow===this.m_frozenRowIndex+1||-1===i.row||s<this.m_frozenRowIndex+1)&&(l=0),s=Math.max(l,s),o=Math.min(this.m_endRow,o),(isNaN(t.column)||isNaN(i.column))&&(n=Math.max(0,this.m_startCol),r=Math.max(n,this.m_endCol));let a=this.m_startCol;return!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&(this.m_startCol===this.m_frozenColIndex+1||-1===i.column||n<this.m_frozenColIndex+1)&&(a=0),n=Math.max(a,n),r=Math.min(this.m_endCol,r),this.createRange(this.createIndex(s,n),this.createIndex(o,r))},A.prototype._applyBorderClassesAroundRange=function(e,t,i,s){if(null==this.m_databody.firstChild||null==e||0===e.length)return;let o=this._getRangeInView(t),n=o.startIndex.row,r=o.startIndex.column,l=o.endIndex.row,a=o.endIndex.column,h=this.isFirstOrFirstNonHiddenIndex(n,"row"),d=this.isFirstOrFirstNonHiddenIndex(r,"column"),m=h?n:this.getVisibleCellIndexInDirection("row",n-1,{up:!0}),c=l,u=d?r:this.getVisibleCellIndexInDirection("column",r-1,{left:!0}),_=a;"row"===this.m_options.getSelectionMode()&&!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&(u=0,d=!0);for(let e=n;e<=l;e++){let t=this._getCellByIndex(this.createIndex(e,u)),o=this._getCellByIndex(this.createIndex(e,_)),n=(d?"start":"end")+s,r="end"+s;i?(this._highlightElement(t,[n]),this._highlightElement(o,[r])):(this._unhighlightElement(t,[n]),this._unhighlightElement(o,[r]))}for(let e=r;e<=a;e++){let t=this._getCellByIndex(this.createIndex(m,e)),o=this._getCellByIndex(this.createIndex(c,e)),n=(h?"top":"bottom")+s,r="bottom"+s;i?(this._highlightElement(t,[n]),this._highlightElement(o,[r])):(this._unhighlightElement(t,[n]),this._unhighlightElement(o,[r]))}if("row"===this.m_options.getSelectionMode()&&!this._isHighWatermarkScrolling()&&this._hasFrozenColumns())for(let e=0;e<=this.m_frozenColIndex;e++){let t=this._getCellByIndex(this.createIndex(m,e)),o=this._getCellByIndex(this.createIndex(c,e)),n=(h?"top":"bottom")+s,r="bottom"+s;i?(this._highlightElement(t,[n]),this._highlightElement(o,[r])):(this._unhighlightElement(t,[n]),this._unhighlightElement(o,[r]))}},A.prototype.readCurrentContent=function(){var e,t;if(null==this.m_active)return!1;if("header"===this.m_active.type)e={},"row"===this.m_active.axis?(this.m_rowHeaderLevelCount>1&&(e.level=this.m_active.level),e.rowHeader=this.m_active.index):(this.m_columnHeaderLevelCount>1&&(e.level=this.m_active.level),e.columnHeader=this.m_active.index),t=this._getActiveElement();else if("cell"===this.m_active.type){if(e=this.m_active.indexes,this._isSelectionEnabled()&&this.isMultipleSelection()&&null!=this.m_selectionFrontier&&(e=this.m_selectionFrontier),null==e)return!1;var i=this.createRange(e),s=this.getElementsInRange(i);if(null==s||0===s.length)return!1;t=s[0]}else t=this._getActiveElement();const o=this._getActiveContext(this.m_active,this.m_prevActive);null!==o&&(this.m_contextInfo.textContent=o),this.m_placeHolder.tabIndex=-1;var n=t.getAttribute("aria-labelledby");return this.m_placeHolder.setAttribute("aria-labelledby",n+" "+t.id),this.m_placeHolder===document.activeElement?t.focus():this.m_placeHolder.focus(),!0},A.prototype._enterActionableMode=function(e,t,i){return this.isActionableMode()||(this._enteringActionableMode=!0,(!i||i&&this._setFocusToFirstFocusableElement(e,t))&&(this.m_focusOutHandler(e),this.setActionableMode(!0))),this._enteringActionableMode=!1,!1},A.prototype._exitActionableMode=function(){if(this.isActionableMode()){var e=this._getActiveElement();this.setActionableMode(!1),u.disableAllFocusableElements(e),this.m_focusInHandler(e)}},A.prototype._reRenderCell=function(e,t,i,s){var o=this.getRendererOrTemplate("cell"),n=e[this.getResources().getMappedAttribute("context")],r=e[this.getResources().getMappedAttribute("metadata")];if(n.mode=t,this.m_utils.empty(e),this.m_utils.containsCSSClassName(e,i)?this.m_utils.removeCSSClassName(e,i):this.m_utils.addCSSClassName(e,i),s){for(;s.hasChildNodes();)e.appendChild(s.firstChild);this._destroyEditableClone()}else this._renderContent(o,n,e,n.data,this.buildCellTemplateContext(n,r))},A.prototype._resetEditableClone=function(){if(this._isGridEditable()&&this.m_active&&"cell"===this.m_active.type){let e=this._getActiveElement();e&&this._setEditableClone(e)}},A.prototype._setEditableClone=function(e){if(this._destroyEditableClone(),null!=e){var t=e.cloneNode(!1);t.removeAttribute("id"),this._createUniqueId(t),t[this.getResources().getMappedAttribute("context")]=e[this.getResources().getMappedAttribute("context")],t[this.getResources().getMappedAttribute("metadata")]=e[this.getResources().getMappedAttribute("metadata")],t[this.getResources().getMappedAttribute("context")].parentElement=t,this.m_root.appendChild(t),this._reRenderCell(t,"edit",this.getMappedStyle("cellEdit"),null),t.style.display="none",t[this.getResources().getMappedAttribute("context")].parentElement=e,this.m_editableClone=t}},A.prototype._destroyEditableClone=function(){this.m_editableClone&&(null!=this.m_editableClone.parentNode?this._remove(this.m_editableClone):this._cleanTemplateNodes(this.m_editableClone),delete this.m_editableClone)},A.prototype.isArrowKey=function(e){return e===this.keyCodes.UP_KEY||e===this.keyCodes.DOWN_KEY||e===this.keyCodes.LEFT_KEY||e===this.keyCodes.RIGHT_KEY},A.prototype.createIndex=function(e,t){var i={};return void 0!==e&&(i.row=e),void 0!==t&&(i.column=t),i},A.prototype.checkCorners=function(e,t,i){return"column"===this.m_selectionFrontier.axis&&this.m_columnHeaderLevelCount!==this.m_selectionFrontier.level||"row"===this.m_selectionFrontier.axis&&this.m_rowHeaderLevelCount!==this.m_selectionFrontier.level||"rowEnd"===this.m_selectionFrontier.axis&&this.m_rowEndHeaderLevelCount!==this.m_selectionFrontier.level||"columnEnd"===this.m_selectionFrontier.axis&&this.m_columnEndHeaderLevelCount!==this.m_selectionFrontier.level||(-1!==e.indexOf("row")?t===i.startIndex.row&&this.m_selectionFrontier.end===i.endIndex.row||t===i.endIndex.row&&this.m_selectionFrontier.end===i.startIndex.row:-1!==e.indexOf("column")&&(t===i.startIndex.column&&this.m_selectionFrontier.end===i.endIndex.column||t===i.endIndex.column&&this.m_selectionFrontier.end===i.startIndex.column))},A.prototype.handleLabelFocusChange=function(e,t,i,s){var o,n,r,l;if(!this.isFetchComplete())return!0;this.getResources().isRTLMode()&&(e===this.keyCodes.LEFT_KEY?e=this.keyCodes.RIGHT_KEY:e===this.keyCodes.RIGHT_KEY&&(e=this.keyCodes.LEFT_KEY));var a=this.m_active.axis,h=this.m_active.level;switch("column"===a?(r=this.m_startColHeader,l=this.m_columnHeaderLevelCount):"row"===a&&(r=this.m_startRowHeader,l=this.m_rowHeaderLevelCount),"columnEnd"===a&&(e===this.keyCodes.DOWN_KEY?e=this.keyCodes.UP_KEY:e===this.keyCodes.UP_KEY&&(e=this.keyCodes.DOWN_KEY),r=this.m_startColEndHeader,l=this.m_columnEndHeaderLevelCount),"rowEnd"===a&&(e===this.keyCodes.LEFT_KEY?e=this.keyCodes.RIGHT_KEY:e===this.keyCodes.RIGHT_KEY&&(e=this.keyCodes.LEFT_KEY),r=this.m_startRowEndHeader,l=this.m_rowEndHeaderLevelCount),"row"!==a&&"rowEnd"!==a||this._isHighWatermarkScrolling()||!this._hasFrozenRows()||(r=0),"column"!==a&&"columnEnd"!==a||this._isHighWatermarkScrolling()||!this._hasFrozenColumns()||(r=0),e){case this.keyCodes.DOWN_KEY:"row"!==a&&"rowEnd"!==a||(o=this._getHeaderByIndex(r,a,h),this._isSelectionEnabled()&&!this.m_discontiguousSelection&&(this._clearSelection(t),this.m_selectionFrontier={}),this._setActive(o,{type:"header",index:r,level:h,axis:a},t)),"column"!==a&&"columnEnd"!==a||((o=this.m_headerLabels[a][h+1])?this._setActive(o,{type:"label",level:h+1,axis:a},t):"column"===a&&h===l-1&&this.m_headerLabels.row.length?(o=this.m_headerLabels.row[this.m_headerLabels.row.length-1],this._setActive(o,{type:"label",level:this.m_headerLabels.row.length-1,axis:"row"},t)):h===l-1&&(n="column"===a?this.m_startRowHeader:this.m_endRowHeader,o=this._getHeaderByIndex(n,"row",this.m_rowHeaderLevelCount-1),this._isSelectionEnabled()&&!this.m_discontiguousSelection&&(this._clearSelection(t),this.m_selectionFrontier={}),o&&this._setActive(o,{type:"header",index:n,level:h,axis:"row"},t)));break;case this.keyCodes.UP_KEY:"row"===a&&h===l-1&&this.m_headerLabels.column.length&&(o=this.m_headerLabels.column[this.m_headerLabels.column.length-1],this._setActive(o,{type:"label",level:this.m_headerLabels.column.length-1,axis:"column"},t)),"column"!==a&&"columnEnd"!==a||(o=this.m_headerLabels[a][h-1])&&this._setActive(o,{type:"label",level:h-1,axis:a},t);break;case this.keyCodes.RIGHT_KEY:if("row"===a||"rowEnd"===a)if(o=this.m_headerLabels[a][h+1])this._setActive(o,{type:"label",level:h+1,axis:a},t);else if(h===l-1){for(n="row"===a?this.m_startColHeader:this.m_endColHeader,"row"===a&&!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&(n=0);this.isHidden("column",n);)n="row"===a?n+1:n-1;(o=this._getHeaderByIndex(n,"column",this.m_columnHeaderLevelCount))&&(this._isSelectionEnabled()&&!this.m_discontiguousSelection&&(this._clearSelection(t),this.m_selectionFrontier={}),this._setActive(o,{type:"header",index:n,level:h,axis:"column"},t))}if("column"===a||"columnEnd"===a){for(n=r,o=this._getHeaderByIndex(n,a,h);null!=o&&this.isHeaderHidden(o);)n=h!==l-1?this._getAttribute(o.parentNode,"start",!0)+this._getAttribute(o.parentNode,"extent",!0):n+1,o=this._getHeaderByIndex(n,a,h);this._isSelectionEnabled()&&!this.m_discontiguousSelection&&(this._clearSelection(t),this.m_selectionFrontier={}),this._setActive(o,{type:"header",index:r,level:h,axis:a},t)}break;case this.keyCodes.LEFT_KEY:"row"!==a&&"rowEnd"!==a||(o=this.m_headerLabels[a][h-1])&&this._setActive(o,{type:"label",level:h-1,axis:a},t)}return!0},A.prototype.handleHeaderFocusChange=function(e,t,i,s,o){var n,r,l,a,h,d,m;let c,u=this._getEmptyElement();this.getResources().isRTLMode()&&(e===this.keyCodes.LEFT_KEY?e=this.keyCodes.RIGHT_KEY:e===this.keyCodes.RIGHT_KEY&&(e=this.keyCodes.LEFT_KEY));var _=this.m_active.axis,g=this.m_active.index,p=this.m_active.level,f=this._getActiveElement(),C=null!=f?this._getAttribute(f,"depth",!0):1;if(_||g||!this.m_active||(_=this.m_selectionFrontier.axis,g=this.m_active.indexes[_]),t.shiftKey&&!i&&this.m_selectionFrontier&&this.isMultipleSelection()&&(i=this.checkHeaderToDatabody(_,e)),!(i&&this.isArrowKey(e)&&this.isHeaderSelectionType(this.m_selectionFrontier)&&this.checkCorners(_,g,this.m_selection[this.m_selection.length-1]))||(_=this.m_selectionFrontier.axis,g=this.m_selectionFrontier.index,p=this.m_selectionFrontier.level,-1===g&&(g=this.m_active.indexes[_]),"cell"!==this.m_active.type||(e!==this.keyCodes.LEFT_KEY&&e!==this.keyCodes.RIGHT_KEY||-1===_.indexOf("row"))&&(e!==this.keyCodes.UP_KEY&&e!==this.keyCodes.DOWN_KEY||-1===_.indexOf("column")))){if("column"===_?(h=this.m_endColHeader,d=this.m_columnHeaderLevelCount,m=this.m_stopColumnHeaderFetch,c=this.m_startColHeader):"row"===_&&(h=this.m_endRowHeader,d=this.m_rowHeaderLevelCount,m=this.m_stopRowHeaderFetch,c=this.m_startRowHeader),"columnEnd"===_&&(e===this.keyCodes.DOWN_KEY?e=this.keyCodes.UP_KEY:e===this.keyCodes.UP_KEY&&(e=this.keyCodes.DOWN_KEY),h=this.m_endColEndHeader,d=this.m_columnEndHeaderLevelCount,m=this.m_stopColumnEndHeaderFetch,c=this.m_startColEndHeader),"rowEnd"===_&&(e===this.keyCodes.LEFT_KEY?e=this.keyCodes.RIGHT_KEY:e===this.keyCodes.RIGHT_KEY&&(e=this.keyCodes.LEFT_KEY),h=this.m_endRowEndHeader,d=this.m_rowEndHeaderLevelCount,m=this.m_stopRowEndHeaderFetch,c=this.m_startRowEndHeader),!this.isFetchComplete())return this.m_skeletonSet.size>0&&!i&&(l=1===d||p===d-1?g+1:null!=f?this._getAttribute(f.parentNode,"start",!0)+this._getAttribute(f.parentNode,"extent",!0):g+1,(e===this.keyCodes.RIGHT_KEY&&l===this.m_endCol+1||e===this.keyCodes.DOWN_KEY&&l===this.m_endRow+1)&&this._scrollSkeletonHeadersIntoViewport(l-1,_,p,!0)),!0;i&&this.isArrowKey(e)&&this.isHeaderSelectionType(this.m_selectionFrontier)&&(C=null!=(f=this._getHeaderByIndex(g,_,p))?this._getAttribute(f,"depth",!0):1);var y=this._isSelectionEnabled()?this.selectAndFocus.bind(this):this._setActiveByIndex.bind(this);switch(e){case this.keyCodes.LEFT_KEY:if("column"===_||"columnEnd"===_)if(g>0&&!this.isFirstOrFirstNonHiddenIndex(g,_)){if(s&&this.m_headerLabels[_][p]){this._setActive(this.m_headerLabels[_][p],{type:"label",level:p,axis:_},t);break}if("column"===_&&s&&this.m_headerLabels.row[this.m_rowHeaderLevelCount-1]){this._setActive(this.m_headerLabels.row[this.m_rowHeaderLevelCount-1],{type:"label",level:this.m_rowHeaderLevelCount-1,axis:"row"},t);break}l=null!=(r=this._getHeaderByIndex(g-1,_,p))&&p!==d-1?this._getAttribute(r.parentNode,"start",!0)-this._getAttribute(r.parentNode,"extent",!0):g-1;let e=1;for(;null!=r&&this.isHeaderHidden(r);)l=g-1-e,r=this._getHeaderByIndex(l,_,p),e+=1;if(l=null!=r&&p!==d-1?this._getAttribute(r.parentNode,"start",!0):this.findNextNonHiddenIndex(l,_),a=null!=r?this.getHeaderCellLevel(r):p,l<0)break;!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&l<=this.m_frozenColIndex&&(c=0),i?this.extendSelectionHeader(r,t,!0):l<c?this._scrollSkeletonHeadersIntoViewport(g,_,p,!1):(this._isSelectionEnabled()&&!this.m_discontiguousSelection&&"row"!==this.m_options.getSelectionMode()&&(this._clearSelection(t),this.m_selectionFrontier={}),this._setActive(r,{type:"header",index:l,level:a,axis:_},t),this._highlightActive())}else this.m_headerLabels[_][p]?this._setActive(this.m_headerLabels[_][p],{type:"label",level:p,axis:_},t):"column"===_&&this.m_headerLabels.row[this.m_rowHeaderLevelCount-1]&&this._setActive(this.m_headerLabels.row[this.m_rowHeaderLevelCount-1],{type:"label",level:this.m_rowHeaderLevelCount-1,axis:"row"},t);else("row"===_||"rowEnd"===_)&&p>0&&(r=this._getHeaderByIndex(g,_,p-1),l=this._getAttribute(r.parentNode,"start",!0),a=this.getHeaderCellLevel(r),i?this.extendSelectionHeader(r,t,!0):(this._isSelectionEnabled()&&!this.m_discontiguousSelection&&(this._clearSelection(t),this.m_selectionFrontier={}),this._setActive(r,{type:"header",index:l,level:a,axis:_},t),this._highlightActive()));break;case this.keyCodes.RIGHT_KEY:if("rowEnd"===_&&s&&-1!==this.m_endRowHeader)r=this._getHeaderByIndex(g,_,this.m_rowHeaderLevelCount),i?this.extendSelectionHeader(r,t,!0):(this._isSelectionEnabled()&&!this.m_discontiguousSelection&&(this._clearSelection(t),this.m_selectionFrontier={}),this._setActive(r,{type:"header",index:g,level:this.m_rowHeaderLevelCount,axis:_},t),this._highlightActive());else if("row"===_&&s&&-1!==this.m_endRowEndHeader)r=this._getHeaderByIndex(g,_,this.m_rowEndHeaderLevelCount),i?this.extendSelectionHeader(r,t,!0):(this._isSelectionEnabled()&&!this.m_discontiguousSelection&&(this._clearSelection(t),this.m_selectionFrontier={}),this._setActive(r,{type:"header",index:g,level:this.m_rowEndHeaderLevelCount,axis:_},t),this._highlightActive());else if("row"===_||"rowEnd"===_)if(p+C>=d&&!i)if(this.m_trueIndex={row:g},o){if("row"===_){let e=this._getEmptyCellNeighborIndex({row:g,column:-1},{right:!0},this._getMaxRight(),this.m_endRowEndHeader);if(e)if(e.cell)y(e.cell,t);else if(e.header){let e=this._getHeaderByIndex(this.m_trueIndex.row,"rowEnd",this.m_rowEndHeaderLevelCount-1);this._setActive(e,{type:"header",index:g,level:this.m_rowEndHeaderLevelCount-1,axis:"rowEnd"},t,!0)}}else if("rowEnd"===_){let e=this._getEmptyCellNeighborIndex({row:g,column:this.m_endCol+1},{left:!0},this._getMaxLeft(),this.m_startRowHeader);if(e.cell)y(e.cell,t);else if(e.header){let e=this._getHeaderByIndex(this.m_trueIndex.row,"row",this.m_rowHeaderLevelCount-1);this._setActive(e,{type:"header",index:g,level:this.m_rowHeaderLevelCount-1,axis:"row"},t,!0)}}}else if(u)this._setActive(u,{type:"empty"},t,!0);else{let e,i;if("row"===_){for(let e=0;e<=this.getDataSource().getCount("column")-1;e++)if(!this.isHidden("column",e)){i=e;break}n=this.createIndex(g,i)}else this._isHighWatermarkScrolling()?(e=this.getVisibleCellIndexInDirection("column",this.m_endCol,{left:!0}),n=this.createIndex(g,e)):(e=this.getVisibleCellIndexInDirection("column",this.getDataSource().getCount("column")-1,{left:!0}),n=this.createIndex(g,e));if(this._isSelectionEnabled())this.selectAndFocus(n,t);else{let e=this._getCellByIndex(n).classList.contains(this.getMappedStyle("frozenCell"));this._setActiveByIndex(n,t,null,null,e),this._highlightActive()}}else{let e=this.getVisibleCellIndexInDirection(_,g,{right:!0});r=this._getHeaderByIndex(e,_,p+C),l=this._getAttribute(r.parentNode,"start",!0),a=this.getHeaderCellLevel(r),i?this.extendSelectionHeader(r,t,!0):(this._isSelectionEnabled()&&!this.m_discontiguousSelection&&(this._clearSelection(t),this.m_selectionFrontier={}),this._setActive(r,{type:"header",index:l,level:a,axis:_},t),this._highlightActive())}else if("column"===_&&s&&this.m_headerLabels.rowEnd[this.m_rowEndHeaderLevelCount-1])this._setActive(this.m_headerLabels.rowEnd[this.m_rowEndHeaderLevelCount-1],{type:"label",level:this.m_rowEndHeaderLevelCount-1,axis:"rowEnd"},t);else{for(l=null!=f&&p!==d-1?this._getAttribute(f.parentNode,"start",!0)+this._getAttribute(f.parentNode,"extent",!0):g+1,r=!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&l>this.m_frozenColIndex&&l<this.m_startCol?null!=(l=this.m_options.getScrollPosition().columnIndex)?this._getHeaderByIndex(l,_,p):g+1:this._getHeaderByIndex(l,_,p);null!=r&&this.isHeaderHidden(r);)l=p!==d-1?this._getAttribute(r.parentNode,"start",!0)+this._getAttribute(r.parentNode,"extent",!0):l+1,r=this._getHeaderByIndex(l,_,p);a=null!=r?this.getHeaderCellLevel(r):p,l>h&&m||!(this._isCountUnknown("column")||l<this.getDataSource().getCount("column"))?"column"===_&&this.m_headerLabels.rowEnd[this.m_rowEndHeaderLevelCount-1]&&this._setActive(this.m_headerLabels.rowEnd[this.m_rowEndHeaderLevelCount-1],{type:"label",level:this.m_rowEndHeaderLevelCount-1,axis:"rowEnd"},t):i?this.extendSelectionHeader(r,t,!0):(this._isSelectionEnabled()&&!this.m_discontiguousSelection&&"row"!==this.m_options.getSelectionMode()&&(this._clearSelection(t),this.m_selectionFrontier={}),this._setActive(r,{type:"header",index:l,level:a,axis:_},t),this._highlightActive())}break;case this.keyCodes.UP_KEY:if("row"===_||"rowEnd"===_){if(s&&this.m_headerLabels[_][p]){this._setActive(this.m_headerLabels[_][p],{type:"label",level:p,axis:_},t);break}if("row"===_&&s&&this.m_headerLabels.column[this.m_columnHeaderLevelCount-1]){this._setActive(this.m_headerLabels.column[this.m_columnHeaderLevelCount-1],{type:"label",level:this.m_columnHeaderLevelCount-1,axis:"column"},t);break}if(g>0&&!this.isFirstOrFirstNonHiddenIndex(g,_)){l=null!=(r=this._getHeaderByIndex(g-1,_,p))&&p!==d-1?this._getAttribute(r.parentNode,"start",!0)-this._getAttribute(r.parentNode,"extent",!0):g-1;let e=1;for(;null!=r&&this.isHeaderHidden(r);)l=g-1-e,r=this._getHeaderByIndex(l,_,p),e+=1;if(l=null!=r&&p!==d-1?this._getAttribute(r.parentNode,"start",!0):this.findNextNonHiddenIndex(l,_),a=null!=r?this.getHeaderCellLevel(r):p,l<0)break;!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&l<=this.m_frozenRowIndex&&(c=0),i?this.extendSelectionHeader(r,t,!0):l<c?this._scrollSkeletonHeadersIntoViewport(g,_,p,!1):(this._isSelectionEnabled()&&!this.m_discontiguousSelection&&(this.m_selectionFrontier={},this._clearSelection(t)),this._setActive(r,{type:"header",index:l,level:a,axis:_},t),this._highlightActive())}else this.m_headerLabels[_][p]?this._setActive(this.m_headerLabels[_][p],{type:"label",level:p,axis:_},t):"row"===_&&this.m_headerLabels.column[this.m_columnHeaderLevelCount-1]&&this._setActive(this.m_headerLabels.column[this.m_columnHeaderLevelCount-1],{type:"label",level:this.m_columnHeaderLevelCount-1,axis:"column"},t)}else("column"===_||"columnEnd"===_)&&p>0&&(r=this._getHeaderByIndex(g,_,p-1),l=this._getAttribute(r.parentNode,"start",!0),a=this.getHeaderCellLevel(r),i?this.extendSelectionHeader(r,t,!0):(this._isSelectionEnabled()&&!this.m_discontiguousSelection&&(this.m_selectionFrontier={},this._clearSelection(t)),this._setActive(r,{type:"header",index:l,level:a,axis:_},t),this._highlightActive()));break;case this.keyCodes.DOWN_KEY:if("columnEnd"===_&&s&&-1!==this.m_endColHeader)r=this._getHeaderByIndex(g,_,this.m_columnHeaderLevelCount),i?this.extendSelectionHeader(r,t,!0):(this._isSelectionEnabled()&&!this.m_discontiguousSelection&&(this.m_selectionFrontier={},this._clearSelection(t)),this._setActive(r,{type:"header",index:g,level:this.m_columnHeaderLevelCount,axis:_},t),this._highlightActive());else if("column"===_&&s&&-1!==this.m_endColEndHeader)r=this._getHeaderByIndex(g,_,this.m_columnEndHeaderLevelCount),i?this.extendSelectionHeader(r,t,!0):(this._isSelectionEnabled()&&!this.m_discontiguousSelection&&(this._clearSelection(t),this.m_selectionFrontier={}),this._setActive(r,{type:"header",index:g,level:this.m_columnEndHeaderLevelCount,axis:_},t),this._highlightActive());else if("column"===_||"columnEnd"===_)if(p+C>=d&&!i)if(this.m_trueIndex={column:g},o){if("column"===_){let e=this._getEmptyCellNeighborIndex({row:0,column:this.m_trueIndex.column},{down:!0},this._getMaxBottom(),this.m_endColEndHeader);if(e)if(e.cell)y(e.cell,t);else if(e.header){let e=this._getHeaderByIndex(this.m_trueIndex.column,"columnEnd",this.m_columnEndHeaderLevelCount-1);this._setActive(e,{type:"header",index:g,level:this.m_columnEndHeaderLevelCount-1,axis:"columnEnd"},t,!0)}}else if("columnEnd"===_){let e=this._getEmptyCellNeighborIndex({row:this.m_endRow+1,column:this.m_trueIndex.column},{up:!0},this._getMaxTop(),this.m_startColHeader);if(e)if(e.cell)y(e.cell,t);else if(e.header){let e=this._getHeaderByIndex(this.m_trueIndex.column,"column",this.m_columnHeaderLevelCount-1);this._setActive(e,{type:"header",index:g,level:this.m_columnHeaderLevelCount-1,axis:"column"},t,!0)}}}else if(u)this._setActive(u,{type:"empty"},t,!0);else{if("column"===_){let e=this.getVisibleCellIndexInDirection("row",0,{down:!0});n=this.createIndex(e,g)}else if(this._isHighWatermarkScrolling())n=this.createIndex(this.m_endRow,g);else{let e=this.getVisibleCellIndexInDirection("row",this.getDataSource().getCount("row")-1,{up:!0});n=this.createIndex(e,g)}this._isSelectionEnabled()?this.selectAndFocus(n,t):(this._setActiveByIndex(n,t),this._highlightActive())}else g=this.getVisibleCellIndexInDirection("column",g,{down:!0}),r=this._getHeaderByIndex(g,_,p+C),l=this._getAttribute(r.parentNode,"start",!0),a=this.getHeaderCellLevel(r),i?this.extendSelectionHeader(r,t,!0):(this._isSelectionEnabled()&&!this.m_discontiguousSelection&&(this._clearSelection(t),this.m_selectionFrontier={}),this._setActive(r,{type:"header",index:l,level:a,axis:_},t),this._highlightActive());else if("row"===_&&s&&this.m_headerLabels.columnEnd[this.m_columnEndHeaderLevelCount-1])this._setActive(this.m_headerLabels.columnEnd[this.m_columnEndHeaderLevelCount-1],{type:"label",level:this.m_columnEndHeaderLevelCount-1,axis:"columnEnd"},t);else{for(l=null!=f&&p!==d-1?this._getAttribute(f.parentNode,"start",!0)+this._getAttribute(f.parentNode,"extent",!0):g+1,r=!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&l>this.m_frozenRowIndex&&l<this.m_startRow?null!=(l=this.m_options.getScrollPosition().rowIndex)?this._getHeaderByIndex(l,_,p):g+1:this._getHeaderByIndex(l,_,p);null!=r&&this.isHeaderHidden(r);)l=p!==d-1?this._getAttribute(r.parentNode,"start",!0)+this._getAttribute(r.parentNode,"extent",!0):l+1,r=this._getHeaderByIndex(l,_,p);a=null!=r?this.getHeaderCellLevel(r):p,l>h&&m||!(this._isCountUnknown("row")||l<this.getDataSource().getCount("row"))?"row"===_&&this.m_headerLabels.columnEnd[this.m_columnEndHeaderLevelCount-1]&&this._setActive(this.m_headerLabels.columnEnd[this.m_rowEndHeaderLevelCount-1],{type:"label",level:this.m_columnEndHeaderLevelCount-1,axis:"columnEnd"},t):i?this.extendSelectionHeader(r,t,!0):(this._isSelectionEnabled()&&!this.m_discontiguousSelection&&(this._clearSelection(t),this.m_selectionFrontier={}),this._setActive(r,{type:"header",index:l,level:a,axis:_},t),this._highlightActive())}break;case this.keyCodes.PAGEUP_KEY:"row"!==_&&"rowEnd"!==_||(f=this._getHeaderByIndex(0,_,p),this._setActive(f,{type:"header",index:0,level:p,axis:_},t));break;case this.keyCodes.PAGEDOWN_KEY:"row"!==_&&"rowEnd"!==_||(g=this._isCountUnknown("row")||this._isHighWatermarkScrolling()?Math.max(0,h):Math.max(0,this.getDataSource().getCount("row")-1),f=this._getHeaderByIndex(g,_,p),this._setActive(f,{type:"header",index:g,level:p,axis:_},t));break;case this.keyCodes.HOME_KEY:if("column"===_||"columnEnd"===_){let e;for(let t=0;t<=g;t++)if(!this.isHidden(_,t)){e=t;break}f=this._getHeaderByIndex(e,_,p),this._setActive(f,{type:"header",index:e,level:p,axis:_},t)}break;case this.keyCodes.END_KEY:if("column"===_||"columnEnd"===_){let e;e=this._isCountUnknown("column")||this._isHighWatermarkScrolling()?Math.max(0,h):Math.max(0,this.getDataSource().getCount("column")-1);for(let t=e;t>=g;t--)if(!this.isHidden(_,t)){e=t;break}f=this._getHeaderByIndex(e,_,p),this._setActive(f,{type:"header",index:e,level:p,axis:_},t)}}return!0}},A.prototype.checkHeaderToDatabody=function(e,t){return!("row"===e&&this.m_rowHeaderLevelCount===this.m_selectionFrontier.level&&t===this.keyCodes.RIGHT_KEY||"rowEnd"===e&&this.m_rowEndHeaderLevelCount===this.m_selectionFrontier.level&&t===this.keyCodes.LEFT_KEY||"column"===e&&this.m_columnHeaderLevelCount===this.m_selectionFrontier.level&&t===this.keyCodes.DOWN_KEY||"columnEnd"===e&&this.m_columnEndHeaderLevelCount===this.m_selectionFrontier.level&&t===this.keyCodes.UP_KEY)},A.prototype._getHeaderLabelledBy=function(e,t,i,s,o,n){var r;if(-1!==i&&(s!==o||this.m_externalFocus)){var l=this.getHeaderFromCell(n,e);return null!=o&&(r=this._getHeaderByIndex(o,e,t-1)),this._getHeaderAndParentIds(l,r)}return""},A.prototype._getHeaderAndParentIds=function(e,t){var i="",s=[];if(null==e)return"";var o=this._getHeaderAndParents(e);null!=t&&(s=this._getHeaderAndParents(t));for(var n=0;n<o.length;n++)s[n]===o[n]&&n!==o.length-1||(i+=(""===i?"":" ")+o[n].id);return i},A.prototype._getHeaderAndParents=function(e){var t,i=[e],s=this.getHeaderCellAxis(e),o=this.getHeaderCellLevel(e),n=this._getLabel(s,o);if("row"===s?t=this.m_rowHeaderLevelCount:"column"===s?t=this.m_columnHeaderLevelCount:"rowEnd"===s?t=this.m_rowEndHeaderLevelCount:"columnEnd"===s&&(t=this.m_columnEndHeaderLevelCount),n&&i.unshift(n),1===t)return i;for(o===t-1&&(e=e.parentNode.firstChild,i.unshift(e),o-=1,(n=this._getLabel(s,o))&&i.unshift(n));o>0;)e=e.parentNode.parentNode.firstChild,i.unshift(e),o-=1,(n=this._getLabel(s,o))&&i.unshift(n);return i},A.prototype.isHeaderSelectionType=function(e){return!(!e||!e.axis)},A.prototype._isChildEmpty=function(e){if(e){let t=e.textContent.trim();return!(e.children.length>0||t.length>0)}return!1},A.prototype._isNeighborCellEmpty=function(e,t){let i=this._getIndex(e,"row"),s=this._getIndex(e,"column");if("row"===t){let t=this.getVisibleCellIndexInDirection("column",s-1,{left:!0}),o=this.getVisibleCellIndexInDirection("column",s+1,{right:!0}),n=this._getCellByIndex({row:i,column:t}),r=this._getCellByIndex({row:i,column:o});if((this._isChildEmpty(n)||this._isChildEmpty(r))&&!this._isChildEmpty(e)&&!this.isHidden("column",s))return!0}else if("column"===t){let t=this._getCellByIndex({row:i-1,column:s}),o=this._getCellByIndex({row:i+1,column:s});if((this._isChildEmpty(t)||this._isChildEmpty(o))&&!this._isChildEmpty(e))return!0}return!1},A.prototype._getEmptyCellNeighborIndex=function(e,t,i,s){let o,n,r,l,a,h,d,m=e.row,c=e.column,u=Object.create({}),_=t.left||t.right,g=t.up||t.down,p=t.right||t.down,f=t.left||t.up;_?(o="row",n=c,r=m):g&&(o="column",n=m,l=c),p?(a=1,d=i):f&&(a=-1,d=i-1);let C,y=n;for(;f?y>=i:y<=i;){if(p?C=y<i:f&&(C=y>i),_?l=y===i?d:y+a:g&&(r=y===i?d:y+a),h=this._getCellByIndex({row:r,column:l}),C&&this._isNeighborCellEmpty(h,o))return u.cell=this.createIndex(r,l),u;if(y===i){let e;return p?e=(t.right?this._isLastColumn(y):this._isLastRow(y))&&-1!==s:f&&(e=0===y),e?(u.header=!0,u):(u.cell=this.createIndex(r,l),u)}y+=a}return null},A.prototype.handleNoDataFocusChange=function(e,t,i,s){let o;if(null==this.m_active)return null;switch(this.getResources().isRTLMode()&&(e===this.keyCodes.LEFT_KEY?e=this.keyCodes.RIGHT_KEY:e===this.keyCodes.RIGHT_KEY&&(e=this.keyCodes.LEFT_KEY)),e){case this.keyCodes.UP_KEY:!t&&s&&-1!==this.m_endColHeader&&(o=this._getHeaderByIndex(this.m_startColHeader,"column",this.m_columnHeaderLevelCount-1),this._setActive(o,{type:"header",index:this.m_startColHeader,level:this.m_columnHeaderLevelCount-1,axis:"column"},i,!0));break;case this.keyCodes.DOWN_KEY:-1!==this.m_endColEndHeader&&s&&(o=this._getHeaderByIndex(this.m_startColEndHeader,"columnEnd",this.m_columnEndHeaderLevelCount-1),this._setActive(o,{type:"header",index:this.m_startColEndHeader,level:this.m_columnEndHeaderLevelCount-1,axis:"columnEnd"},i,!0));break;case this.keyCodes.LEFT_KEY:!t&&s&&-1!==this.m_endRowHeader&&(o=this._getHeaderByIndex(this.m_startRowHeader,"row",this.m_rowHeaderLevelCount-1),this._setActive(o,{type:"header",index:this.m_startRowHeader,level:this.m_rowHeaderLevelCount-1,axis:"row"},i,!0));break;case this.keyCodes.RIGHT_KEY:-1!==this.m_endRowEndHeader&&s&&(o=this._getHeaderByIndex(this.m_startRowEndHeader,"rowEnd",this.m_rowEndHeaderLevelCount-1),this._setActive(o,{type:"header",index:this.m_startRowEndHeader,level:this.m_rowEndHeaderLevelCount-1,axis:"rowEnd"},i,!0))}return!0},A.prototype.handleFocusChange=function(e,t,i,s,o,n=!1,r=!1){var l,a,h,d=1,m=1;if(this.getResources().isRTLMode()&&(e===this.keyCodes.LEFT_KEY?e=this.keyCodes.RIGHT_KEY:e===this.keyCodes.RIGHT_KEY&&(e=this.keyCodes.LEFT_KEY)),!this.isFetchComplete()&&!1===this.m_fetchingForUpdate){if(this.m_skeletonSet.size>0&&!t){const t=(l=this.m_active.indexes).column,i=l.row;e===this.keyCodes.RIGHT_KEY&&t+1===this.m_endCol+1?this._scrollSkeletonCellsIntoViewport(i,t,"column",!0):e===this.keyCodes.DOWN_KEY&&i+1===this.m_endRow+1&&this._scrollSkeletonCellsIntoViewport(i,t,"row",!0)}return!0}if(t){if(l=this.m_selectionFrontier,this.isHeaderSelectionType(this.m_selectionFrontier))return void this.handleHeaderFocusChange(e,i,t,o)}else l=this.m_active.indexes;if(null!=l){var c,u,_,g,p;switch(null==this.m_trueIndex&&(this.m_trueIndex={}),c=this._isSelectionEnabled()?this.selectAndFocus.bind(this):this._setActiveByIndex.bind(this),u=l.row,_=l.column,(g=this._getCellByIndex(l))&&(d=(p=g[this.getResources().getMappedAttribute("context")]).extents.row,m=p.extents.column),e){case this.keyCodes.LEFT_KEY:if(this.m_trueIndex.row||t||(this.m_trueIndex={row:u}),n){let e=p.indexes.row,t=p.indexes.column,s=this._getEmptyCellNeighborIndex({row:e,column:t},{left:!0},this._getMaxLeft(),this.m_startRowHeader);s&&(s.cell?c(s.cell,i):s.header&&(h=this._getHeaderByIndex(this.m_trueIndex.row,"row",this.m_rowHeaderLevelCount-1),this._setActive(h,{type:"header",index:this.m_trueIndex.row,level:this.m_rowHeaderLevelCount-1,axis:"row"},i,!0)))}else if(_>0&&(!o||-1===this.m_endRowHeader))if("row"===this.m_options.getSelectionMode())a=this.createIndex(this.m_trueIndex.row,_-1),this._setActiveByIndex(a,i);else{if(t){let t=this.getVisibleCellIndexInDirection("column",_-1,{left:!0});t!==_&&-1!==t&&(a=this.createIndex(u,t),this.extendSelection(a,i,e))}else if(_-1<this.m_startCol&&!(!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&_-1<=this.m_frozenColIndex))this._scrollSkeletonCellsIntoViewport(u,_,"column",!1);else{let e=_-1,t=!1;for(;this.isHidden("column",e);){if(0===e){e=this.getVisibleCellIndexInDirection("column",e,{right:!0}),t=!0;break}e-=1}t&&s?(h=this._getHeaderByIndex(this.m_trueIndex.row,"row",this.m_rowHeaderLevelCount-1),this._setActive(h,{type:"header",index:this.m_trueIndex.row,level:this.m_rowHeaderLevelCount-1,axis:"row"},i,!0)):c(a=this.createIndex(this.m_trueIndex.row,e),i)}_-1==0&&this._setAccInfoText("accessibleFirstColumn")}else!t&&s&&(h=this._getHeaderByIndex(this.m_trueIndex.row,"row",this.m_rowHeaderLevelCount-1),this.m_discontiguousSelection?this.discontiguousHeaderSetActiveFromDatabody(i,"row",h,this.m_rowHeaderLevelCount):this._setActive(h,{type:"header",index:this.m_trueIndex.row,level:this.m_rowHeaderLevelCount-1,axis:"row"},i,!0));break;case this.keyCodes.RIGHT_KEY:if(this.m_trueIndex.row||t||(this.m_trueIndex={row:u}),n){let e=p.indexes.row,t=p.indexes.column,s=this._getEmptyCellNeighborIndex({row:e,column:t},{right:!0},this._getMaxRight(),this.m_endRowEndHeader);s&&(s.cell?c(s.cell,i):s.header&&(h=this._getHeaderByIndex(this.m_trueIndex.row,"rowEnd",this.m_rowEndHeaderLevelCount-1),this._setActive(h,{type:"header",index:this.m_trueIndex.row,level:this.m_rowEndHeaderLevelCount-1,axis:"rowEnd"},i,!0)))}else if(this._isLastColumn(_+(m-1))||o&&-1!==this.m_endRowEndHeader)-1!==this.m_endRowEndHeader&&s?(h=this._getHeaderByIndex(this.m_trueIndex.row,"rowEnd",this.m_rowEndHeaderLevelCount-1),this.m_discontiguousSelection?this.discontiguousHeaderSetActiveFromDatabody(i,"rowEnd",h,this.m_rowEndHeaderLevelCount):this._setActive(h,{type:"header",index:this.m_trueIndex.row,level:this.m_rowEndHeaderLevelCount-1,axis:"rowEnd"},i,!0)):t||c(l,i);else if("row"===this.m_options.getSelectionMode())a=this.createIndex(this.m_trueIndex.row,_+m),this._setActiveByIndex(a,i);else{if(t){let t=this.getVisibleCellIndexInDirection("column",_+1,{right:!0});t!==_&&(a=this.createIndex(u,t),this.extendSelection(a,i,e))}else{let e=_+m,t=!1;for(;this.isHidden("column",e);){if(this._isLastColumn(e)){e=this.getVisibleCellIndexInDirection("column",e,{left:!0}),t=!0;break}e+=1}t&&-1!==this.m_endRowEndHeader?(h=this._getHeaderByIndex(this.m_trueIndex.row,"rowEnd",this.m_rowEndHeaderLevelCount-1),this._setActive(h,{type:"header",index:this.m_trueIndex.row,level:this.m_rowEndHeaderLevelCount-1,axis:"rowEnd"},i,!0)):c(a=this.createIndex(this.m_trueIndex.row,e),i)}this._isLastColumn(_+m)&&this._setAccInfoText("accessibleLastColumn")}break;case this.keyCodes.UP_KEY:if(this.m_trueIndex.column||t||(this.m_trueIndex={column:_}),n){let e=p.indexes.row,t=p.indexes.column,s=this._getEmptyCellNeighborIndex({row:e,column:t},{up:!0},this._getMaxTop(),this.m_startColHeader);s&&(s.cell?c(s.cell,i):s.header&&(h=this._getHeaderByIndex(this.m_trueIndex.column,"column",this.m_columnHeaderLevelCount-1),this._setActive(h,{type:"header",index:this.m_trueIndex.column,level:this.m_columnHeaderLevelCount-1,axis:"column"},i,!0)))}else if(u>0&&(!o||-1===this.m_endColHeader)){if(t){let t=this.getVisibleCellIndexInDirection("row",u-1,{up:!0});t!==u&&-1!==t&&(a=this.createIndex(t,_),this.extendSelection(a,i,e))}else if(u-1<this.m_startRow&&!(!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&u-1<=this.m_frozenRowIndex))this._scrollSkeletonCellsIntoViewport(u,_,"row",!1);else{let e=this.getVisibleCellIndexInDirection("row",u-1,{up:!0});-1===e&&s?(h=this._getHeaderByIndex(this.m_trueIndex.column,"column",this.m_columnHeaderLevelCount-1),this._setActive(h,{type:"header",index:this.m_trueIndex.column,level:this.m_columnHeaderLevelCount-1,axis:"column"},i,!0)):c(a=this.createIndex(e,this.m_trueIndex.column),i)}u-1==0&&this._setAccInfoText("accessibleFirstRow")}else!t&&s&&(h=this._getHeaderByIndex(this.m_trueIndex.column,"column",this.m_columnHeaderLevelCount-1),this.m_discontiguousSelection?this.discontiguousHeaderSetActiveFromDatabody(i,"column",h,this.m_columnHeaderLevelCount):this._setActive(h,{type:"header",index:this.m_trueIndex.column,level:this.m_columnHeaderLevelCount-1,axis:"column"},i,!0));break;case this.keyCodes.DOWN_KEY:if(this.m_trueIndex.column||t||(this.m_trueIndex={column:_}),n){let e=p.indexes.row,t=p.indexes.column,s=this._getEmptyCellNeighborIndex({row:e,column:t},{down:!0},this._getMaxBottom(),this.m_endColEndHeader);s&&(s.cell?c(s.cell,i):s.header&&(h=this._getHeaderByIndex(this.m_trueIndex.column,"columnEnd",this.m_columnEndHeaderLevelCount-1),this._setActive(h,{type:"header",index:this.m_trueIndex.column,level:this.m_columnEndHeaderLevelCount-1,axis:"columnEnd"},i,!0)))}else if(this._isLastRow(u+(d-1))||o&&-1!==this.m_endColEndHeader)-1!==this.m_endColEndHeader&&s?(h=this._getHeaderByIndex(this.m_trueIndex.column,"columnEnd",this.m_columnEndHeaderLevelCount-1),this.m_discontiguousSelection?this.discontiguousHeaderSetActiveFromDatabody(i,"columnEnd",h,this.m_columnEndHeaderLevelCount):this._setActive(h,{type:"header",index:this.m_trueIndex.column,level:this.m_columnEndHeaderLevelCount-1,axis:"columnEnd"},i,!0)):t||c(l,i);else{if(t){let t=this.getVisibleCellIndexInDirection("row",u+1,{down:!0});t!==u&&(a=this.createIndex(t,_),this.extendSelection(a,i,e))}else{let e=this.getVisibleCellIndexInDirection("row",u+d,{down:!0});e>this._getLastAxis("row")&&s?(h=this._getHeaderByIndex(this.m_trueIndex.column,"columnEnd",this.m_columnEndHeaderLevelCount-1),this._setActive(h,{type:"header",index:this.m_trueIndex.column,level:this.m_columnEndHeaderLevelCount-1,axis:"columnEnd"},i,!0)):c(a=this.createIndex(e,this.m_trueIndex.column),i)}this._isLastRow(u+d)&&this._setAccInfoText("accessibleLastRow")}break;case this.keyCodes.HOME_KEY:{let e=0,t=0;for(let e=0;e<=_;e++)if(!this.isHidden("column",e)){t=e;break}if(r)c(this.createIndex(e,t),i);else this.m_trueIndex.row||(this.m_trueIndex={row:u}),c(a=this.createIndex(this.m_trueIndex.row,t),i);break}case this.keyCodes.END_KEY:{let e;this.m_trueIndex.row||(this.m_trueIndex={row:u,column:_}),e=this._isCountUnknown("column")||this._isHighWatermarkScrolling()?Math.max(0,this.m_endCol):Math.max(0,this.getDataSource().getCount("column")-1);for(let t=e;t>=_;t--)if(!this.isHidden("column",t)){e=t;break}if(r){let t;t=this._isCountUnknown("column")||this._isHighWatermarkScrolling()?this.createIndex(Math.max(0,this.m_endRow),e):this.createIndex(Math.max(0,this.getDataSource().getCount("row")-1),e),c(t,i)}else c(a=this._isCountUnknown("column")||this._isHighWatermarkScrolling()?this.createIndex(this.m_trueIndex.row,Math.max(0,e)):this.createIndex(this.m_trueIndex.row,e),i);break}case this.keyCodes.PAGEUP_KEY:this.m_trueIndex.column||(this.m_trueIndex={column:_}),c(a=this.createIndex(0,_),i);break;case this.keyCodes.PAGEDOWN_KEY:this.m_trueIndex.column||(this.m_trueIndex={column:_}),c(a=this._isCountUnknown("column")||this._isHighWatermarkScrolling()?this.createIndex(Math.max(0,this.m_endRow),this.m_trueIndex.column):this.createIndex(Math.max(0,this.getDataSource().getCount("row")-1),this.m_trueIndex.column),i)}return!0}},A.prototype.scrollToIndex=function(e,t,i){var s,o,n=e.row,r=e.column;t&&(this.m_shouldFocus=!1),i&&(e.scrollToOrigin=!0);var l=this.getResources().isRTLMode()?"right":"left",a=0,h=0,d=this._getViewportTop(),m=this._getViewportBottom(),c=this._getViewportLeft(),u=this._getViewportRight();if(n<this.m_startRow||n>this.m_endRow){var _;n<this.m_startRow?(_=this.m_avgRowHeight*n,!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&n<=this.m_frozenRowIndex&&(_=this.m_currentScrollTop),!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&(_=this.m_avgRowHeight*(n-(this.m_frozenRowIndex+1)))):_=this.m_avgRowHeight*(n+1)-m+d,h=this.m_currentScrollTop-_,this.m_scrollIndexAfterFetch=e,!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&n<=this.m_frozenRowIndex||(s=!0)}else{o=this._getCellByIndex(e);let t=this.getMappedStyle("frozenCell");var g;null===o?(o=this._getFirstCellWithMatchingStartIndex(n,"row"),g=this.m_sizingManager.getSize("row",this._getKey(o,"row"))):g=this.getElementHeight(o);var p=this.getElementDir(o,"top");if(i||e.scrollToOrigin?h=d-p:p+g>m?h=m-(p+g):p<d&&(h=d-p),o&&o.classList.contains(t)){let e=this._getCellContainer(o);(e.classList.contains(this.getMappedStyle("databodyFrozenRow"))||e.classList.contains(this.getMappedStyle("databodyFrozenCorner")))&&(h=0)}}if(!isNaN(r)&&!0!==s)if(r<this.m_startCol||r>this.m_endCol){var f;let t,i;r<this.m_startCol?(t=this.hiddenColumnsInDirection(r,{left:!0}),i=t.length,f=this.m_avgColWidth*(r-i),!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&r<=this.m_frozenColIndex&&(f=this.m_currentScrollLeft),!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&(f=this.m_avgColWidth*(r-(this.m_frozenColIndex+1)-i))):(t=this.hiddenColumnsInDirection(r,{right:!0}),i=t.length,f=this.m_avgColWidth*(r-i+1)-u+c),a=this.m_currentScrollLeft-f,this.m_scrollIndexAfterFetch=e}else{var C;null===(o=this._getCellByIndex(e))?(o=this._getFirstCellWithMatchingStartIndex(r,"column"),C=this.m_sizingManager.getSize("column",this._getKey(o,"column"))):C=this.getElementWidth(o);var y=this.getElementDir(o,l);i||e.scrollToOrigin||y<c?a=c-y:y+C>u&&(a=u-(y+C));let t=this.getMappedStyle("frozenCell");if(o&&o.classList.contains(t)){let e=this._getCellContainer(o);(e.classList.contains(this.getMappedStyle("databodyFrozenCol"))||e.classList.contains(this.getMappedStyle("databodyFrozenCorner")))&&(a=0)}}0!==a||0!==h?(null!=(o=this._getCellByIndex(e))&&!0!==t&&!1!==this.m_shouldFocus&&(this.m_cellToFocus=o),this.scrollDelta(a,h)):null!=this.m_scrollIndexAfterFetch&&(t||!1===this.m_shouldFocus||this._setActiveByIndex(this.m_scrollIndexAfterFetch,null,!1,!1,!0))&&(this.m_scrollIndexAfterFetch=null)},A.prototype.scrollToHeader=function(e){var t,i,s,o,n,r,l,a,h,d,m=e.axis,c=e.index,u=e.level,_=0;"row"===m?(t=this.m_startRowHeader,i=this.m_endRowHeader,s=this.m_avgRowHeight,o=this.m_currentScrollTop,h=this._getViewportTop(),d=this._getViewportBottom()):"column"===m?(t=this.m_startColHeader,i=this.m_endColHeader,s=this.m_avgColWidth,o=this.m_currentScrollLeft,h=this._getViewportLeft(),d=this._getViewportRight()):"rowEnd"===m?(t=this.m_startRowEndHeader,i=this.m_endRowEndHeader,s=this.m_avgRowHeight,o=this.m_currentScrollTop,h=this._getViewportTop(),d=this._getViewportBottom()):"columnEnd"===m&&(t=this.m_startColEndHeader,i=this.m_endColEndHeader,s=this.m_avgColWidth,o=this.m_currentScrollLeft,h=this._getViewportLeft(),d=this._getViewportRight());var g=d-h;if(c<t||c>i?(c<t?(n=s*c,this._isHighWatermarkScrolling()||(("column"===m||"columnEnd"===m)&&this._hasFrozenColumns()&&c<=this.m_frozenColIndex||("row"===m||"rowEnd"===m)&&this._hasFrozenRows()&&c<=this.m_frozenRowIndex)&&(n=o)):n=s*(c+1)-g,_=o-n,this.m_scrollHeaderAfterFetch=e):("row"===m||"rowEnd"===m?(a=this._getHeaderByIndex(c,m,u),r=this.getElementDir(a,"top"),l=this.getElementHeight(a)):"column"!==m&&"columnEnd"!==m||(a=this._getHeaderByIndex(c,m,u),r=this.getElementDir(a,this.getResources().isRTLMode()?"right":"left"),l=this.getElementWidth(a)),g>l?r+l>d?_=d-(r+l):r<h&&(_=h-r):_=h-r),a){let e=this.getMappedStyle("frozenHeader");a.classList.contains(e)&&(_=0)}0!==_?(null!=a&&!1!==this.m_shouldFocus&&(this.m_cellToFocus=a),"row"===m||"rowEnd"===m?this.scrollDelta(0,_):this.scrollDelta(_,0)):null!=this.m_scrollHeaderAfterFetch&&(this._updateActive(e,!0,!0),this.m_scrollHeaderAfterFetch=null)},A.prototype.findHeader=function(e,t,i){if(null==t&&(t=this.getMappedStyle("headercell")),null==i&&(i=this.getMappedStyle("endheadercell")),null!=t){if(this.m_utils.containsCSSClassName(e,t)||this.m_utils.containsCSSClassName(e,i))return e;if(e.parentNode)return this.findHeader(e.parentNode,t,i);if(e===this.m_root)return null}return null},A.prototype.updateRowBanding=function(){var e=this.m_options.getRowBandingInterval();if(e>0)for(var t=this.m_databody.firstChild.querySelectorAll("."+this.getMappedStyle("cell")),i=this.getMappedStyle("banded"),s=0;s<t.length;s++){var o=t[s],n=this._getIndex(o,"row");Math.floor(n/e)%2==1?this.m_utils.containsCSSClassName(o,i)||this.m_utils.addCSSClassName(o,i):this.m_utils.containsCSSClassName(o,i)&&this.m_utils.removeCSSClassName(o,i)}},A.prototype.updateColumnBanding=function(){var e=this.m_options.getColumnBandingInterval();if(e>0)for(var t=this.m_databody.firstChild.querySelectorAll("."+this.getMappedStyle("cell")),i=this.getMappedStyle("banded"),s=0;s<t.length;s+=1){var o=t[s],n=this._getIndex(o,"column");Math.floor(n/e)%2==1?this.m_utils.containsCSSClassName(o,i)||this.m_utils.addCSSClassName(o,i):this.m_utils.containsCSSClassName(o,i)&&this.m_utils.removeCSSClassName(o,i)}},A.prototype._removeBanding=function(){for(var e=this.m_databody.firstChild.querySelectorAll("."+this.getMappedStyle("cell")),t=this.getMappedStyle("banded"),i=0;i<e.length;i++)this.m_utils.containsCSSClassName(e[i],t)&&this.m_utils.removeCSSClassName(e[i],t)},A.prototype._setAccInfoText=function(e,t){var i=this.getResources().getTranslatedText(e,t);null!=i&&(this.m_accInfo.textContent=i)},A.prototype.handleExpandEvent=function(e,t){void 0===t&&this.queueModelEvent(e)?e.operation="expand":(this._setAccInfoText("accessibleRowExpanded"),this.populateAccInfo(),t&&this._runModelEventQueue())},A.prototype.handleCollapseEvent=function(e,t){void 0===t&&this.queueModelEvent(e)?e.operation="collapse":(this._setAccInfoText("accessibleRowCollapsed"),this.populateAccInfo(),t&&this._runModelEventQueue())},A.prototype._getKey=function(e,t){return null!=e&&e[this.getResources().getMappedAttribute("context")]?null!=t&&this.m_utils.containsCSSClassName(e,this.getMappedStyle("cell"))?e[this.getResources().getMappedAttribute("context")].keys[t]:e[this.getResources().getMappedAttribute("context")].key:null},A.prototype._getActiveKey=function(e,t){if(t&&null!=this.m_prevActive){if("header"===this.m_prevActive.type&&(this.m_prevActive.axis===e||this.m_prevActive.axis===e+"End"))return this.m_prevActive.key;if("cell"===this.m_prevActive.type)return this.m_prevActive.keys[e]}else if(null!=this.m_active){if("header"===this.m_active.type&&(this.m_active.axis===e||this.m_active.axis===e+"End"))return this.m_active.key;if("cell"===this.m_active.type)return this.m_active.keys[e]}return null},A.prototype._handleCut=function(e,t){null==t&&(t=e.target);var i=this.findCellOrHeader(t);if(this._isMoveOnElementEnabled(i)){if(null!=this.m_cutCells)for(var s=0;s<this.m_cutCells.length;s++)this.m_utils.removeCSSClassName(this.m_cutCells[s],this.getMappedStyle("cut"));var o=this._getKey(i,"row");return this.m_cutCells=this._getAxisCellsByKey(o,"row"),this.m_cutRowHeader=this._findHeaderByKey(o,this.m_rowHeader,this.getMappedStyle("rowheadercell")),this.m_cutRowEndHeader=this._findHeaderByKey(o,this.m_rowEndHeader,this.getMappedStyle("rowendheadercell")),this._highlightCellsAlongAxis(o,"row","key","add",["cut"]),null!==this.m_cutRowHeader&&this.m_utils.addCSSClassName(this.m_cutRowHeader,this.getMappedStyle("cut")),null!==this.m_cutRowEndHeader&&this.m_utils.addCSSClassName(this.m_cutRowEndHeader,this.getMappedStyle("cut")),!0}return!1},A.prototype._handleCutCells=function(e,t){null==t&&(t=e.target);const i=this.findCell(e.target),s=this.findLabel(e.target),o=this.findHeader(e.target);if(this._isDataGridProvider()){this.m_dataTransferAction="cut";let t={event:e,ui:{action:this.m_dataTransferAction}};if((i||o)&&this.m_options.isCutEnabled()&&this._isSelectionEnabled()&&this.m_selection?.length&&!s){this.m_selectionRange&&this.m_selectionRange.length&&this.unhighlightFloodFillRange(this.m_selectionRange[0]);let e=this.m_selection[this.m_selection.length-1];if(this.m_selectionRange=[e],t.ui.sourceRange=this.m_selectionRange[0],!this.fireEvent("cutRequest",t))return!0;this.highlightFloodFillRange(e),this.m_options.isFloodFillEnabled()&&this._removeFloodFillAffordance()}else if(s&&this.m_options._isLabelCutEnabled()){const e=this.getResources().getMappedAttribute("context");if(s){const i=s[e].level,o=s[e].axis;t.ui.level=i,t.ui.axis=o;let n=[];n.push(s),n=this._getDropHeaderTargets(o,i,n),n=this._getHeadersInView(n,o),this._headersDragged=n;let r="row"===o||"rowEnd"===o?["endFloodfill"]:["bottomFloodfill"];this._highlightHeaderRange(n,o,i,r),this.fireEvent("headerLabelCutRequest",t)}}}return!0},A.prototype._handleCopyCells=function(e,t){if(null==t&&(t=e.target),this._isDataGridProvider()&&this._isSelectionEnabled()&&this.m_options.isCopyEnabled()&&this.m_selection?.length){this.m_selectionRange&&this.m_selectionRange.length&&this.unhighlightFloodFillRange(this.m_selectionRange[0]);let t=this.m_selection[this.m_selection.length-1];this.m_selectionRange=[t],this.m_dataTransferAction="copy";let i={event:e,ui:{action:this.m_dataTransferAction,sourceRange:this.m_selectionRange[0]}};return!this.fireEvent("copyRequest",i)||(this.highlightFloodFillRange(t),this.m_options.isFloodFillEnabled()&&this._removeFloodFillAffordance(),!0)}return!1},A.prototype._handlePaste=function(e,t){if(null==t&&(t=e.target),null!=this.m_cutCells){for(var i=0;i<this.m_cutCells.length;i++)this.m_utils.removeCSSClassName(this.m_cutCells[i],this.getMappedStyle("cut"));null!==this.m_cutRowHeader&&(this.m_utils.removeCSSClassName(this.m_cutRowHeader,this.getMappedStyle("cut")),this.m_cutRowHeader=null),null!==this.m_cutRowEndHeader&&(this.m_utils.removeCSSClassName(this.m_cutRowEndHeader,this.getMappedStyle("cut")),this.m_cutRowEndHeader=null);var s=this._getKey(this.findCellOrHeader(t),"row"),o=this._getKey(this.m_cutCells[0],"row");o!==s&&(this._isSelectionEnabled()&&this._clearSelection(e),this._isDatabodyCellActive()&&this._unhighlightActive(),this.m_moveActive=!0,this.getDataSource().move(o,s)),this.m_cutCells=null}return!0},A.prototype._handlePasteCells=function(e,t){if(null==t&&(t=e.target),this._isDataGridProvider()&&this.m_options.isPasteEnabled())if(this.m_selectionRange&&this._isSelectionEnabled()&&!this.m_discontiguousSelection&&1===this.m_selection.length){let t={event:e,ui:{action:this.m_dataTransferAction,sourceRange:this.m_selectionRange[0],targetRange:this.m_selection[0]}};if(!this.fireEvent("pasteRequest",t))return!0;this.unhighlightFloodFillRange(this.m_selectionRange[0]),this.m_selectionRange=null,this.m_dataTransferAction=null}else if(!this.m_selectionRange){let t={event:e,ui:{action:"unknown",sourceRange:{},targetRange:this.m_selection[0]}};if(!this.fireEvent("pasteRequest",t))return!0;this.m_selectionRange=null,this.m_dataTransferAction=null}return!0},A.prototype._handleAutofill=function(e,t){if(null==t&&(t=e.target),this._isDataGridProvider()&&this._isSelectionEnabled()&&!this.m_discontiguousSelection&&this.m_options.isFloodFillEnabled()&&1===this.m_selection.length){let t="down",s=this.m_selection[0].startIndex,o=this.m_selection[0].endIndex,n=this.createRange(s,o),r=this.createRange(s,o),l=!1;if("keydown"===e.type)t=e.keyCode===this.keyCodes.D_KEY?"down":"end","down"===t?(n.endIndex.row=n.startIndex.row,r.startIndex.row=n.startIndex.row+1,r.startIndex.row<=r.endIndex.row&&(l=!0)):(n.endIndex.column=n.startIndex.column,r.startIndex.column=n.startIndex.column+1,r.startIndex.column<=r.endIndex.column&&(l=!0));else if("contextmenu"===e.type){l=!0,t="down";let e=this.m_active.indexes;n=this.createRange(e,e),e.row>=s.row&&e.row<=o.row&&(e.column<o.column||e.column>s.column)&&(t="end")}if(l){var i={event:e,ui:{action:t,sourceRange:n,targetRange:r}};if(!this.fireEvent("fillRequest",i))return!0}return this.unhighlightFloodFillRange(this.m_selection[0]),this._removeFloodFillAffordance(),this.m_selectionRange=null,this.m_dataTransferAction=null,this.m_floodFillDirection=null,!0}return!1},A.prototype._handleCancelReorder=function(e,t){if(null!=this.m_cutCells){for(var i=0;i<this.m_cutCells.length;i++)this.m_utils.removeCSSClassName(this.m_cutCells[i],this.getMappedStyle("cut"));return this.m_cutCells=null,null!==this.m_cutRowHeader&&(this.m_utils.removeCSSClassName(this.m_cutRowHeader,this.getMappedStyle("cut")),this.m_cutRowHeader=null),null!==this.m_cutRowEndHeader&&(this.m_utils.removeCSSClassName(this.m_cutRowEndHeader,this.getMappedStyle("cut")),this.m_cutRowEndHeader=null),!0}null!==this.m_dataTransferAction&&(this.m_selectionRange&&this.m_selectionRange.length?(this.unhighlightFloodFillRange(this.m_selectionRange[0]),this.m_selectionRange=null):(this.unhighlightDraggedHeaders(),this._headersDragged=[]),this.m_dataTransferAction=null)},A.prototype.unhighlightDraggedHeaders=function(){this._unhighlightElementsByClassName(this._headersDragged,["bottomFloodfill","startFloodfill","topFloodfill","endFloodfill"]);const e=this.getResources().getMappedAttribute("context");let t=this._headersDragged[0][e];if(0!==t.level){let e=this.m_headerLabels[t.axis][t.level-1],i=[];i.push(e),i=this._getDropHeaderTargets(t.axis,t.level-1,i),"column"===t.axis||"columnEnd"===t.axis?this._unhighlightElementsByClassName(i,["bottomFloodfill"]):this._unhighlightElementsByClassName(i,["endFloodfill"])}},A.prototype._handleMove=function(e){if(null==this.m_moveCells){var t=e.target,i=this.findCellOrHeader(t),s=this._getKey(i,"row");this.m_originalMoveIndex=this._getIndex(i,"row"),this.m_moveIndex=this.m_originalMoveIndex,this.m_moveCells=this._getAxisCellsByIndex(this.m_moveIndex,"row"),this.m_moveRowHeader=this._findHeaderByKey(s,this.m_rowHeader,this.getMappedStyle("rowheadercell")),this.m_moveRowEndHeader=this._findHeaderByKey(s,this.m_rowEndHeader,this.getMappedStyle("rowendheadercell")),this._highlightCellsAlongAxis(this.m_moveIndex,"row","index","add",["drag"]),this.m_originalTop=this.getElementDir(this.m_moveCells[0],"top"),this.m_dropTarget=document.createElement("div"),this.m_utils.addCSSClassName(this.m_dropTarget,this.getMappedStyle("drop")),this.setElementHeight(this.m_dropTarget,this.calculateRowHeight(this.m_moveCells[0])),this.setElementDir(this.m_dropTarget,this.m_originalTop,"top"),this.m_databody.firstChild.appendChild(this.m_dropTarget),this._addHeaderDropTarget(this.m_moveRowHeader,this.m_rowHeader,!1),this._addHeaderDropTarget(this.m_moveRowEndHeader,this.m_rowEndHeader,!0)}this.m_utils.isTouchDevice()||(this.m_prevY=this.m_currentY,this.m_currentY=e.pageY);for(var o=this.m_currentY-this.m_prevY,n=this.calculateRowHeight(this.m_moveCells[0]),r=0;r<this.m_moveCells.length;r++)this.setElementDir(this.m_moveCells[r],this.getElementDir(this.m_moveCells[r],"top")+o,"top");null!==this.m_moveRowHeader&&this.setElementDir(this.m_moveRowHeader,this.getElementDir(this.m_moveRowHeader,"top")+o,"top"),null!==this.m_moveRowEndHeader&&this.setElementDir(this.m_moveRowEndHeader,this.getElementDir(this.m_moveRowEndHeader,"top")+o,"top");var l=this.m_moveIndex+1,a=this.m_moveIndex-1,h=this._getCellByIndex(this.createIndex(l,this.m_startCol)),d=this._getCellByIndex(this.createIndex(a,this.m_startCol));null!=h&&this.getElementDir(h,"top")<this.getElementDir(this.m_moveCells[0],"top")+n/2?this._moveDropRows("nextSibling",l):null!=d&&this.getElementDir(d,"top")>this.getElementDir(this.m_moveCells[0],"top")-n/2&&this._moveDropRows("previousSibling",a)},A.prototype._addHeaderDropTarget=function(e,t,i){var s;null!==e&&(null==e.style.height&&this.setElementHeight(e,this.calculateRowHeight(e)),this.m_utils.addCSSClassName(e,this.getMappedStyle("drag")),s=document.createElement("div"),this.m_utils.addCSSClassName(s,this.getMappedStyle("drop")),this.setElementHeight(s,this.calculateRowHeight(e)),this.setElementDir(s,this.m_originalTop,"top"),t.firstChild.appendChild(s),i?this.m_dropTargetEndHeader=s:this.m_dropTargetHeader=s)},A.prototype._moveDropRows=function(e,t){var i,s,o,n,r;"nextSibling"===e?(r=this._getAxisCellsByIndex(t,"row"),i=this.m_originalTop+this.calculateRowHeight(r[0]),s=this.m_originalTop):(r=this._getAxisCellsByIndex(t,"row"),s=(i=this.getElementDir(r[0],"top"))+this.calculateRowHeight(r[0])),this.setElementDir(this.m_dropTarget,i,"top");for(var l=0;l<r.length;l++)this.setElementDir(r[l],s,"top");null!==this.m_moveRowHeader&&(o=this.m_moveRowHeader.parentNode,this.setElementDir(this.m_dropTargetHeader,i,"top"),this.setElementDir(this.m_moveRowHeader[e],s,"top")),null!==this.m_moveRowEndHeader&&(n=this.m_moveRowEndHeader.parentNode,this.setElementDir(this.m_dropTargetEndHeader,i,"top"),this.setElementDir(this.m_moveRowEndHeader[e],s,"top")),this.m_originalTop=i,this._highlightCellsAlongAxis(this.m_moveIndex+1,"row","index","remove",["activedrop"]),"nextSibling"===e?(this._modifyAxisCellContextIndex("row",this.m_moveIndex,1,1),this._modifyAxisCellContextIndex("row",this.m_moveIndex+1,1,-1),this.m_moveIndex+=1,null!==this.m_moveRowHeader&&o&&o.insertBefore(this.m_moveRowHeader,this.m_moveRowHeader[e][e]),null!==this.m_moveRowEndHeader&&n&&n.insertBefore(this.m_moveRowEndHeader,this.m_moveRowEndHeader[e][e])):(this._modifyAxisCellContextIndex("row",this.m_moveIndex,1,-1),this._modifyAxisCellContextIndex("row",this.m_moveIndex-1,1,1),this.m_moveIndex-=1,null!==this.m_moveRowHeader&&o&&o.insertBefore(this.m_moveRowHeader,this.m_moveRowHeader[e]),null!==this.m_moveRowEndHeader&&n&&n.insertBefore(this.m_moveRowEndHeader,this.m_moveRowEndHeader[e])),this._refreshDatabodyMap(),this._highlightCellsAlongAxis(this.m_moveIndex+1,"row","index","add",["activedrop"])},A.prototype._isMoveEnabled=function(e){var t=this.getDataSource().getCapability("move");return"enable"===this.m_options.isMoveable("row")&&("full"===t||t===e)},A.prototype._handleMoveMouseUp=function(e,t){if(null!=this.m_moveCells){this._remove(this.m_dropTarget),null!==this.m_moveRowHeader&&this._remove(this.m_dropTargetHeader),null!==this.m_moveRowEndHeader&&this._remove(this.m_dropTargetEndHeader),null!=this.m_active&&"column"!==this.m_active.axis&&(this.m_moveActive=!0),this._isSelectionEnabled()&&this._clearSelection(e);var i=this.m_moveCells[0],s=this._getKey(i,"row");if(!0===t){var o=this.m_moveIndex+1,n=this._getKey(this._getCellByIndex(this.createIndex(o,this.m_startCol)),"row");this.getDataSource().move(s,n)}else this.getDataSource().move(s,s);this.m_moveCells=null,this.m_originalMoveIndex=null,this.m_moveIndex=null}this.m_databodyMove=!1},A.prototype._handleFloodFillMouseUp=function(e){if(this.m_floodFillRange&&this.m_floodFillRange.length){var t={event:e,ui:{action:this.m_floodFillDirection,sourceRange:this.m_selectionRange[0],targetRange:this.m_floodFillRange[0]}};if(!this.fireEvent("fillRequest",t))return!0;this.unhighlightFloodFillRange()}this.m_selectionRange=null,this.m_floodFillRange=null,this.m_floodFillDirection=null;const i=[this.m_databody,this.m_databodyFrozenCol,this.m_databodyFrozenRow,this.m_databodyFrozenCorner];for(let e=0;e<i.length;e++)i[e]&&(i[e].style.cursor="default");return this.m_cursor="default",!0},A.prototype._isMoveOnElementEnabled=function(e){return!(null==e||!this._isMoveEnabled("row")||this._getActiveKey("row")!==this._getKey(e,"row"))},A.prototype._manageMoveCursor=function(){if(!this._isDataGridProvider()){var e=this._getActiveKey("row"),t=this._getActiveKey("row",!0),i=this.getMappedStyle("draggable"),s=this.getMappedStyle("rowheadercell"),o=this.getMappedStyle("rowendheadercell");if(null!=t){this._highlightCellsAlongAxis(t,"row","key","remove",["draggable"]);var n=this._findHeaderByKey(t,this.m_rowHeader,s);this.m_utils.containsCSSClassName(n,i)&&this.m_utils.removeCSSClassName(n,i),n=this._findHeaderByKey(t,this.m_rowEndHeader,o),this.m_utils.containsCSSClassName(n,i)&&this.m_utils.removeCSSClassName(n,i)}if(null!=e){var r=this._getAxisCellsByKey(e,"row");if(this._isMoveOnElementEnabled(r[0])){this._highlightCellsAlongAxis(e,"row","key","add",["draggable"]);var l=this._findHeaderByKey(e,this.m_rowHeader,s);this.m_utils.addCSSClassName(l,i);var a=this._findHeaderByKey(e,this.m_rowEndHeader,o);this.m_utils.addCSSClassName(a,i)}}}},A.prototype.handleRootFocus=function(e,t){this.m_utils.addCSSClassName(this.m_root,this.getMappedStyle("focus")),this._clearFocusoutTimeout(),this._clearFocusoutBusyState();const i=e.target;if(!t){if(this._clearOpenPopupListeners(),!this.m_root.contains(document.activeElement)||document.activeElement===this.m_root&&0===this.m_root.tabIndex||document.activeElement===this.m_databody&&this.m_scrollbarFocus&&0===this.m_root.tabIndex){this._exitActionableMode(),this.m_externalFocus=!0,this._isCellEditable()?this._setAccInfoText("accessibleEditableMode"):this._isGridEditable()&&this._setAccInfoText("accessibleNavigationMode");var s=!1;!0===this.m_scrollbarFocus&&(this.m_shouldFocus=!1,this.m_scrollbarFocus=!1,s=!0);let t=this._getEmptyElement();if(null==this.m_active&&t)this._setActive(t,{type:"empty"},e,null,null,s,!0);else if(null!=this.m_active||this._databodyEmpty())null!=this.m_active&&this._highlightActive();else{var o;let t=this.getVisibleCellIndexInDirection("column",0,{right:!0}),i=this.getVisibleCellIndexInDirection("row",0,{down:!0});o=this.createIndex(i,t),s||this.scrollToIndex(o),this._setActiveByIndex(o,e,null,null,s)}}else if(this.m_utils.containsCSSClassName(i,this.getMappedStyle("cell"))||this.m_utils.containsCSSClassName(i,this.getMappedStyle("headercell"))||this.m_utils.containsCSSClassName(i,this.getMappedStyle("headerlabel"))||this.m_utils.containsCSSClassName(i,this.getMappedStyle("endheadercell"))||this.m_utils.containsCSSClassName(i,this.getMappedStyle("noDataContainer"))||this._isEditOrEnter())this._exitActionableMode(),this._closeToolTip(),this._openToolTipOnFocus(i,e);else if(!this._enteringActionableMode){const t=this._getOwnedContentFromTarget(i);if(t){this.m_shouldFocus=!1;const i=this._createActiveObject(t);this._setActive(t,i,e,null,null,!0,!0),u.enableAllFocusableElements(t),this._enterActionableMode(t,null,!1)}}this.m_root.tabIndex=-1}},A.prototype._openToolTipOnFocus=function(e,t){this._closeToolTip();const i=this.findHeader(e)||this.findLabel(e);if(!i)return;const s=this._getToolTipDescription(e,null!==this.findLabel(e));null!=s&&this._setToolTipOpenTimeout(t,i,s)},A.prototype._getOwnedContentFromTarget=function(e){let t=this.findCellOrHeader(e);return null===t&&(t=this.findLabel(e)),null===t&&(t=this.find(e,"noDataContainer")),t},A.prototype.handleContextMenuEvent=function(){clearTimeout(this.m_toolTipOpenTimeoutId);this._getToolTip()&&this._closeToolTip()},A.prototype.handleRootBlur=function(e){this._clearFocusoutTimeout(),this._clearOpenPopupListeners(),this._openPopups=f.getAllLogicalChildPopups(this.m_root);const t=this._getToolTip();t&&(this._openPopups=this._openPopups.filter(e=>e!==t)),this._handlePopupFocusinListener=this._handlePopupFocusin.bind(this),this._handlePopupFocusoutListener=this._handlePopupFocusout.bind(this);for(var i=0;i<this._openPopups.length;i++)this._openPopups[i].addEventListener("focusin",this._handlePopupFocusinListener),this._openPopups[i].addEventListener("focusout",this._handlePopupFocusoutListener);this._setFocusoutBusyState(),clearTimeout(this.m_toolTipOpenTimeoutId),this.m_focusoutTimeout=setTimeout(function(){if(!this.m_root.contains(document.activeElement)){t&&t!==document.activeElement&&(clearTimeout(this.m_toolTipOpenTimeoutId),this._closeToolTip()),this.m_root.tabIndex=0;var i=this._getActiveElement();null!=i&&(this._unsetAriaProperties(i),this._isEditOrEnter()&&!this.m_animating&&this._leaveEditing(e,i,!1,!1),this._exitActionableMode())}this._clearFocusoutBusyState()}.bind(this),100),null==this.m_moveRow&&this.m_utils.removeCSSClassName(this.m_root,this.getMappedStyle("focus"))},A.prototype._clearOpenPopupListeners=function(){if(null!=this._openPopups){for(var e=0;e<this._openPopups.length;e++)this._openPopups[e].removeEventListener("focusin",this._handlePopupFocusinListener),this._openPopups[e].removeEventListener("focusout",this._handlePopupFocusoutListener);this._openPopups=null}this._handlePopupFocusinListener=null,this._handlePopupFocusoutListener=null},A.prototype._handlePopupFocusout=function(e){this.handleRootBlur(e)},A.prototype._handlePopupFocusin=function(e){this.handleRootFocus(e,!0)},A.prototype._clearFocusoutTimeout=function(){this.m_focusoutTimeout&&(clearTimeout(this.m_focusoutTimeout),this.m_focusoutTimeout=null)},A.prototype._setFocusoutBusyState=function(){if(!this.m_focusoutResolveFunc){var e=c.getContext(this.m_root).getBusyContext(),t={description:"Datagrid component 'is handling focusout."};this.m_focusoutResolveFunc=e.addBusyState(t)}},A.prototype._clearFocusoutBusyState=function(){this.m_focusoutResolveFunc&&(this.m_focusoutResolveFunc(),this.m_focusoutResolveFunc=null)},A.prototype.calculateRowHeight=function(e){return""!==e.style.height?this.getElementHeight(e):null!=e.nextSibling?this.getElementDir(e.nextSibling,"top")-this.getElementDir(e,"top"):this.m_endRowPixel-this.getElementDir(e,"top")},A.prototype._databodyEmpty=function(){return null==this.m_databody.firstChild||null==this.m_databody.firstChild.firstChild},A.prototype._databodyEmptyState=function(){return!(null!=this.m_databody.firstChild&&null!=this.m_databody.firstChild.firstChild&&!this._getEmptyElement())},A.prototype._getEmptyElement=function(){let e=this.m_databody.querySelector("."+this.getMappedStyle("noDataContainer")),t=this.m_databody.querySelector("."+this.getMappedStyle("emptytext"));return e||t},A.prototype.addTransformMoveStyle=function(e,t,i,s,o,n,r){e.style.transitionDelay=i,e.style.transitionTimingFunction=s,e.style.transitionDuration=t,e.style.transform="translate3d("+o+"px,"+n+"px,"+r+"px)"},A.prototype.removeTransformMoveStyle=function(e){e.style.transitionDelay="",e.style.transitionTimingFunction="",e.style.transitionDuration="",e.style.transform=""},A.prototype._refreshDatabodyMap=function(){this._clearDatabodyMap(),this._addNodesToDatabodyMap(this.m_databody.firstChild.childNodes),this.m_databodyFrozenCol&&this._addNodesToDatabodyMap(this.m_databodyFrozenCol.firstChild.childNodes),this.m_databodyFrozenCorner&&this._addNodesToDatabodyMap(this.m_databodyFrozenCorner.firstChild.childNodes),this.m_databodyFrozenRow&&this._addNodesToDatabodyMap(this.m_databodyFrozenRow.firstChild.childNodes)},A.prototype._populateDatabody=function(e,t){this._addNodesToDatabodyMap(t.childNodes),e.appendChild(t),this.m_subtreeAttachedCallback(e)},A.prototype._emptyDatabody=function(e){this._clearDatabodyMap(),this.m_utils.empty(e)},A.prototype._addNodesToDatabodyMap=function(e){for(var t=0;t<e.length;t++){var i=e[t];if(this.m_utils.containsCSSClassName(i,this.getMappedStyle("cell"))){var s=this.getCellIndexes(i),o=this.getCellExtents(i),n=i.id;this._addToDatabodyMap(s,n,o)}}},A.prototype._addToDatabodyMap=function(e,t,i){for(var s=i.row,o=i.column,n=0;n<s;n++)for(var r=0;r<o;r++)this._addIndexToDatabodyMap(this.createIndex(e.row+n,e.column+r),t)},A.prototype._addIndexToDatabodyMap=function(e,t){var i="r"+e.row+"c"+e.column;this.m_databodyMap.set(i,t)},A.prototype._removeIndexFromDatabodyMap=function(e){var t="r"+e.row+"c"+e.column;return this.m_databodyMap.delete(t)},A.prototype._getFromDatabodyMap=function(e){var t="r"+e.row+"c"+e.column;return this.m_databodyMap.get(t)},A.prototype._clearDatabodyMap=function(){return this.m_databodyMap.clear()},A.prototype._modifyAxisCellContextIndex=function(e,t,i,s){for(var o=t;o<t+i;o++)for(var n=this._getAxisCellsByIndex(o,e),r=0;r<n.length;r++){n[r][this.getResources().getMappedAttribute("context")].indexes[e]+=s}},A.prototype._modifyAxisHeaderContextIndex=function(e,t,i,s){for(var o=t;o<t+i;o++){var n;n="row"===e?this._getHeadersByIndex(o,"row"):this._getHeadersByIndex(o,"rowEnd");for(var r=0;r<n.length;r++){n[r][this.getResources().getMappedAttribute("context")].index+=s}}},A.prototype._getCellOrHeaderByIndex=function(e,t){var i=null,s=this._getAxisCellsByIndex(e,t,!0);return null!=s&&s.length>0&&(i=s[0]),null==i&&("row"===t&&null==(i=this._getHeaderByIndex(e,t))&&(i=this._getHeaderByIndex(e,"rowEnd")),"column"===t&&null==(i=this._getHeaderByIndex(e,t))&&(i=this._getHeaderByIndex(e,"columnEnd"))),i},A.prototype._getLabel=function(e,t){return this.m_headerLabels[e][t]},A.prototype._getCellByIndex=function(e){var t=this._getFromDatabodyMap(e);let i=null;if(null!=t){let e=[this.m_databody,this.m_databodyFrozenCorner,this.m_databodyFrozenCol,this.m_databodyFrozenRow];e=e.filter(e=>e);for(let s=0;s<e.length&&(i=e[s].querySelector(`#${t}`),!i);s++);}return i},A.prototype._getCellContainer=function(e){let t=this.m_databody,i=[this.m_databodyFrozenCorner,this.m_databodyFrozenCol,this.m_databodyFrozenRow];i=i.filter(e=>e);for(let s=0;s<i.length;s++){if(i[s].querySelector(`#${e.id}`)){t=i[s];break}}return t},A.prototype._getFrozenCellByIndex=function(e,t,i){var s=this._getFromDatabodyMap(e);if(null!=s){let e;return i?e=this.m_databodyFrozenCorner.querySelector("#"+s):"row"===t?e=this.m_databodyFrozenCol.querySelector("#"+s):"column"===t&&(e=this.m_databodyFrozenRow.querySelector("#"+s)),e}return null},A.prototype._getCellsInRange=function(e,t,i,s){let o=[];for(let n=e;n<=i;n++)for(let e=t;e<=s;e++){let t=this._getCellByIndex(this.createIndex(n,e));t&&o.push(t)}return o},A.prototype._getFirstCellWithMatchingStartIndex=function(e,t){let i,s,o="row"===t?this.m_startCol:this.m_startRow,n="row"===t?this.m_endCol:this.m_endRow;for(let r=o;r<=n;r++)if(i=this.createIndex("row"===t?e:r,"row"===t?r:e),s=this._getCellByIndex(i),this._getIndex(s,t)===e)return s;return null},A.prototype._getAxisCellsByIndex=function(e,t,i){var s,o="row"===t?this.m_startCol:this.m_startRow,n="row"===t?this.m_endCol:this.m_endRow;!this._isHighWatermarkScrolling()&&("row"===t&&this._hasFrozenRows()||"column"===t&&this._hasFrozenColumns())&&(o=0);for(var r=[],l=o;l<=n;l+=s){var a=this._getCellByIndex(this.createIndex("row"===t?e:l,"row"===t?l:e));if(null!=a){if(s=this.getCellExtents(a)["row"===t?"column":"row"],r.push(a),i)break}else s=1}return r},A.prototype._getAxisCellsByKey=function(e,t,i){if(null==e||null==this.m_databody||null==this.m_databody.firstChild)return null;var s=[];let o=[this.m_databody,this.m_databodyFrozenCorner,this.m_databodyFrozenCol,this.m_databodyFrozenRow];o=o.filter(e=>e);let n=[];for(let e=0;e<o.length;e++)n.push(...o[e].firstChild.querySelectorAll("."+this.getMappedStyle("cell")));for(var r=0;r<n.length;r++){var l=n[r];if(this.m_utils.containsCSSClassName(l,this.getMappedStyle("cell")))if(this._getKey(l,t)===e&&(s.push(l),i))break}return s},A.prototype._isDOMElementFilterable=function(e){if(null==e)return!1;var t=this.findHeader(e);return null!=t&&"true"===t.getAttribute(this.getResources().getMappedAttribute("filterable"))},A.prototype._getHorizontalAlignmentStyle=function(e){const t={justifyContent:e,textAlign:e};return"start"===e?(t.justifyContent="flex-start",t.textAlign="start"):"end"===e&&(t.justifyContent="flex-end",t.textAlign="end"),t},A.prototype._getVerticalAlignmentStyle=function(e){return"top"===e?"flex-start":"bottom"===e?"flex-end":"center"},A.prototype._shouldAppendIcon=function(e,t,i){return!!("start"===e||"center"===e||this.getResources().isRTLMode()&&"right"===e||!this.getResources().isRTLMode()&&"left"===e||"auto"===e&&("row"===t||this._isParentNode(i)))},A.prototype._setupActions=function(){this.actions={ACTIONABLE:this._handleActionable,EXIT_ACTIONABLE:this._handleExitActionable,TAB_NEXT_IN_CELL:u.handleActionableTab,TAB_PREV_IN_CELL:u.handleActionablePrevTab,TAB_NEXT_IN_CELL_OR_FOCUS_RIGHT:this._handleEditableTab,TAB_PREV_IN_CELL_OR_FOCUS_LEFT:this._handleEditablePrevTab,EDITABLE:this._handleEditable,EXIT_EDITABLE:this._handleExitEditable,DATA_ENTRY:this._handleDataEntry,EDIT:this._handleEdit,EXIT_EDIT:this._handleExitEdit,CANCEL_EDIT:this._handleCancelEdit,NO_OP:this._handleNoOp,FOCUS_LEFT:this._handleFocusLeft,FOCUS_LEFT_NON_EMPTY_CELL:this._handleFocusLeftNonEmptyCell,FOCUS_RIGHT:this._handleFocusRight,FOCUS_RIGHT_NON_EMPTY_CELL:this._handleFocusRightNonEmptyCell,FOCUS_UP:this._handleFocusUp,FOCUS_UP_NON_EMPTY_CELL:this._handleFocusUpNonEmptyCell,FOCUS_DOWN:this._handleFocusDown,FOCUS_DOWN_NON_EMPTY_CELL:this._handleFocusDownNonEmptyCell,FOCUS_ROW_FIRST:this._handleFocusRowFirst,FOCUS_ROW_LAST:this._handleFocusRowLast,FOCUS_COLUMN_FIRST:this._handleFocusColumnFirst,FOCUS_COLUMN_LAST:this._handleFocusColumnLast,FOCUS_COLUMN_HEADER:this._handleFocusColumnHeader,FOCUS_COLUMN_END_HEADER:this._handleFocusColumnEndHeader,FOCUS_ROW_HEADER:this._handleFocusRowHeader,FOCUS_ROW_END_HEADER:this._handleFocusRowEndHeader,FOCUS_FIRST_CELL_IN_GRID:this._handleFocusFirstCellInGrid,FOCUS_LAST_CELL_IN_GRID:this._handleFocusLastCellInGrid,READ_CELL:this.readCurrentContent,SORT:this._handleSortKey,EXPAND:this._handleExpandKey,COLLAPSE:this._handleCollapseKey,SELECT_DISCONTIGUOUS:this._handleSelectDiscontiguous,SELECT_EXTEND_LEFT:this._handleExtendSelectionLeft,SELECT_EXTEND_RIGHT:this._handleExtendSelectionRight,SELECT_EXTEND_UP:this._handleExtendSelectionUp,SELECT_EXTEND_DOWN:this._handleExtendSelectionDown,SELECT_ROW:this._handleSelectRow,SELECT_COLUMN:this._handleSelectColumn,SELECT_ALL:this._handleSelectAll,CUT:this._handleCut,CUT_CELLS:this._handleCutCells,COPY_CELLS:this._handleCopyCells,CANCEL_REORDER:this._handleCancelReorder,PASTE:this._handlePaste,PASTE_CELLS:this._handlePasteCells,FILL:this._handleAutofill,CANCEL_DRAG:this.handleCancelDrag,FILTER_COLUMN:this._handleFilterKey}},A.prototype._getActionFromKeyDown=function(e,t,i){var s={cellOrHeader:t,isLabel:i,readOnly:!this._isCellEditable(),currentMode:this._getCurrentMode(),activeMove:null!=this.m_cutCells||null!=this.m_dataTransferAction,rowMove:this._isMoveEnabled("row"),columnSort:"column"===t&&this._isDOMElementSortable(this._getActiveElement()),rowSort:"row"===t&&this._isDOMElementSortable(this._getActiveElement()),selection:this._isSelectionEnabled(),selectionMode:this.m_options.getSelectionMode(),multipleSelection:this.isMultipleSelection(),expandCollapse:this._isTargetExpandCollapseEnabled(e.target)};return this._isDataGridProvider()&&(s.cutCells=!0,s.copyCells=!0,s.pasteCells=!0,s.activeDrag=!(!this._cellsDragged||!this._cellsDragged.length),s.filterCol=this._isDOMElementFilterable(this._getActiveElement())),this.m_options.isFloodFillEnabled()&&(s.fill=!0),this.actions[this.m_keyboardHandler.getAction(e,s)]},A.prototype._getActionFromNoDataKeydown=function(e){var t={readOnly:!this._isCellEditable(),currentMode:this._getCurrentMode()};return this.actions[this.m_keyboardHandler.getNoDataAction(e,t)]},A.prototype.isActionableMode=function(){return"actionable"===this.m_currentMode},A.prototype.setActionableMode=function(e){this.m_currentMode=e?"actionable":"navigation",this._setAccInfoText(this.isActionableMode()?"accessibleActionableMode":"accessibleNavigationMode")},A.prototype._handleActionable=function(e,t){return this._enterActionableMode(t,e,!0),!1},A.prototype._handleExitActionable=function(e,t){return this._exitActionableMode(),this._highlightActive(),!1},A.prototype._getEditMode=function(){return null==this.m_editMode&&(this.m_editMode=this.m_options.getEditMode()),this.m_editMode},A.prototype._getCurrentMode=function(){return null==this.m_currentMode&&(this.m_currentMode="navigation"),this.m_currentMode},A.prototype._isEditOrEnter=function(){return"edit"===this._getCurrentMode()},A.prototype._isGridEditable=function(){var e=this._getEditMode();return"cellNavigation"===e||"cellEdit"===e},A.prototype._isCellEditable=function(){return"cellEdit"===this._getEditMode()},A.prototype._handleEditable=function(e,t){return this._isGridEditable()?(this.m_editMode=null,this.m_setOptionCallback("editMode","cellEdit",{_context:{writeback:!0,internalSet:!0}}),this.m_utils.removeCSSClassName(this.m_root,this.getMappedStyle("readOnly")),this.m_utils.addCSSClassName(this.m_root,this.getMappedStyle("editable")),this._updateEdgeCellBorders(""),this._setAccInfoText("accessibleEditableMode"),this._setEditableClone(t)):this._handleActionable(e,t),!1},A.prototype._handleExitEditable=function(e,t){this.m_editMode=null,this.m_setOptionCallback("editMode","cellNavigation",{_context:{writeback:!0,internalSet:!0}}),this.m_utils.addCSSClassName(this.m_root,this.getMappedStyle("readOnly")),this.m_utils.removeCSSClassName(this.m_root,this.getMappedStyle("editable")),this._updateEdgeCellBorders("none"),this._setAccInfoText("accessibleNavigationMode"),this._destroyEditableClone()},A.prototype._handleDataEntry=function(e,t){this._beforeEditFocusCallbackDetails=null;var i={event:e,ui:{cell:t,cellContext:t[this.getResources().getMappedAttribute("context")],focusCallback:this._beforeEditFocusCallback.bind(this)}},s=!this._getAttribute(t,"readOnly")&&this.fireEvent("beforeEdit",i);let o=this._beforeEditFocusCallbackDetails;return this._beforeEditFocusCallbackDetails=null,s?(this._removeFloodFillAffordance(),this._reRenderCell(t,"edit",this.getMappedStyle("cellEdit"),this.m_editableClone),this._setFocusToFirstFocusableElement(t,void 0,!0,o)?this.m_currentMode="edit":this.m_utils.removeCSSClassName(t,this.getMappedStyle("cellEdit"))):this._showToolTip(t,this.getResources().getTranslatedText("msgReadOnly"),!0),!1},A.prototype._beforeEditFocusCallback=function(e){this._beforeEditFocusCallbackDetails=e},A.prototype._handleEdit=function(e,t,i){this._beforeEditFocusCallbackDetails=null;var s={event:e,ui:{cell:t,cellContext:t[this.getResources().getMappedAttribute("context")],focusCallback:this._beforeEditFocusCallback.bind(this)}},o=this._getAttribute(t,"readOnly"),n=!o&&this.fireEvent("beforeEdit",s);let r=this._beforeEditFocusCallbackDetails;if(this._beforeEditFocusCallbackDetails=null,n){this._removeFloodFillAffordance(),this._reRenderCell(t,"edit",this.getMappedStyle("cellEdit"),this.m_editableClone),this.m_currentMode="edit",this._updateEdgeCellBorders(""),this.m_editCell={indexes:t[this.getResources().getMappedAttribute("context")].indexes},s={event:e,ui:{editCell:this.m_editCell}},this.fireEvent("editCell",s);var l=this;c.getContext(t).getBusyContext().whenReady().then(function(){l._setFocusToFirstFocusableElement(t,void 0,i,r)||(l.m_utils.removeCSSClassName(t,l.getMappedStyle("cellEdit")),l.m_currentMode="navigation")})}else n=!1,o?(this._enterActionableMode(t,null,!0),this.isActionableMode()||this._showToolTip(t,this.getResources().getTranslatedText("msgReadOnly"),!0)):(this.m_editCell=null,s={event:e,ui:{editCell:this.m_editCell}},this.fireEvent("editCell",s));return n},A.prototype._handleExitEdit=function(e,t){return this._leaveEditing(e,t,!1)},A.prototype._handleCancelEdit=function(e,t){return!!this._leaveEditing(e,t,!0)&&(this._setEditableClone(t),!0)},A.prototype._leaveEditing=function(e,t,i,s){const o=t[this.getResources().getMappedAttribute("context")];var n={event:e,ui:{cell:t,cellContext:o,cancelEdit:i}};"invalidShown"===o.metadata?.validity&&this._applyBorderClassesAroundRange(t,{startIndex:this.m_active.indexes},!1,"EditInvalid"),i||(u.disableAllFocusableElements(t),!1===s&&(this.m_shouldFocus=s),this._highlightActive());var r=this.fireEvent("beforeEditEnd",n);return r?(this.m_currentMode="navigation",this.m_editCell=null,n={event:e,ui:{editCell:this.m_editCell}},this.fireEvent("editCell",n),u.disableAllFocusableElements(t),!1===s&&(this.m_shouldFocus=s),this._highlightActive(),this._reRenderCell(t,"navigation",this.getMappedStyle("cellEdit"),this.m_editableClone)):(r=!1,this._scrollToActive(this.m_active),this._setFocusToFirstFocusableElement(t)),this._runModelEventQueue(),r},A.prototype._handleFocusKey=function(e,t,i,s,o,n,r){var l,a=!0,h=!0;if(null!=this.m_active){if("cell"===this.m_active.type){if(this._isEditOrEnter()?(l=!0,a=this._leaveEditing(e,t,!1),h=!1):this.isActionableMode()&&this._exitActionableMode(),a){this.m_options.isFloodFillEnabled()&&this._removeFloodFillAffordance();var d=this.m_active,m=this.handleFocusChange(i,s,e,h,o,n,r);return this._isGridEditable()&&d!==this.m_active&&l&&this.m_utils.isTouchDevice()?this._handleEdit(e,this._getActiveElement(),!0):m}return!0}if("header"===this.m_active.type)return this.handleHeaderFocusChange(i,e,s,o,n);if("label"===this.m_active.type)return this.handleLabelFocusChange(i,e,s,o);if("empty"===this.m_active.type)return this.handleNoDataFocusChange(i,s,e,h)}return!1},A.prototype._handleFocusLeft=function(e,t){return this._handleFocusKey(e,t,this.keyCodes.LEFT_KEY,!1,!1)},A.prototype._handleFocusLeftNonEmptyCell=function(e,t){return this._handleFocusKey(e,t,this.keyCodes.LEFT_KEY,!1,!1,!0)},A.prototype._handleFocusRight=function(e,t){return this._handleFocusKey(e,t,this.keyCodes.RIGHT_KEY,!1,!1)},A.prototype._handleFocusRightNonEmptyCell=function(e,t){return this._handleFocusKey(e,t,this.keyCodes.RIGHT_KEY,!1,!1,!0)},A.prototype._handleFocusUp=function(e,t){return this._handleFocusKey(e,t,this.keyCodes.UP_KEY,!1,!1)},A.prototype._handleFocusUpNonEmptyCell=function(e,t){return this._handleFocusKey(e,t,this.keyCodes.UP_KEY,!1,!1,!0)},A.prototype._handleFocusDown=function(e,t){return this._handleFocusKey(e,t,this.keyCodes.DOWN_KEY,!1,!1)},A.prototype._handleFocusDownNonEmptyCell=function(e,t){return this._handleFocusKey(e,t,this.keyCodes.DOWN_KEY,!1,!1,!0)},A.prototype._handleFocusRowFirst=function(e,t){return this._handleFocusKey(e,t,this.keyCodes.PAGEUP_KEY,!1,!1)},A.prototype._handleFocusRowLast=function(e,t){return this._handleFocusKey(e,t,this.keyCodes.PAGEDOWN_KEY,!1,!1)},A.prototype._handleFocusColumnFirst=function(e,t){return this._handleFocusKey(e,t,this.keyCodes.HOME_KEY,!1,!1)},A.prototype._handleFocusColumnLast=function(e,t){return this._handleFocusKey(e,t,this.keyCodes.END_KEY,!1,!1)},A.prototype._handleFocusRowHeader=function(e,t){return this._handleFocusKey(e,t,this.keyCodes.LEFT_KEY,!1,!0)},A.prototype._handleFocusRowEndHeader=function(e,t){return this._handleFocusKey(e,t,this.keyCodes.RIGHT_KEY,!1,!0)},A.prototype._handleFocusColumnHeader=function(e,t){return this._handleFocusKey(e,t,this.keyCodes.UP_KEY,!1,!0)},A.prototype._handleFocusColumnEndHeader=function(e,t){return this._handleFocusKey(e,t,this.keyCodes.DOWN_KEY,!1,!0)},A.prototype._handleFocusFirstCellInGrid=function(e,t){return this._handleFocusKey(e,t,this.keyCodes.HOME_KEY,!1,!1,!1,!0)},A.prototype._handleFocusLastCellInGrid=function(e,t){return this._handleFocusKey(e,t,this.keyCodes.END_KEY,!1,!1,!1,!0)},A.prototype._handleSelectRow=function(e,t){var i,s,o,n,r=1;if(!this._isSelectionEnabled()||!this.isMultipleSelection()&&"row"!==this.m_options.getSelectionMode())return!1;if(this.m_utils.containsCSSClassName(t,this.getMappedStyle("cell")))i=n=this.m_active.indexes.row,s=n,o=this.m_rowHeaderLevelCount-1;else{if(null==this.m_active||"header"!==this.m_active.type||-1===this.m_active.axis.indexOf("row"))return!1;if(n=this.m_active.index,o=this.m_active.level,this.m_rowHeaderLevelCount-1===o)i=n,s=n;else{var l=this._getActiveElement();s=(i=this._getAttribute(l.parentNode,"start",!0))+(r=this._getAttribute(l.parentNode,"extent",!0))-1}}if(this.m_selectionFrontier&&this.m_selectionFrontier.axis&&-1!==this.m_selectionFrontier.axis.indexOf("column"))return this._handleSelectAll(e),!0;if(this.setHeaderSelectionFrontier("row",s,n,o,t,!0),this._shouldDeselectHeader(n,r,"row")){var a=this.createIndex(n,0),h=this.createIndex(n+r-1,-1),d=this._getSelectionStartAndEnd(a,h,0),m=this.createRange(this.createIndex(d.min.row,0),this.createIndex(d.max.row,-1)),c=this._trimRangeForSelectionMode(m);return this.m_deselectInfo={selection:this.GetSelection()},this._deselectRange(c,e),!0}return this._selectEntireRow(i,s,e),this._setAccInfoText("accessibleRowSelected",{row:n+1}),!0},A.prototype._handleSelectColumn=function(e,t){var i,s,o,n,r=1;if(!this._isSelectionEnabled()||!this.isMultipleSelection()||"cell"!==this.m_options.getSelectionMode())return!1;if(this.m_utils.containsCSSClassName(t,this.getMappedStyle("cell")))i=n=this.m_active.indexes.column,s=n,o=this.m_columnHeaderLevelCount-1;else{if(null==this.m_active||"header"!==this.m_active.type||-1===this.m_active.axis.indexOf("column"))return!1;if(n=this.m_active.index,o=this.m_active.level,this.m_columnHeaderLevelCount-1===o)i=n,s=n;else{var l=this._getActiveElement();s=(i=this._getAttribute(l.parentNode,"start",!0))+(r=this._getAttribute(l.parentNode,"extent",!0))-1}}if(this.m_selectionFrontier&&this.m_selectionFrontier.axis&&-1!==this.m_selectionFrontier.axis.indexOf("row"))return this._handleSelectAll(e),!0;if(this.setHeaderSelectionFrontier("column",s,n,o,t,!0),this._shouldDeselectHeader(n,r,"column")){var a=this.createIndex(0,n),h=this.createIndex(-1,n+r-1),d=this._getSelectionStartAndEnd(a,h,0),m=this.createRange(this.createIndex(0,d.min.column),this.createIndex(-1,d.max.column)),c=this._trimRangeForSelectionMode(m);return this.m_deselectInfo={selection:this.GetSelection()},this._deselectRange(c,e),!0}return this._selectEntireColumn(i,s,e),this._setAccInfoText("accessibleColumnSelected",{column:n+1}),!0},A.prototype._handleSelectDiscontiguous=function(e,t){return this.setDiscontiguousSelectionMode(!this.m_discontiguousSelection),!0},A.prototype._handleExtendSelectionLeft=function(e,t){return this._handleFocusKey(e,t,this.keyCodes.LEFT_KEY,!0,!1)},A.prototype._handleExtendSelectionRight=function(e,t){return this._handleFocusKey(e,t,this.keyCodes.RIGHT_KEY,!0,!1)},A.prototype._handleExtendSelectionUp=function(e,t){return this._handleFocusKey(e,t,this.keyCodes.UP_KEY,!0,!1)},A.prototype._handleExtendSelectionDown=function(e,t){return this._handleFocusKey(e,t,this.keyCodes.DOWN_KEY,!0,!1)},A.prototype._handleSortKey=function(e,t){return"true"===t.getAttribute(this.getResources().getMappedAttribute("sortable"))?(this._handleKeyboardSort(t,e),!0):this._handleActionable(e,t)},A.prototype._handleExpandKey=function(e,t){return!!this._isHeaderCollapsed(t)&&(this._handleExpandCollapseRequest(e),!0)},A.prototype._handleCollapseKey=function(e,t){return!!this._isHeaderExpanded(t)&&(this._handleExpandCollapseRequest(e),!0)},A.prototype._handleNoOp=function(e,t){return!1},A.prototype._handleFilterKey=function(e){return this._handleHeaderFilter(e,"column"),!0},A.prototype._handleEditableTab=function(e,t){var i=u.getFocusableElementsInNode(t);return!(i&&i.indexOf(document.activeElement)<i.length-1)&&this._handleFocusRight(e,t)},A.prototype._handleEditablePrevTab=function(e,t){var i=u.getFocusableElementsInNode(t);return!(i&&i.indexOf(document.activeElement)>0)&&this._handleFocusLeft(e,t)},A.RESIZE_OFFSET=5,A.RESIZE_TOUCH_OFFSET=8,A.prototype.handleResize=function(e){if(!1===this.m_isResizing){var t=this.find(e.target,"header"),i=this.find(e.target,"headerlabel");if(null==t&&(t=this.find(e.target,"endheader")),null!=t&&(t===this.m_rowHeader||t===this.m_colHeader||t===this.m_rowEndHeader||t===this.m_colEndHeader||t===this.m_colHeaderFrozen||t===this.m_colEndHeaderFrozen||t===this.m_rowHeaderFrozen||t===this.m_rowEndHeaderFrozen)||null!=i){let s=!1;i&&(s=!0),this.m_cursor=this.manageHeaderCursor(e,s),null!=this.m_resizingElement&&("default"===this.m_cursor?(this.m_resizingElement.style.cursor="",this._isSelectionEnabled()&&(t&&this.shouldHoverHeader(t)||i)&&this.m_utils.addCSSClassName(e.target,this.getMappedStyle("hover")),null!=this.m_resizingElementSibling&&(this.m_resizingElementSibling.style.cursor="")):(this.m_resizingElement.style.cursor=this.m_cursor,this.m_utils.removeCSSClassName(e.target,this.getMappedStyle("hover")),null!=this.m_resizingElementSibling&&(this.m_resizingElementSibling.style.cursor=this.m_cursor)))}}else this.handleResizeMouseMove(e)},A.prototype.handleResizeMouseDown=function(e){return("col-resize"===this.m_cursor||"row-resize"===this.m_cursor)&&(this.m_isResizing=!0,this.m_utils.isTouchDevice()?(this.m_lastMouseX=e.touches[0].pageX,this.m_lastMouseY=e.touches[0].pageY):(document.addEventListener("mousemove",this.m_docMouseMoveListener,!1),document.addEventListener("mouseup",this.m_docMouseUpListener,!1),this.m_lastMouseX=e.pageX,this.m_lastMouseY=e.pageY),this.m_overResizeLeft=0,this.m_overResizeMinLeft=0,this.m_overResizeTop=0,this.m_overResizeMinTop=0,this.m_overResizeRight=0,this.m_overResizeBottom=0,this.m_orginalResizeDimensions={width:this.getElementWidth(this.m_resizingElement),height:this.getElementHeight(this.m_resizingElement)},!0)},A.prototype._resizeSelectedHeaders=function(e,t,i,s,o,n){let r=this.m_resizingElement,l=this.getHeaderCellAxis(this.m_resizingElement),a=this._getResizeHeaderMode(this.m_resizingElement),h=this.getHeaderCellLevel(this.m_resizingElement),d=!1;("column"===l&&h===this.m_columnHeaderLevelCount-1||"row"===l&&h===this.m_rowHeaderLevelCount-1||"columnEnd"===l&&h===this.m_columnEndHeaderLevelCount-1||"rowEnd"===l&&h===this.m_rowEndHeaderLevelCount-1)&&(d=!0);const m=new Set,c=this.m_resizingElement[this.getResources().getMappedAttribute("context")],u=this._getSelectionAxis(l);this.m_selection&&this.m_selection.length&&d&&!this.m_discontiguousSelection&&this._isHeaderSelected(c,u)&&this.m_selection.forEach(e=>{this._getHeadersWithinSelection(e,e.startIndex[u],l).forEach(e=>m.add(e))}),0!==m.size?m.forEach(l=>{let h=l[this.getResources().getMappedAttribute("context")],d=h.index,m=h.key,c="column"===a?s:o,u="column"===a?"width":"height";if(r!==l){this.m_resizingElement=l;let e=this.getElementDir(l,u);this.isHidden(a,d)&&(this.m_sizingManager.setSize(a,m,c),c=0),"column"===a?this.resizeColWidth(e,c):this.resizeRowHeight(e,c)}this._fireResizeEvent(e,t,i,s,o,n)}):("column"===a?this.resizeColWidth(this.getElementDir(this.m_resizingElement,"width"),s):this.resizeRowHeight(this.getElementDir(this.m_resizingElement,"height"),o),this._fireResizeEvent(e,t,i,s,o,n)),this._fireCellResizeEvent(e,t,i,s,o,m)},A.prototype._getSelectionAxis=function(e){let t=e;return"rowEnd"===t?t="row":"columnEnd"===t&&(t="column"),t},A.prototype._fireCellResizeEvent=function(e,t,i,s,o,n){const r={event:e,ui:{}};let l;const a=this._getResizeHeaderMode(this.m_resizingElement),h=this.getHeaderCellIndex(this.m_resizingElement),d=this.getHeaderCellLevel(this.m_resizingElement),m=this.getHeaderCellAxis(this.m_resizingElement),c=this.find(this.m_resizingElement,"headerlabel"),u=this.m_resizingElement[this.getResources().getMappedAttribute("context")];let _=!1;if(("column"===m&&d===this.m_columnHeaderLevelCount-1||"row"===m&&d===this.m_rowHeaderLevelCount-1||"columnEnd"===m&&d===this.m_columnEndHeaderLevelCount-1||"rowEnd"===m&&d===this.m_rowEndHeaderLevelCount-1)&&(_=!0),s!==t){if("column"!==a&&"columnEnd"!==a||c)if(c){l=this.m_utils.containsCSSClassName(this.m_resizingElement,this.getMappedStyle("rowendheaderlabel"))?"rowEndHeaderWidth":"rowHeaderWidth",r.ui.levels=[a.includes("row")?u.level:this.m_rowHeaderLevelCount-1],r.ui.size=s}else{let e=this.m_utils.containsCSSClassName(this.m_resizingElement,this.getMappedStyle("rowendheadercell"));l=e?"rowEndHeaderWidth":"rowHeaderWidth",r.ui.levels=[u.level+u.depth-1],r.ui.size=e?this.m_rowEndHeaderLevelWidths[u.level+u.depth-1]:this.m_rowHeaderLevelWidths[u.level+u.depth-1]}else l="columnWidth",r.ui.size=this.getElementWidth(this._getHeaderByIndex(h+u.extent-1,"column",this.m_columnHeaderLevelCount-1));r.ui.dimension=l}else{if(o===i)return;if("row"!==a&&"rowEnd"!==a||c)if(c){l=this.m_utils.containsCSSClassName(this.m_resizingElement,this.getMappedStyle("columnendheaderlabel"))?"columnEndHeaderHeight":"columnHeaderHeight",r.ui.levels=[a.includes("column")?u.level:this.m_columnHeaderLevelCount-1],r.ui.size=o}else{let e=this.m_utils.containsCSSClassName(this.m_resizingElement,this.getMappedStyle("colendheadercell"));l=e?"columnEndHeaderHeight":"columnHeaderHeight",r.ui.levels=[u.level+u.depth-1],r.ui.size=e?this.m_columnEndHeaderLevelHeights[u.level+u.depth-1]:this.m_columnHeaderLevelHeights[u.level+u.depth-1]}else l="rowHeight",r.ui.size=this.getElementHeight(this._getHeaderByIndex(h+u.extent-1,"row",this.m_rowHeaderLevelCount-1));r.ui.dimension=l}const g=this._getSelectionAxis(m);if(this.m_selection&&this.m_selection.length&&_&&!this.m_discontiguousSelection&&("rowHeight"===l||"columnWidth"===l)){const e=[];this._isHeaderSelected(u,g)?n.forEach(t=>{const i=t[this.getResources().getMappedAttribute("context")];e.push(this.getHeaderCellIndex(t)+i.extent-1)}):e.push(h+u.extent-1),r.ui.indices=e}else"rowHeight"!==l&&"columnWidth"!==l||(r.ui.indices=[],r.ui.indices.push(h+u.extent-1));this.fireEvent("cellResize",r)},A.prototype._fireResizeEvent=function(e,t,i,s,o,n){let r={event:e,ui:{header:this._getKey(this.m_resizingElement),oldDimensions:{width:t,height:i},newDimensions:{width:s,height:o},size:n}};this.fireEvent("resize",r)},A.prototype.handleResizeMouseUp=function(e){if(!0===this.m_isResizing){var t=this.getElementWidth(this.m_resizingElement),i=this.getElementHeight(this.m_resizingElement);let s=this.m_orginalResizeDimensions.width,o=this.m_orginalResizeDimensions.height,n=this.m_resizingElement,r="col-resize"===this.m_cursor?n.style.width:n.style.height;t===this.m_orginalResizeDimensions.width&&i===this.m_orginalResizeDimensions.height||"col-resize"!==this.m_cursor&&"row-resize"!==this.m_cursor||this._resizeSelectedHeaders(e,s,o,t,i,r),n.style.cursor="",this._unhighlightResizeBorderColor(),this.m_isResizing=!1,this.m_cursor="default",null!=this.m_resizingElementSibling&&(this.m_resizingElementSibling.style.cursor=""),this.m_resizingElement=null,this.m_resizingElementMin=null,this.m_resizingElementSibling=null,this.m_orginalResizeDimensions=null,document.removeEventListener("mousemove",this.m_docMouseMoveListener,!1),document.removeEventListener("mouseup",this.m_docMouseUpListener,!1)}},A.prototype._isDOMElementResizable=function(e){return null!=e&&"true"===e.getAttribute(this.getResources().getMappedAttribute("resizable"))},A.prototype.manageHeaderCursor=function(e,t){var i,s,o,n,r,l,a,h,d;if((d=t?this.find(e.target,"headerlabel"):this.find(e.target,"headercell"))||t||(d=this.find(e.target,"endheadercell")),!d)return"default";var m=t?this.getHeaderLabelAxis(d):this.getHeaderCellAxis(d),c=t?this.getHeaderLabelLevel(d):this.getHeaderCellIndex(d),u=t?c:this.getHeaderCellLevel(d);if("column"===m)if(r="enable"===this.m_options.isResizable(m,"height"),n=this._isDOMElementResizable(d),t)a=null,l=null,h=this.m_headerLabels.column[c-1];else{let e=this.getVisibleCellIndexInDirection("column",c-1,{left:!0});(a=this._getHeaderByIndex(e,"column",u))||(this.m_headerLabels.column.length?(a=this._getLabel("column",u),u===this.m_columnHeaderLevelCount-1&&this._isHeaderLabelCollision()&&(a=this.m_headerLabels.row[this.m_rowHeaderLevelCount-1])):a=this._getLabel("row",u)),l=this._isDOMElementResizable(a),h=this._getHeaderByIndex(c,"column",u-1)}else if("row"===m)n="enable"===this.m_options.isResizable(m,"width"),r=t?"enable"===this.m_options.isResizable(m,"height"):this._isDOMElementResizable(d),t?(h=this.m_headerLabels.row[c-1],this._isHeaderLabelCollision()&&d===this.m_headerLabels.row[this.m_rowHeaderLevelCount-1]&&(a=this.m_headerLabels.column[this.m_columnHeaderLevelCount-1])):(a=this._getHeaderByIndex(c-1,"row",u),l=this._isDOMElementResizable(a),h=this._getHeaderByIndex(c,"row",u-1));else if("columnEnd"===m)if(r="enable"===this.m_options.isResizable(m).height,n=this._isDOMElementResizable(d),t)a=null,l=null,h=this.m_headerLabels.columnEnd[c-1];else{let e=this.getVisibleCellIndexInDirection("column",c-1,{left:!0});(a=this._getHeaderByIndex(e,"columnEnd",u))||(a=this._getLabel("columnEnd",u)),l=this._isDOMElementResizable(a),h=this._getHeaderByIndex(c,"columnEnd",u-1)}else"rowEnd"===m&&(n="enable"===this.m_options.isResizable(m).width,r=this._isDOMElementResizable(d),t?(a=this.m_headerLabels.rowEnd[c-1],l=this._isDOMElementResizable(a)):(a=this._getHeaderByIndex(c-1,"rowEnd",u),l=this._isDOMElementResizable(a),h=this._getHeaderByIndex(c,"rowEnd",u-1)));if(this.m_utils.isTouchDevice())i=e.touches[0].pageX,s=e.touches[0].pageY,o=A.RESIZE_TOUCH_OFFSET;else{i=e.offsetX,s=e.offsetY,o=A.RESIZE_OFFSET;var _=this._findHeaderOffset(e.target,d);i+=_[0],s+=_[1]}var g=this.getHeaderEdgePixels(d),p=this.getResources().isRTLMode(),f="columnEnd"===m||"rowEnd"===m,C=i<g[0]+o,y=s<g[1]+o,w=i>g[2]-o,E=s>g[3]-o;if("column"===m||"columnEnd"===m){if(n&&(p?C:w))return this.m_resizingElement=d,"col-resize";if(l&&(p?w:C)){if(this.m_resizingElement=a,this.m_resizingElementSibling=d,null!==this.m_resizingElement)return"col-resize"}else if(r){if(!f&&E||f&&y)return this.m_resizingElement=d,"row-resize";if((!f&&y||f&&E)&&0!==u)return this.m_resizingElement=h,this.m_resizingElementSibling=d,"row-resize"}}else if("row"===m||"rowEnd"===m){if(r&&E)return this.m_resizingElement=d,"row-resize";if(l&&y&&!t){if(this.m_resizingElement=a,this.m_resizingElementSibling=d,null!==this.m_resizingElement)return"row-resize"}else if(h&&y&&t&&a&&(this.m_resizingElement=h,this.m_resizingElementSibling=d,null!==this.m_resizingElement))return"row-resize";if(n){if(!f&&(p?C:w)||f&&(p?w:C))return this.m_resizingElement=d,"col-resize";if((!f&&(p?w:C)||f&&(p?C:w))&&0!==u&&(this.m_resizingElement=h,this.m_resizingElementSibling=d,null!==this.m_resizingElement))return"col-resize"}}return"default"},A.prototype.handleResizeMouseMove=function(e){var t,i,s,o,n;this.m_currentMouseX=e.pageX,this.m_currentMouseY=e.pageY,this.m_utils.isTouchDevice()?(this.m_currentMouseX=e.touches[0].pageX,this.m_currentMouseY=e.touches[0].pageY):(this.m_currentMouseX=e.pageX,this.m_currentMouseY=e.pageY),t=this._getResizeHeaderMode(this.m_resizingElement);var r=this.m_utils.containsCSSClassName(this.m_resizingElement,this.getMappedStyle("endheadercell"))||this.m_utils.containsCSSClassName(this.m_resizingElement,this.getMappedStyle("columnendheaderlabel"));let l=this.find(this.m_resizingElement,"headerlabel");"col-resize"===this.m_cursor?"column"===t?(r=!l&&r,i=this.getElementWidth(this.m_resizingElement),s=this.getNewElementWidth("column",i,r,null,l),l?this.resizeRowWidth(s,s-i,r,l):this.resizeColWidth(i,s)):"row"===t&&(this.m_utils.containsCSSClassName(this.m_resizingElement,this.getMappedStyle("rowendheaderlabel"))&&(r=!0),i=this.getElementWidth(this.m_resizingElement),s=this.getNewElementWidth("row",i,r,null,l),this.resizeRowWidth(s,s-i,r,l)):"row-resize"===this.m_cursor&&("row"===t?(o=this.getElementHeight(this.m_resizingElement),n=this.getNewElementHeight("row",o,r,null,l),l?this.resizeColHeight(n,n-o,r):this.resizeRowHeight(o,n)):"column"===t&&(o=this.getElementHeight(this.m_resizingElement),n=this.getNewElementHeight("column",o,r,null,l),this.resizeColHeight(n,n-o,r))),this.buildCorners(),this.m_utils.isTouchDevice()&&this._moveTouchSelectionAffordance(),this.m_lastMouseX=this.m_currentMouseX,this.m_lastMouseY=this.m_currentMouseY},A.prototype.resizeColWidth=function(e,t){var i,s=t-e;const o=this.getResources().isRTLMode()?"right":"left";if(0!==s){let e=!1;if(this.m_resizingElement.classList.contains(this.getMappedStyle("frozenHeader"))&&(e=!0),null==this.m_databody.firstChild||e){if(e&&this.m_databodyFrozenCol){let e=this.getElementWidth(this.m_databodyFrozenCol),t=this.getElementDir(this.m_databodyFrozenCol,o);if(-1!==this.m_endRowEndHeader){let i=this.getElementDir(this.m_rowEndHeader,o);s=t+e+s>i?i-(t+e):s}i=e+s,this.setElementWidth(this.m_databodyFrozenCol,i),this.m_databodyFrozenCorner&&this.setElementWidth(this.m_databodyFrozenCorner,i)}}else{i=this.getElementWidth(this.m_databody.firstChild)+s,this._setAllScrollableRegions("width",i),this.m_databodyFrozenRow&&this.setElementWidth(this.m_databodyFrozenRow.firstChild,i)}this.resizeColumnWidthAndShift(s),this.deleteAndApplyHiddenIndicators(),e||(-1!==this.m_endCol&&(this.m_endColPixel+=s),-1!==this.m_endColHeader&&(this.m_endColHeaderPixel+=s),-1!==this.m_endColEndHeader&&(this.m_endColEndHeaderPixel+=s),null!=i&&(this.m_avgColWidth=i/this.getDataSource().getCount("column"))),this.manageResizeScrollbars()}},A.prototype.resizeRowHeight=function(e,t){var i,s=t-e;if(0!==s){let e=!1;if(this.m_resizingElement.classList.contains(this.getMappedStyle("frozenHeader"))&&(e=!0),null==this.m_databody.firstChild||e){if(e&&this.m_databodyFrozenRow){let e=this.getElementHeight(this.m_databodyFrozenRow),t=this.getElementDir(this.m_databodyFrozenRow,"top");if(-1!==this.m_endColEndHeader){let i=this.getElementDir(this.m_colEndHeader,"top");s=t+e+s>i?i-(t+e):s}i=e+s,this.setElementHeight(this.m_databodyFrozenRow,i),this.m_databodyFrozenCorner&&this.setElementHeight(this.m_databodyFrozenCorner,i)}}else{i=this.getElementHeight(this.m_databody.firstChild)+s,this._setAllScrollableRegions("height",i)}this.resizeRowHeightAndShift(s),this.deleteAndApplyHiddenIndicators(),e||(-1!==this.m_endRow&&(this.m_endRowPixel+=s),-1!==this.m_endRowHeader&&(this.m_endRowHeaderPixel+=s),-1!==this.m_endRowEndHeader&&(this.m_endRowEndHeaderPixel+=s),null!=i&&(this.m_avgRowHeight=i/this.getDataSource().getCount("row"))),this.manageResizeScrollbars()}},A.prototype.resizeColHeight=function(e,t,i,s=!1){if(0!==t){var o,n,r,l=!0,a=this.find(this.m_resizingElement,"headerlabel");if(a?"column"===(r=this.getHeaderLabelAxis(this.m_resizingElement))||"columnEnd"===r?n=this.getHeaderLabelLevel(this.m_resizingElement):"row"!==r&&"rowEnd"!==r||(n=this.m_columnHeaderLevelCount-1,l=!1):(n=this.getHeaderCellLevel(this.m_resizingElement)+(this.getHeaderCellDepth(this.m_resizingElement)-1),r=this.getHeaderCellAxis(this.m_resizingElement)),i?this.m_columnEndHeaderLevelHeights[n]+=t:(o=this.m_columnHeaderLevelHeights[n],this.m_columnHeaderLevelHeights[n]+=t),!i&&n===this.m_columnHeaderLevelCount-1&&this.m_headerLabels.row.length&&this._isHeaderLabelCollision()&&(l=!1),this.resizeColumnHeightsAndShift(t,n,i,l),i)this.m_colEndHeaderHeight+=t,this.setElementHeight(this.m_colEndHeader,this.m_colEndHeaderHeight),this.m_colEndHeaderFrozen&&this.setElementHeight(this.m_colEndHeaderFrozen,this.m_colEndHeaderHeight);else{if(this.m_colHeaderHeight+=t,this.setElementHeight(this.m_colHeader,this.m_colHeaderHeight),this.m_colHeaderFrozen&&this.setElementHeight(this.m_colHeaderFrozen,this.m_colHeaderHeight),0===this.m_headerLabels.column.length&&-1!==n)this._resizeHeaderLabelDirs(n,t,["row"],"height");else if(null!=this.m_columnHeaderLevelCount&&n===this.m_columnHeaderLevelCount-1)if(this.m_headerLabels.row.length){var h,d;if(a){if("column"===r)d=e,this.m_collisionResize=!0;else if("row"===r)h=t,this.m_collisionResize=!0;else if("rowEnd"===r)if(this._isHeaderLabelCollision()){let e=0;for(let t=0;t<this.m_columnHeaderLevelCount-1;t++)e+=this.getElementHeight(this.m_headerLabels.column[t]);let t=this.m_colHeaderHeight-e,i=this._calculateCollisionDimension(t,o,a,r,s);h=i.rowHeightChange,d=i.colHeight}else h=t,d=this.m_colHeaderHeight}else if(this._isHeaderLabelCollision()){let t=this._calculateCollisionDimension(e,o,!0,r,s);h=t.rowHeightChange,d=t.colHeight}else h=t,d=e;var m=this._getLabel("column",this.m_columnHeaderLevelCount-1);m&&this.setElementHeight(m,d),this._resizeHeaderLabelDirs(this.m_rowHeaderLevelCount-1,h,["row"],"height")}else{let t=["bottomResized"],i=this._getLabel("column",this.m_columnHeaderLevelCount-1);this._highlightElement(i.parentNode,t);let s=0;if("rowEnd"===r)for(let e=0;e<this.m_columnHeaderLevelCount-1;e++)s+=this.getElementHeight(this.m_headerLabels.column[e]);let o=e-s;this.setElementHeight(i,o)}else if(n<0){let t=this._getLabel("row",this.m_rowHeaderLevelCount-1),i=["bottomResized"];if(t&&n<0){this._highlightElement(t.parentNode,i);for(let i=0;i<this.m_rowHeaderLevelCount;i++)t=this._getLabel("row",i),this.setElementHeight(t,e)}}let i=this._getLabel("rowEnd",this.m_rowEndHeaderLevelCount-1),l=["bottomResized"];if(i){let t=-1===this.m_endColHeader?e:this.m_colHeaderHeight;this._highlightElement(i.parentNode,l);for(let e=0;e<this.m_rowEndHeaderLevelCount;e++)i=this._getLabel("rowEnd",e),this.setElementHeight(i,t)}}this.deleteAndApplyHiddenIndicators(),this.manageResizeScrollbars()}},A.prototype._calculateCollisionDimension=function(e,t,i,s,o=!1){let n,r,l={},a=this._getMinValue("height",s,i);if(this.m_collisionResize){let l=this.getElementDir(this.m_headerLabels.row[this.m_rowHeaderLevelCount-1],"height"),h=this.getElementDir(this.m_headerLabels.column[this.m_columnHeaderLevelCount-1],"height"),d=l+h,m=h/d,c=l/d;o?(r=Math.floor(.5*e),n=e-r-l):l===a&&h===a?(n=Math.floor(e/2)-Math.floor(t/2),r=Math.ceil(e/2),this.m_collisionResize=!1):m>c?(r=Math.floor(e*m),n=e-r-l,l+n<this._getMinValue("height",s,i)&&(n=0)):(n=Math.floor(e*c)-l,l+n<this._getMinValue("height",s,i)&&(n=0),r=e-(l+n),r=Math.max(r,this._getMinValue("height",s,i)))}else n=Math.floor(e/2)-Math.floor(t/2),r=Math.ceil(e/2);return l.colHeight=r,l.rowHeightChange=n,l},A.prototype.resizeRowWidth=function(e,t,i,s){if(0!==t){var o;if(s){let e=this.getHeaderLabelAxis(this.m_resizingElement);"column"===e||"columnEnd"===e?o=this.m_rowHeaderLevelCount-1:"row"!==e&&"rowEnd"!==e||(o=this.getHeaderLabelLevel(this.m_resizingElement))}else o=this.getHeaderCellLevel(this.m_resizingElement)+(this.getHeaderCellDepth(this.m_resizingElement)-1);if(i?this.m_rowEndHeaderLevelWidths[o]+=t:this.m_rowHeaderLevelWidths[o]+=t,this.resizeRowWidthsAndShift(t,o,i),i)this.m_rowEndHeaderWidth+=t,this.setElementWidth(this.m_rowEndHeader,this.m_rowEndHeaderWidth),this.m_rowEndHeaderFrozen&&this.setElementWidth(this.m_rowEndHeaderFrozen,this.m_rowEndHeaderWidth);else{if(this.m_rowHeaderWidth+=t,o<0){let t=this.getResources().isRTLMode()?["startResized"]:["endResized"],i=this._getLabel("column",this.m_columnHeaderLevelCount-1);this._highlightElement(i.parentNode,t);for(let t=0;t<this.m_columnHeaderLevelCount;t++)i=this._getLabel("column",t),this.setElementWidth(i,e)}else this.setElementWidth(this.m_rowHeader,this.m_rowHeaderWidth),this.m_rowHeaderFrozen&&this.setElementWidth(this.m_rowHeaderFrozen,this.m_rowHeaderWidth),(o===this.m_rowHeaderLevelCount-1||0===this.m_headerLabels.row.length&&this.m_headerLabels.column.length)&&this._resizeHeaderLabelDirs(o,t,["column"],"width");let i=this._getLabel("columnEnd",this.m_columnEndHeaderLevelCount-1),s=this.getResources().isRTLMode()?["startResized"]:["endResized"];if(i){this._highlightElement(i.parentNode,s);let e=this.getElementWidth(i)+t;for(let t=0;t<this.m_columnEndHeaderLevelCount;t++)i=this._getLabel("columnEnd",t),this.setElementWidth(i,e)}}this.deleteAndApplyHiddenIndicators(),this.manageResizeScrollbars()}},A.prototype._resizeHeaderLabelDirs=function(e,t,i,s){for(var o=0;o<i.length;o++){for(var n=i[o],r=0;r<this.m_headerLabels[n].length;r++){var l=this.m_headerLabels[n][r];if(null!=l){var a=this.getElementDir(l,s)+t;this.setElementDir(l,a,s)}}this._highlightResizeLabelDirs(n,e)}},A.prototype._highlightResizeLabelDirs=function(e,t){let i=this.getResources().isRTLMode()?["startResized"]:["endResized"],s="column"===e?i:["bottomResized"];this.m_corner&&("column"===e&&t===this.m_columnHeaderLevelCount-1||"row"===e&&t===this.m_rowHeaderLevelCount-1)&&this._highlightElement(this.m_corner,s);let o=this._getLabel("rowEnd",this.m_columnHeaderLevelCount-1);o&&this._highlightElement(o.parentNode,s)},A.prototype._unhighlightResizeBorderColor=function(){let e=this.m_root.querySelectorAll(".oj-datagrid-resized-start,\n    .oj-datagrid-resized-end, .oj-datagrid-resized-top, .oj-datagrid-resized-bottom");this._unhighlightElementsByClassName(e,["startResized","endResized","topResized","bottomResized"])},A.prototype.getNewElementWidth=function(e,t,i,s,o){const n=this._getResizeMinWidth(e,this.m_resizingElement,o,!1);null==s&&(s=this.getResources().isRTLMode()?this.m_lastMouseX-this.m_currentMouseX:this.m_currentMouseX-this.m_lastMouseX),i&&"row"===e&&(s*=-1);var r=t+s+this.m_overResizeLeft+this.m_overResizeMinLeft+this.m_overResizeRight;if(r<n?(this.m_overResizeMinLeft+=s-n+t,r=n):(this.m_overResizeMinLeft=0,this.m_overResizeLeft=0),"row"===e){const e=this._getResizeMaxWidth(t);r>e?(this.m_overResizeRight+=s-e+t,r=e):this.m_overResizeRight=0}return r},A.prototype._getResizeMinWidth=function(e,t,i,s){return this._getMinValue("width",e,i,s,t)},A.prototype._getResizeMaxWidth=function(e){const t=this.getRowHeaderWidth()+this.getRowEndHeaderWidth()-e;return Math.round(this.getWidth()-this.m_utils.getScrollbarSize()-1)-t},A.prototype.getNewElementHeight=function(e,t,i,s,o){const n=this._getResizeMinHeight(e,this.m_resizingElement,o,!1,i);null==s&&(s=this.m_currentMouseY-this.m_lastMouseY),i&&"column"===e&&(s*=-1);var r=t+s+this.m_overResizeTop+this.m_overResizeMinTop+this.m_overResizeBottom;if(r<n?(this.m_overResizeMinTop+=s-n+t,r=n):(this.m_overResizeMinTop=0,this.m_overResizeTop=0),"column"===e){const e=this._getResizeMaxHeight(t);r>e?(this.m_overResizeBottom+=s-e+t,r=e):this.m_overResizeBottom=0}return r},A.prototype._getResizeMaxHeight=function(e){var t=this.getColumnHeaderHeight()+this.getColumnEndHeaderHeight()-e;return Math.round(this.getHeight()-this.m_utils.getScrollbarSize()-1)-t},A.prototype._getResizeMinHeight=function(e,t,i,s,o){let n=0;const r=this._getMinValue("height",e,!0,s,t);if(i){if(n=r,"rowEnd"===this.getHeaderLabelAxis(t)&&this.m_headerLabels.column&&this.m_headerLabels.column.length){this._isHeaderLabelCollision()&&(n=2*r);for(let e=0;e<this.m_columnHeaderLevelCount-1;e++)n+=this.getElementHeight(this.m_headerLabels.column[e])}}else n=this._getMinValue("height",e,i,s,t);return"column"===e&&!o&&this.getHeaderCellLevel(t)+this.getHeaderCellDepth(t)===this.m_columnHeaderLevelCount&&this._isHeaderLabelCollision()&&(n=2*r),n},A.prototype._getMinValue=function(e,t,i,s,o=this.m_resizingElement){var n,r,l=this._getCellPaddingBorder(e,o),a=l;if(i||s)return Math.max(this.m_utils.isTouchDevice()?2*A.RESIZE_TOUCH_OFFSET:2*A.RESIZE_OFFSET,a);var h=this.getHeaderCellLevel(o),d=this.getHeaderCellDepth(o),m=this.getResources().getMappedAttribute("sortable");"true"===o.getAttribute(m)&&this._setSortContainerSize(this._getSortContainer(o),l),"column"===t&&"true"===o.getAttribute(m)&&(a="width"===e?this.m_sortContainerWidth:this.m_sortContainerHeight);var c=Math.max(this.m_utils.isTouchDevice()?2*A.RESIZE_TOUCH_OFFSET:2*A.RESIZE_OFFSET,a);if("column"===t&&(1===this.m_columnHeaderLevelCount||"width"===e&&this.m_columnHeaderLevelCount===h+1||"height"===e&&1===d)||"row"===t&&-1===this.m_endRowHeader||"column"===t&&-1===this.m_endColHeader||"row"===t&&(1===this.m_rowHeaderLevelCount||"height"===e&&this.m_rowHeaderLevelCount===h+1||"width"===e&&1===d))return c;var u=this.getHeaderCellIndex(o),_=this._getAttribute(o.parentNode,"extent",!0),g=this.getElementDir(o,e);if("column"===t)if("width"===e){let i=u+(_-1);for(;this.isHidden("column",i);)i-=1;n=this._getHeaderByIndex(i,t,this.m_columnHeaderLevelCount-1),r=this.getElementDir(n,e)}else r=this._getHeaderLevelDimension(h+(d-1),o,this.m_columnHeaderLevelHeights,"height",1);else"row"===t&&("height"===e?(n=this._getHeaderByIndex(u+(_-1),t,this.m_rowHeaderLevelCount-1),r=this.getElementDir(n,e)):r=this._getHeaderLevelDimension(h+(d-1),o,this.m_rowHeaderLevelWidths,"width",1));return g-(r-c)},A.prototype._getLabelMinValue=function(e){var t=this.m_resizingElement,i=this._getCellPaddingBorder(e,t);return Math.max(this.m_utils.isTouchDevice()?2*A.RESIZE_TOUCH_OFFSET:2*A.RESIZE_OFFSET,i)},A.prototype._setSortContainerSize=function(e,t){this.m_sortContainerWidth=this.getElementWidth(e)+t,this.m_sortContainerHeight=this.getElementHeight(e)},A.prototype._getCellPaddingBorder=function(e,t){if(null==this.m_resizingElementMin){for(var i=["top","right","bottom","left"],s="width"===e?1:0,o=0,n=window.getComputedStyle(t);s<4;s+=2)o+=parseFloat(n.getPropertyValue("padding-"+i[s])),o+=parseFloat(n.getPropertyValue("border-"+i[s]+"-width"));this.m_resizingElementMin=Math.round(o)}return this.m_resizingElementMin},A.prototype.manageResizeScrollbars=function(){var e=this.getWidth(),t=this.getHeight(),i=this.m_colHeader,s=this.m_colEndHeader,o=this.m_rowHeader,n=this.m_rowEndHeader,r=this.m_databody,l=r.firstChild;const a=this.m_databodyFrozenCol,h=this.m_databodyFrozenRow;let d=0,m=0;var c=this.getColumnHeaderHeight(),u=this.getColumnEndHeaderHeight(),_=this.getRowHeaderWidth(),g=this.getRowEndHeaderWidth();if(a&&(d=this.getElementWidth(a)),h&&(m=this.getElementHeight(h)),-1===this.m_endRowHeader&&-1!==this.m_endColHeader){let e=this._getLabel("column",this.m_columnHeaderLevelCount-1);e&&(_=this.getElementWidth(e))}else if(-1!==this.m_endRowHeader&&-1===this.m_endColHeader){let e=this._getLabel("row",this.m_rowHeaderLevelCount-1);e&&(c=this.getElementHeight(e))}var p=t-c-u-m,f=e-_-g-d;p<0&&(p=0),f<0&&(f=0);var C,y=this.m_utils.getScrollbarSize(),w=this.getResources().isRTLMode()?"right":"left";if(this._databodyEmpty())if(null==this.m_empty){C=this._buildEmptyText();var E=this.getElementHeight(C),v=this.getElementWidth(C);E>this.getElementHeight(l)&&this._setAllScrollableRegions("height",E),v>this.getElementWidth(l)&&this._setAllScrollableRegions("width",v),this.m_databody.firstChild.appendChild(C)}else C=this.m_empty,this.setElementDir(C,this.m_endColHeader>=0?c:0,"top");var x,H,b,S,R,I=this.getElementWidth(r.firstChild),z=this.getElementHeight(r.firstChild),F=this.isDatabodyHorizontalScrollbarRequired(f);F?(x=this.isDatabodyVerticalScrollbarRequired(p-y),r.style.overflow="auto"):(x=this.isDatabodyVerticalScrollbarRequired(p))?(F=this.isDatabodyHorizontalScrollbarRequired(f-y),r.style.overflow="auto"):r.style.overflow="hidden",this.m_hasHorizontalScroller=F,this.m_hasVerticalScroller=x,-1!==this.m_endColEndHeader?(H=Math.min(z+(F?y:0),p),b=F?H-y:H):(H=p,b=Math.min(z,F?H-y:H)),-1!==this.m_endRowEndHeader?(S=Math.min(I+(x?y:0),f),R=x?S-y:S):(S=f,R=Math.min(I,x?S-y:S));var M=_+R+d+(x?y:0),A=c+b+m+(F?y:0);if(this.setElementDir(o,0,w),this.setElementDir(o,c,"top"),this.setElementHeight(o,b),this.setElementDir(n,M,w),this.setElementDir(n,c,"top"),this.setElementHeight(n,b),this.setElementDir(i,_,w),this.setElementWidth(i,R),this.setElementDir(s,_,w),this.setElementDir(s,A,"top"),this.setElementWidth(s,R),[_,c]=this._setFrozenContainerDimension(S,H,_,g,c,u),this.setElementDir(r,c,"top"),this.setElementDir(r,_,w),this.setElementWidth(r,S),this.setElementHeight(r,H),-1===this.m_endRowHeader&&-1!==this.m_endColHeader&&this.m_rowHeaderScrollbarSpacer?(this.setElementDir(this.m_rowHeaderScrollbarSpacer,c,"top"),this.setElementHeight(this.m_rowHeaderScrollbarSpacer,H+u),this.setElementWidth(this.m_rowHeaderScrollbarSpacer,_)):-1!==this.m_endRowHeader&&-1===this.m_endColHeader&&this.m_columnHeaderScrollbarSpacer&&(this.setElementDir(this.m_columnHeaderScrollbarSpacer,_,"left"),this.setElementWidth(this.m_columnHeaderScrollbarSpacer,S+g),this.setElementHeight(this.m_columnHeaderScrollbarSpacer,c)),this.m_scrollWidth=I-R,this.m_scrollHeight=z-b,this.buildCorners(),this._adjustHeaderBorders(),this._updateGridlines(),this.m_utils.isTouchDevice()){var D=0,L=0;if(this.m_currentScrollLeft>this.m_scrollWidth&&(D=this.m_scrollWidth-this.m_currentScrollLeft),this.m_currentScrollTop>this.m_scrollHeight&&(L=this.m_scrollHeight-this.m_currentScrollTop),0!==D||0!==L){var T=this.adjustTouchScroll(D,L);D=T[0],L=T[1],this.scrollDelta(D,L)}}},A.prototype.resizeColumnWidthAndShift=function(e){var t=this.getResources().isRTLMode()?"right":"left",i=this.m_colHeader.style.display,s=this.m_colEndHeader.style.display;let o=this.m_resizingElement.classList.contains(this.getMappedStyle("frozenHeader")),n=!1;o?(this.m_databodyFrozenCol.style.display="none",this.m_colHeaderFrozen.style.display="none",this.m_colEndHeaderFrozen.style.display="none",this.m_databodyFrozenCorner&&(this.m_databodyFrozenCorner.style.display="none",n=!0)):(this.m_databody.style.display="none",this.m_colHeader.style.display="none",this.m_colEndHeader.style.display="none",this.m_databodyFrozenRow&&(this.m_databodyFrozenRow.style.display="none"));var r=this.getHeaderCellIndex(this.m_resizingElement);if(this.m_columnHeaderLevelCount>1&&this.m_resizingElement===this.m_resizingElement.parentNode.firstChild&&null!=this.m_resizingElement.nextSibling)for(r+=this._getAttribute(this.m_resizingElement.parentNode,"extent",!0)-1;this.isHidden("column",r);)r-=1;var l,a=this.createIndex(-1,r),h=this.getElementsInRange(this.createRange(a,a));if(h)for(let e=0;e<h.length;e++)l=this.getResources().isRTLMode()?["startResized"]:["endResized"],this._highlightElement(h[e],l);let d=this.m_colHeader.firstChild,m=this.m_colEndHeader.firstChild;o&&(d=this.m_colHeaderFrozen.firstChild,m=this.m_colEndHeaderFrozen.firstChild),this._shiftHeadersAlongAxisInContainer(d,r,e,t,this.getMappedStyle("colheadercell"),"column"),this._shiftHeadersAlongAxisInContainer(m,r,e,t,this.getMappedStyle("colendheadercell"),"column"),o?this._shiftCellsAlongAxis("column",e,r,null,this.m_frozenColIndex,n):(this._shiftCellsAlongAxis("column",e,r),this.m_databodyFrozenRow&&this._shiftFrozenCellsAlongAxis("column",e,r,!1)),o?(this.m_databodyFrozenCol.style.display="",this.m_colHeaderFrozen.style.display=i,this.m_colEndHeaderFrozen.style.display=s,this.m_databodyFrozenCorner&&(this.m_databodyFrozenCorner.style.display="")):(this.m_databody.style.display="",this.m_colHeader.style.display=i,this.m_colEndHeader.style.display=s,this.m_databodyFrozenRow&&(this.m_databodyFrozenRow.style.display=""))},A.prototype._shiftCellsAlongAxis=function(e,t,i,s,o,n,r){var l,a,h,d,m=[];let c=o;if(null==s&&(s=!1),"row"===e?(l="height",a="top",void 0===c&&(c=this.m_endRow),h=this.m_startCol,(this._isHighWatermarkScrolling()||!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&this.m_startCol<=this.m_frozenColIndex)&&(h=this._hasFrozenColumns()&&!n?this.m_frozenColIndex+1:this.m_startCol),!0===n&&!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&(h=0),d=this.m_endCol):(l="width",a=this.getResources().isRTLMode()?"right":"left",void 0===c&&(c=this.m_endCol),h=this.m_startRow,(this._isHighWatermarkScrolling()||!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&this.m_startRow<=this.m_frozenRowIndex)&&(h=this._hasFrozenRows()&&!n?this.m_frozenRowIndex+1:this.m_startRow),!0===n&&!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&(h=0),d=this.m_endRow),null!=this.m_databody.firstChild)for(var u=h;u<=d;u++){var _="row"===e?this.createIndex(i,u):this.createIndex(u,i),g=this._getCellByIndex(_),p=g[this.getResources().getMappedAttribute("context")],f=p.indexes[e],C=p.extents[e],y=i-f,w=C-y;m[u]&&m[u][i]||!0===s||(this.setElementDir(g,this.getElementDir(g,l)+t,l),"row"===e?this._updateTempArray(m,!0,u,i,p.extents.column,C-y):this._updateTempArray(m,!0,u,i,p.extents.row,C-y),r&&(this.isCellHidden(g)?g.style.display="none":g.style.display=""));var E=i;!0!==s&&(E=i+w);for(var v=E;v<=c;v++)if(!m[u]||!m[u][v]){_="row"===e?this.createIndex(v,u):this.createIndex(u,v),C=(p=(g=this._getCellByIndex(_))[this.getResources().getMappedAttribute("context")]).extents[e];var x=this.getElementDir(g,a)+t;this.setElementDir(g,x,a),"row"===e?this._updateTempArray(m,!0,u,v,p.extents.column,C):this._updateTempArray(m,!0,u,v,p.extents.row,C)}}},A.prototype._shiftFrozenCellsAlongAxis=function(e,t,i,s,o){const n=[];let r,l,a,h,d;"row"===e?(r="top",l=this.m_endRow,a=0,h=this.m_frozenColIndex,this._isHighWatermarkScrolling()||-1!==this.m_frozenColIndex&&null!==this.m_frozenColIndex||(a=this.m_startCol,h=this.m_endCol),this._isHighWatermarkScrolling()||this._hasFrozenColumns()||(h=this.m_endCol),d="height"):(r=this.getResources().isRTLMode()?"right":"left",l=this.m_endCol,a=0,h=this.m_frozenRowIndex,this._isHighWatermarkScrolling()||-1!==this.m_frozenRowIndex&&null!==this.m_frozenRowIndex||(a=this.m_startRow,h=this.m_endRow),this._isHighWatermarkScrolling()||this._hasFrozenRows()||(h=this.m_endRow),d="width");for(let m=a;m<=h;m++){let a="row"===e?this.createIndex(i,m):this.createIndex(m,i),h=this._getFrozenCellByIndex(a,e),c=h[this.getResources().getMappedAttribute("context")],u=c.extents[e],_=i-c.indexes[e],g=u-_;if(!(n[m]&&n[m][i]||!0===s)){this.setElementDir(h,this.getElementDir(h,d)+t,d),o&&(this.isCellHidden(h)?h.style.display="none":h.style.display="");const s="row"===e?"column":"row";this._updateTempArray(n,!0,m,i,c.extents[s],u-_)}let p=i;!0!==s&&(p=i+g);for(let i=p;i<=l;i++)if(!n[m]||!n[m][i]){a="row"===e?this.createIndex(i,m):this.createIndex(m,i),h=this._getFrozenCellByIndex(a,e),c=h[this.getResources().getMappedAttribute("context")],u=c.extents[e];let s=this.getElementDir(h,r)+t;this.setElementDir(h,s,r),"row"===e?this._updateTempArray(n,!0,m,i,c.extents.column,u):this._updateTempArray(n,!0,m,i,c.extents.row,u)}}},A.prototype.resizeRowHeightAndShift=function(e){var t=this.m_rowHeader.style.display,i=this.m_rowEndHeader.style.display;let s=this.m_resizingElement.classList.contains(this.getMappedStyle("frozenHeader")),o=!1;s?(this.m_databodyFrozenRow.style.display="none",this.m_rowHeaderFrozen.style.display="none",this.m_rowEndHeaderFrozen.style.display="none",this.m_databodyFrozenCorner&&(this.m_databodyFrozenCorner.style.display="none",o=!0)):(this.m_databody.style.display="none",this.m_rowHeader.style.display="none",this.m_rowEndHeader.style.display="none");var n=this.getHeaderCellIndex(this.m_resizingElement);this.m_rowHeaderLevelCount>1&&this.m_resizingElement===this.m_resizingElement.parentNode.firstChild&&null!=this.m_resizingElement.nextSibling&&(n+=this._getAttribute(this.m_resizingElement.parentNode,"extent",!0)-1);var r,l=this.createIndex(n,-1),a=this.getElementsInRange(this.createRange(l,l));if(a)for(let e=0;e<a.length;e++)r=["bottomResized"],this._highlightElement(a[e],r);let h=this.m_rowHeader.firstChild,d=this.m_rowEndHeader.firstChild;s&&(h=this.m_rowHeaderFrozen.firstChild,d=this.m_rowEndHeaderFrozen.firstChild),this._shiftHeadersAlongAxisInContainer(h,n,e,"top",this.getMappedStyle("rowheadercell"),"row"),this._shiftHeadersAlongAxisInContainer(d,n,e,"top",this.getMappedStyle("rowendheadercell"),"row"),s?this._shiftCellsAlongAxis("row",e,n,null,this.m_frozenRowIndex,o):(this._shiftCellsAlongAxis("row",e,n),this.m_databodyFrozenCol&&this._shiftFrozenCellsAlongAxis("row",e,n,!1)),s?(this.m_databodyFrozenRow.style.display="",this.m_rowHeaderFrozen.style.display=t,this.m_rowEndHeaderFrozen.style.display=i,this.m_databodyFrozenCorner&&(this.m_databodyFrozenCorner.style.display="",o=!0)):(this.m_databody.style.display="",this.m_rowHeader.style.display=t,this.m_rowEndHeader.style.display=i)},A.prototype._shiftHeadersAlongAxisInContainer=function(e,t,i,s,o,n,r){var l,a,h,d,m=0,c=this._getHeaderLastChild(e);if(null!=c){var u,_=this.m_utils.containsCSSClassName(c,o);for(_?(a=c.parentNode,l=c,h=this.getHeaderCellIndex(l)):(a=c,l=c.firstChild,h=this._getAttribute(a,"start",!0));t<h;)if(_)d=this.getElementDir(l,s)+i,this.setElementDir(l,d,s),c=this._getHeaderPreviousSibling(c),_=this.m_utils.containsCSSClassName(c,o),a=c.parentNode,l=c,h=this.getHeaderCellIndex(l);else{for(var g=a.getElementsByClassName(o),p=0;p<g.length;p++)d=this.getElementDir(g[p],s)+i,this.setElementDir(g[p],d,s);c=this._getHeaderPreviousSibling(c),_=this.m_utils.containsCSSClassName(c,o),a=c,l=c.firstChild,h=this._getAttribute(a,"start",!0)}if(this.m_resizingElement&&(u=this.getHeaderCellLevel(this.m_resizingElement)),"column"===n?(m=this.getElementWidth(l)+i,this.setElementWidth(l,m)):"row"===n?(m=this.getElementHeight(l)+i,this.setElementHeight(l,m)):null==n&&(d=this.getElementDir(l,s)+i,this.setElementDir(l,d,s)),r&&(this.isHeaderHidden(l)?l.style.display="none":l.style.display=""),("row"===n||"column"===n)&&!r){let e=this.getResources().isRTLMode()?["startResized"]:["endResized"],t="row"===n?["bottomResized"]:e;void 0!==u&&this.getHeaderCellLevel(l)>=u&&this._highlightElement(l,t),l!==this.m_resizingElement||l!==a.lastChild&&l!==a.firstChild||this._highlightResizeBorder(t,n)}_||null==l.nextSibling?null==n||r||"column"===n&&this.isHidden("column",t)||this.m_sizingManager.setSize(n,this._getKey(l),m):this._shiftHeadersAlongAxisInContainer(c,t,i,s,o,n,r)}},A.prototype._highlightResizeBorder=function(e,t){let i=this.getHeaderCellIndex(this.m_resizingElement),s="column"===t?this.m_columnHeaderLevelCount:this.m_rowHeaderLevelCount,o=this.m_resizingElement[this.getResources().getMappedAttribute("context")],n=o.index+o.extent-1;for(let o=0;o<s-1;o++){let s=this._getHeaderByIndex(i,t,o),r=s[this.getResources().getMappedAttribute("context")];r.index+r.extent-1===n&&this._highlightElement(s,e)}},A.prototype.resizeColumnHeightsAndShift=function(e,t,i,s){var o,n,r,l;i?(o=this.m_colEndHeader,n=this.getMappedStyle("colendheadercell"),r="columnEnd",l="bottom"):(o=this.m_colHeader,n=this.getMappedStyle("colheadercell"),r="column",l="top"),o.style.display="none",this.m_databody.style.display="none",this._hasFrozenColumns()&&(i?this.m_colEndHeaderFrozen.style.display="none":this.m_colHeaderFrozen.style.display="none",this.m_databodyFrozenCol.style.display="none"),s&&this._shiftLabelsDir(this.m_headerLabels[r],e,t,l,r),this._shiftHeadersDirInContainer(o.firstChild,e,t,l,n,r),this.m_colHeaderFrozen&&this._shiftHeadersDirInContainer(this.m_colHeaderFrozen.firstChild,e,t,l,n,r),o.style.display="",this.m_databody.style.display="",this._hasFrozenColumns()&&(i?this.m_colEndHeaderFrozen.style.display="":this.m_colHeaderFrozen.style.display="",this.m_databodyFrozenCol.style.display="")},A.prototype.resizeRowWidthsAndShift=function(e,t,i){var s,o,n,r;i?(s=this.m_rowEndHeader,o=this.getMappedStyle("rowendheadercell"),n="rowEnd",r=this.getResources().isRTLMode()?"left":"right"):(s=this.m_rowHeader,o=this.getMappedStyle("rowheadercell"),n="row",r=this.getResources().isRTLMode()?"right":"left"),s.style.display="none",this.m_databody.style.display="none",this._hasFrozenRows()&&(i?this.m_rowEndHeaderFrozen.style.display="none":this.m_rowHeaderFrozen.style.display="none",this.m_databodyFrozenRow.style.display="none"),this._shiftLabelsDir(this.m_headerLabels[n],e,t,r,n),this._shiftHeadersDirInContainer(s.firstChild,e,t,r,o,n),this.m_rowHeaderFrozen&&this._shiftHeadersDirInContainer(this.m_rowHeaderFrozen.firstChild,e,t,r,o,n),s.style.display="",this.m_databody.style.display="",this._hasFrozenRows()&&(i?this.m_rowEndHeaderFrozen.style.display="":this.m_rowHeaderFrozen.style.display="",this.m_databodyFrozenRow.style.display="")},A.prototype._shiftLabelsDir=function(e,t,i,s,o){for(var n=0;n<e.length;n++){var r,l=e[n];if(n===i)if("column"===o||"columnEnd"===o)if(r=this.getElementHeight(l)+t,this.setElementHeight(l,r),"column"===o&&this._isHeaderLabelCollision()&&i===this.m_columnHeaderLevelCount-1){let e=["bottomResized"];this._highlightElement(this.m_corner,e)}else if("columnEnd"===o){let e=["topResized"],t=this._getLabel("columnEnd",this.m_columnEndHeaderLevelCount-1);t&&this._highlightElement(t,e)}else{let e="column"===o?["bottomResized"]:["topResized"];this._highlightElement(l,e)}else{r=this.getElementWidth(l)+t,this.setElementWidth(l,r);let e=this.getResources().isRTLMode()?["startResized"]:["endResized"],i=this.getResources().isRTLMode()?["endResized"]:["startResized"],s="row"===o?e:i;this._highlightElement(l,s);let n=this._getLabel("columnEnd",this.m_columnEndHeaderLevelCount-1);n&&this._highlightElement(n.parentNode,s)}n>i&&(r=this.getElementDir(l,s)+t,this.setElementDir(l,r,s))}},A.prototype._shiftHeadersDirInContainer=function(e,t,i,s,o,n){for(var r=e.childNodes,l=0;l<r.length;l++){var a,h,d=r[l];if(this.m_utils.containsCSSClassName(d,o)){a=this.getHeaderCellLevel(d);var m=this.getHeaderCellDepth(d);if(a<=i&&i<a+m){if("column"===n||"columnEnd"===n){if(h=this.getElementHeight(d)+t,this.setElementHeight(d,h),this.m_resizingElement){var c=this.getMappedStyle("colendheadercell");if(this.m_utils.containsCSSClassName(d,c)){let e=["topResized"];this._highlightElement(d,e)}else{let e=["bottomResized"];this._highlightElement(d,e)}}}else if(h=this.getElementWidth(d)+t,this.setElementWidth(d,h),this.m_resizingElement){var u=this.getMappedStyle("rowendheadercell");if(this.m_utils.containsCSSClassName(d,u)){let e=this.getResources().isRTLMode()?["endResized"]:["startResized"];this._highlightElement(d,e)}else{let e=this.getResources().isRTLMode()?["startResized"]:["endResized"];this._highlightElement(d,e)}}}else a>i&&(h=this.getElementDir(d,s)+t,this.setElementDir(d,h,s))}else if((a=this._getAttribute(d,"level",!0))<=i)this._shiftHeadersDirInContainer(d,t,i,s,o,n);else for(var _=d.getElementsByClassName(o),g=0;g<_.length;g++)h=this.getElementDir(_[g],s)+t,this.setElementDir(_[g],h,s)}},A.prototype.handleContextMenuResize=function(e,t,i,s){this.m_overResizeLeft=0,this.m_overResizeMinLeft=0,this.m_overResizeTop=0,this.m_overResizeMinTop=0,this.m_overResizeRight=0,this.m_overResizeBottom=0;var o=parseFloat(i,10),n=o-this.getElementWidth(s),r=o-this.getElementHeight(s);this.m_utils.containsCSSClassName(s,this.getMappedStyle("cell"))&&(s=t===this.m_resources.getMappedCommand("resizeHeight")?this.getHeaderFromCell(s,"row",!0):this.getHeaderFromCell(s,"column",!0)),this.m_isResizing=!0,this.m_resizingElement=s;let l=this.find(this.m_resizingElement,"headerlabel");var a=this.getElementWidth(s),h=this.getElementHeight(s),d=this.m_utils.containsCSSClassName(this.m_resizingElement,this.getMappedStyle("endheadercell"))||this.m_utils.containsCSSClassName(this.m_resizingElement,this.getMappedStyle("columnendheaderlabel"))||this.m_utils.containsCSSClassName(this.m_resizingElement,this.getMappedStyle("rowendheaderlabel"));if(t===this.m_resources.getMappedCommand("resizeWidth")){if(a!==o)if("column"===this._getResizeHeaderMode(this.m_resizingElement)){if(this._isDOMElementResizable(this.m_resizingElement))if(l)this.m_utils.containsCSSClassName(this.m_resizingElement,this.getMappedStyle("columnendheaderlabel"))&&(d=!1),this.resizeRowWidth(o,o-a,d,l),this._fireResizeEvent(e,a,h,o,h,o),this._fireCellResizeEvent(e,a,h,o,h);else{let t=this.getNewElementWidth("column",a,d,n,l);this.resizeColWidth(a,t),this._resizeSelectedHeaders(e,a,h,o,h,o)}}else this.resizeRowWidth(o,o-a,d,l),this._fireResizeEvent(e,a,h,o,h,o),this._fireCellResizeEvent(e,a,h,o,h)}else if(t===this.m_resources.getMappedCommand("resizeHeight")&&h!==o)if("column"===this._getResizeHeaderMode(this.m_resizingElement))this.resizeColHeight(o,o-h,d),this._fireResizeEvent(e,a,h,a,o,o),this._fireCellResizeEvent(e,a,h,a,o);else if(this._isDOMElementResizable(this.m_resizingElement)){let t=this.getNewElementHeight("row",h,d,r,l);l?(this.m_utils.containsCSSClassName(this.m_resizingElement,this.getMappedStyle("rowendheaderlabel"))&&(d=!1),this.resizeColHeight(t,t-h,d),this._fireResizeEvent(e,a,h,a,o,o),this._fireCellResizeEvent(e,a,h,a,o)):(this.resizeRowHeight(h,t),this._resizeSelectedHeaders(e,a,h,a,t,o))}var m=this.getElementWidth(s),c=this.getElementHeight(s);m===a&&c===h||(this.buildCorners(),this.m_utils.isTouchDevice()&&this._moveTouchSelectionAffordance()),this._unhighlightResizeBorderColor(),this.m_resizingElement=null,this.m_resizingElementMin=null,this.m_isResizing=!1},A.prototype._highlightResizeMouseDown=function(){let e,t,i=this.getHeaderCellIndex(this.m_resizingElement),s=this._getResizeHeaderMode(this.m_resizingElement),o=this.m_utils.containsCSSClassName(this.m_resizingElement,this.getMappedStyle("endheadercell"))||this.m_utils.containsCSSClassName(this.m_resizingElement,this.getMappedStyle("columnendheaderlabel")),n=this.getResources().isRTLMode()?"right":"left",r=this.find(this.m_resizingElement,"headerlabel");if("col-resize"===this.m_cursor)if("column"===s)if(o=!r&&o,r)t=this.getHeaderLabelAxis(this.m_resizingElement),"column"===t||"columnEnd"===t?e=this.m_rowHeaderLevelCount-1:"row"!==t&&"rowEnd"!==t||(e=this.getHeaderLabelLevel(this.m_resizingElement)),this.resizeRowWidthsAndShift(0,e,o),o||(e===this.m_rowHeaderLevelCount-1||0===this.m_headerLabels.row.length&&this.m_headerLabels.column.length)&&this._highlightResizeLabelDirs("column",e);else{this.m_columnHeaderLevelCount>1&&this.m_resizingElement===this.m_resizingElement.parentNode.firstChild&&null!=this.m_resizingElement.nextSibling&&(i+=this._getAttribute(this.m_resizingElement.parentNode,"extent",!0)-1);let e,t=this.createIndex(-1,i),s=this.getElementsInRange(this.createRange(t,t));if(s)for(let t=0;t<s.length;t++)e=this.getResources().isRTLMode()?["startResized"]:["endResized"],this._highlightElement(s[t],e);let o=this.m_colHeader.firstChild,r=this.m_colEndHeader.firstChild;this.m_resizingElement.classList.contains(this.getMappedStyle("frozenHeader"))&&(o=this.m_colHeaderFrozen.firstChild,r=this.m_colEndHeaderFrozen.firstChild),this._shiftHeadersAlongAxisInContainer(o,i,0,n,this.getMappedStyle("colheadercell"),"column"),this._shiftHeadersAlongAxisInContainer(r,i,0,n,this.getMappedStyle("colendheadercell"),"column")}else"row"===s&&(this.m_utils.containsCSSClassName(this.m_resizingElement,this.getMappedStyle("rowendheaderlabel"))&&(o=!0),r?(t=this.getHeaderLabelAxis(this.m_resizingElement),"column"===t||"columnEnd"===t?e=this.m_rowHeaderLevelCount-1:"row"!==t&&"rowEnd"!==t||(e=this.getHeaderLabelLevel(this.m_resizingElement))):e=this.getHeaderCellLevel(this.m_resizingElement)+(this.getHeaderCellDepth(this.m_resizingElement)-1),this.resizeRowWidthsAndShift(0,e,o),o||(e===this.m_rowHeaderLevelCount-1||0===this.m_headerLabels.row.length&&this.m_headerLabels.column.length)&&this._highlightResizeLabelDirs("column",e));else if("row-resize"===this.m_cursor)if("row"===s)if(r){let i=!0;t=this.getHeaderLabelAxis(this.m_resizingElement),"column"===t||"columnEnd"===t?e=this.getHeaderLabelLevel(this.m_resizingElement):"row"!==t&&"rowEnd"!==t||(e=this.m_columnHeaderLevelCount-1,i=!1),!o&&e===this.m_columnHeaderLevelCount-1&&this.m_headerLabels.row.length&&this._isHeaderLabelCollision()&&(i=!1),this.resizeColumnHeightsAndShift(0,e,o,i),o||(0===this.m_headerLabels.column.length||e===this.m_columnHeaderLevelCount-1&&this.m_headerLabels.row.length)&&this._highlightResizeLabelDirs("row",e)}else{this.m_rowHeaderLevelCount>1&&this.m_resizingElement===this.m_resizingElement.parentNode.firstChild&&null!=this.m_resizingElement.nextSibling&&(i+=this._getAttribute(this.m_resizingElement.parentNode,"extent",!0)-1);let e,t=this.createIndex(i,-1),s=this.getElementsInRange(this.createRange(t,t));if(s)for(let t=0;t<s.length;t++)e=["bottomResized"],this._highlightElement(s[t],e);let o=this.m_rowHeader.firstChild,n=this.m_rowEndHeader.firstChild;this.m_resizingElement.classList.contains(this.getMappedStyle("frozenHeader"))&&(o=this.m_rowHeaderFrozen.firstChild,n=this.m_rowEndHeaderFrozen.firstChild),this._shiftHeadersAlongAxisInContainer(o,i,0,"top",this.getMappedStyle("rowheadercell"),"row"),this._shiftHeadersAlongAxisInContainer(n,i,0,"top",this.getMappedStyle("rowendheadercell"),"row")}else{let i=!0;r?(t=this.getHeaderLabelAxis(this.m_resizingElement),"column"===t||"columnEnd"===t?e=this.getHeaderLabelLevel(this.m_resizingElement):"row"!==t&&"rowEnd"!==t||(e=this.m_columnHeaderLevelCount-1,i=!1)):(e=this.getHeaderCellLevel(this.m_resizingElement)+(this.getHeaderCellDepth(this.m_resizingElement)-1),t=this.getHeaderCellAxis(this.m_resizingElement)),!o&&e===this.m_columnHeaderLevelCount-1&&this.m_headerLabels.row.length&&this._isHeaderLabelCollision()&&(i=!1),this.resizeColumnHeightsAndShift(0,e,o,i),o||(0===this.m_headerLabels.column.length||e===this.m_columnHeaderLevelCount-1&&this.m_headerLabels.row.length)&&this._highlightResizeLabelDirs("row",e)}},A.prototype.handleResizeFitToContent=function(e,t,i,s){this.m_resizingElement=t;const o=this.getHeaderCellAxis(t),n=this.getHeaderCellIndex(t),r=this.m_utils.containsCSSClassName(t,this.getMappedStyle("endheadercell"));let l;l=i?"column"===o?"height":"width":"contextmenu"===e.type||"col-resize"!==this.m_cursor&&"row-resize"!==this.m_cursor?"column"===o?"width":"height":"col-resize"===this.m_cursor?"width":"height";const a="column"===o||"columnEnd"===o,h="row"===o||"rowEnd"===o;if(this.isHidden(a?"column":"row",n))return;let d=[];if(i)d=s;else{const e=this.createIndex(a?-1:n,a?n:-1);d=this.getElementsInRange(this.createRange(e,e))||[],d.push(t)}const m=this.getElementWidth(this.m_resizingElement),c=this.getElementHeight(this.m_resizingElement);let u,_=m,g=c,p=!1;"width"===l?(_=this._calculateResizeFitToContentValue(d,l),u=_,a&&"enable"===this.m_options.isResizable("column","width")?(p=!0,this.resizeColWidth(m,_)):h&&"enable"===this.m_options.isResizable("row","width")&&(p=!0,this.resizeRowWidth(_,_-m,r,!1))):(g=this._calculateResizeFitToContentValue(d,l),u=g,a&&"enable"===this.m_options.isResizable("column","height")?(p=!0,this.resizeColHeight(g,g-c,r,!0)):h&&"enable"===this.m_options.isResizable("row","height")&&(p=!0,this.resizeRowHeight(c,g)));p&&(m!==_||c!==g)&&(this._fireResizeEvent(e,m,c,_,g,u),this._fireCellResizeEvent(e,m,c,_,g,[t])),this._unhighlightResizeBorderColor()},A.prototype._calculateResizeFitToContentValue=function(e,t){const i=this._getMinValue(t,"width"===t?"row":"column",!1),s=document.createElement("div");s.style.visibility="hidden",this.m_root.appendChild(s);for(let i=0;i<e.length;i++){const o=e[i].cloneNode(!0);"width"===t?o.style.width="fit-content":o.style.height="fit-content",s.appendChild(o)}let o=0;[...s.children].forEach(e=>{const i="width"===t?e.offsetWidth:e.offsetHeight;i>o&&(o=i)});const n="width"===t?this.m_databody.offsetWidth:this.m_databody.offsetHeight;return o=o<i?i:o,o=o>n?n:o,this.m_root.removeChild(s),o},A.prototype.getHeaderEdgePixels=function(e){var t=0,i=0;if(this.m_utils.isTouchDevice()){var s=this.findPos(e);t=s[0],i=s[1]}return[t,i,t+this.getElementWidth(e),i+this.getElementHeight(e)]},A.prototype.unhighlightSelection=function(){for(var e=this.GetSelection(),t=0;t<e.length;t+=1)this.unhighlightRange(e[t]);this.getResources()&&this._clearHeaderHighLight()},A.prototype.unhighlightRange=function(e){var t=this.getElementsInRange(e);if(!this._isHighWatermarkScrolling()&&null!==t)if(-1===e.endIndex.row&&this._hasFrozenRows())for(let i=e.startIndex.column;i<=e.endIndex.column;i++)for(let e=0;e<this.m_frozenRowIndex+1;e++)t.push(this._getCellByIndex({row:e,column:i}));else if(-1===e.endIndex.column&&this._hasFrozenColumns())for(let i=e.startIndex.row;i<=e.endIndex.row;i++)for(let e=0;e<this.m_frozenColIndex+1;e++)t.push(this._getCellByIndex({row:i,column:e}));this.unhighlightElems(t),this._applyBorderClassesAroundRange(t,e,!1,"Selected")},A.prototype.highlightRange=function(e,t){const i=this.getHeadersByRange(e,"row"),s=this.getHeadersByRange(e,"column");if(!this._isHighWatermarkScrolling()){if(-1===e.endIndex.row&&this._hasFrozenRows())for(let e=0;e<this.m_frozenRowIndex+1;e++)this._getHeadersByIndex(e,"row").forEach(e=>i.add(e)),this._getHeadersByIndex(e,"rowEnd").forEach(e=>i.add(e));if(-1===e.endIndex.column&&this._hasFrozenColumns())for(let e=0;e<this.m_frozenColIndex+1;e++)this._getHeadersByIndex(e,"column").forEach(e=>s.add(e)),this._getHeadersByIndex(e,"columnEnd").forEach(e=>s.add(e))}this._highlightHeaders(e,i,s);var o,n=this.getElementsInRange(e);if(!this._isHighWatermarkScrolling())if(-1===e.endIndex.row&&this._hasFrozenRows())for(let t=e.startIndex.column;t<=e.endIndex.column;t++)for(let e=0;e<this.m_frozenRowIndex+1;e++)n.push(this._getCellByIndex({row:e,column:t}));else if(-1===e.endIndex.column&&this._hasFrozenColumns())for(let t=e.startIndex.row;t<=e.endIndex.row;t++)for(let e=0;e<this.m_frozenColIndex+1;e++)n.push(this._getCellByIndex({row:t,column:e}));(this.highlightElems(n,e),this._applyBorderClassesAroundRange(n,e,!0,"Selected"),t)&&(o=1===this.GetSelection().length?n.length:this._getCurrentSelectionCellCount(),this._setAccInfoText("accessibleMultiCellSelected",{num:o}))},A.prototype.getHeadersByRange=function(e,t){const i=new Set;let s,o,n,r;if("row"===t&&this.m_rowHeaderLevelCount>0){e.endIndex&&e.endIndex.row&&(r=e.endIndex.row),r||null==e.startIndex.row?-1!==r&&null!=e.startIndex.row||(r=this.m_endRowHeader):r=e.startIndex.row;let l=this.m_startRowHeader;!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&this.m_startRowHeader===this.m_frozenRowIndex+1&&(l=0);let a=e.startIndex.row?Math.max(l,e.startIndex.row):this.m_startRowHeader;for(!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&0===e.startIndex.row&&(a=Math.max(l,e.startIndex.row)),o=a;o<=r;o++)for(s=this._getHeadersByIndex(o,t),n=0;n<s.length;n++)i.add(s[n])}else if("column"===t&&this.m_columnHeaderLevelCount>0){e.endIndex&&e.endIndex.column&&(r=e.endIndex.column),r||null==e.startIndex.column?-1!==r&&null!=e.startIndex.column||(r=this.m_endColHeader):r=e.startIndex.column;let l=this.m_startColHeader;!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&this.m_startColHeader===this.m_frozenColIndex+1&&(l=0);let a=e.startIndex.column?Math.max(l,e.startIndex.column):this.m_startColHeader;for(!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&0===e.startIndex.column&&(a=Math.max(l,e.startIndex.column)),o=a;o<=r;o++)for(s=this._getHeadersByIndex(o,t),n=0;n<s.length;n++)i.add(s[n])}if("row"===t&&this.m_rowEndHeaderLevelCount>0){e.endIndex&&e.endIndex.row&&(r=e.endIndex.row),r||null==e.startIndex.row?-1!==r&&null!=e.startIndex.row||(r=this.m_endRowHeader):r=e.startIndex.row;let t=this.m_startRowEndHeader;!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&this.m_startRowEndHeader===this.m_frozenRowIndex+1&&(t=0);let l=e.startIndex.row?Math.max(t,e.startIndex.row):this.m_startRowEndHeader;for(!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&0===e.startIndex.row&&(l=Math.max(t,e.startIndex.row)),o=l;o<=r;o++)for(s=this._getHeadersByIndex(o,"rowEnd"),n=0;n<s.length;n++)i.add(s[n])}else if("column"===t&&this.m_columnEndHeaderLevelCount>0){e.endIndex&&e.endIndex.column&&(r=e.endIndex.column),r||null==e.startIndex.column?-1!==r&&null!=e.startIndex.column||(r=this.m_endColHeader):r=e.startIndex.column;let t=this.m_startColEndHeader;!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&this.m_startColEndHeader===this.m_frozenColIndex+1&&(t=0);let l=e.startIndex.column?Math.max(t,e.startIndex.column):this.m_startColEndHeader;for(!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&0===e.startIndex.column&&(l=Math.max(t,e.startIndex.column)),o=l;o<=r;o++)for(s=this._getHeadersByIndex(o,"columnEnd"),n=0;n<s.length;n++)i.add(s[n])}return i},A.prototype._highlightHeaders=function(e,t,i){t.forEach(t=>{const i=t[this.getResources().getMappedAttribute("context")];null==e?.endIndex?.column||-1===e.endIndex.row&&-1===e.endIndex.column||-1===e.endIndex.column&&0===e.startIndex.column&&this._isHeaderSelected(i,"row")?(t.classList.remove(this.getMappedStyle("headerPartialSelected")),t.classList.add(this.getMappedStyle("headerAllSelected"))):(t.classList.remove(this.getMappedStyle("headerAllSelected")),t.classList.add(this.getMappedStyle("headerPartialSelected")))}),i.forEach(t=>{const i=t[this.getResources().getMappedAttribute("context")];null==e?.endIndex?.row||-1===e.endIndex.row&&-1===e.endIndex.column||-1===e.endIndex.row&&0===e.startIndex.row&&this._isHeaderSelected(i,"column")?(t.classList.remove(this.getMappedStyle("headerPartialSelected")),t.classList.add(this.getMappedStyle("headerAllSelected"))):(t.classList.remove(this.getMappedStyle("headerAllSelected")),t.classList.add(this.getMappedStyle("headerPartialSelected")))})},A.prototype._isHeaderSelected=function(e,t){let i=!1;return this.GetSelection().forEach(s=>{e.index>=s.startIndex[t]&&e.index+(e.extent-1)<=s.endIndex[t]&&(i=!0)}),i},A.prototype._clearHeaderHighLight=function(){const e=this.getMappedStyle("headerAllSelected"),t=this.getMappedStyle("headerPartialSelected"),i=this.getMappedStyle("headercell"),s=this.getMappedStyle("endheadercell"),o=this.m_root.querySelectorAll("."+e+"."+i+",."+e+"."+s+",."+t+"."+i+",."+t+"."+s);for(let i=0;i<o.length;i++)o[i].classList.remove(e,t,this.getMappedStyle("draggableItem"))},A.prototype._getCurrentSelectionCellCount=function(){for(var e=0,t=this.GetSelection(),i=0;i<t.length;i++){var s=this.getElementsInRange(t[i]);null!=s&&(e+=s.length)}return e},A.prototype.unhighlightElems=function(e){if(null!=e&&0!==e.length)for(let t=0;t<e.length;t+=1){let i=e[t],s=["selected","topSelected","bottomSelected","startSelected","endSelected"];this._unhighlightElement(i,s)}},A.prototype.highlightElems=function(e){if(null!=e&&0!==e.length)for(let t=0;t<e.length;t+=1)this._highlightElement(e[t],["selected"])},A.prototype.applySelection=function(e,t,i,s){for(var o=this.GetSelection(),n=0;n<o.length;n+=1){var r=this.getElementsInRange(o[n],e,t,i,s);if(this.highlightElems(r),this._applyBorderClassesAroundRange(r,o[n],!0,"Selected"),this.m_dragIndex&&r&&r.length)for(let e=0;e<r.length;e++)this._highlightElement(r[e],["dragSourceOpaque"])}},A.prototype.handleDatabodySelectionDrag=function(e){var t,i;if(this.m_utils.isTouchDevice()?t=this.findCell(document.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY)):(i=e.target,t=this.findCell(i)),null!=t){var s=this.getCellIndexes(t);this.m_deselectInProgress?this.extendDeselection(s,e):this.isHeaderSelectionType(this.m_selectionFrontier)?this.extendSelectionHeader(t,e):this.extendSelection(s,e)}},A.prototype.handleHeaderClickSelection=function(e){var t,i,s,o,n=e.target,r=this.findHeader(n),l=e.shiftKey,a=this.isMultipleSelection(),h=this.m_utils.ctrlEquivalent(e);if(l&&a||!r||this._setActive(r,this._createActiveObject(r),e,null,null,!0),null==this.m_active||"header"!==this.m_active.type&&!e.shiftKey)return!1;var d=r[this.getResources().getMappedAttribute("context")];if(t=d.axis,i=d.index,o=d.extent,h&&this._shouldDeselectHeader(i,o,t)){var m,c,u,_;-1!==t.indexOf("row")?(m=this.createIndex(i,0),c=this.createIndex(i+o-1,-1),_=this._getSelectionStartAndEnd(m,c,0),u=this.createRange(this.createIndex(_.min.row,0),this.createIndex(_.max.row,-1))):(m=this.createIndex(0,i),c=this.createIndex(-1,i+o-1),_=this._getSelectionStartAndEnd(m,c,0),u=this.createRange(this.createIndex(0,_.min.column),this.createIndex(-1,_.max.column)));var g=this._trimRangeForSelectionMode(u);return this.m_deselectInfo={anchor:g.startIndex,selection:this.GetSelection(),axis:-1!==t.indexOf("row")?"row":"column",sourceParent:r},void(this.m_deselectInProgress=this._deselectRange(g,e))}"header"===this.m_active.type&&(t=this.m_active.axis,i=this.m_active.index,s=this.m_active.level),this.m_utils.isTouchDevice()?(this._removeTouchSelectionAffordance(),this._selectHeader(t,i,s,e)):l&&a?(null==t&&(t=d.axis),(-1!==t.indexOf("row")&&-1!==d.axis.indexOf("row")||-1!==t.indexOf("column")&&-1!==d.axis.indexOf("column"))&&this.extendSelectionHeader(r,e)):this._isHeaderInsideSelection(i,t)&&1!==e.buttons||this._selectHeader(t,i,s,e)},A.prototype.discontiguousHeaderSetActiveFromDatabody=function(e,t,i,s){var o=t.replace("End",""),n=this.m_selection[this.m_selection.length-1];this.unhighlightSelection(),n.startIndex.row===this.m_active.indexes.row&&n.endIndex.row===this.m_active.indexes.row&&n.startIndex.column===this.m_active.indexes.column&&n.endIndex.column===this.m_active.indexes.column&&this.m_selection.pop(),this._setActive(i,{type:"header",index:this.m_trueIndex[o],level:s-1,axis:t},e,!1),this.rehighlightSelection()},A.prototype.handleDragAnchorChange=function(e){if(this.m_headerDragState){var t,i,s=e.target,o=this.findHeader(s),n=o[this.getResources().getMappedAttribute("context")],r=this._getActiveElement(),l=r[this.getResources().getMappedAttribute("context")],a=this._getAttribute(r.parentNode,"start",!0),h=a+(this._getAttribute(r.parentNode,"extent",!0)-1);if(!n.extent)return;1===n.extent?(t=n.index,i=n.index):i=(t=this._getAttribute(o.parentNode,"start",!0))+(this._getAttribute(o.parentNode,"extent",!0)-1),1!==l.extent?(t<=a&&i>=h||t>=a&&i<=h)&&this._setActive(o,this._createActiveObject(o),e,null,null,!0):t!==i&&t<=a&&a<=i&&this._setActive(o,this._createActiveObject(o),e,null,null,!0)}},A.prototype.handleDatabodyClickSelection=function(e){var t,i=e.target,s=this.findCell(i);if(null!=s&&(t=this.getCellIndexes(s)),null!=t){if(this.isMultipleSelection()&&2===e.button&&this._isContainSelection(t))return;var o=this.m_utils.ctrlEquivalent(e),n=e.shiftKey;if(this.m_utils.containsCSSClassName(s,this.getMappedStyle("selected"))&&o){this.m_deselectInfo={anchor:t,selection:this.GetSelection()};var r=this.getCellEndIndexes(s),l=this._trimRangeForSelectionMode(this.createRange(t,r));return void(this.m_deselectInProgress=this._deselectRange(l,e))}if(this.isMultipleSelection())if(this._removeTouchSelectionAffordance(),this.m_utils.isTouchDevice())null!=this.m_active&&this._unhighlightActive(),this.selectAndFocus(t,e,!1);else if(o)o&&n?this.extendSelection(t,e):this.selectAndFocus(t,e,!0);else if(n)this.extendSelection(t,e);else{let i=!0;this.selectAndFocus(t,e,!1,i)}else this.selectAndFocus(t,e,!1)}},A.prototype._doRangesOverlap=function(e,t){var i=e.startIndex,s=i.column,o=i.row,n=e.endIndex,r=n.column,l=n.row,a=t.startIndex,h=a.column,d=a.row,m=t.endIndex,c=m.column,u=m.row;return(s<=c||-1===c||void 0===c)&&(r>=h||-1===r||void 0===r)&&(o<=u||-1===u)&&(l>=d||-1===l)},A.prototype._isRangeValid=function(e){return(e.startIndex.row<=e.endIndex.row||e.startIndex.row>=0&&-1===e.endIndex.row)&&(e.startIndex.column<=e.endIndex.column||e.startIndex.column>=0&&-1===e.endIndex.column||void 0===e.startIndex.column&&void 0===e.endIndex.column)},A.prototype._deselectRange=function(e,t){var i=this.m_deselectInfo.selection,s=e.startIndex,o=s.column,n=s.row,r=e.endIndex,l=r.column,a=r.row,h=!1,d=[],m=0,c=[],u=this;return i.forEach(function(t){var i=t.startIndex,s=i.column,r=i.row,_=t.endIndex,g=_.column,p=_.row;if(this._doRangesOverlap(t,e)){var f,C,y=function(e,t,i){return new Promise(function(s){u._createRangeWithKeys(e,t,function(e){d[i]=e,s()})})};h=!0,r<n&&(f=this.createIndex(r,s),C=this.createIndex(n-1,g),this._isRangeValid({startIndex:f,endIndex:C})&&(c.push(y(f,C,m)),m+=1)),-1!==a&&(f=this.createIndex(a+1,s),C=this.createIndex(p,g),this._isRangeValid({startIndex:f,endIndex:C})&&(c.push(y(f,C,m)),m+=1)),s<o&&void 0!==s&&(f=this.createIndex(Math.max(n,r),s),C=this.createIndex(Math.min(-1===a?p:a,-1===p?a:p),o-1),this._isRangeValid({startIndex:f,endIndex:C})&&(c.push(y(f,C,m)),m+=1)),-1!==l&&void 0!==s&&(f=this.createIndex(Math.max(n,r),l+1),C=this.createIndex(Math.min(-1===a?p:a,-1===p?a:p),g),this._isRangeValid({startIndex:f,endIndex:C})&&(c.push(y(f,C,m)),m+=1))}else d[m]=t,m+=1},this),!!h&&(Promise.all(c).then(function(){var e=u.m_selection;u.SetSelection(d),u._compareSelectionAndFire(t,e)}),!0)},A.prototype._shouldDeselectHeader=function(e,t,i){var s,o,n=this.GetSelection();"row"===i||"rowEnd"===i?(s="row",o="column"):(s="column",o="row");var r=!1,l=this.m_options.getSelectionMode();return n.forEach(function(i){var n=i.startIndex[o],a=i.endIndex[o];if(0===n&&-1===a||"row"===l&&"row"===s){var h=i.startIndex[s],d=i.endIndex[s];h<=e&&(d>=e+t-1||-1===d)&&(r=!0)}}),r},A.prototype._handleSelectAll=function(e){return!(!this._isSelectionEnabled()||!this.isMultipleSelection())&&("row"===this.m_options.getSelectionMode()?this._selectRange(this.createIndex(0),this.createIndex(-1),e):this._selectRange(this.createIndex(0,0),this.createIndex(-1,-1),e),this.m_utils.isTouchDevice()&&this.m_topSelectIconContainer&&this.m_bottomSelectIconContainer&&(this.m_topSelectIconContainer.parentNode.removeChild(this.m_topSelectIconContainer),this.m_bottomSelectIconContainer.parentNode.removeChild(this.m_bottomSelectIconContainer)),!0)},A.prototype._isContainSelection=function(e,t){null==t&&(t=this.GetSelection());for(var i=0;i<t.length;i+=1){var s=t[i],o=s.startIndex,n=this.getEndIndex(s),r=o.row,l=n.row;if(e.row>=r&&(-1===l||e.row<=l)){var a=o.column,h=n.column;if(isNaN(a)||isNaN(h))return!0;if(e.column>=a&&(-1===h||e.column<=h))return!0}}return!1},A.prototype._isHeaderInsideSelection=function(e,t){const i=this.GetSelection();for(let s=0;s<i.length;s+=1){let o=i[s],n=o.startIndex,r=this.getEndIndex(o),l=n.row,a=r.row,h=n.column,d=r.column;if("column"===t||"columnEnd"===t){if(e>=h&&(-1===d||e<=d)&&0===l&&-1===a)return!0}else if(("row"===t||"rowEnd"===t)&&e>=l&&(-1===a||e<=a)&&(0===h&&-1===d||void 0===h&&void 0===d))return!0}return!1},A.prototype._compareSelections=function(e,t){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i+=1){for(var s=!1,o=0;o<t.length;o+=1)this._compareIndividualSelectionObjects(e[i],t[o])&&(s=!0);if(!1===s)return!1}return!0},A.prototype._compareIndividualSelectionObjects=function(e,t){return e.startIndex.row===t.startIndex.row&&e.startIndex.column===t.startIndex.column&&e.endIndex.row===t.endIndex.row&&e.endIndex.column===t.endIndex.column},A.prototype._clearSelection=function(e){this.unhighlightSelection(),this._removeTouchSelectionAffordance();var t=this.GetSelection();this.m_selection=[],this._compareSelectionAndFire(e,t)},A.prototype.setDiscontiguousSelectionMode=function(e){this.m_discontiguousSelection=e,this._setAccInfoText(e?"accessibleRangeSelectModeOn":"accessibleRangeSelectModeOff")},A.prototype._selectEntireRow=function(e,t,i){var s=this.createIndex(e,0),o=this.createIndex(t,-1),n=this._getSelectionStartAndEnd(s,o,0);"row"===this.m_options.getSelectionMode()?this._selectRange(this.createIndex(n.min.row),this.createIndex(n.max.row),i):this._selectRange(this.createIndex(n.min.row,0),this.createIndex(n.max.row,-1),i)},A.prototype._selectEntireColumn=function(e,t,i){var s=this.createIndex(0,e),o=this.createIndex(-1,t),n=this._getSelectionStartAndEnd(s,o,0);this._selectRange(this.createIndex(0,n.min.column),this.createIndex(-1,n.max.column),i)},A.prototype._selectRange=function(e,t,i){this.unhighlightSelection(),this._createRangeWithKeys(e,t,this._selectRangeCallback.bind(this,i))},A.prototype._selectRangeCallback=function(e,t){var i,s=this.GetSelection();(i=this.m_discontiguousSelection||!e||this.m_utils.ctrlEquivalent(e)&&this.isMultipleSelection()&&0===e.button?this.m_utils.ctrlEquivalent(e)&&this.isMultipleSelection()&&!0===e.shiftKey?s.slice(0,s.length-1):s.slice(0):[]).push(t),this.m_selection=i,this.rehighlightSelection(),this._isDatabodyCellActive()&&e.target[this.getResources().getMappedAttribute("context")]&&!e.target[this.getResources().getMappedAttribute("context")].axis&&!this.m_selectionFrontier.axis&&(this.m_selectionFrontier=this.m_active.indexes,this._highlightActive()),this._compareSelectionAndFire(e,s)},A.prototype.rehighlightSelection=function(){for(var e=0;e<this.m_selection.length;e++)this.highlightRange(this.m_selection[e])},A.prototype.GetSelection=function(){return null==this.m_selection&&(this.m_selection=[]),this.m_selection},A.prototype.SetSelection=function(e){void 0!==e&&(null===e&&(e=[]),this.unhighlightSelection(),this.m_selection=e,this._resetHeaderHighLight(),null!=this.m_databody&&this.applySelection(this.m_startRow,this.m_endRow,this.m_startCol,this.m_endCol),this.m_bottomFloodFillIconContainer&&(1===this.m_selection.length?this._moveFloodFillAffordance():this._removeFloodFillAffordance()),this.m_utils.isTouchDevice()&&void 0!==this.m_resources&&this._moveTouchSelectionAffordance())},A.prototype.fireSelectionEvent=function(e,t){var i={event:e,ui:{selection:this.GetSelection(),previousSelection:t}};this.fireEvent("select",i)},A.prototype.extendSelection=function(e,t,i){if(this.m_active&&"header"!==this.m_active.type){var s;if(this.m_utils.isTouchDevice())s=this.m_touchSelectAnchor;else s={row:this.m_active.indexes.row,column:this.m_active.indexes.column};if(null!=s){this._resetSelectionFrontierFocus();var o=this._updateSelectionFrontier(s,e,i),n=o.min,r=o.max;if("row"===this.m_options.getSelectionMode()&&(n=this.createIndex(n.row),r=this.createIndex(r.row)),this.m_discontiguousSelection&&(this.m_deselectInProgress||this._isContainSelection(s,this.GetSelection().slice(0,-1)))){this.m_deselectInProgress||(this.m_deselectInfo={anchor:s,selection:this.GetSelection()});var l=this._trimRangeForSelectionMode(this.createRange(n,r));this.m_deselectInProgress=this._deselectRange(l,t)}else this._createRangeWithKeys(n,r,this._extendSelectionCallback.bind(this,t,s))}}},A.prototype.extendDeselection=function(e,t){var i=this.m_deselectInfo.anchor,s=this._updateSelectionFrontier(i,e),o=s.min,n=s.max,r=this._trimRangeForSelectionMode(this.createRange(o,n));this._deselectRange(r,t)},A.prototype.extendSelectionHeader=function(e,t,i,s){if(null!=e){var o=this.findCellOrHeader(e);if(null!==o){var n,r,l,a,h,d=o[this.getResources().getMappedAttribute("context")];if(null==i&&(i=this.m_discontiguousSelection),d){if(d.cell)a=l=-1!==this.m_selectionFrontier.axis.indexOf("column")?d.indexes.column:d.indexes.row,h=l;else{if(this.m_selectionFrontier&&d.index===this.m_selectionFrontier.index&&d.level===this.m_selectionFrontier.level)return;1===d.extent?(l=d.index,a=d.index,h=d.index):a=(l=this._getAttribute(e.parentNode,"start",!0))+(this._getAttribute(e.parentNode,"extent",!0)-1)}var m=s?this.m_deselectInfo.sourceParent:this._getActiveElement();if(m){var c,u,_,g=m[this.getResources().getMappedAttribute("context")];if(s?(r=this.m_deselectInfo.axis,n=this.m_deselectInfo.anchor[r],u=(c=this._getAttribute(m.parentNode,"start",!0))+(this._getAttribute(m.parentNode,"extent",!0)-1)):this.m_utils.isTouchDevice()?(-1===(n=-1!==this.m_selectionFrontier.axis.indexOf("column")?this.m_touchSelectAnchor.column:this.m_touchSelectAnchor.row)&&(n=0),c=n,u=n,r=this.m_selectionFrontier.axis):(u=(c=this._getAttribute(m.parentNode,"start",!0))+(this._getAttribute(m.parentNode,"extent",!0)-1),"header"===this.m_active.type&&(r=this.m_active.axis,n=this.m_active.index)),"cell"===this.m_active.type?(_=1,n=-1!==(r=d.axis).indexOf("row")?this.m_active.indexes.row:this.m_active.indexes.column):_=g.extent,i&&!s){var p=this.m_selection[this.m_selection.length-1];this.unhighlightSelection(),p&&this.checkCorners(r,n,p)&&this.m_selection.pop()}if(1!==_?l<=c&&a>=u||l>=c&&a<=u?(this.m_headerDragState||this._setActive(o,this._createActiveObject(o),t),n=l,h=a):l>c&&a>u?(n=c,h=a):l<c&&a<u&&(n=l,h=u):1===_&&l!==a&&(l<=n&&n<=a?(this.m_headerDragState||"cell"===this.m_active.type||this._setActive(o,this._createActiveObject(o),t),n=l,h=a):l<=n&&a<=n?(h=n,n=l):l>=n&&a>=n&&(h=a)),d.cell?this.setHeaderSelectionFrontier(r,h,h,this.m_selectionFrontier.level,o,!0):this.setHeaderSelectionFrontier(r,h,d.index,d.level,o,!0),!s&&r)-1!==r.indexOf("column")?this._selectEntireColumn(n,h,t):-1!==r.indexOf("row")&&this._selectEntireRow(n,h,t);else{var f,C=Math.min(n,h),y=Math.max(n,h);f=null!=r&&-1!==r.indexOf("row")?this.createRange(this.createIndex(C,0),this.createIndex(y,-1)):this.createRange(this.createIndex(0,C),this.createIndex(-1,y));var w=this._trimRangeForSelectionMode(f);this._deselectRange(w,t)}}}}}},A.prototype._updateSelectionFrontier=function(e,t,i){var s,o,n;if("row"===this.m_options.getSelectionMode()?(s=this.createIndex(e.row,this.m_startCol),o=this.createIndex(t.row,this.m_endCol)):(s=e,o=t),null!=i){if(this.m_deselectInProgress)n=this.createRange(this.m_deselectInfo.anchor,this.m_selectionFrontier);else{var r=this.GetSelection();n=r[this._getLastAnchoredSelectionIndex(r,s)]}var l=n.startIndex,a=n.endIndex;l.row===this.m_selectionFrontier.row&&s.row!==l.row?s.row=a.row:a.row===this.m_selectionFrontier.row&&s.row!==a.row&&(s.row=l.row),l.column===this.m_selectionFrontier.column&&s.column!==l.column?s.column=a.column:a.column===this.m_selectionFrontier.column&&s.column!==a.column&&(s.column=l.column)}var h=this._getSelectionStartAndEnd(s,o,0),d=o;if(null!=i){var m=h.min,c=h.max;for("row"===this.m_options.getSelectionMode()&&(m=this.createIndex(m.row),c=this.createIndex(c.row));this._compareIndividualSelectionObjects(n,this.createRange(m,c));){if(i===this.keyCodes.LEFT_KEY){if(0===o.column)break;o.column-=1}else if(i===this.keyCodes.RIGHT_KEY){if(o.column===this.m_endCol)break;o.column+=1}else if(i===this.keyCodes.UP_KEY){if(0===o.row)break;o.row-=1}else{if(i!==this.keyCodes.DOWN_KEY)break;if(o.row===this.m_endRow)break;o.row+=1}m=(h=this._getSelectionStartAndEnd(s,o,0)).min,c=h.max,"row"===this.m_options.getSelectionMode()&&(m=this.createIndex(m.row),c=this.createIndex(c.row))}i===this.keyCodes.LEFT_KEY?(d.column=m.column<s.column?m.column:c.column,d.row=m.row<s.row?m.row:c.row):i===this.keyCodes.RIGHT_KEY?(d.column=c.column>s.column?c.column:m.column,d.row=m.row<s.row?m.row:c.row):i===this.keyCodes.UP_KEY?(d.row=m.row<s.row?m.row:c.row,d.column=m.column<s.column?m.column:c.column):i===this.keyCodes.DOWN_KEY&&(d.row=c.row>s.row?c.row:m.row,d.column=m.column<s.column?m.column:c.column)}else d=this.getCellIndexes(this._getCellByIndex(d));return"row"===this.m_options.getSelectionMode()&&(d=this.createIndex(d.row,this.m_active.indexes.column)),this.m_selectionFrontier=d,h},A.prototype._getMinOrMax=function(e,t,i){return isNaN(e)?isNaN(t)?null:t:isNaN(t)?e:i(e,t)},A.prototype._getSelectionStartAndEnd=function(e,t,i){var s=this.getElementsInRange(this.createRange(e,t));if(null==s||s.length===i)return{min:e,max:t};for(var o={row:this._getMinOrMax(e.row,t.row,Math.min),column:this._getMinOrMax(e.column,t.column,Math.min)},n={row:this._getMinOrMax(e.row,t.row,Math.max),column:this._getMinOrMax(e.column,t.column,Math.max)},r=0;r<s.length;r++){var l=this.getCellIndexes(s[r]),a=this.getCellEndIndexes(s[r]);(l.row<o.row||null==o.row)&&(o.row=l.row),(l.column<o.column||null==o.column)&&(o.column=l.column),(a.row>n.row||null==n.row)&&(n.row=a.row),(a.column>n.column||null==n.column)&&(n.column=a.column)}return this._getSelectionStartAndEnd(o,n,s.length)},A.prototype._getLastAnchoredSelectionIndex=function(e,t){var i;for(i=e.length-1;i>-1;i--)if(this._isContainSelection(t,[e[i]]))return i;return i-1},A.prototype._extendSelectionCallback=function(e,t,i){var s=this.GetSelection(),o=this._getLastAnchoredSelectionIndex(s,t),n=s[o];if(null!=n){var r=n.startIndex.row===i.startIndex.row;null!=n.startIndex.column&&null!=i.startIndex.column&&(r=r&&n.startIndex.column===i.startIndex.column);var l=n.endIndex.row===i.endIndex.row;if(null!=n.endIndex.column&&null!=i.endIndex.column&&(l=l&&n.endIndex.column===i.endIndex.column),!r||!l){var a;if(this.m_discontiguousSelection||e&&this.m_utils.ctrlEquivalent(e)&&0===e.button?(a=s.slice(0),this.unhighlightRange(n),a.splice(o,1)):(a=[],this.unhighlightSelection()),a.push(i),this.m_selection=a,this.m_discontiguousSelection||e&&this.m_utils.ctrlEquivalent(e)&&0===e.button)for(var h=0;h<this.m_selection.length;h++)this.highlightRange(this.m_selection[h]);else this.highlightRange(i,!0);this._makeSelectionFrontierFocus(),this._compareSelectionAndFire(e,s)}}},A.prototype._resetSelectionFrontierFocus=function(){if(!(null==this.m_selectionFrontier||this._isDatabodyCellActive()&&this.m_selectionFrontier.row===this.m_active.indexes.row&&this.m_selectionFrontier.column===this.m_active.indexes.column)){var e=this.createRange(this.m_selectionFrontier),t=this.getElementsInRange(e);null!=t&&t.length>0&&this._unsetAriaProperties(t[0])}},A.prototype._makeSelectionFrontierFocus=function(){if(null==this.m_selectionFrontier||this._isDatabodyCellActive()&&this.m_selectionFrontier.row===this.m_active.indexes.row&&this.m_selectionFrontier.column===this.m_active.indexes.column)return;if(this._isDatabodyCellActive()){var e=this.createRange(this.m_active.indexes),t=this.getElementsInRange(e);null!=t&&t.length>0&&this._unsetAriaProperties(t[0])}var i=this.createRange(this.m_selectionFrontier),s=this.getElementsInRange(i);if(null==s||0===s.length)return;const o=this._getContextInfo(this.m_selectionFrontier);null!==o&&(this.m_contextInfo.textContent=o);var n=this.m_utils.containsCSSClassName(s[0],this.getMappedStyle("row"))?s[0].firstChild:s[0];this._setAriaProperties(this._createActiveObject(n),null,n)},A.prototype._selectHeader=function(e,t,i,s){var o,n;if("row"===e&&this.m_rowHeaderLevelCount-1===i||"rowEnd"===e&&this.m_rowEndHeaderLevelCount-1===i||"column"===e&&this.m_columnHeaderLevelCount-1===i||"columnEnd"===e&&this.m_columnEndHeaderLevelCount-1===i)o=t,n=t;else{var r=this._getActiveElement();n=(o=this._getAttribute(r.parentNode,"start",!0))+(this._getAttribute(r.parentNode,"extent",!0)-1)}-1!==e.indexOf("row")?((o===n&&!this.isMultipleSelection()||this.isMultipleSelection())&&(this.setHeaderSelectionFrontier(e,n,t,i,s.target,!0),this._selectEntireRow(o,n,s)),this._setAccInfoText("accessibleRowSelected",{row:t+1})):-1!==e.indexOf("column")&&(this.setHeaderSelectionFrontier(e,n,t,i,s.target,!0),this._selectEntireColumn(o,n,s),this._setAccInfoText("accessibleColumnSelected",{column:t+1})),this.isMultipleSelection()&&(this.m_headerDragState=!0)},A.prototype.setHeaderSelectionFrontier=function(e,t,i,s,o,n){n&&(this.m_selectionFrontier={}),this.m_selectionFrontier.axis=e,this.m_selectionFrontier.end=t,this.m_selectionFrontier.index=i,this.m_selectionFrontier.level=s,this.m_selectionFrontier.target=o},A.prototype._resetHeaderHighLight=function(){this.GetSelection().forEach(e=>{var t=this.getHeadersByRange(e,"row"),i=this.getHeadersByRange(e,"column");this._highlightHeaders(e,t,i)})},A.prototype.selectAndFocus=function(e,t,i,s){null==i&&(i=!1),this._resetSelectionFrontierFocus(),this._setActiveByIndex(e,t,null,null,s),"row"===this.m_options.getSelectionMode()&&(e=this.createIndex(e.row));var o=this._getSelectionStartAndEnd(e,e,0),n=o.min,r=o.max;"row"===this.m_options.getSelectionMode()&&(n=this.createIndex(n.row),r=this.createIndex(r.row)),this._createRangeWithKeys(n,r,this._selectAndFocusRangeCallback.bind(this,n,t,i))},A.prototype._selectAndFocusRangeCallback=function(e,t,i,s){var o=this.GetSelection(),n=o.slice(0);i||(this.m_discontiguousSelection||!t||this.isMultipleSelection()&&this.m_utils.ctrlEquivalent(t)&&0===t.button?!this._isDatabodyCellActive()||null==this.m_prevActive||"cell"!==this.m_prevActive.type||!(this.m_selectionFrontier.row===this.m_prevActive.indexes.row&&this.m_selectionFrontier.column===this.m_prevActive.indexes.column||this.m_selectionFrontier.row===this.m_prevActive.indexes.row&&this.isMultipleSelection()&&"row"===this.m_options.getSelectionMode())||this.m_utils.isTouchDevice()||!t.keyCode&&this.isMultipleSelection()||n.pop():n=[]),this.m_selectionFrontier=e,n.push(s),this.unhighlightSelection(),this._clearHeaderHighLight(),this.m_selection=n,this.rehighlightSelection(),this.m_options.isFloodFillEnabled()&&!this.m_discontiguousSelection&&"cell"===this.m_active.type&&this._moveFloodFillAffordance(),this._compareSelectionAndFire(t,o)},A.prototype._compareSelectionAndFire=function(e,t){var i=this.GetSelection();this.isMultipleSelection()&&i.length>0&&(this.m_utils.isTouchDevice()?(this._addTouchSelectionAffordance(e),this._moveTouchSelectionAffordance()):this.m_options.isFloodFillEnabled()&&this._isSelectionEnabled()&&!this.m_discontiguousSelection&&"cell"===this.m_active.type&&(this._addFloodfillAffordance(e),this._moveFloodFillAffordance())),this._compareSelections(i,t)||(this._resetHeaderHighLight(),this.fireSelectionEvent(e,t))},A.prototype._addTouchSelectionAffordance=function(e){if(null==this.m_topSelectIconContainer&&null==this.m_bottomSelectIconContainer){var t=e.target,i=this.findCell(t);if(i||(i=this.findHeader(t)),!i)return;this.m_topSelectIconContainer=document.createElement("div"),this.m_topSelectIconContainer.className=this.getMappedStyle("toucharea");var s=document.createElement("div");s.className=this.getMappedStyle("selectaffordance"),s.setAttribute("role","button"),s.setAttribute("aria-label",this.getResources().getTranslatedText("accessibleSelectionAffordanceTop")),this.m_topSelectIconContainer.appendChild(s),this.m_bottomSelectIconContainer=document.createElement("div"),this.m_bottomSelectIconContainer.className=this.getMappedStyle("toucharea");var o=document.createElement("div");if(o.className=this.getMappedStyle("selectaffordance"),o.setAttribute("role","button"),o.setAttribute("aria-label",this.getResources().getTranslatedText("accessibleSelectionAffordanceBottom")),this.m_bottomSelectIconContainer.appendChild(o),i?.classList.contains(this.getMappedStyle("frozenCell"))){let e=this._getCellContainer(i);e.firstChild.appendChild(this.m_topSelectIconContainer),e.firstChild.appendChild(this.m_bottomSelectIconContainer)}else if(i?.classList.contains(this.getMappedStyle("frozenHeader"))){let e;i.classList.contains(this.getMappedStyle("rowheadercell"))?e=this.m_databodyFrozenRow:i.classList.contains(this.getMappedStyle("colheadercell"))&&(e=this.m_databodyFrozenCol),e.firstChild.childNodes?.length||(e=this.m_databodyFrozenCorner),e.firstChild.appendChild(this.m_topSelectIconContainer),e.firstChild.appendChild(this.m_bottomSelectIconContainer)}else this.m_databody.firstChild.appendChild(this.m_topSelectIconContainer),this.m_databody.firstChild.appendChild(this.m_bottomSelectIconContainer);this.m_touchSelectionAffordanceHeight=this.m_topSelectIconContainer.firstElementChild.offsetHeight,this.m_touchSelectionAffordanceWidth=this.m_topSelectIconContainer.firstElementChild.offsetWidth}},A.prototype._addRoundedAffordanceClasses=function(e,t,i,s){if(e&&t)i||"row"!==s?i||"column"!==s?(e.classList.add(this.getMappedStyle("selectaffordancetopcornerbounded")),t.classList.add(this.getMappedStyle("selectaffordancebottomcornerbounded"))):(e.classList.add(this.getMappedStyle("selectaffordancetopcolumn")),t.classList.add(this.getMappedStyle("selectaffordancebottomcolumn"))):(e.classList.add(this.getMappedStyle("selectaffordancetoprow")),t.classList.add(this.getMappedStyle("selectaffordancebottomrow")));else if(t){let e;e=i||"row"!==s?i||"column"!==s?"selectaffordancebottomcornerbounded":"selectaffordancebottomcolumn":"selectaffordancebottomrow",t.classList.add(this.getMappedStyle(e))}},A.prototype._clearRoundedAffordanceClasses=function(e,t){e&&(e.classList.remove(this.getMappedStyle("selectaffordancetopcornerbounded")),e.classList.remove(this.getMappedStyle("selectaffordancetopcolumn")),e.classList.remove(this.getMappedStyle("selectaffordancetoprow"))),t.classList.remove(this.getMappedStyle("selectaffordancebottomcornerbounded")),t.classList.remove(this.getMappedStyle("selectaffordancebottomcolumn")),t.classList.remove(this.getMappedStyle("selectaffordancebottomrow"))},A.prototype._removeTouchSelectionAffordance=function(e){(this._isDatabodyCellActive()||e)&&this.m_topSelectIconContainer&&this.m_topSelectIconContainer.parentNode&&(this.m_topSelectIconContainer.parentNode.removeChild(this.m_topSelectIconContainer),this.m_bottomSelectIconContainer.parentNode.removeChild(this.m_bottomSelectIconContainer))},A.prototype._moveTouchSelectionAffordance=function(){var e,t,i=this.getResources().isRTLMode()?"right":"left",s=this.GetSelection();let o=this.m_databody,n=this.m_databody;if(s.length>0){var r=this.m_options.getSelectionMode(),l=this._getTouchSelectionAffordanceSize();if(null!=this.m_topSelectIconContainer&&null!=this.m_bottomSelectIconContainer){var a=this.m_topSelectIconContainer.firstElementChild,h=this.m_bottomSelectIconContainer.firstElementChild;if(this._clearRoundedAffordanceClasses(a,h),"row"===r||-1!==s[s.length-1].endIndex.row&&-1===s[s.length-1].endIndex.column){if(this._addRoundedAffordanceClasses(a,h,!1,"row"),s[s.length-1]?.startKey?.row){let t=s[s.length-1].startKey.row;e=this._getAxisCellsByKey(t,"row")}else s[s.length-1]?.startIndex?.row&&(e=this._getAxisCellsByIndex(s[s.length-1].startIndex.row,"row"));if(s[s.length-1]?.endKey?.row){let e=s[s.length-1].endKey.row;t=this._getAxisCellsByKey(e,"row")}else s[s.length-1]?.endIndex?.row&&(t=this._getAxisCellsByIndex(s[s.length-1].endIndex.row,"row"));let r;if(t&&t.length&&(r=t[0]),!r){let e=this.createIndex(-1,0),t=this.getElementsInRange(this.createRange(e,e));r=t[t.length-1]}o=e[0].parentNode.parentNode,n=t[0].parentNode.parentNode,this.setElementDir(this.m_topSelectIconContainer,this.getElementDir(e[0],"top")-this.m_touchSelectionAffordanceHeight-1,"top"),this.setElementDir(this.m_bottomSelectIconContainer,this.getElementDir(r,"top")+this.getElementHeight(r)-l+this.m_touchSelectionAffordanceHeight,"top");const d=this.getElementWidth(o)/2+this.m_currentScrollLeft-l/2;this.setElementDir(this.m_topSelectIconContainer,d,i),this.setElementDir(this.m_bottomSelectIconContainer,d,i)}else if(-1!==s[s.length-1].endIndex.column&&-1===s[s.length-1].endIndex.row){if(this._addRoundedAffordanceClasses(a,h,!1,"column"),s[s.length-1]?.startKey?.column){let t=s[s.length-1].startKey.column;e=this._getAxisCellsByKey(t,"column")}else s[s.length-1]?.startIndex?.column&&(e=this._getAxisCellsByIndex(s[s.length-1].startIndex.column,"column"));if(s[s.length-1]?.endKey?.column){let e=s[s.length-1].endKey.column;t=this._getAxisCellsByKey(e,"column")}else s[s.length-1]?.endIndex?.column&&(t=this._getAxisCellsByIndex(s[s.length-1].endIndex.column,"column"));o=e[0].parentNode.parentNode,n=t[0].parentNode.parentNode;var d=this.getElementHeight(o)/2+this.m_currentScrollTop-l/2;this.setElementDir(this.m_topSelectIconContainer,d,"top"),this.setElementDir(this.m_bottomSelectIconContainer,d,"top"),this.setElementDir(this.m_topSelectIconContainer,this.getElementDir(e[0],"left")-this.m_touchSelectionAffordanceWidth-2,"left"),this.setElementDir(this.m_bottomSelectIconContainer,this.getElementDir(t[0],"left")+this.getElementWidth(t[0])-(l-this.m_touchSelectionAffordanceWidth-1),"left")}else{this._addRoundedAffordanceClasses(a,h,!0);var m=this._getCellByIndex(s[s.length-1].startIndex),c=this._getCellByIndex(s[s.length-1].endIndex);if(!c){let e=this.createIndex(-1,-1),t=this.getElementsInRange(this.createRange(e,e));c=t[t.length-1]}o=this._getCellContainer(m),n=this._getCellContainer(c),this.setElementDir(this.m_topSelectIconContainer,this.getElementDir(m,"top")-this.m_touchSelectionAffordanceHeight-1,"top"),this.setElementDir(this.m_bottomSelectIconContainer,this.getElementDir(c,"top")+this.getElementHeight(c)-l+this.m_touchSelectionAffordanceWidth,"top"),this.setElementDir(this.m_topSelectIconContainer,this.getElementDir(m,i)-this.m_touchSelectionAffordanceWidth-2,i),this.setElementDir(this.m_bottomSelectIconContainer,this.getElementDir(c,i)+this.getElementWidth(c)-(l-this.m_touchSelectionAffordanceWidth),i)}null!=this.m_topSelectIconContainer.parentNode&&this.m_topSelectIconContainer.parentNode===o||o.firstChild.appendChild(this.m_topSelectIconContainer),null!=this.m_bottomSelectIconContainer.parentNode&&this.m_bottomSelectIconContainer.parentNode===o||n.firstChild.appendChild(this.m_bottomSelectIconContainer)}}},A.prototype._scrollTouchSelectionAffordance=function(){var e,t,i=this.m_options.getSelectionMode();if("row"===i)null!=this.m_topSelectIconContainer&&(t=this.getResources().isRTLMode()?"right":"left",e=this.getElementWidth(this.m_databody)/2+this.m_currentScrollLeft,this.setElementDir(this.m_topSelectIconContainer,e,t),this.setElementDir(this.m_bottomSelectIconContainer,e,t));else if("cell"===i&&this.isHeaderSelectionType(this.m_selectionFrontier)&&null!=this.m_topSelectIconContainer)if(-1!==this.m_selectionFrontier.axis.indexOf("row"))t=this.getResources().isRTLMode()?"right":"left",e=this.getElementWidth(this.m_databody)/2+this.m_currentScrollLeft,this.setElementDir(this.m_topSelectIconContainer,e,t),this.setElementDir(this.m_bottomSelectIconContainer,e,t);else{var s=this.getElementHeight(this.m_databody)/2+this.m_currentScrollTop;this.setElementDir(this.m_topSelectIconContainer,s,"top"),this.setElementDir(this.m_bottomSelectIconContainer,s,"top")}},A.prototype._getTouchSelectionAffordanceSize=function(){if(null==this.m_touchSelectionAffordanceSize){var e=document.createElement("div");e.className=this.getMappedStyle("toucharea"),e.style.visibilty="hidden",e.style.top="0px",e.style.visibilty="0px",this.m_root.appendChild(e);var t=e.offsetWidth;this.m_root.removeChild(e),this.m_touchSelectionAffordanceSize=t}return this.m_touchSelectionAffordanceSize},A.SORT_ANIMATION_DURATION=800,A.prototype._handleSortContainerMouseOver=function(e){var t=e.target;let i=this.findHeader(t)||this.findLabel(t);var s=this._getSortIcon(i),o=this._getSortContainer(i);this.m_utils.containsCSSClassName(e.currentTarget,this.getMappedStyle("sortIcon"))&&(this.m_utils.addCSSClassName(e.currentTarget,this.getMappedStyle("hover")),this.m_utils.addCSSClassName(s,this.getMappedStyle("hover")),this.m_utils.removeCSSClassName(o,this.getMappedStyle("iconHidden")))},A.prototype._handleSortMouseOut=function(e){if(!this._databodyEmpty()){var t=e.target,i=e.relatedTarget;let n=this.findHeader(t),r=!1;var s;!n&&this.findLabel(t)&&(r=!0,n=this.findLabel(t)),null!=n&&null!=i&&n===this.findHeader(i)&&n===this.findLabel(i)||this._displaySortIcon(n,r),(s=this._getSortIcon(n))&&this.m_utils.removeCSSClassName(s,this.getMappedStyle("hover"));var o=this._getSortContainer(n);o&&(this.m_utils.removeCSSClassName(o,this.getMappedStyle("hover")),this.m_utils.removeCSSClassName(o,this.getMappedStyle("selected")),!s||this.m_utils.containsCSSClassName(s,this.getMappedStyle("sortdescending"))||this.m_utils.containsCSSClassName(s,this.getMappedStyle("sortascending"))||o.classList.add(this.getMappedStyle("iconHidden")))}},A.prototype._handleSortIconMouseDown=function(e,t){const i=this.m_utils.containsCSSClassName(e,this.getMappedStyle("sortIcon"))?e.lastChild:e;if(!this._databodyEmpty()){this.m_utils.addCSSClassName(i,this.getMappedStyle("selected"));this._getSortContainer(t).classList.remove(this.getMappedStyle("iconHidden"))}},A.prototype._toggleSortIconDirection=function(e,t){if(null!=e){var i=this._getSortIcon(e);"descending"===t&&(this.m_utils.containsCSSClassName(i,this.getMappedStyle("sortascending"))||this.m_utils.containsCSSClassName(i,this.getMappedStyle("sortdefault")))?(this.m_utils.removeCSSClassName(i,this.getMappedStyle("sortascending")),this.m_utils.removeCSSClassName(i,this.getMappedStyle("sortdefault")),this.m_utils.addCSSClassName(i,this.getMappedStyle("sortdescending")),i.setAttribute("title",this.getResources().getTranslatedText("labelSortAsc"))):"ascending"===t&&(this.m_utils.containsCSSClassName(i,this.getMappedStyle("sortdescending"))||this.m_utils.containsCSSClassName(i,this.getMappedStyle("sortdefault")))?(this.m_utils.removeCSSClassName(i,this.getMappedStyle("sortdescending")),this.m_utils.removeCSSClassName(i,this.getMappedStyle("sortdefault")),this.m_utils.addCSSClassName(i,this.getMappedStyle("sortascending")),i.setAttribute("title",this.getResources().getTranslatedText("labelSortDsc"))):"default"===t&&(this.m_utils.removeCSSClassName(i,this.getMappedStyle("sortdescending")),this.m_utils.removeCSSClassName(i,this.getMappedStyle("sortascending")),this.m_utils.addCSSClassName(i,this.getMappedStyle("sortdefault")),i.setAttribute("title",this.getResources().getTranslatedText("labelSortAsc")))}},A.prototype._displaySortIcon=function(e,t){var i=!1;if(null!=e){var s=this._getSortIcon(e);if(this._isDataGridProvider()){if(this._isDataGridProvider()){let s=t?this.getHeaderLabelAxis(e):this.getHeaderCellAxis(e);"column"===s?i=t?this.m_sortRowInfo?.level===this.getHeaderLabelLevel(e):this.m_sortColumnInfo?.key===this._getKey(e):"row"===s&&(i=t?this.m_sortColumnInfo?.level===this.getHeaderLabelLevel(e):this.m_sortRowInfo?.key===this._getKey(e))}}else i=this.m_sortColumnInfo?.key===this._getKey(e);i&&this.m_utils.addCSSClassName(s,this.getMappedStyle("default"))}},A.prototype._populateSortIcon=function(e,t,i,s){let o=i.split(" ");for(let t=0;t<o.length;t++)this.m_utils.addCSSClassName(e,o[t]);return"ascending"===s?(this.m_utils.addCSSClassName(e,this.getMappedStyle("sortascending")),t.setAttribute(this.getResources().getMappedAttribute("sortDir"),s),e.setAttribute("title",this.getResources().getTranslatedText("labelSortDsc"))):"descending"===s?(this.m_utils.addCSSClassName(e,this.getMappedStyle("sortdescending")),t.setAttribute(this.getResources().getMappedAttribute("sortDir"),s),e.setAttribute("title",this.getResources().getTranslatedText("labelSortAsc"))):(this.m_utils.addCSSClassName(e,this.getMappedStyle("sortdefault")),e.setAttribute("title",this.getResources().getTranslatedText("labelSortAsc"))),e},A.prototype._buildHiddenSortIcon=function(e,t,i){e.className=this.getMappedStyle("sortdefault")+" "+i,e.setAttribute("title",this.getResources().getTranslatedText("labelSortAsc")),t.classList.add(this.getMappedStyle("iconHidden"))},A.prototype._buildSortIcon=function(e,t,i){var s=document.createElement("div");this.m_utils.addCSSClassName(s,this.getMappedStyle("iconContainer")),this.m_utils.addCSSClassName(s,this.getMappedStyle("sortIcon"));var o=document.createElement("div"),n=this.getMappedStyle("icon")+" "+this.getMappedStyle("clickableicon");let r=null,l=null;return this._isDataGridProvider()?"column"===i&&"header"===this.m_sortColumnInfo?.type?(r=this.m_sortColumnInfo.key,l=this.m_sortColumnInfo.direction):"row"===i&&"header"===this.m_sortRowInfo?.type&&(r=this.m_sortRowInfo.key,l=this.m_sortRowInfo.direction):(r=this.m_sortColumnInfo?.axis===i?this.m_sortColumnInfo?.key:null,l=this.m_sortColumnInfo?.axis===i?this.m_sortColumnInfo?.direction:null),e.key===r?this._populateSortIcon(o,t,n,l):this._buildHiddenSortIcon(o,s,n),s.appendChild(o),s.addEventListener("mouseover",this._handleSortContainerMouseOver.bind(this)),s},A.prototype._buildLabelSortIcon=function(e,t,i){const s=document.createElement("div");this.m_utils.addCSSClassName(s,this.getMappedStyle("iconContainer")),this.m_utils.addCSSClassName(s,this.getMappedStyle("sortIcon"));const o=document.createElement("div"),n=this.getMappedStyle("icon")+" "+this.getMappedStyle("clickableicon");let r=null,l=null;return this._isDataGridProvider()&&("row"===i||"rowEnd"===i?(r=this.m_sortColumnInfo?.axis===i?this.m_sortColumnInfo.level:null,l=this.m_sortColumnInfo?.axis===i?this.m_sortColumnInfo.direction:null):(r=this.m_sortRowInfo?.axis===i?this.m_sortRowInfo.level:null,l=this.m_sortRowInfo?.axis===i?this.m_sortRowInfo.direction:null),e.level===r?this._populateSortIcon(o,t,n,l):this._buildHiddenSortIcon(o,s,n)),s.appendChild(o),s.addEventListener("mouseover",this._handleSortContainerMouseOver.bind(this)),s},A.prototype._handleKeyboardSort=function(e,t){if(!this._databodyEmpty()){var i=e.getAttribute(this.getResources().getMappedAttribute("sortDir"));i=null==i||"descending"===i?"ascending":"descending","header"===(this.find(e,"headerlabel")?"label":"header")?this._doHeaderSort(t,e,i):this._doHeaderLabelSort(t,e,i)}},A.prototype._handleHeaderSort=function(e,t){if(!this._databodyEmpty()){var i=e.target,s=this.findHeader(i);if(null!=s){const e=this.getHeaderCellAxis(s);null==t&&(this._isDataGridProvider()?(t="ascending","column"===e&&"header"===this.m_sortColumnInfo?.type&&this.m_sortColumnInfo?.key===this._getKey(s)?t="ascending"===this.m_sortColumnInfo?.direction?"descending":"ascending":"row"===e&&"header"===this.m_sortRowInfo?.type&&this.m_sortRowInfo?.key===this._getKey(s)&&(t="ascending"===this.m_sortRowInfo?.direction?"descending":"ascending")):(t="ascending",this.m_sortColumnInfo?.key===this._getKey(s)&&"ascending"===this.m_sortColumnInfo.direction&&(t="descending")))}this._doHeaderSort(e,s,t)}},A.prototype._handleHeaderLabelSort=function(e,t,i){if(!this._databodyEmpty()){const s=this.getResources().getMappedAttribute("context");if(null!=t){let o=t[s].axis;if(void 0===i){let e=this.m_sortRowInfo;"row"!==o&&"rowEnd"!==o||(e=this.m_sortColumnInfo),i=e?.axis===o&&"label"===e.type&&"ascending"===e.direction?"descending":"ascending"}this._doHeaderLabelSort(e,t,i)}}},A.prototype._handleCellSort=function(e,t,i){null==i||this._databodyEmpty()||(this._removeTouchSelectionAffordance(),this._doHeaderSort(e,i,t))},A.prototype._doHeaderSort=function(e,t,i){if(!0!==this.m_isSorting){this.m_delayedSort=null;var s=this._getKey(t),o=this._getAxis(t);if(this._removeSortSelection(o),t.setAttribute(this.getResources().getMappedAttribute("sortDir"),i),"column"!==o&&this._isDataGridProvider()?(this.m_sortRowInfo={event:e,key:s,axis:o,direction:i,header:t,type:"header"},"header"===this.m_sortColumnInfo?.type&&(this.m_sortColumnInfo={})):(this.m_sortColumnInfo={event:e,key:s,axis:o,direction:i,header:t,type:"header"},"header"===this.m_sortRowInfo?.type&&(this.m_sortRowInfo={})),this._toggleSortIconDirection(t,i),this._addSortSelection(o),this._setAccInfoText("ascending"===i?"accessibleSortAscending":"accessibleSortDescending",{id:s}),null!=i&&null!=s&&null!=o)if(this._isDataGridProvider())this._fireSortRequestEvent(o);else{this.m_isSorting=!0,this.showStatusText(!this.isSkeletonSupport());var n={axis:o,key:s,direction:i};this.getDataSource().sort(n,{success:this._handleSortSuccess.bind(this),error:this._handleSortError.bind(this)})}}else this.m_delayedSort={event:e,header:t,direction:i}},A.prototype._doHeaderLabelSort=function(e,t,i){const s=this.getHeaderLabelAxis(t),o=this.getHeaderLabelLevel(t);t.setAttribute(this.getResources().getMappedAttribute("sortDir"),i),"row"===s||"rowEnd"===s?this.m_sortColumnInfo={event:e,level:o,axis:s,direction:i,label:t,type:"label"}:this.m_sortRowInfo={event:e,level:o,axis:s,direction:i,label:t,type:"label"},this._toggleSortIconDirection(t,i),this._setAccInfoText("ascending"===i?"accessibleSortAscending":"accessibleSortDescending",{id:o}),null!=i&&null!=o&&null!=s&&this._isDataGridProvider()&&this._fireSortLabelRequestEvent(t,s)},A.prototype._handleSortError=function(){this.hideStatusText()},A.prototype._removeSortSelection=function(e){let t="column"===e?this.m_sortColumnInfo:this.m_sortRowInfo;if(null!=t&&"header"===t.type){var i;if(!(i="column"===e?this._findHeaderByKey(t.key,this.m_colHeader,this.getMappedStyle("colheadercell")):this._findHeaderByKey(t.key,this.m_rowHeader,this.getMappedStyle("rowheadercell"))))return;i.removeAttribute(this.getResources().getMappedAttribute("sortDir"));var s=this._getSortIcon(i);this._toggleSortIconDirection(i,"default"),"descending"===t.direction&&(this.m_utils.removeCSSClassName(s,this.getMappedStyle("sortdescending")),this.m_utils.addCSSClassName(s,this.getMappedStyle("sortascending"))),this.m_utils.removeCSSClassName(s,this.getMappedStyle("default")),this.m_utils.removeCSSClassName(s,this.getMappedStyle("selected"));this._getSortContainer(i).classList.add(this.getMappedStyle("iconHidden"))}},A.prototype._addSortSelection=function(e){let t="column"===e?this.m_sortColumnInfo:this.m_sortRowInfo;if(null!=t&&"header"===t.type){var i;i="column"===e?this._findHeaderByKey(t.key,this.m_colHeader,this.getMappedStyle("colheadercell")):this._findHeaderByKey(t.key,this.m_rowHeader,this.getMappedStyle("rowheadercell"));var s=this._getSortIcon(i);this.m_utils.addCSSClassName(s,this.getMappedStyle("default")),this.m_utils.addCSSClassName(s,this.getMappedStyle("selected"));this._getSortContainer(i).classList.remove(this.getMappedStyle("iconHidden"))}},A.prototype._getAxis=function(e){var t=this.getMappedStyle("colheadercell"),i=this.getMappedStyle("rowheadercell");return this.m_utils.containsCSSClassName(e,t)?"column":this.m_utils.containsCSSClassName(e,i)?"row":null},A.prototype._handleSortSuccess=function(){this.hideStatusText(),this._isDatabodyCellActive()?this._indexes({row:this.m_active.keys.row,column:this.m_active.keys.column},this._handlePreSortScrolling):this._fetchForSort(this.m_startRow,this.m_endRow-this.m_startRow+1,!1)},A.prototype._handlePreSortScrolling=function(e){var t=(-1===e.row?0:e.row)*this.m_avgRowHeight,i=t+this.m_avgRowHeight,s=this._isHighWatermarkScrolling();if(this.m_currentScrollTop<=t&&i<=this.m_currentScrollTop+this.getElementHeight(this.m_databody)||s)this._fetchForSort(this.m_startRow,this.m_endRow-this.m_startRow+1,!1);else{this.m_currentScrollTop=Math.min(t,this._getMaxScrollHeight());var o=Math.floor(this.m_currentScrollTop/this.m_avgRowHeight),n=o*this.m_avgRowHeight;this.m_startRow=o,this.m_endRow=-1,this.m_startRowHeader=o,this.m_endRowHeader=-1,this.m_startRowPixel=n,this.m_endRowPixel=n,this.m_startRowHeaderPixel=n,this.m_endRowHeaderPixel=n,this._fetchForSort(o,null,!0)}},A.prototype._fetchForSort=function(e,t,i){var s=document.createDocumentFragment(),o=document.createDocumentFragment();this.fetchHeaders("row",e,s,o,t,{success:this.handleHeadersFetchSuccessForSort.bind(this),error:this.handleCellsFetchError}),this.fetchCells(this.m_databody,e,this.m_startCol,t,this.m_endCol-this.m_startCol+1,{success:this.handleCellsFetchSuccessForSort.bind(this,s,o,i),error:this.handleCellsFetchError})},A.prototype.handleHeadersFetchSuccessForSort=function(e,t,i,s){var o,n,r,l,a,h,d,m=t.axis,c=t.start,u=t.header,_=t.endHeader;if(this.m_fetching[m]=!1,null!=e){for(o=e.getCount(),l=0,n=0,h=this.getMappedStyle("headercell")+" "+this.getMappedStyle("rowheadercell"),d=this.getRendererOrTemplate("row");o-n>0;)r=c+n,n+=(a=this.buildLevelHeaders(u,r,0,0,this.m_startRowPixel+l,!0,s,d,e,"row",h,this.m_rowHeaderLevelCount)).count,l+=a.totalHeaderDimension;this.m_endRowHeader=this.m_startRowHeader+(o-1),this.m_endRowHeaderPixel=this.m_startRowHeaderPixel+l}if(null!=i){for(o=i.getCount(),l=0,n=0,h=this.getMappedStyle("endheadercell")+" "+this.getMappedStyle("rowendheadercell"),d=this.getRendererOrTemplate("rowEnd");o-n>0;)r=c+n,n+=(a=this.buildLevelHeaders(_,r,0,0,this.m_startRowPixel+l,!0,s,d,i,"rowEnd",h,this.m_rowEndHeaderLevelCount)).count,l+=a.totalHeaderDimension;this.m_endRowEndHeader=this.m_startRowEndHeader+(o-1),this.m_endRowEndHeaderPixel=this.m_startRowEndHeaderPixel+l}this._signalTaskEnd()},A.prototype.handleCellsFetchSuccessForSort=function(e,t,i,s,o){var n;this.m_fetching.cells=!1;var r=A.SORT_ANIMATION_DURATION;this.isFetchComplete()&&this.hideStatusText();var l=o[0].start,a=s.getCount("row"),h=o[1].start,d=document.createDocumentFragment(),m=this._addCellsToFragment(d,s,l,this.m_startRowPixel,h,this.m_startColPixel);this.m_endRow=this.m_startRow+(a-1),this.m_endRowPixel=this.m_startRowPixel+m.totalRowHeight;var _=this.m_databody.firstChild,g=this.m_rowHeader.firstChild,p=this.m_rowEndHeader.firstChild;if(!0===i&&(n=this._isHighWatermarkScrolling(),this.m_silentScroll=!0,this.m_databody.scrollTop=this.m_currentScrollTop,this._syncScroller()),!r||1===a||this.m_rowHeaderLevelCount>1&&null!=this.m_rowHeaderLevelCount||!1===n)this._signalTaskStart(),this._handleSortEnd(d,e,t);else if(this.m_isCustomElementCallback()){this._signalTaskStart("processing sort render");let i=document.createElement("div"),s=document.createElement("div"),o=document.createElement("div");i.setAttribute(this.getResources().getMappedAttribute("busyContext"),""),s.setAttribute(this.getResources().getMappedAttribute("busyContext"),""),o.setAttribute(this.getResources().getMappedAttribute("busyContext"),""),i.className=this.getMappedStyle("info"),s.className=this.getMappedStyle("info"),o.className=this.getMappedStyle("info"),i.appendChild(d),s.appendChild(e),o.appendChild(t),this.m_root.appendChild(i),this.m_root.appendChild(s),this.m_root.appendChild(o);var f=c.getContext(i).getBusyContext().whenReady(),C=c.getContext(s).getBusyContext().whenReady(),y=c.getContext(o).getBusyContext().whenReady();Promise.all([f,C,y]).then(function(){for(;i.childNodes.length>0;)d.appendChild(i.childNodes[0]);for(;s.childNodes.length>0;)e.appendChild(s.childNodes[0]);for(;o.childNodes.length>0;)t.appendChild(o.childNodes[0]);this.m_root.removeChild(i),this.m_root.removeChild(s),this.m_root.removeChild(o),this._signalTaskEnd(),this.processSortAnimationToPosition(r,0,"ease-in",g,e,_,d,p,t)}.bind(this))}else this.processSortAnimationToPosition(r,0,"ease-in",g,e,_,d,p,t);u.isIos()&&this._applyIosAccessibility(),this._signalTaskEnd()},A.prototype._handleSortEnd=function(e,t,i,s,o,n){var r;if(t.childNodes.length>1){if(r=this.m_rowHeader.firstChild,o)for(let e=0;e<o.length;e++){let i=o[e];t.insertBefore(i.element,t.childNodes[i.index])}this.m_utils.empty(r),r.appendChild(t),this.m_subtreeAttachedCallback(r)}if(i.childNodes.length>1){if(r=this.m_rowEndHeader.firstChild,n)for(let e=0;e<n.length;e++){let t=n[e];i.insertBefore(t.element,i.childNodes[t.index])}this.m_utils.empty(r),r.appendChild(i),this.m_subtreeAttachedCallback(r)}var l=this.m_databody.firstChild,a=this.m_rowHeader.firstChild,h=this.m_rowEndHeader.firstChild;if(s)for(let t=0;t<s.length;t++)e.appendChild(s[t]);this._emptyDatabody(l),this._populateDatabody(l,e),this._fireSortEvent(),this._restoreActive(),this.m_isSorting=!1,this._doDelayedSort(),this.m_animating=!1;for(let e=0;e<l.childNodes.length;e++)this.removeTransformMoveStyle(l.childNodes[e]);if(-1!==this.m_endRowHeader)for(let e=0;e<a.childNodes.length;e++)this.removeTransformMoveStyle(a.childNodes[e]);if(-1!==this.m_endRowEndHeader)for(let e=0;e<h.childNodes.length;e++)this.removeTransformMoveStyle(h.childNodes[e]);this._signalTaskEnd(),this._runModelEventQueue()},A.prototype.processSortAnimationToPosition=function(e,t,i,s,o,n,r,l,a){var h,d,m,c,u,_,g,p,f,C,y=this;this._signalTaskStart();var w=o.childNodes.length>1,E=a.childNodes.length>1,v=this.getResources().isRTLMode()?"right":"left",x=this._getViewportBottom(),H=this._getViewportLeft(),b=this._getViewportRight(),S={},R={},I=[];for(c=0;c<n.childNodes.length;c++)u=n.childNodes[c],h=this._getKey(u,"row"),C=(f=this.getElementDir(u,v))+this.getElementWidth(u),_=(d=this.getElementDir(u,"top"))+this.getElementHeight(u),this._isCellBoundaryInViewport(f,C,d,_)&&(S[h]?S[h].cell.push(u):(m=x,S[h]={cell:[u],oldTop:d,newTop:m}),m-d!=0&&(p=u));for(c=0;c<s.childNodes.length;c++)w&&(u=s.childNodes[c],h=this._getKey(u,"row"),_=(d=this.getElementDir(u,"top"))+this.getElementHeight(u),this._isCellBoundaryInViewport(H,b,d,_)&&(m=x,S[h]||(S[h]={oldTop:d,newTop:m}),S[h].rowHeader=u));for(c=0;c<l.childNodes.length;c++)w&&(u=l.childNodes[c],h=this._getKey(u,"row"),_=(d=this.getElementDir(u,"top"))+this.getElementHeight(u),this._isCellBoundaryInViewport(H,b,d,_)&&(m=x,S[h]||(S[h]={oldTop:d,newTop:m}),S[h].rowEndHeader=u));for(c=0;c<r.childNodes.length;c++)u=r.childNodes[c],h=this._getKey(u,"row"),m=this.getElementDir(u,"top"),S[h]?S[h].newTop=m:(d=x,g=m+this.getElementHeight(u),C=(f=this.getElementDir(u,v))+this.getElementWidth(u),this._isCellBoundaryInViewport(f,C,m,g)&&(u.style.transform="translate3d(0px,"+d+"px,0px)",I.push(u),R[h]?R[h].cell.push(u):R[h]={cell:[u],oldTop:d,newTop:m,add:!0},m-d!=0&&(p=u)));for(let e=0;e<I.length;e++)n.appendChild(I[e]);var z=[];for(c=0;c<o.childNodes.length;c++)if(w){var F=o.childNodes[c];h=this._getKey(F,"row"),S[h]||(g=(m=this.getElementDir(F,"top"))+this.getElementHeight(F),d=x,this._isCellBoundaryInViewport(H,b,m,g)&&(F.style.transform="translate3d(0px,"+d+"px,0px)",z.push({element:F,index:c}),R[h]||(R[h]={oldTop:d,newTop:m,add:!0}),R[h].rowHeader=F))}for(let e=0;e<z.length;e++)s.appendChild(z[e].element);var M=[];for(c=0;c<a.childNodes.length;c++)if(E){var A=a.childNodes[c];h=this._getKey(A,"row"),S[h]||(g=(m=this.getElementDir(A,"top"))+this.getElementHeight(A),d=x,this._isCellBoundaryInViewport(H,-1,m,g)&&(A.style.transform="translate3d(0px,"+d+"px,0px)",M.push({element:A,index:c}),R[h].rowEndHeader=A,R[h]||(R[h]={oldTop:d,newTop:m,add:!0})))}for(let e=0;e<M.length;e++)l.appendChild(M[e].element);if(null!=p){var D=this._handleSortEnd.bind(this,r,o,a,I,z,M);y._onEndEvent("transitionend",p,D,e),this.m_animating=!0,setTimeout(function(){var s,o,n,r,l=0,a=Object.keys(S);for(r=0;r<a.length;r++){if(h=a[r],n=S[a[r]],o=t+"ms",s=n.newTop-n.oldTop,n.cell)for(l=0;l<n.cell.length;l++)y.addTransformMoveStyle(n.cell[l],e/2+"ms",o,i,0,s,0);w&&n.rowHeader&&y.addTransformMoveStyle(n.rowHeader,e/2+"ms",o,i,0,s,0),E&&n.rowEndHeader&&y.addTransformMoveStyle(n.rowEndHeader,e/2+"ms",o,i,0,s,0)}for(a=Object.keys(R),r=0;r<a.length;r++){if(h=a[r],n=R[a[r]],o=t*l+"ms",s=0,n.cell)for(var d=0;d<n.cell.length;d++)y.addTransformMoveStyle(n.cell[d],e/2+"ms",o,i,0,s,0);w&&n.rowHeader&&y.addTransformMoveStyle(n.rowHeader,e/2+"ms",o,i,0,s,0),E&&n.rowEndHeader&&y.addTransformMoveStyle(n.rowEndHeader,e/2+"ms",o,i,0,s,0)}},0)}else this._handleSortEnd(r,o,a)},A.prototype._restoreActive=function(){if(null!=this.m_active){var e=this.m_active.axis,t=this.m_sortColumnInfo.originalEvent;if("cell"===this.m_active.type){var i=this._getCellByKeys(this.m_active.keys);if(null!=i){var s=this.getCellIndexes(i);this._isSelectionEnabled()?this.selectAndFocus(s,t):this._setActiveByIndex(s,t)}else this._setActive(null,null,t,!0),this._isSelectionEnabled()&&this._clearSelection(t)}else if("row"===e||"rowEnd"===e){var o="row"===e?this.m_rowHeader:this.m_rowEndHeader,n="row"===e?this.getMappedStyle("rowheadercell"):this.getMappedStyle("rowendheadercell"),r=this._findHeaderByKey(this.m_active.key,o,n);if(null!=r){var l=r[this.getResources().getMappedAttribute("context")];this._setActive(r,{type:"header",axis:e,index:l.index,key:l.key,level:l.level},t)}else this._setActive(null,null,t)}}},A.prototype._getSortIcon=function(e){return this._getSortContainer(e).firstChild},A.prototype._getSortContainer=function(e){return e.querySelector("."+this.getMappedStyle("sortIcon"))},A.prototype._fireSortEvent=function(){var e={event:this.m_sortColumnInfo.event,ui:{header:this.m_sortColumnInfo.key,direction:this.m_sortColumnInfo.direction}};this.fireEvent("sort",e)},A.prototype._fireSortRequestEvent=function(e){let t="column"===e?this.m_sortColumnInfo:this.m_sortRowInfo,i=t.header[this.getResources().getMappedAttribute("context")],s=t.header[this.getResources().getMappedAttribute("metadata")],o=this.buildHeaderTemplateContext(i,s).item;var n={event:t.event,ui:{direction:t.direction,item:o,axis:t.axis}};this.fireEvent("sortRequest",n)},A.prototype._fireSortLabelRequestEvent=function(e,t){let i=e[this.getResources().getMappedAttribute("context")],s={metadata:i.metadata},o=this.buildLabelTemplateContext(i,s).item,n=this.m_sortRowInfo;if("row"!==t&&"rowEnd"!==t||(n=this.m_sortColumnInfo),n){var r={event:n.event,ui:{direction:n.direction,item:o,axis:t,level:n.level}};this.fireEvent("sortLabelRequest",r)}},A.prototype._doDelayedSort=function(){null!=this.m_delayedSort?this._doHeaderSort(this.m_delayedSort.event,this.m_delayedSort.header,this.m_delayedSort.direction):this.fillViewport()},A.prototype._isSortIcon=function(e){return this.m_utils.containsCSSClassName(e,this.getMappedStyle("sortascending"))||this.m_utils.containsCSSClassName(e,this.getMappedStyle("sortdescending"))||this.m_utils.containsCSSClassName(e,this.getMappedStyle("sortdefault"))||this.m_utils.containsCSSClassName(e,this.getMappedStyle("sortIcon"))},A.prototype._fireExpandRequestEvent=function(e){const t=this.findHeader(e.target),i=t[this.getResources().getMappedAttribute("context")],s=t[this.getResources().getMappedAttribute("metadata")];s.metadata.expanded="expanded";const o={item:this.buildHeaderTemplateContext(i,s).item,axis:i.axis},n=this._getDisclosureIcon(t);this.m_utils.removeCSSClassName(n,this.getMappedStyle("collapsed")),this.m_utils.addCSSClassName(n,this.getMappedStyle("expanded")),this.fireEvent("expandRequest",o)},A.prototype._fireCollapseRequestEvent=function(e){const t=this.findHeader(e.target),i=t[this.getResources().getMappedAttribute("context")],s=t[this.getResources().getMappedAttribute("metadata")];s.metadata.expanded="collapsed";const o={item:this.buildHeaderTemplateContext(i,s).item,axis:i.axis},n=this._getDisclosureIcon(t);this.m_utils.removeCSSClassName(n,this.getMappedStyle("expanded")),this.m_utils.addCSSClassName(n,this.getMappedStyle("collapsed")),this.fireEvent("collapseRequest",o)},A.prototype._handleExpandCollapseRequest=function(e){this._isHeaderExpanded(e.target)?this._fireCollapseRequestEvent(e):this._isHeaderCollapsed(e.target)&&this._fireExpandRequestEvent(e)},A.prototype._isTargetExpandCollapseEnabled=function(e){return this._isHeaderCollapsed(e)||this._isHeaderExpanded(e)},A.prototype._isHeaderCollapsed=function(e){const t=this._getDisclosureIcon(e);return!!t&&this.m_utils.containsCSSClassName(t,this.getMappedStyle("collapsed"))},A.prototype._isHeaderExpanded=function(e){const t=this._getDisclosureIcon(e);return!!t&&this.m_utils.containsCSSClassName(t,this.getMappedStyle("expanded"))},A.prototype._buildDisclosureIcon=function(e){const t=document.createElement("div");t.classList.add(this.getMappedStyle("iconContainer")),t.classList.add(this.getMappedStyle("disclosureIcon"));const i=document.createElement("div");let s;return i.classList.add(this.getMappedStyle("icon")),i.classList.add(this.getMappedStyle("clickableicon")),"expanded"===e.metadata.expanded?(i.classList.add(this.getMappedStyle("expanded")),s=this.getResources().getTranslatedText("collapsedText")):"collapsed"===e.metadata.expanded&&(i.classList.add(this.getMappedStyle("collapsed")),s=this.getResources().getTranslatedText("expandedText")),t.setAttribute("title",s),t.appendChild(i),t.addEventListener("mouseover",this._handleExpandCollapseContainerMouseOver.bind(this)),t.addEventListener("mouseout",this._handleDisclosureMouseOut.bind(this)),t},A.prototype._handleExpandCollapseContainerMouseOver=function(e){const t=e.target,i=this.findHeader(t),s=this._getDisclosureIcon(i);this.m_utils.containsCSSClassName(e.currentTarget,this.getMappedStyle("disclosureIcon"))&&(this.m_utils.addCSSClassName(e.currentTarget,this.getMappedStyle("hover")),this.m_utils.addCSSClassName(s,this.getMappedStyle("hover")),this.m_utils.removeCSSClassName(s,this.getMappedStyle("disabled")))},A.prototype._buildSpacer=function(e){const t=document.createElement("span");return this._addDataGridSpacerClass(t),this._addIndentation(e,t),t},A.prototype._getTreeDepth=function(e){return e.metadata.treeDepth?e.metadata.treeDepth:null},A.prototype._addDataGridSpacerClass=function(e){this.m_utils.addCSSClassName(e,this.getMappedStyle("spacer"))},A.prototype._isLeaf=function(e){return!e.metadata.expanded||null===e.metadata.expanded},A.prototype._addIndentation=function(e,t){let i=this._getTreeDepth(e);null!==i&&this._appendSpacerClass(i,t,e)},A.prototype._appendSpacerClass=function(e,t,i){t.style.width=e*A.SPACER_DEFAULT_WIDTH+(this._isLeaf(i)?A.SPACER_DEFAULT_WIDTH:0)+"rem"},A.prototype._handleDisclosureMouseOut=function(e){const t=e.target,i=this.findHeader(t),s=this._getDisclosureIcon(i);this.m_utils.containsCSSClassName(e.currentTarget,this.getMappedStyle("disclosureIcon"))&&(this.m_utils.removeCSSClassName(e.currentTarget,this.getMappedStyle("hover")),this.m_utils.removeCSSClassName(s,this.getMappedStyle("hover")))},A.prototype._isDisclosureIcon=function(e){return this.m_utils.containsCSSClassName(e,this.getMappedStyle("icon"))&&this.m_utils.containsCSSClassName(e.parentElement,this.getMappedStyle("disclosureIcon"))},A.prototype._getDisclosureIcon=function(e){return this._isDisclosureIcon(e)?e:e.getElementsByClassName(this.getMappedStyle("icon"))[0]};const D=function(e){this.datagridprovider=e,this.pendingHeaderCallback={},this._registerEventListeners(),this.totalRowCount=-1,this.totalColumnCount=-1,this.rowKeyMap=new N,this.columnKeyMap=new N,D.superclass.constructor.call(this)};function L(e,t,i){this.results=e,this.rowKeyMap=t,this.columnKeyMap=i,this.databodyResults=e.results.databody,this.rowStart=this.results.rowOffset,this.rowCount=this.results.rowCount,this.rowEnd=this.rowStart+this.rowCount-1,this.columnStart=this.results.columnOffset,this.columnCount=this.results.columnCount,this.columnEnd=this.columnStart+this.columnCount-1,this.lastItem=null}function T(e,t,i){this.results=e,this.axis=t,this.axisResults=e.results[this.axis+"Header"],this.axisLabels=e.results[this.axis+"HeaderLabel"],"row"===this.axis||"rowEnd"===this.axis?(this.start=this.results.rowOffset,this.count=this.results.rowCount):(this.start=this.results.columnOffset,this.count=this.results.columnCount),this.end=this.start+this.count-1,this.lastItem=null,this.keyMap=i,this.levelCount=null}function N(){this.keyMap=new Map,this.nextKey=0,this.set=(e,t,i,s)=>{const o=""+this.nextKey;null==s&&(s=1);for(let n=0;n<s;n++){let s=null==t?t:t+n,r=this.pairIndexLevel(e,s,i);this.keyMap.set(r,o)}return this.nextKey+=1,o},this.get=(e,t,i,s)=>{const o=this.pairIndexLevel(e,t,i);let n=this.keyMap.get(o);return null==n&&(n=this.set(e,t,i,s)),n},this.pairIndexLevel=(e,t,i)=>null==t||null!=i&&t===i-1?""+e:e+","+t,this.handleOffsetChange=e=>{let t=new Map;const i=[...this.keyMap.keys()];for(let s=0;s<i.length;s++){let o=i[s].split(",");parseInt(o[0],10)<e&&t.set(i[s],this.keyMap.get(i[s]))}this.keyMap=t},this.handleChange=(e,t)=>{let i=new Set;e.forEach(function(e){let t=e.offset,s=e.count;for(var o=0;o<s;o++)i.add(t+o)});let s=Array.from(i);s.sort(function(e,t){return e-t});let o=new Map;this.keyMap.forEach((e,i)=>{let n=i.split(","),r=parseInt(n[0],10),l=n[1];if(t&&s.some(e=>e===r))return;let a=0;if(r>=s[0]){let e=r;a=s.findIndex(i=>(!t&&e>=i&&(e+=1),i>e)),-1===a&&(a=s.length)}let h=t?r-a:r+a,d=this.pairIndexLevel(h,l);o.set(d,e)}),this.keyMap=o}}async function k(){return E.loadAllPendingBundles()}h.Object.createSubclass(D,h.DataGridDataSource,"DataGridProviderDataGridDataSource"),D.prototype.fetchHeaders=function(e,t,i){if(null!=t){var s=e.axis,o={headerRange:e,callbacks:t,callbackObjects:i};this.pendingHeaderCallback[s]=o}},D.prototype.fetchCells=function(e,t,i){let s,o,n,r;for(let t=0;t<e.length;t+=1){let i=e[t];"row"===i.axis?(s=i.start,o=i.count):"column"===i.axis&&(n=i.start,r=i.count)}let l,a=this.pendingHeaderCallback.row,h=this.pendingHeaderCallback.column;this.pendingHeaderCallback={},l=a&&h?["all"]:a?["databody","rowHeader","rowEndHeader","rowHeaderLabel","rowEndHeaderLabel"]:h?["databody","columnHeader","columnEndHeader","columnHeaderLabel","columnEndHeaderLabel"]:["databody"];let d={rowOffset:s,columnOffset:n,rowCount:o,columnCount:r,fetchRegions:new Set(l)},m=(s,o)=>{let n,r,l;null!=o?(s.results=Object.assign({},s.results,o.results),null!=o.next&&(n=o.next)):null!=s.next&&(n=s.next),this.totalRowCount=s.totalRowCount,this.totalColumnCount=s.totalColumnCount;let d=s.results;if(h&&(!n||null!=d.columnHeader&&null!=d.columnEndHeader&&null!=d.columnHeaderLabel&&null!=d.columnEndHeaderLabel)&&(r=h.callbacks,null!=r&&null!=r.success)){let e,t;l=h.callbackObjects,null!=d.columnHeader&&(e=new T(s,"column",this.columnKeyMap)),null!=d.columnEndHeader&&(t=new T(s,"columnEnd",this.columnKeyMap)),r.success.call(l.success,e,h.headerRange,t),h=null}if(a&&(!n||null!=d.rowHeader&&null!=d.rowEndHeader&&null!=d.rowHeaderLabel&&null!=d.rowEndHeaderLabel)&&(r=a.callbacks,null!=r&&null!=r.success)){let e,t;l=a.callbackObjects,null!=d.rowHeader&&(e=new T(s,"row",this.rowKeyMap)),null!=d.rowEndHeader&&(t=new T(s,"rowEnd",this.rowKeyMap)),r.success.call(l.success,e,a.headerRange,t),a=null}if(null!=t&&null!=t.success&&!n){let o=new L(s,this.rowKeyMap,this.columnKeyMap);t.success.call(i.success,o,e)}n&&n.then(m.bind(this,s))};Promise.all([this.datagridprovider.fetchByOffset(d),k()]).then(e=>{m(e[0])},s=>{h?.callbacks?.error&&(h.callbacks.error.call(h.callbackObjects?.error,s,h.headerRange),h=null),a?.callbacks?.error&&(a.callbacks.error.call(a.callbackObjects?.error,s,a.headerRange),a=null),t?.error&&t.error.call(i?.error,s,e)})},D.prototype.getCapability=function(e){return"sort"===e?"full":"sort"===e||"move"===e?"none":null},D.prototype.getCount=function(e){return"row"===e?this.totalRowCount:"column"===e?this.totalColumnCount:-1},D.prototype.getCountPrecision=function(){return"exact"},D.prototype.indexes=function(){return{row:-1,column:-1}},D.prototype.keys=function(){return{row:null,column:null}},D.prototype.move=function(){},D.prototype.moveOK=function(){return"invalid"},D.prototype.sort=function(){},D.prototype._registerEventListeners=function(){this._addListener=this._handleDataGridProviderAddEvent.bind(this),this._removeListener=this._handleDataGridProviderRemoveEvent.bind(this),this._updateListener=this._handleDataGridProviderUpdateEvent.bind(this),this._refreshListener=this._handleDataGridProviderRefreshEvent.bind(this),this.datagridprovider.addEventListener("add",this._addListener),this.datagridprovider.addEventListener("remove",this._removeListener),this.datagridprovider.addEventListener("update",this._updateListener),this.datagridprovider.addEventListener("refresh",this._refreshListener)},D.prototype.Destroy=function(){this.datagridprovider.removeEventListener("add",this._addListener),this.datagridprovider.removeEventListener("remove",this._removeListener),this.datagridprovider.removeEventListener("update",this._updateListener),this.datagridprovider.removeEventListener("refresh",this._refreshListener)},D.prototype.updateTotalCount=function(e,t,i){"row"===t&&-1===this.totalRowCount||"column"===t&&-1===this.totalColumnCount||e.forEach(e=>{let s=i*e.count;"row"===t?this.totalRowCount+=s:"column"===t&&(this.totalColumnCount+=s)})},D.prototype._handleDataGridProviderAddEvent=function(e){var t={source:this,operation:"insert",detail:e.detail};("row"===e.detail.axis?this.rowKeyMap:this.columnKeyMap).handleChange(e.detail.ranges,!1),this.updateTotalCount(e.detail.ranges,e.detail.axis,1),this.handleEvent("change",t)},D.prototype._handleDataGridProviderRemoveEvent=function(e){var t={source:this,operation:"delete",detail:e.detail};("row"===e.detail.axis?this.rowKeyMap:this.columnKeyMap).handleChange(e.detail.ranges,!0),this.updateTotalCount(e.detail.ranges,e.detail.axis,-1),this.handleEvent("change",t)},D.prototype._handleDataGridProviderUpdateEvent=function(e){var t={source:this,operation:"update",detail:e.detail};this.handleEvent("change",t)},D.prototype._handleDataGridProviderRefreshEvent=function(e){let t=!0;if(e&&null!=e.detail){const i=e.detail;if(null!=i.disregardAfterColumnOffset){const e=i.disregardAfterColumnOffset+1;this.columnKeyMap.handleOffsetChange(e),t=!1}if(null!=i.disregardAfterRowOffset){const e=i.disregardAfterRowOffset+1;this.rowKeyMap.handleOffsetChange(e),t=!1}}t&&(this.columnKeyMap=new N,this.rowKeyMap=new N);const i={source:this,operation:"refresh",detail:e.detail};this.handleEvent("change",i)},L.prototype.getData=function(e){return this._findItemByIndex(e.row,e.column).data},L.prototype.getMetadata=function(e){let t=this._findItemByIndex(e.row,e.column);return{metadata:t.metadata,keys:{row:this.rowKeyMap.get(t.rowIndex),column:this.columnKeyMap.get(t.columnIndex)}}},L.prototype.getCount=function(e){if(null!=this.databodyResults){if("row"===e)return this.rowCount;if("column"===e)return this.columnCount}return 0},L.prototype.getExtent=function(e){let t=!1,i=!1,s=!1,o=!1,n=this._findItemByIndex(e.row,e.column),r=n.rowIndex,l=n.rowExtent,a=r+l-1,h=n.columnIndex,d=n.columnExtent,m=h+d-1;return r<this.rowStart&&(l-=this.rowStart-r,t=!0),a>this.rowEnd&&(l-=a-this.rowEnd,i=!0),h<this.columnStart&&(d-=this.columnStart-h,s=!0),m>this.columnEnd&&(d-=m-this.columnEnd,o=!0),{row:{extent:l,more:{before:t,after:i}},column:{extent:d,more:{before:s,after:o}}}},L.prototype._findItemByIndex=function(e,t){let i=i=>{let s=i.rowIndex,o=i.rowExtent,n=i.columnIndex,r=i.columnExtent;return e>=s&&e<s+o&&t>=n&&t<n+r};return null!=this.lastItem&&i(this.lastItem)||(this.lastItem=this.databodyResults.find(i)),this.lastItem},T.prototype.getData=function(e,t){return this._findItemByIndexLevel(e,t).data},T.prototype.getMetadata=function(e,t){let i=this._findItemByIndexLevel(e,t),s=i.metadata.sortDirection;return null!=s&&(s="unsorted"===i.metadata.sortDirection?null:s),{metadata:i.metadata,key:this.keyMap.get(i.index,i.level,this.getLevelCount(),i.depth),sortDirection:s}},T.prototype.getLevelCount=function(){if(null==this.levelCount){let e=0;null!=this.axisResults&&this.axisResults.forEach(t=>{let i=t.level+t.depth-1;i>e&&(e=i)}),this.levelCount=e+1}return this.levelCount},T.prototype.getExtent=function(e,t){let i=this._findItemByIndexLevel(e,t),s=i.extent,o=i.index,n=i.index+s-1,r=!1,l=!1;return o<this.start&&(s-=this.start-o,r=!0),n>this.end&&(s-=n-this.end,l=!0),{extent:s,more:{before:r,after:l}}},T.prototype.getLabel=function(e){return null!=this.axisLabels?this.axisLabels[e].data:null},T.prototype.getLabelMetadata=function(e){return null!=this.axisLabels?{metadata:this.axisLabels[e].metadata}:null},T.prototype.getDepth=function(e,t){return this._findItemByIndexLevel(e,t).depth},T.prototype.getCount=function(){return null!=this.axisResults?this.count:0},T.prototype._findItemByIndexLevel=function(e,t){let i=i=>{let s=i.index,o=i.extent,n=i.level,r=i.depth;return e>=s&&e<s+o&&t>=n&&t<n+r};return null!=this.lastItem&&i(this.lastItem)||(this.lastItem=this.axisResults.find(i)),this.lastItem};const O=function(e){this.datagridprovider=e,this.pendingHeaderCallback={},this._registerEventListeners(),this.totalRowCount=-1,this.totalColumnCount=-1,this.totalFrozenRowCount=-1,this.totalFrozenColumnCount=-1,this.rowKeyMap=new B,this.columnKeyMap=new B,O.superclass.constructor.call(this)};function P(e,t,i){this.results=e,this.rowKeyMap=t,this.columnKeyMap=i,this.databodyResults=e.results.databody,this.rowStart=this.results.rowOffset,this.rowCount=this.results.rowCount,this.rowEnd=this.rowStart+this.rowCount-1,this.columnStart=this.results.columnOffset,this.columnCount=this.results.columnCount,this.columnEnd=this.columnStart+this.columnCount-1,this.lastItem=null}function W(e,t,i){this.results=e,this.axis=t,this.axisResults=e.results[this.axis+"Header"],this.axisLabels=e.results[this.axis+"HeaderLabel"],"row"===this.axis||"rowEnd"===this.axis?(this.start=this.results.rowOffset,this.count=this.results.rowCount):(this.start=this.results.columnOffset,this.count=this.results.columnCount),this.end=this.start+this.count-1,this.lastItem=null,this.keyMap=i,this.levelCount=null}function B(){this.keyMap=new Map,this.nextKey=0,this.set=(e,t,i,s)=>{const o=""+this.nextKey;null==s&&(s=1);for(let n=0;n<s;n++){let s=null==t?t:t+n,r=this.pairIndexLevel(e,s,i);this.keyMap.set(r,o)}return this.nextKey+=1,o},this.get=(e,t,i,s)=>{const o=this.pairIndexLevel(e,t,i);let n=this.keyMap.get(o);return null==n&&(n=this.set(e,t,i,s)),n},this.pairIndexLevel=(e,t,i)=>null==t||null!=i&&t===i-1?""+e:e+","+t,this.handleOffsetChange=e=>{let t=new Map;const i=[...this.keyMap.keys()];for(let s=0;s<i.length;s++){let o=i[s].split(",");parseInt(o[0],10)<e&&t.set(i[s],this.keyMap.get(i[s]))}this.keyMap=t},this.handleChange=(e,t)=>{let i=new Set;e.forEach(function(e){let t=e.offset,s=e.count;for(var o=0;o<s;o++)i.add(t+o)});let s=Array.from(i);s.sort(function(e,t){return e-t});let o=new Map;this.keyMap.forEach((e,i)=>{let n=i.split(","),r=parseInt(n[0],10),l=n[1];if(t&&s.some(e=>e===r))return;let a=0;if(r>=s[0]){let e=r;a=s.findIndex(i=>(!t&&e>=i&&(e+=1),i>e)),-1===a&&(a=s.length)}let h=t?r-a:r+a,d=this.pairIndexLevel(h,l);o.set(d,e)}),this.keyMap=o}}h.Object.createSubclass(O,h.DataGridDataSource,"DataGridProviderFrozenDataGridDataSource"),O.prototype.fetchHeaders=function(e,t,i,s){if(null!=t){var o=e?.axis?e.axis:s.axis,n={headerRange:e,callbacks:t,callbackObjects:i,frozenHeaderRange:s};this.pendingHeaderCallback[o]=n}},O.prototype.fetchCells=async function(e,t,i,s){let o,n,r,l,a,h,d,m,c,u,_,g,p,f,C,y;for(let t=0;t<e.length;t+=1){let i=e[t];"row"===i.axis?(o=i.start,n=i.count):"column"===i.axis&&(r=i.start,l=i.count)}for(let e=0;e<s.length;e++){let t=s[e];"row"===t.axis?(a=t.rowStart,h=t.rowCount,d=t.colStart,m=t.colCount):"column"===t.axis?(c=t.colStart,u=t.colCount,_=t.rowStart,g=t.rowCount):"corner"===t.axis&&(p=void 0===t.colStart?0:t.colStart,f=void 0===t.rowStart?0:t.rowStart,C=void 0===u?t.colCount:u,y=void 0===y?t.rowCount:h)}let w,v=this.pendingHeaderCallback.row,x=this.pendingHeaderCallback.column;this.pendingHeaderCallback={},w=v&&x?["all"]:v?["databody","rowHeader","rowEndHeader","rowHeaderLabel","rowEndHeaderLabel"]:x?["databody","columnHeader","columnEndHeader","columnHeaderLabel","columnEndHeaderLabel"]:["databody"];let H,b,S,R={rowOffset:o,columnOffset:r,rowCount:n,columnCount:l,fetchRegions:new Set(w)};void 0!==a&&(H={rowOffset:a,rowCount:h,columnOffset:d,columnCount:m,fetchRegions:new Set(w)}),void 0!==c&&(b={rowOffset:_,rowCount:g,columnOffset:c,columnCount:u,fetchRegions:new Set(w)}),(void 0!==y&&void 0!==C||void 0!==f&&void 0!==p)&&(S={rowOffset:f,columnOffset:p,rowCount:y,columnCount:C,fetchRegions:new Set(w)});let I=async(o,n,r,l,a)=>{let h,d,m,c,u,_;void 0===r?.results&&(r=void 0),void 0===l?.results&&(l=void 0),void 0===a?.results&&(a=void 0),null!=n?(o.results=Object.assign({},o.results,n.results),null!=n.next&&(h=n.next)):null!=o.next&&(h=o.next),null!=r?.next&&(d=r.next),null!=l?.next&&(m=l.next),null!=a?.next&&(c=a.next),this.totalRowCount=o.totalRowCount,this.totalColumnCount=o.totalColumnCount,this.totalFrozenRowCount=r?.rowCount,this.totalFrozenColumnCount=l?.columnCount;let g=o.results,p=l?.results,f=r?.results;if(x&&(!h||null!=g.columnHeader&&null!=g.columnEndHeader&&null!=g.columnHeaderLabel&&null!=g.columnEndHeaderLabel)||!h||null!=p.columnHeader&&null!=p.columnEndHeader&&null!=p.columnHeaderLabel&&null!=p.columnEndHeaderLabel){let e,t,i,s;u=x?.callbacks,null!=u&&null!=u.success&&(_=x.callbackObjects,Object.keys(x.headerRange).length&&(null!=g.columnHeader&&(e=new W(o,"column",this.columnKeyMap)),null!=g.columnEndHeader&&(t=new W(o,"columnEnd",this.columnKeyMap))),null!=p?.columnHeader&&(i=new W(l,"column",this.columnKeyMap,!0)),null!=p?.columnEndHeader&&(s=new W(l,"columnEnd",this.columnKeyMap,!0))),null!=x&&(u.success.call(_.success,e,x.headerRange,t,!1,i,x?.frozenHeaderRange,s),x=null)}if(v&&(!h||null!=g.rowHeader&&null!=g.rowEndHeader&&null!=g.rowHeaderLabel&&null!=g.rowEndHeaderLabel)||!h||null!=f.rowHeader&&null!=f.rowEndHeader&&null!=f.rowHeaderLabel&&null!=f.rowEndHeaderLabel){let e,t,i,s;u=v?.callbacks,null!=u&&null!=u.success&&(_=v.callbackObjects,Object.keys(v.headerRange).length&&(null!=g.rowHeader&&(e=new W(o,"row",this.rowKeyMap)),null!=g.rowEndHeader&&(t=new W(o,"rowEnd",this.rowKeyMap))),null!=f?.rowHeader&&(i=new W(r,"row",this.rowKeyMap,!0)),null!=f?.rowEndHeader&&(s=new W(r,"rowEnd",this.rowKeyMap,!0))),null!=v&&(u.success.call(_?.success,e,v?.headerRange,t,!1,i,v?.frozenHeaderRange,s),v=null)}if(null!=t&&null!=t.success&&!h){let n,h,d,m=new P(o,this.rowKeyMap,this.columnKeyMap);r&&(n=new P(r,this.rowKeyMap,this.columnKeyMap)),l&&(h=new P(l,this.rowKeyMap,this.columnKeyMap)),a&&(d=new P(a,this.rowKeyMap,this.columnKeyMap)),t.success.call(i.success,m,e,void 0,s,n,h,d)}if(h){let e=await h;null!=e&&(o.results=Object.assign({},o.results,e.results),o.next=e.next)}if(d){let e=await d;null!=e&&(r.results=Object.assign({},r.results,e.results),r.next=e.next)}if(m){let e=await m;null!=e&&(l.results=Object.assign({},l.results,e.results),l.next=e.next)}if(c){let e=await c;null!=e&&(a.results=Object.assign({},a.results,e.results),a.next=e.next)}(h||d||m||c)&&I(o,null,r,l,a)},z=[this.datagridprovider.fetchByOffset(R)];H?z.push(this.datagridprovider.fetchByOffset(H)):z.push([]),b?z.push(this.datagridprovider.fetchByOffset(b)):z.push([]),S&&z.push(this.datagridprovider.fetchByOffset(S)),z.push(async function(){return E.loadAllPendingBundles()}()),Promise.all(z).then(e=>{I(e[0],null,e[1],e[2],e[3])},s=>{x?.callbacks?.error&&(x.callbacks.error.call(x.callbackObjects?.error,s,x.headerRange),x=null),v?.callbacks?.error&&(v.callbacks.error.call(v.callbackObjects?.error,s,v.headerRange),v=null),t?.error&&t.error.call(i?.error,s,e)})},O.prototype.getCapability=function(e){return"sort"===e?"full":"sort"===e||"move"===e?"none":null},O.prototype.getCount=function(e){return"row"===e?this.totalRowCount:"column"===e?this.totalColumnCount:-1},O.prototype.getCountPrecision=function(){return"exact"},O.prototype.indexes=function(){return{row:-1,column:-1}},O.prototype.keys=function(){return{row:null,column:null}},O.prototype.move=function(){},O.prototype.moveOK=function(){return"invalid"},O.prototype.sort=function(){},O.prototype._registerEventListeners=function(){this._addListener=this._handleDataGridProviderAddEvent.bind(this),this._removeListener=this._handleDataGridProviderRemoveEvent.bind(this),this._updateListener=this._handleDataGridProviderUpdateEvent.bind(this),this._refreshListener=this._handleDataGridProviderRefreshEvent.bind(this),this.datagridprovider.addEventListener("add",this._addListener),this.datagridprovider.addEventListener("remove",this._removeListener),this.datagridprovider.addEventListener("update",this._updateListener),this.datagridprovider.addEventListener("refresh",this._refreshListener)},O.prototype.Destroy=function(){this.datagridprovider.removeEventListener("add",this._addListener),this.datagridprovider.removeEventListener("remove",this._removeListener),this.datagridprovider.removeEventListener("update",this._updateListener),this.datagridprovider.removeEventListener("refresh",this._refreshListener)},O.prototype.updateTotalCount=function(e,t,i){"row"===t&&-1===this.totalRowCount||"column"===t&&-1===this.totalColumnCount||e.forEach(e=>{let s=i*e.count;"row"===t?this.totalRowCount+=s:"column"===t&&(this.totalColumnCount+=s)})},O.prototype._handleDataGridProviderAddEvent=function(e){var t={source:this,operation:"insert",detail:e.detail};("row"===e.detail.axis?this.rowKeyMap:this.columnKeyMap).handleChange(e.detail.ranges,!1),this.updateTotalCount(e.detail.ranges,e.detail.axis,1),this.handleEvent("change",t)},O.prototype._handleDataGridProviderRemoveEvent=function(e){var t={source:this,operation:"delete",detail:e.detail};("row"===e.detail.axis?this.rowKeyMap:this.columnKeyMap).handleChange(e.detail.ranges,!0),this.updateTotalCount(e.detail.ranges,e.detail.axis,-1),this.handleEvent("change",t)},O.prototype._handleDataGridProviderUpdateEvent=function(e){var t={source:this,operation:"update",detail:e.detail};this.handleEvent("change",t)},O.prototype._handleDataGridProviderRefreshEvent=function(e){let t=!0;if(e&&null!=e.detail){const i=e.detail;if(null!=i.disregardAfterColumnOffset){const e=i.disregardAfterColumnOffset+1;this.columnKeyMap.handleOffsetChange(e),t=!1}if(null!=i.disregardAfterRowOffset){const e=i.disregardAfterRowOffset+1;this.rowKeyMap.handleOffsetChange(e),t=!1}}t&&(this.columnKeyMap=new B,this.rowKeyMap=new B);const i={source:this,operation:"refresh",detail:e.detail};this.handleEvent("change",i)},P.prototype.getData=function(e){return this._findItemByIndex(e.row,e.column).data},P.prototype.getMetadata=function(e){let t=this._findItemByIndex(e.row,e.column);return{metadata:t.metadata,keys:{row:this.rowKeyMap.get(t.rowIndex),column:this.columnKeyMap.get(t.columnIndex)}}},P.prototype.getCount=function(e){if(null!=this.databodyResults){if("row"===e)return this.rowCount;if("column"===e)return this.columnCount}return 0},P.prototype.getExtent=function(e){let t=!1,i=!1,s=!1,o=!1,n=this._findItemByIndex(e.row,e.column),r=n.rowIndex,l=n.rowExtent,a=r+l-1,h=n.columnIndex,d=n.columnExtent,m=h+d-1;return r<this.rowStart&&(l-=this.rowStart-r,t=!0),a>this.rowEnd&&(l-=a-this.rowEnd,i=!0),h<this.columnStart&&(d-=this.columnStart-h,s=!0),m>this.columnEnd&&(d-=m-this.columnEnd,o=!0),{row:{extent:l,more:{before:t,after:i}},column:{extent:d,more:{before:s,after:o}}}},P.prototype._findItemByIndex=function(e,t){let i=i=>{let s=i.rowIndex,o=i.rowExtent,n=i.columnIndex,r=i.columnExtent;return e>=s&&e<s+o&&t>=n&&t<n+r};return null!=this.lastItem&&i(this.lastItem)||(this.lastItem=this.databodyResults.find(i)),this.lastItem},W.prototype.getData=function(e,t){return this._findItemByIndexLevel(e,t).data},W.prototype.getMetadata=function(e,t){let i=this._findItemByIndexLevel(e,t),s=i.metadata.sortDirection;return null!=s&&(s="unsorted"===i.metadata.sortDirection?null:s),{metadata:i.metadata,key:this.keyMap.get(i.index,i.level,this.getLevelCount(),i.depth),sortDirection:s}},W.prototype.getLevelCount=function(){if(null==this.levelCount){let e=0;null!=this.axisResults&&this.axisResults.forEach(t=>{let i=t.level+t.depth-1;i>e&&(e=i)}),this.levelCount=e+1}return this.levelCount},W.prototype.getExtent=function(e,t){let i=this._findItemByIndexLevel(e,t),s=i.extent,o=i.index,n=i.index+s-1,r=!1,l=!1;return o<this.start&&(s-=this.start-o,r=!0),n>this.end&&(s-=n-this.end,l=!0),{extent:s,more:{before:r,after:l}}},W.prototype.getLabel=function(e){return null!=this.axisLabels?this.axisLabels[e].data:null},W.prototype.getLabelMetadata=function(e){return null!=this.axisLabels?{metadata:this.axisLabels[e].metadata}:null},W.prototype.getDepth=function(e,t){return this._findItemByIndexLevel(e,t).depth},W.prototype.getCount=function(){return null!=this.axisResults?this.count:0},W.prototype._findItemByIndexLevel=function(e,t){let i=i=>{let s=i.index,o=i.extent,n=i.level,r=i.depth;return e>=s&&e<s+o&&t>=n&&t<n+r};return null!=this.lastItem&&i(this.lastItem)||(this.lastItem=this.axisResults.find(i)),this.lastItem},h.__registerWidget("oj.ojDataGrid",C.oj.baseComponent,{widgetEventPrefix:"oj",options:{bandingInterval:{row:0,column:0},data:null,gridlines:{horizontal:"visible",vertical:"visible"},scrollToKey:"auto",scrollPosition:{x:0,y:0},selectionMode:{cell:"none",row:"none"},dnd:{reorder:{row:"disable"},drag:null,drop:null},dataTransferOptions:{cut:"disable",copy:"disable",paste:"disable",fill:"disable",headerLabelCut:"disable"},frozenColumnCount:null,frozenRowCount:null,scrollPolicy:"auto",scrollPolicyOptions:{maxRowCount:500,maxColumnCount:500},selection:[],hiddenColumns:new Set([]),hiddenRows:new Set([]),currentCell:null,editMode:"none",editCell:null,header:{row:{alignment:{horizontal:"auto",vertical:"auto"},className:null,label:{alignment:{horizontal:"auto",vertical:"auto"},renderer:null,className:null,style:null,sortable:"disable",description:null},renderer:null,resizable:{width:"disable",height:"disable"},sortable:"auto",style:null,hidable:"disable",freezable:"disable",description:null},column:{alignment:{horizontal:"auto",vertical:"auto"},className:null,filterable:"disable",label:{alignment:{horizontal:"auto",vertical:"auto"},renderer:null,className:null,style:null,sortable:"disable",description:null},renderer:null,resizable:{width:"disable",height:"disable"},sortable:"auto",style:null,hidable:"disable",freezable:"disable",description:null},columnEnd:{alignment:{horizontal:"auto",vertical:"auto"},className:null,label:{alignment:{horizontal:"auto",vertical:"auto"},renderer:null,className:null,style:null,sortable:"disable",description:null},renderer:null,resizable:{width:"disable",height:"disable"},style:null,description:null},rowEnd:{alignment:{horizontal:"auto",vertical:"auto"},className:null,label:{alignment:{horizontal:"auto",vertical:"auto"},renderer:null,className:null,style:null,sortable:"disable",description:null},renderer:null,resizable:{width:"disable",height:"disable"},style:null,description:null}},cell:{alignment:{horizontal:"auto",vertical:"auto"},className:null,editable:"enable",renderer:null,style:null},resize:null,cellResize:null,sort:null,sortRequest:null,sortLabelRequest:null,collapseRequest:null,expandRequest:null,filterRequest:null,ready:null,scroll:null,beforeCurrentCell:null,beforeEdit:null,beforeEditEnd:null,cutRequest:null,copyRequest:null,pasteRequest:null,fillRequest:null,headerLabelCutRequest:null},_ComponentCreate:function(){this._super(),this._isCreate=!0,this.root=this.element[0],this.rootId=this.root.getAttribute("id"),this.grid=new A(this.root),this.grid.setVisibility(A.VISIBILITY_STATE_RENDER),C(this.root).addClass("oj-datagrid oj-component"),C(this.root).attr(m._OJ_CONTAINER_ATTR,this.widgetName),u.disableDefaultBrowserStyling(this.root),this.redrawSet={data:"all",header:["className","renderer","style","template"]}},_AfterCreate:function(){var e=this;this._unregisterResizeListener(this.root),this._removeAllChildren(),this._super(),this.resources=new x(this._GetReadingDirection(),this._getTranslation.bind(e),{showIndicatorDelay:w.getCachedCSSVarValues(["--oj-private-core-global-loading-indicator-delay-duration"])[0],loadIndicator:w.getCachedCSSVarValues(["--oj-private-data-grid-global-load-indicator-default"])[0]},this.widgetName),this._setDataSource(),this._setSelection(),this._hideColumns(),this._hideRows(),null!=this.datasource&&(this.grid.SetDataSource(this.datasource),this._addContextMenu(),this.grid._addDataSourceEventListeners()),this._checkSelectionMode(this.options),this.grid.SetOptions(this.options,this._WrapCustomElementRenderer.bind(e)),this.grid.SetResources(this.resources),this.grid.SetCreateContextCallback(this._modifyContext.bind(e)),this.grid.SetFixContextCallback(this._FixRendererContext.bind(e)),this.grid.SetRemoveCallback(this._remove.bind(e)),this.grid.SetUniqueIdCallback(this._uniqueId.bind(e)),this.grid.SetCompareValuesCallback(this._compareValues.bind(e)),this.grid.SetNotReadyCallback(this._NotReady.bind(e)),this.grid.SetMakeReadyCallback(this._MakeReady.bind(e)),this.grid.SetOptionCallback(this.option.bind(e)),this.grid.SetSubtreeAttachedCallback(m.subtreeAttached),this.grid.SetContextCallback(c.getContext),this.grid.SetCustomElementCallback(this._IsCustomElement.bind(e)),this.grid.SetUpdateScrollPostionOnRefreshCallback(this._updateScrollPositionOnRefresh.bind(e)),this.grid.SetCustomElement(this._GetCustomElement()),this._focusable({applyHighlight:!0,setupHandlers:function(t,i){e.grid.SetFocusableCallback.call(e.grid,function(e){return t(C(e))},function(e){return i(C(e))})}}),this._registerEventListeners(),this._possiblyRenderOrRefresh()},_SetupResources:function(){this._super(),this.setupResources(!this._isCreate)},setupResources:function(e){null!=this.datasource&&(e||this.grid._addDataSourceEventListeners(),this.grid._addDomEventListeners(),this._registerResizeListener(this.root)),e&&this.refresh(),this._isCreate=!1},_ReleaseResources:function(){this._super(),this.releaseResources()},releaseResources:function(){this.grid._removeDataSourceEventListeners(),this.grid._removeDomEventListeners(),this._unregisterResizeListener(this.root),this.contextMenuEvent=null,this._removeAllChildren(),this.grid.m_fetching=null},_registerEventListeners:function(){var e=this;this.grid.addListener("resize",function(t){e._trigger("resize",t.event,t.ui)}),this.grid.addListener("select",function(t){e.option("selection",t.ui.selection,{_context:{originalEvent:t.event,internalSet:!0},changed:!0})}),this.grid.addListener("currentCell",function(t){e.option("currentCell",t.ui,{_context:{originalEvent:t.event,internalSet:!0},changed:!0})}),this.grid.addListener("beforeCurrentCell",function(t){return e._trigger("beforeCurrentCell",t.event,t.ui)}),this.grid.addListener("sort",function(t){var i=e._trigger2("sort",t.event,t.ui);e.grid.SetSortOriginalEvent(i.event)}),this.grid.addListener("sortRequest",function(t){return e._trigger("sortRequest",t.event,t.ui)}),this.grid.addListener("sortLabelRequest",function(t){return e._trigger("sortLabelRequest",t.event,t.ui)}),this.grid.addListener("expandRequest",function(t){return e._trigger("expandRequest",t.event,t)}),this.grid.addListener("collapseRequest",function(t){return e._trigger("collapseRequest",t.event,t)}),this.grid.addListener("keydown",function(t){return e._trigger("keydown",t.event,t.ui)}),this.grid.addListener("ready",function(){e._trigger("ready",null,{})}),this.grid.addListener("scroll",function(t){e._trigger("scroll",t.event,t.ui)}),this.grid.addListener("beforeEdit",function(t){return e._trigger("beforeEdit",t.event,t.ui)}),this.grid.addListener("beforeEditEnd",function(t){return e._trigger("beforeEditEnd",t.event,t.ui)}),this.grid.addListener("cutRequest",function(t){return e._trigger("cutRequest",t.event,t.ui)}),this.grid.addListener("copyRequest",function(t){return e._trigger("copyRequest",t.event,t.ui)}),this.grid.addListener("pasteRequest",function(t){return e._trigger("pasteRequest",t.event,t.ui)}),this.grid.addListener("fillRequest",function(t){return e._trigger("fillRequest",t.event,t.ui)}),this.grid.addListener("cellResize",function(t){return e._trigger("cellResize",t.event,t.ui)}),this.grid.addListener("rowFreeze",function(t){e.option("frozenRowCount",t.ui.frozenCount,{_context:{originalEvent:t.event,internalSet:!0},changed:!0})}),this.grid.addListener("columnFreeze",function(t){e.option("frozenColumnCount",t.ui.frozenCount,{_context:{originalEvent:t.event,internalSet:!0},changed:!0})}),this.grid.addListener("headerLabelCutRequest",function(t){return e._trigger("headerLabelCutRequest",t.event,t.ui)}),this.grid.addListener("columnHide",function(t){e.option("hiddenColumns",t.ui.hiddenColumns,{_context:{originalEvent:t.event,internalSet:!0},changed:!0})}),this.grid.addListener("rowHide",function(t){e.option("hiddenRows",t.ui.hiddenRows,{_context:{originalEvent:t.event,internalSet:!0},changed:!0})}),this.grid.addListener("filterRequest",function(t){return e._trigger("filterRequest",t.event,t.ui)}),this.grid.addListener("editCell",function(t){e.option("editCell",t.ui.editCell,{_context:{originalEvent:t.event,internalSet:!0},changed:!0})})},refresh:function(){this._super(),(!this._IsCustomElement()||null!=this._defaultContextMenu)&&this._ReleaseContextMenu(),this.releaseResources(),this._defaultContextMenu&&(this.options.contextMenu=null,this._defaultContextMenu=null),this._setDataSource(),null!=this.datasource&&(h.FlattenedTreeDataGridDataSource&&this.datasource instanceof h.FlattenedTreeDataGridDataSource&&(this.datasource.Destroy(),this.datasource.Init()),this.grid.SetDataSource(this.datasource),this._addContextMenu()),this.grid.SetOptions(this.options,this._WrapCustomElementRenderer.bind(this)),this.resources.setRTLMode(this._GetReadingDirection()),this.grid.SetResources(this.resources),(!this._IsCustomElement()||null!=this._defaultContextMenu)&&this._SetupContextMenu(),this.setupResources(!1),this.grid.getVisibility()!==A.VISIBILITY_STATE_RENDER&&this.grid.setVisibility(A.VISIBILITY_STATE_REFRESH),this._possiblyRenderOrRefresh()},_updateScrollPositionOnRefresh:function(e,t){var i=this.options.selection,s={};if(null!=i&&0!==i.length){var o=i[i.length-1];o&&(o.startKey?(s.rowKey=o.startKey.row,s.columnKey=o.startKey.column):o.startIndex&&(s.rowIndex=0,s.columnIndex=0))}else s={x:0,y:0};null!=e&&(s.x=e),null!=t&&(s.y=t),this.option("scrollPosition",s,{_context:{internalSet:!0},changed:!1})},_destroy:function(){C(this.root).removeAttr(m._OJ_CONTAINER_ATTR),null!=this.datasource&&this.datasource.Destroy&&this.datasource.Destroy(),this.grid.destroy(),this._unregisterResizeListener(this.root),C(this.root).empty(),this._MakeReady()},_setOptions:function(e,t){if(this.datasource){let i="refresh";this.grid.getVisibility()!==A.VISIBILITY_STATE_RENDER&&(i=this._handleOptionUpdate(e,t)),this._super(e,t),"refresh"===i?this.refresh():"pass"===i&&this.grid.UpdateOptions(e,t)}else this._super(e,t),null!=e.data&&this.refresh()},_checkSelectionMode:function(e){var t=e.selectionMode;if(t&&t.row&&t.cell&&"none"!==t.row&&"none"!==t.cell)throw new Error("JET DataGrid does not support selectionMode on cell and row simultaneously.")},_NotifyShown:function(){this._super(),this._possiblyRenderOrRefresh()},_NotifyHidden:function(){this._super(),this.grid.getVisibility()===A.VISIBILITY_STATE_VISIBLE&&this.grid.setVisibility(A.VISIBILITY_STATE_HIDDEN)},_NotifyAttached:function(){this._super(),this._possiblyRenderOrRefresh()&&this.grid._initiateScrollOnAttached()},_NotifyDetached:function(){this._super(),this.grid.getVisibility()===A.VISIBILITY_STATE_VISIBLE&&this.grid.setVisibility(A.VISIBILITY_STATE_HIDDEN)},_VerifyConnectedForSetup:function(){return!0},_handleOptionUpdate:function(e,t){for(var i="ignore",s=Object.keys(e),o=0;o<s.length;o++){switch(s[o]){case"bandingInterval":case"currentCell":case"editMode":case"gridlines":case"scrollPosition":case"selection":case"frozenColumnCount":case"frozenRowCount":case"hiddenColumns":case"hiddenRows":case"editCell":i="pass";break;case"beforeCurrentCell":case"beforeEdit":case"beforeEditEnd":case"cutRequest":case"copyRequest":case"pasteRequest":case"fillRequest":case"create":case"disabled":case"dnd":case"optionChange":case"ready":case"resize":case"rootAttributes":case"scroll":case"sort":break;case"selectionMode":this._checkSelectionMode(e),i="pass";break;case"cell":case"header":var n=t.subkey;if(null!=n){var r=n.split(".");if("resizable"===r[1]||"sortable"===r[1]){i="pass";break}}return"refresh";case"data":return this._updateScrollPositionOnRefresh(),"refresh";default:return"refresh"}}return i},_isResizeEnabled:function(e,t){return!(!this.options.header[e]||!this.options.header[e].resizable)&&"disable"!==this.options.header[e].resizable[t]},_isSortEnabled:function(e){return!!this.options.header[e]&&"disable"!==this.options.header[e].sortable},_isSortLabelEnabled:function(e){return!!this.options.header[e]?.label&&"disable"!==this.options.header[e].label.sortable},_isFreezeEnabled:function(e){return!!this.options.header[e]&&"disable"!==this.options.header[e].freezable},_isHideEnabled:function(e){return!!this.options.header[e]&&"disable"!==this.options.header[e].hidable},_isFilterEnabled:function(e){return!!this.options.header[e]&&"disable"!==this.options.header[e].filterable},_removeAllChildren:function(){for(var e=this.root.children,t=e.length-1;t>=0;t--)"TEMPLATE"!==e[t].tagName&&"OJ-SURROGATE"!==e[t].tagName&&("OJ-MENU"!==e[t].tagName||"OJ-MENU"===e[t].tagName&&"contextMenu"!==e[t].slot)&&this._remove(e[t])},_GetDefaultContextMenu:function(){return this._defaultContextMenu},_addContextMenu:function(){var e=this,t=e._IsCustomElement(),i=this._GetContextMenu()?this._GetContextMenu():this._menuContainer;if(i){null==this._menuItemsSetByGrid&&(this._menuItemsSetByGrid=[]),this._menuContainer=i;var s=(i=C(i)).find("[data-oj-command]"),o=[];s.each(function(){var i=e._shouldUpdateListItem(this,t);if(i.shouldUpdate){var s=C(this).attr("data-oj-command").split("-");if(t){var n=e._getContextMenuText(s[s.length-1],t);i.itemToUpdate?(i.itemToUpdate.textContent=n,o.push(i.itemToUpdate)):(i.toFirstChild,this.textContent=n,o.push(this))}else{var r=C(e._buildContextMenuItem(s[s.length-1],t));C(this).replaceWith(r),o.push(r.children("a").get(0))}}}),this._menuItemsSetByGrid=o,i.data("oj-ojMenu")&&(t?i[0].refresh():i.ojMenu("refresh"))}else null!=this.datasource&&(i=this._createDefaultContextMenu())&&(this._defaultContextMenu=i[0]);i&&this._addMenuSelectListener(i)},_shouldUpdateListItem:function(e,t){var i,s=!1;if(t){if(null!=e.firstElementChild&&"opt"===e.firstElementChild.getAttribute("ojmenu")?(i=p.CustomElementUtils.getSlotMap(e.firstElementChild),s=!0):i=p.CustomElementUtils.getSlotMap(e),!i[""]||0===i[""].length)return{shouldUpdate:!0,toFirstChild:s};if(i[""]){var o=this._menuItemsSetByGrid.indexOf(e);if(-1!==o)return{shouldUpdate:!0,itemToUpdate:this._menuItemsSetByGrid[o]}}return{shouldUpdate:!1}}var n=C(e).children("a");return{shouldUpdate:0===n.length||-1!==this._menuItemsSetByGrid.indexOf(n.get(0))}},_addMenuSelectListener:function(e){var t=this._handleContextMenuSelect.bind(this);this._IsCustomElement()?e[0].addEventListener("ojAction",t):e.on("ojselect",t)},_createDefaultContextMenu:function(){let e,t,i,s,o,n,r,l,a,h,d,m,c=null,u=null,g=null;const p=this._IsCustomElement();r=p?this._createCustomElementContextMenu():this._createWidgetContextMenu(),(this._isResizeEnabled("column","height")||this._isResizeEnabled("row","height"))&&(c=this._buildContextMenuItem("resizeHeight",p)),(this._isResizeEnabled("column","width")||this._isResizeEnabled("row","width"))&&(u=this._buildContextMenuItem("resizeWidth",p)),(this._isResizeEnabled("column","width")||this._isResizeEnabled("column","height")||this._isResizeEnabled("row","width")||this._isResizeEnabled("row","height"))&&(g=this._buildContextMenuItem("resizeFitToContent",p));const f=this.datasource.getCapability("sort");if((this._isSortEnabled("column")||this._isSortLabelEnabled("column")||this._isSortLabelEnabled("columnEnd"))&&("column"!==f&&"full"!==f||(e=this._buildContextMenuItem("sortCol",p))),(this._isSortEnabled("row")||this._isSortLabelEnabled("row")||this._isSortLabelEnabled("rowEnd"))&&("row"!==f&&"full"!==f||(t=this._buildContextMenuItem("sortRow",p))),this._isHideEnabled("column")&&(l=this._buildContextMenuItem("hideCol",p),a=this._buildContextMenuItem("unhideCol",p)),this._isHideEnabled("row")&&(h=this._buildContextMenuItem("hideRow",p),d=this._buildContextMenuItem("unhideRow",p)),this._isFilterEnabled("column")&&(m=this._buildContextMenuItem("filterCol",p)),"enable"===this.options.dnd.reorder.row)if("none"===this.datasource.getCapability("move"));else p?(s=new DocumentFragment,s.appendChild(this._buildContextMenuOjOption("cut")),s.appendChild(this._buildContextMenuOjOption("paste")),s.appendChild(this._buildContextMenuDivider())):(s=new DocumentFragment,s.appendChild(this._buildContextMenuListItem("cut")),s.appendChild(this._buildContextMenuListItem("paste")));let y=[];if(y=Object.keys(this.options.dataTransferOptions).filter(e=>"enable"===this.options.dataTransferOptions[e]),y.length){let e=this.options.dataTransferOptions;o=new DocumentFragment,p?("enable"!==e.cut&&"enable"!==e.headerLabelCut||o.appendChild(this._buildContextMenuOjOption("cutCells")),"enable"===e.copy&&o.appendChild(this._buildContextMenuOjOption("copyCells")),"enable"===e.paste&&o.appendChild(this._buildContextMenuOjOption("pasteCells")),"enable"===e.fill&&o.appendChild(this._buildContextMenuOjOption("autoFill")),o.appendChild(this._buildContextMenuDivider())):("enable"!==e.cut&&"enable"!==e.headerLabelCut||o.appendChild(this._buildContextMenuListItem("cutCells")),"enable"===e.copy&&o.appendChild(this._buildContextMenuListItem("copyCells")),"enable"===e.paste&&o.appendChild(this._buildContextMenuListItem("pasteCells")),"enable"===e.fill&&o.appendChild(this._buildContextMenuListItem("autoFill")))}return this._isMultipleSelection()&&_.isTouchSupported()&&(this._discontiguousSelection=!1,p?(i=document.createElement("oj-menu-select-many"),i.setAttribute("data-oj-binding-provider","none"),i.appendChild(this._buildContextMenuOjOption("discontiguousSelection"))):i=this._buildContextMenuListItem("discontiguousSelection")),this._isFreezeEnabled("row")&&(n=new DocumentFragment,p?(n.appendChild(this._buildContextMenuOjOption("freezeRow")),n.appendChild(this._buildContextMenuOjOption("unfreezeRow"))):(n.appendChild(this._buildContextMenuListItem("freezeRow")),n.appendChild(this._buildContextMenuListItem("unfreezeRow")))),this._isFreezeEnabled("column")&&(void 0===n&&(n=new DocumentFragment),p?(n.appendChild(this._buildContextMenuOjOption("freezeCol")),n.appendChild(this._buildContextMenuOjOption("unfreezeCol"))):(n.appendChild(this._buildContextMenuListItem("freezeCol")),n.appendChild(this._buildContextMenuListItem("unfreezeCol")))),c||u||g||e||t||s||i||n||l||a||h||d||o||m?(o&&r.appendChild(o),l&&r.appendChild(l),a&&r.appendChild(a),h&&r.appendChild(h),d&&r.appendChild(d),n&&r.appendChild(n),(l||a||h||d||n)&&r.appendChild(this._buildContextMenuDivider()),c&&r.appendChild(c),u&&r.appendChild(u),g&&r.appendChild(g),(e||t||m)&&((c||u||g)&&r.appendChild(this._buildContextMenuDivider()),e&&r.appendChild(e),t&&r.appendChild(t),m&&r.appendChild(m)),s&&((c||u||g||n||l||a||h||d||e||t||m)&&r.appendChild(this._buildContextMenuDivider()),r.appendChild(s)),i&&((c||u||g||n||e||t||l||a||h||d||m||s)&&r.appendChild(this._buildContextMenuDivider()),r.appendChild(i)),p||C(r).ojMenu(),this.option("contextMenu",r,{_context:{internalSet:!0}}),C(r)):null},_createCustomElementContextMenu:function(e){const t=document.createElement("oj-menu");t.setAttribute("data-oj-binding-provider","none"),t.style.display="none";let i=e?"contextsubmenu":"contextmenu";return t.setAttribute("id",this.rootId+i),e||this.root.appendChild(t),t},_createWidgetContextMenu:function(e){const t=document.createElement("ul");let i=e?"contextsubmenu":"contextmenu";return t.setAttribute("id",this.rootId+i),t.style.display="none",e||this.root.appendChild(t),t},_buildContextMenuItem:function(e,t){if(t){if("resize"===e){const e=new DocumentFragment;return e.appendChild(this._buildContextMenuOjOption("resizeRow")),e.appendChild(this._buildContextMenuOjOption("resizeColumn")),e}if("sortCol"===e){const e=new DocumentFragment;return e.appendChild(this._buildContextMenuOjOption("sortColAsc")),e.appendChild(this._buildContextMenuOjOption("sortColDsc")),e}if("sortRow"===e){const e=new DocumentFragment;return e.appendChild(this._buildContextMenuOjOption("sortRowAsc")),e.appendChild(this._buildContextMenuOjOption("sortRowDsc")),e}if(-1!==Object.keys(this.resources.commands).indexOf(e))return this._buildContextMenuOjOption(e)}else{if("resize"===e){const e=this._buildContextMenuListItem("resize"),t=document.createElement("ul");return t.appendChild(this._buildContextMenuListItem("resizeWidth")),t.appendChild(this._buildContextMenuListItem("resizeHeight")),e.appendChild(t),e}if("sortCol"===e){const e=this._buildContextMenuListItem("sortCol"),t=document.createElement("ul");return t.appendChild(this._buildContextMenuListItem("sortColAsc")),t.appendChild(this._buildContextMenuListItem("sortColDsc")),e.appendChild(t),e}if("sortRow"===e){const e=this._buildContextMenuListItem("sortRow"),t=document.createElement("ul");return t.appendChild(this._buildContextMenuListItem("sortRowAsc")),t.appendChild(this._buildContextMenuListItem("sortRowDsc")),e.appendChild(t),e}if(-1!==Object.keys(this.resources.commands).indexOf(e))return this._buildContextMenuListItem(e)}},_buildContextMenuOjOption:function(e){const t=document.createElement("oj-option");let i;if(t.setAttribute("data-oj-command",this._getMappedCommand(e)),-1!==["cutCells","copyCells","pasteCells"].indexOf(e)){i=document.createElement("span");let t=e.indexOf("Cells"),s=e.slice(0,t);i=document.createElement("span"),i.setAttribute("slot","startIcon"),i.setAttribute("class",`oj-ux-ico-${s}`)}return t.textContent=this._getContextMenuText(e),i&&t.appendChild(i),t},_buildContextMenuDivider:function(){const e=document.createElement("oj-option");return e.textContent="---",e},_buildContextMenuListItem:function(e){const t=document.createElement("li");return t.setAttribute("data-oj-command",this._getMappedCommand(e)),t.appendChild(this._buildContextMenuLabel(e)),t},_getContextMenuText:function(e){var t=this._IsCustomElement();t&&"discontiguousSelection"===e&&(e="SelectMultiple"),"resizeWidth"===e?e="resizeColumn":"resizeHeight"===e&&(e="resizeRow"),"hideCol"===e&&(e="hideColumns"),"unhideCol"===e&&(e="unhideColumns"),"hideRow"===e&&(e="hideRows"),"unhideRow"===e&&(e="unhideRows");let i="label"+e.charAt(0).toUpperCase()+e.slice(1);return t||"discontiguousSelection"!==e||(i="labelEnableNonContiguous"),this._getTranslation(i)},_buildContextMenuLabel:function(e){const t=this._getContextMenuText(e),i=document.createElement("a");return i.setAttribute("href","#"),i.textContent=t,i},_getDataGridContextMenu:function(){return this._GetContextMenu()||this._GetDefaultContextMenu()},_getTranslation:function(e,t){return this.getTranslatedString(e,t)},_handleResizeDialog:function(e){var t,i;let s;this._IsCustomElement()?(s=document.getElementById(this.rootId+"inputNumber"),"valid"===s.valid&&document.getElementById(this.rootId+"modal").close(),t=s.value,i=document.getElementById(this.rootId+"modal").getAttribute("dimension")):(s=C("#"+this.rootId+"inputNumber"),t=C("#"+this.rootId+"inputNumber").ojInputNumber("option","value"),s.valid&&C("#"+this.rootId+"modal").ojDialog("close")),"valid"===s.valid&&(this.grid.handleContextMenuReturn(this.contextMenuEvent,this._getMappedCommand(i),t),this.contextMenuEvent.target.focus())},_buildResizeDialog:function(e,t,i){let s,o,n,r,l,a,h,d,m;if(this._IsCustomElement()){s=document.getElementById(this.rootId+"inputNumber"),n=document.getElementById(this.rootId+"modal");const u=null===n||null===s;if(u){n=document.createElement("oj-dialog"),n.id=this.rootId+"modal",n.setAttribute("data-oj-binding-provider","none"),n.setAttribute("initial-focus","firstFocusable"),n.className=this._getMappedStyle("resizeDialog"),r=document.createElement("div"),r.setAttribute("slot","header"),l=document.createElement("div"),l.setAttribute("slot","body"),a=document.createElement("div"),a.setAttribute("slot","footer"),m=document.createElement("h5"),m.textContent=e,r.appendChild(m),r.className=this._getMappedStyle("dialogTitle"),n.appendChild(r),n.appendChild(l),n.appendChild(a),s=document.createElement("oj-input-number"),s.id=this.rootId+"inputNumber",h=document.createElement("oj-button"),h.id=this.rootId+"modalcancel",h.style.margin="5px",d=document.createElement("oj-button"),d.id=this.rootId+"modalsubmit",d.style.margin="5px",d.setAttribute("chroming","callToAction"),l.appendChild(s),a.appendChild(h),a.appendChild(d),this.root.appendChild(n),h.textContent=this._getTranslation("labelResizeDialogCancel"),d.textContent=this._getTranslation("labelResizeDialogApply"),o=()=>{d.disabled=!1,s.value=0,n.close()},h.addEventListener("click",o),d.addEventListener("click",this._handleResizeDialog.bind(this));const t={my:{horizontal:"center",vertical:"center"},at:{horizontal:"center",vertical:"center"},collision:"none"};n.setAttribute("position",JSON.stringify(t))}let _=!1,g=!1,p=this.grid.findHeader(this.contextMenuEvent.target);null===p&&(p=this.grid.findCell(this.contextMenuEvent.target),p&&(g=!0)),null===p&&(p=this.grid.findLabel(this.contextMenuEvent.target),p&&(_=!0));const f=this.grid._getResizeHeaderMode(p);let C=0;if("width"===i)C=this.grid._getResizeMinWidth(f,p,_,g);else{const e=this.grid.m_utils.containsCSSClassName(p,this.grid.getMappedStyle("endheadercell"))||this.grid.m_utils.containsCSSClassName(p,this.grid.getMappedStyle("columnendheaderlabel"));C=this.grid._getResizeMinHeight(f,p,_,g,e)}if(s.setAttribute("min",C),s.setAttribute("max",2e3),s.setAttribute("step",1),s.setAttribute("value",t),s.setAttribute("display-options",'{"converterHint": "none", "validatorHint": "none"}'),s.setAttribute("label-edge","inside"),s.setAttribute("user-assistance-density","efficient"),s.setAttribute("required",!0),"width"===i?(s.setAttribute("label-hint",this._getTranslation("columnWidth")),n.setAttribute("dimension","resizeWidth")):(s.setAttribute("label-hint",this._getTranslation("rowHeight")),n.setAttribute("dimension","resizeHeight")),n.setAttribute("dialog-title",e),u){c.getContext(n).getBusyContext().whenReady().then(()=>{n.open(this.root)})}else n.open(this.root)}else n=C("#"+this.rootId+"modal"),s=C("#"+this.rootId+"inputNumber"),0===n.length||0===s.length?(n=document.createElement("div"),n.id=this.rootId+"modal",r=document.createElement("div"),l=document.createElement("div"),a=document.createElement("div"),r.className=this._getMappedStyle("dialogTitle"),n.appendChild(r),n.appendChild(l),n.appendChild(a),m=document.createElement("h5"),m.textContent=e,r.appendChild(m),s=document.createElement("input"),s.id=this.rootId+"inputNumber",s.setAttribute("label-edge","inside"),s.setAttribute("required",!0),h=document.createElement("oj-button"),h.id=this.rootId+"modalcancel",h.style.margin="5px",d=document.createElement("oj-button"),d.id=this.rootId+"modalsubmit",d.style.margin="5px",l.appendChild(s),a.appendChild(h),a.appendChild(d),this.root.appendChild(n),C(h).ojButton({component:"ojButton",label:this._getTranslation("labelResizeDialogCancel")}),C(d).ojButton({component:"ojButton",label:this._getTranslation("labelResizeDialogApply")}),o=function(){C(d).ojButton({disabled:!1}),C(s).ojInputNumber({value:0}),C(n).ojDialog("close")},h.addEventListener("click",o),d.addEventListener("click",this._handleResizeDialog.bind(this)),C(s).ojInputNumber({component:"ojInputNumber",max:1e3,min:20,step:1,value:t}),"width"===i?(s.setAttribute("label-hint",this._getTranslation("columnWidth")),n.setAttribute("dialog-title","resizeWidth")):(s.setAttribute("label-hint",this._getTranslation("rowHeight")),n.setAttribute("dialog-title","resizeHeight")),C(n).ojDialog({initialFocus:"firstFocusable",position:{my:"center center",at:"center center",collision:"none",of:C(this.root)}}),C(n).ojDialog("open")):(s.ojInputNumber("option","value",t),s.setAttribute("label-edge","inside"),s.setAttribute("required",!0),n.find("."+this._getMappedStyle("dialogTitle"))[0].firstChild.textContent=e,n.ojDialog("open"))},_handleContextMenuSelect:function(e,t){var i;if(i=t?t.item:C(e.target),this.menuItemFunction=i.attr("data-oj-command"),this.menuItemFunction===this._getMappedCommand("sortColAsc")||this.menuItemFunction===this._getMappedCommand("sortColDsc")||this.menuItemFunction===this._getMappedCommand("sortRowAsc")||this.menuItemFunction===this._getMappedCommand("sortRowDsc")||this.menuItemFunction===this._getMappedCommand("cut")||this.menuItemFunction===this._getMappedCommand("paste")||this.menuItemFunction===this._getMappedCommand("cutCells")||this.menuItemFunction===this._getMappedCommand("pasteCells")||this.menuItemFunction===this._getMappedCommand("copyCells")||this.menuItemFunction===this._getMappedCommand("autoFill")||this.menuItemFunction===this._getMappedCommand("freezeRow")||this.menuItemFunction===this._getMappedCommand("freezeCol")||this.menuItemFunction===this._getMappedCommand("unfreezeRow")||this.menuItemFunction===this._getMappedCommand("unfreezeCol")||this.menuItemFunction===this._getMappedCommand("hideCol")||this.menuItemFunction===this._getMappedCommand("unhideCol")||this.menuItemFunction===this._getMappedCommand("hideRow")||this.menuItemFunction===this._getMappedCommand("unhideRow")||this.menuItemFunction===this._getMappedCommand("filterCol"))this.grid.handleContextMenuReturn(this.contextMenuEvent,this.menuItemFunction,null);else if(this.menuItemFunction===this._getMappedCommand("resizeWidth")||this.menuItemFunction===this._getMappedCommand("resizeHeight")){var s=C(this.contextMenuEvent.target).closest("."+this._getMappedStyle("cell"));if(0===s.length&&(s=C(this.contextMenuEvent.target).closest("."+this._getMappedStyle("headercell"))),0===s.length&&(s=C(this.contextMenuEvent.target).closest("."+this._getMappedStyle("endheadercell"))),0===s.length&&(s=C(this.contextMenuEvent.target).closest("."+this._getMappedStyle("headerlabel"))),s.length>0){var o=this.menuItemFunction===this._getMappedCommand("resizeWidth")?s.outerWidth():s.outerHeight(),n=this.menuItemFunction===this._getMappedCommand("resizeWidth")?"width":"height",r="width"===n?this._getTranslation("resizeColumnDialog"):this._getTranslation("resizeRowDialog");this._buildResizeDialog(r,o,n)}}else if(this.menuItemFunction===this._getMappedCommand("resizeFitToContent"))this.grid.handleContextMenuReturn(this.contextMenuEvent,this.menuItemFunction,null);else if(this.menuItemFunction===this._getMappedCommand("discontiguousSelection")){let e;this._discontiguousSelection=!this._discontiguousSelection,this.grid.handleContextMenuReturn(this.contextMenuEvent,this.menuItemFunction,this._discontiguousSelection);e=this._IsCustomElement()?"labelSelectMultiple":this._discontiguousSelection?"labelDisableNonContiguous":"labelEnableNonContiguous",i.children().first().text(this._getTranslation(e))}},_NotifyContextMenuGesture:function(e,t,i){this.grid.handleContextMenuGesture(t,i,this._contextMenuGestureCallback.bind(this))},_contextMenuGestureCallback:function(e,t,i){if(null!=e){this.contextMenuEvent=t.originalEvent;var s=e.launcher,o=e.capabilities;this._manageContextMenu(o);var n="keyboard"===i?{position:{of:s},launcher:C(s)}:{launcher:C(s)};_.isTouchSupported()&&(this.grid.m_databodyReorder||this.grid.m_pivotInProgress)||this._OpenContextMenu(t,i,n)}},_addContextMenuCapability:function(e){var t=C(this._getDataGridContextMenu());this._IsCustomElement()?t.find("[data-oj-command="+e+"]").attr("disabled")||t.find("[data-oj-command="+e+"]").attr("disabled",!0):t.find("[data-oj-command="+e+"]").hasClass("oj-disabled")||t.find("[data-oj-command="+e+"]").addClass("oj-disabled")},_removeContextMenuCapability:function(e){C(this._getDataGridContextMenu()).find("[data-oj-command="+e+"]").removeClass("oj-disabled").attr("disabled",!1)},_manageContextMenu:function(e){for(var t=Object.keys(e),i=0;i<t.length;i++){var s=t[i],o=this.resources.getMappedCommand(s);"disable"===e[s]?this._addContextMenuCapability(o):this._removeContextMenuCapability(o)}},_findCellIndex:function(e){return e[this._getMappedAttribute("context")].indexes},_setDataSource:function(){null!=this.options.data?"scroll"===this.options.scrollPolicy&&(this._isFreezeEnabled("row")||this._isFreezeEnabled("column")||this.options.frozenColumnCount>0||this.options.frozenRowCount>0)?this.datasource=new O(this.options.data):this.options.data.fetchByOffset&&!this.options.data.fetchFirst?(null!=this.datasource&&this.datasource.Destroy&&this.datasource.Destroy(),this.datasource=new D(this.options.data)):h.DataProviderFeatureChecker.isDataProvider(this.options.data)?(this.datasource=new H(this.options.data),"randomAccess"!==this.options.data.getCapability("fetchByOffset").implementation&&"scroll"===this.options.scrollPolicy&&(y.error("oj.DataProvider does not support fetchByOffset and scrollPolicy is set to scroll. scrollPolicy will fall back to auto."),this.options.scrollPolicy="auto")):this.datasource=this.options.data:this.datasource=null},_setSelection:function(){var e=this.options.selection;null!=e&&this.grid.SetSelection(e)},_hideColumns:function(){var e=this.options.hiddenColumns;null!=e&&(e=[...e],this.grid.setHiddenColumns(e))},_hideRows:function(){var e=this.options.hiddenRows;null!=e&&(e=[...e],this.grid.setHiddenRows(e))},_modifyContext:function(e){e.component=m.__GetWidgetConstructor(this.element,"ojDataGrid")},_setAccessibleContext:function(e){this.grid.SetAccessibleContext(e)},_unregisterResizeListener:function(e){e&&this._resizeHandler&&(_.removeResizeListener(e,this._resizeHandler),this._resizeHandler=null)},_registerResizeListener:function(e){e&&(null==this._resizeHandler&&(this._resizeHandler=this._handleResize.bind(this)),_.addResizeListener(e,this._resizeHandler))},_handleResize:function(e,t){e>0&&t>0&&(this._possiblyRenderOrRefresh(),this.grid.HandleResize(e,t))},getNodeBySubId:function(e){var t;if(null==e)return this.element?this.element[0]:null;var i=e.subId;if("oj-datagrid-cell"===i){var s=e.rowIndex,o=e.columnIndex;t=C(this.grid._getCellByIndex({row:s,column:o}))}else if("oj-datagrid-sort-icon"===i||"oj-datagrid-sort-ascending"===i||"oj-datagrid-sort-default"===i||"oj-datagrid-sort-descending"===i||"oj-datagrid-header"===i){var n,r=e.axis,l=e.index,a=null==e.level?0:e.level;if(null==(n=this.grid._getHeaderByIndex(l,r,a)))return null;if(n=C(n),"oj-datagrid-sort-icon"===i)return n.children("."+this._getMappedStyle("sortIcon")).children().get(0);t="oj-datagrid-sort-ascending"===i?n.find("."+this._getMappedStyle("sortascending")):"oj-datagrid-sort-default"===i?n.find("."+this._getMappedStyle("sortdefault")):"oj-datagrid-sort-descending"===i?n.find("."+this._getMappedStyle("sortdescending")):n}else"oj-datagrid-header-label"===i&&(t=C(this.grid._getLabel(e.axis,e.level)));return null!=t&&t.length>0?t[0]:null},getSubIdByNode:function(e){var t,i=C(e).closest("."+this._getMappedStyle("cell"));if(i.length>0){var s=this._findCellIndex(i[0]);return{subId:"oj-datagrid-cell",rowIndex:s.row,columnIndex:s.column}}var o=C(e).closest("."+this._getMappedStyle("headercell"));if(0===o.length&&(o=C(e).closest("."+this._getMappedStyle("endheadercell"))),o.length>0)return t=o[0][this._getMappedAttribute("context")],{subId:C(e).hasClass(this._getMappedStyle("sortascending"))?"oj-datagrid-sort-ascending":C(e).hasClass(this._getMappedStyle("sortdefault"))?"oj-datagrid-sort-default":C(e).hasClass(this._getMappedStyle("sortdescending"))?"oj-datagrid-sort-descending":"oj-datagrid-header",axis:t.axis,index:this._getHeaderIndex(o),level:t.level};var n=C(e).closest("."+this._getMappedStyle("headerlabel"));return n.length>0?{subId:"oj-datagrid-header-label",axis:(t=n[0][this._getMappedAttribute("context")]).axis,level:t.level}:null},getContextByNode:function(e){var t,i,s=C(e).closest("."+this._getMappedStyle("cell"));if(s.length>0)return t=s[0][this._getMappedAttribute("context")],(i=h.CollectionUtils.copyInto({},t,void 0,!0)).subId="oj-datagrid-cell",i;var o=C(e).closest("."+this._getMappedStyle("headercell"));if(0===o.length&&(o=C(e).closest("."+this._getMappedStyle("endheadercell"))),o.length>0)return t=o[0][this._getMappedAttribute("context")],(i=h.CollectionUtils.copyInto({},t,void 0,!0)).subId="oj-datagrid-header",i.index=this._getHeaderIndex(o),i;var n=C(e).closest("."+this._getMappedStyle("headerlabel"));return n.length>0?(t=n[0][this._getMappedAttribute("context")],(i=h.CollectionUtils.copyInto({},t,void 0,!0)).subId="oj-datagrid-header-label",i):null},_getMappedStyle:function(e){return this.resources.getMappedStyle(e)},_getMappedAttribute:function(e){return this.resources.getMappedAttribute(e)},_getMappedCommand:function(e){return this.resources.getMappedCommand(e)},_isDataGridSizingAvailable:function(){return null!=this.root.offsetParent},_possiblyRenderOrRefresh:function(){var e=this.grid.getVisibility(),t=!1;return this._isDataGridSizingAvailable()?(e===A.VISIBILITY_STATE_RENDER?(this.grid.render(this.root),t=!0):e===A.VISIBILITY_STATE_REFRESH&&(this.grid.refresh(this.root),t=!0),this.grid.setVisibility(A.VISIBILITY_STATE_VISIBLE)):e===A.VISIBILITY_STATE_VISIBLE&&this.grid.setVisibility(A.VISIBILITY_STATE_HIDDEN),t},_getHeaderIndex:function(e){var t;let i;if(e.parent().hasClass(this._getMappedStyle("groupingcontainer"))){if(t=parseInt(e.parent().attr(this._getMappedAttribute("start")),10),e.get(0)===e.parent().children(":first").get(0))return t;t-=1}else e.hasClass(this._getMappedStyle("rowheadercell"))?(t=this.grid.getStartRowHeader(),i="row"):e.hasClass(this._getMappedStyle("colheadercell"))?(t=this.grid.getStartColumnHeader(),i="column"):e.hasClass(this._getMappedStyle("colendheadercell"))?(t=this.grid.getStartColumnEndHeader(),i="column"):(t=this.grid.getStartRowEndHeader(),i="row");return i&&this.grid.m_options.isFreezeEnabled(i)&&this.grid.m_options._getFreezeIndex(i)>=0&&!e.parent().parent().hasClass(this._getMappedStyle("frozenHeader"))&&(t+=this.grid.m_options._getFreezeIndex(i)+1),t+=e.index()},_isMultipleSelection:function(){return null!=this.options.selectionMode&&("multiple"===this.options.selectionMode.row||"multiple"===this.options.selectionMode.cell)},_remove:function(e){null!=e&&(this.grid._cleanTemplateNodes(e),C(e).remove())},_uniqueId:function(e,t){t?C(e).removeUniqueId():C(e).uniqueId()},_compareValues:function(e,t){return h.Object.compareValues(e,t)},scrollTo:function(e){this.grid.scroll(e)},whenReady:function(){if(this._ready)return Promise.resolve(!0);if(!this._readyPromise){var e=this;this._readyPromise=new Promise(function(t){e._readyPromiseResolve=t})}return this._readyPromise},_NotReady:function(){if(this._ready=!1,!this._readyResolveFunc){var e=c.getContext(this.element[0]).getBusyContext(),t={description:"The component identified by '"+this.element.attr("id")+"' is being loaded."};this._readyResolveFunc=e.addBusyState(t)}},_MakeReady:function(){this._readyPromiseResolve&&(this._readyPromiseResolve(!0),this._readyPromiseResolve=null),this._ready=!0,this._readyPromise=null,this._readyResolveFunc&&(this._readyResolveFunc(),this._readyResolveFunc=null)},_CompareOptionValues:function(e,t,i){switch(e){case"currentCell":case"selection":return h.Object.compareValues(t,i);default:return this._super(e,t,i)}},_WrapCustomElementRenderer:function(e){return this._IsCustomElement()&&"function"==typeof e?function(t){return e(t)}:e}}),A.prototype.unhighlightFloodFillRange=function(e){null==e&&(e=this.GetFloodFillRange()[0]),null!=e&&this._applyBorderClassesAroundRange(this.getElementsInRange(e),e,!1,"Floodfill")},A.prototype.highlightFloodFillRange=function(e){this._applyBorderClassesAroundRange(this.getElementsInRange(e),e,!0,"Floodfill")},A.prototype.handleDatabodyFloodFillDrag=function(e){var t=e.target,i=this.findCell(t);if(null!=i){var s=this.getCellIndexes(i);this.extendFloodFillSelection(s,e)}else this.unhighlightFloodFillRange(),this.m_floodFillRange=[]},A.prototype.GetFloodFillRange=function(){return null==this.m_floodFillRange&&(this.m_floodFillRange=[]),this.m_floodFillRange},A.prototype.extendFloodFillSelection=function(e,t){if("header"===this.m_active.type)return;var i;if(null==(i={row:this.m_active.indexes.row,column:this.m_active.indexes.column}))return;let s,o=!1;s||(s=this.m_selection);let n,r=s[0].startIndex,l=s[0].endIndex;e.row>=r.row&&e.row<=l.row&&(o=!0,e.column>l.column?n="right":e.column<r.column&&(n="left"),e.row=l.row);let a=!1;e.column>=r.column&&e.column<=l.column&&(a=!0,e.row>l.row?n="bottom":e.row<r.row&&(n="top"));let h=r.row===l.row,d=r.column===l.column;if(h&&e.row===r.row&&a||d&&e.column===r.column&&o)return this.unhighlightFloodFillRange(),void(this.m_floodFillRange=[]);if((!o&&!a||e.column<=l.column&&!o)&&(e.column=l.column),o||a||(e.row>l.row?n="bottom":e.row<r.row&&(n="top")),n){let s=r,o=e;this._createRangeWithKeys(s,o,this._extendFloodFillSelectionCallback.bind(this,t,i,n))}else this.unhighlightFloodFillRange()},A.prototype._extendFloodFillSelectionCallback=function(e,t,i,s){let o=s;"top"===i?o.endIndex.row-=1:"bottom"===i?o.startIndex.row=this.m_selectionRange[0].endIndex.row+1:"left"===i?o.endIndex.column-=1:o.startIndex.column=this.m_selectionRange[0].endIndex.column+1;let n=[];this.unhighlightFloodFillRange(),n.push(o),this.m_floodFillRange=n,this.m_floodFillDirection="flood",this.highlightFloodFillRange(o)},A.prototype._addFloodfillAffordance=function(e){if(null==this.m_bottomFloodFillIconContainer){var t=e.target,i=this.findCell(t);if(i||(i=this.findHeader(t)),!i)return;this._attachFloodFillIcon()}},A.prototype._attachFloodFillIcon=function(){this.m_bottomFloodFillIconContainer=document.createElement("div"),this.m_bottomFloodFillIconContainer.className=this.getMappedStyle("toucharea");var e=document.createElement("div");e.className=this.getMappedStyle("floodfillaffordance"),e.setAttribute("role","button"),this.m_bottomFloodFillIconContainer.appendChild(e),this.m_databody.firstChild.appendChild(this.m_bottomFloodFillIconContainer),this.m_floodFillAffordanceHeight=this.m_bottomFloodFillIconContainer.firstElementChild.offsetHeight,this.m_floodFillAffordanceWidth=this.m_bottomFloodFillIconContainer.firstElementChild.offsetWidth,this.m_options.isFloodFillEnabled()&&(this.m_bottomFloodFillIconContainer.addEventListener("mouseover",this.handleFloodFillAffordanceMouseOver.bind(this)),this.m_bottomFloodFillIconContainer.addEventListener("mousedown",this.handleFloodFillAffordanceMouseDown.bind(this)),this.m_bottomFloodFillIconContainer.addEventListener("mouseup",this.handleFloodFillAffordanceMouseUp.bind(this)),this.m_bottomFloodFillIconContainer.addEventListener("mouseleave",this.handleFloodFillAffordanceMouseLeave.bind(this)))},A.prototype.handleFloodFillAffordanceMouseOver=function(e){if(0===e.buttons){e.currentTarget.parentNode.parentNode.style.cursor="crosshair",this.m_cursor="crosshair"}},A.prototype.handleFloodFillAffordanceMouseDown=function(){this.m_databodyDragState=!0,this.m_floodFillDragState=!0,this.m_selectionRange=null,this.m_floodFillRange=null;const e=[this.m_databody,this.m_databodyFrozenCol,this.m_databodyFrozenRow,this.m_databodyFrozenCorner];for(let t=0;t<e.length;t++)e[t]&&(e[t].style.cursor="crosshair");this.m_cursor="crosshair"},A.prototype.handleFloodFillAffordanceMouseUp=function(e){this.m_databodyDragState=!1,this.m_floodFillDragState=!1;e.currentTarget.parentNode.parentNode.style.cursor="default",this.m_cursor="default",this.m_selectionRange=null,this.m_floodFillRange=null},A.prototype.handleFloodFillAffordanceMouseLeave=function(e){if(0===e.buttons){this.m_databodyDragState=!1,this.m_floodFillDragState=!1;e.currentTarget.parentNode.parentNode.style.cursor="default",this.m_cursor="default"}},A.prototype._removeFloodFillAffordance=function(){this._isDatabodyCellActive()&&this.m_bottomFloodFillIconContainer&&this.m_bottomFloodFillIconContainer.parentNode&&(this.m_databody.style.cursor="default",this.m_cursor="default",this.m_bottomFloodFillIconContainer.parentNode.removeChild(this.m_bottomFloodFillIconContainer))},A.prototype._moveFloodFillAffordance=function(){var e=this.getResources().isRTLMode()?"right":"left",t=this.GetSelection();if(t.length>0){var i=this._getTouchSelectionAffordanceSize();if(null!=this.m_bottomFloodFillIconContainer){var s=this._getCellByIndex(t[t.length-1].endIndex);if(s)if(this.setElementDir(this.m_bottomFloodFillIconContainer,this.getElementDir(s,"top")+this.getElementHeight(s)-i+this.m_floodFillAffordanceHeight+1,"top"),this.setElementDir(this.m_bottomFloodFillIconContainer,this.getElementDir(s,e)+this.getElementWidth(s)-(i-this.m_floodFillAffordanceWidth)+1,e),s.classList.contains(this.getMappedStyle("frozenCell"))){this._getCellContainer(s).firstChild.appendChild(this.m_bottomFloodFillIconContainer)}else this.m_databody.firstChild.appendChild(this.m_bottomFloodFillIconContainer);else this._removeFloodFillAffordance()}}},A.prototype.handleDragStart=function(e){let t,i=e.target,s=this.findHeader(i);if(s){let i=this.getHeaderCellAxis(s),o=this.getHeaderCellLevel(s),n=this.getHeaderCellIndex(s);if(this.m_options._isDragEnabled(i)){let r,l,a,h=this.m_selection,d=0,m=0,c=1,u=this.m_options.options.dnd.drag,_="row"===i||"rowEnd"===i?u.rows.dataTypes:u.columns.dataTypes,g="row"===i||"rowEnd"===i?"rows":"columns",p=[],f=[],C=[],y=JSON.parse(JSON.stringify(h));y.sort((e,t)=>e.startIndex[i]<t.startIndex[i]?-1:1),"row"===i||"rowEnd"===i?(a=-1!==this.m_endRowEndHeader,this.m_rowHeader&&(r=this.m_rowHeaderLevelCount-1),this.m_rowEndHeader&&(l=this.m_rowEndHeaderLevelCount-1)):(a=-1!==this.m_endColEndHeader,this.m_colHeader&&(r=this.m_columnHeaderLevelCount-1),this.m_endColHeader&&(l=this.m_columnEndHeaderLevelCount-1));let w="row"===i||"rowEnd"===i?"row":"column";[p,f]=this._getHeadersInSelection(o,y,w,a),p&&(C=this._getHeadersAtInnermostLevel(p,C,r)),f&&(C=this._getHeadersAtInnermostLevel(f,C,l)),[t,c,d,m]=this._getCellsForDndContainer(w,y,C,c),this._cellsDragged=t,this.m_dragIndex=n,this.m_dragHeader=s,this._setDragRowsData(e,_);const E=this.m_utils.containsCSSClassName(s,this.getMappedStyle("endheadercell"));this._setDragImage(e,w,t,d,m,c,E,p,f),this._draggedElements=[];for(let e=0;e<h.length;e++){let t=this.getElementsInRange(h[e]);if(t?.length){this._draggedElements.push(...t),this._draggedElements.push(...C);for(let e=0;e<t.length;e++)this._highlightElement(t[e],["dragSourceOpaque"]);this._applyBorderClassesAroundRange(t,h[e],!1,"Selected")}}const v=s[[this.getResources().getMappedAttribute("context")]];"expanded"===v.metadata.expanded&&null!==v.metadata.treeDepth&&this._disableChildElements(i);let x={range:y,axis:w};return this._invokeDndCallback("drag",g,"dragStart",e,x)}e.preventDefault()}},A.prototype._getHeadersAtInnermostLevel=function(e,t,i){let s=Object.keys(e).length;for(let o=0;o<s;o++){let s=Object.keys(e)[o];if(e[s])for(let o=0;o<=e[s].length-1;o++){let n=e[s][o],r=this.getHeaderCellDepth(n),l=this.getHeaderCellLevel(n);n&&r-1+l===i&&t.push(n)}}return t},A.prototype._getHeadersInSelection=function(e,t,i){let s={},o={};for(let n=0;n<t.length;n++){let r=[...this.getHeadersByRange(t[n],i)];for(let e=r.length-1;e>=0;e--)this.m_utils.containsCSSClassName(r[e],this.getMappedStyle("selected"))||r.splice(e,1);[s,o]=this._getHeadersUnderLevel(e,r,i,s,o)}return[s,o]},A.prototype._getHeadersUnderLevel=function(e,t,i,s,o){let n="row"===i?this.m_rowHeaderLevelCount:this.m_columnHeaderLevelCount,r="row"===i?this.m_rowEndHeaderLevelCount:this.m_columnEndHeaderLevelCount;for(let i=0;i<t.length;i++){let l=this.getHeaderCellLevel(t[i]);const a=this.m_utils.containsCSSClassName(t[i],this.getMappedStyle("endheadercell"));a?a&&(r>1&&l>=e||1===r)&&(o[l]||(o[l]=[]),o[l].push(t[i])):(n>1&&l>=e||1===n)&&(s[l]||(s[l]=[]),s[l].push(t[i]))}return[s,o]},A.prototype.handleRowDragEnd=function(e){return this._destroyDragImage(),this._unhighlightDragSource(),this._removeDropTargetLine("row"),this._removeDropTargetClass(),this._enableChildElements(),this.m_databodyReorder=!1,this._removeDragStyle("row"),this.m_dragIndex=null,this._invokeDndCallback("drag","rows","dragEnd",e,this._cellsDragged)},A.prototype.handleRowDragOver=function(e){let t;if(this.m_pivotInProgress)this._handlePivotDragOverOnHeader(e);else if(this.m_dragFrozenIndicator){let i=this.m_freezeIndicatorAxis,s=this._getOverIndex(e,i);if("column"===i){if(this.m_utils.containsCSSClassName(e.target,this.getMappedStyle("endheadercell")))return t;s=-1}null==s||null!=this.m_dropTarget&&s===this._getAttribute(this.m_dropTarget,"dropIndex",!0)?e.preventDefault():this.handleFreezeIndicatorDragOver(e,s,i)}else if(this._matchDragDataType(e,"rows")){this.m_databodyReorder=!0;let i="row",s=this._getOverIndex(e,i),o=-1===s?0:s,n=this.getResources().isRTLMode()?"right":"left",r=this._getHeaderByIndex(o,i,this.m_rowHeaderLevelCount-1),l=this._isHeaderWithinSelection(r,i);if(void 0!==s&&this.m_dragIndex!==s){if(this.m_utils.containsCSSClassName(r,this.getMappedStyle("disabledElement"))||this.m_utils.containsCSSClassName(r,this.getMappedStyle("dragSourceOpaque")))this._removeDropTargetLine(i),this._removeDropTargetClass(),this.m_dropRowIndex=null;else{let a=this._getRelativePosition(e,i,r,!0),h=this._getDropContext(e,this.m_dropRowIndex,"row");if(t=this._invokeDropCallback("rows","dragOver",e,h),(!1===t||e.defaultPrevented)&&(null==this.m_dropTarget||s!==this._getAttribute(this.m_dropTarget,"dropIndex",!0))&&(this._removeDropTargetLine(i),this._removeDropTargetClass(),!l))if("inside"===a)this._highlightElement(r,["dropTarget"]),this._highlightCellsAlongAxis(s,i,"index","add",["dropTarget"]);else{let e=this.getElementDir(r,"top");e+=-1===s?0:this.getElementHeight(r),this._hasFrozenRows()&&s>this.m_frozenRowIndex&&(e+=this.getElementHeight(this.m_databodyFrozenRow)),this._addDropTargetLine(i,e,n,0,o)}}return t}}else this._matchDragDataType(e,"rowLabels")&&this._handlePivotDragOverOnHeader(e)},A.prototype.handleDatabodyDragOver=function(e){if(this.m_pivotInProgress)this._removePivotDropTargetLine();else if(this.m_dragFrozenIndicator){let t=this.m_freezeIndicatorAxis,i=this._getOverIndex(e,t);null!=i&&this.handleFreezeIndicatorDragOver(e,i[t],t)}else{let t;this.m_databodyReorder=!0,t=this._matchDragDataType(e,"rows")?"row":"column";let i=this._getOverIndex(e,t),s=this.getResources().isRTLMode()?"right":"left";if(i){let o=JSON.parse(JSON.stringify(i));-1===i[t]&&(o[t]=0);let n=this._getCellByIndex(o);if(n&&!this.m_utils.containsCSSClassName(n,this.getMappedStyle("dragSourceOpaque"))){let r,l=this._getRelativePosition(e,t,n,!1),a=this.m_utils.containsCSSClassName(n,"selected");if(this.m_utils.containsCSSClassName(n,this.getMappedStyle("disabledElement")))this._removeDropTargetLine(t),this._removeDropTargetClass(),"row"===t?this.m_dropRowIndex=null:this.m_dropColumnIndex=null;else if(r="row"===t?this._invokeDropCallback("rows","dragOver",e,{index:this.m_dropRowIndex,position:l,axis:"row"}):this._invokeDropCallback("columns","dragOver",e,{index:this.m_dropColumnIndex,position:l,axis:"column"}),(!1===r||e.defaultPrevented&&(void 0===this.m_dropTarget||i[t]!==this._getAttribute(this.m_dropTarget,"dropIndex",!0)))&&(this._removeDropTargetLine(t),this._removeDropTargetClass(),!a)){let e;"inside"===l?this._highlightCellsAlongAxis(i,t,"index","add",["dropTarget"]):"row"===t?(e=this.getElementDir(n,"top"),e+=-1===i[t]?0:this.getElementHeight(n),this._hasFrozenRows()&&i[t]>this.m_frozenRowIndex&&(e+=this.getElementHeight(this.m_databodyFrozenRow)),this._addDropTargetLine(t,e,s,0,o[t])):(e=this.getElementDir(n,s),e+=-1===i[t]?0:this.getElementWidth(n),this._hasFrozenColumns()&&i[t]>this.m_frozenColIndex&&(e+=this.getElementWidth(this.m_databodyFrozenCol)),this._addDropTargetLine(t,0,s,e,o[t]))}return r}}else if(this._databodyEmptyState()){let i;return"row"===t?(this.m_dropRowIndex=0,i=this._invokeDropCallback("rows","dragOver",e,{index:this.m_dropRowIndex,position:"before",axis:"row"})):(this.m_dropColumnIndex=0,i=this._invokeDropCallback("columns","dragOver",e,{index:this.m_dropColumnIndex,position:"before",axis:"column"})),(!1===i||e.defaultPrevented&&void 0===this.m_dropTarget)&&(this._removeDropTargetLine(t),this._removeDropTargetClass()),i}}},A.prototype.handleDatabodyDrop=function(e){let t=e.target.getBoundingClientRect(),i=this.getResources().isRTLMode()?"right":"left",s="after";if(this.m_dragFrozenIndicator){let t,i=this.m_freezeIndicatorAxis;s=this._getRelativePosition(e,i,null,!1),"row"===i?(t=this.m_dropRowIndex,this.m_dropRowIndex=null):(t=this.m_dropColumnIndex,this.m_dropColumnIndex=null),"before"===s&&(t-=1),this.handleFreezeIndicatorDrop(t,i,e)}else{let o,n,r;if(o=this._matchDragDataType(e,"rows")?"row":"column",this._destroyDragImage(),this._removeDropTargetLine(o),this._removeDropTargetClass(),"row"===o){n=this.m_dropRowIndex,e.clientY-t.top<.4*t.height&&(s="before"),this.m_dropRowIndex=null,r={index:n,position:s,axis:"row"}}else{n=this.m_dropColumnIndex,Math.abs(e.clientX-t[i])<.4*t.width&&(s="before"),this.m_dropColumnIndex=null,r={index:n,position:s,axis:"column"}}this._unhighlightDragSource(),this._enableChildElements(),this._resetDragInternals(),null!==n&&this._invokeDropCallback(`${o}s`,"drop",e,r)}this._isSelectionEnabled()&&this.m_utils.isTouchDevice()&&this.m_selection.length>0&&this._moveTouchSelectionAffordance()},A.prototype.handleRowDragEnter=function(e){if(this._getOverIndex(e,"row"),this.m_dropRowIndex){let t=this._getDropContext(e,this.m_dropRowIndex,"row");return this._invokeDropCallback("rows","dragEnter",e,t)}},A.prototype.handleDatabodyDragEnter=function(e){let t;t=this._matchDragDataType(e,"rows")?"row":"column";let i=this._getOverIndex(e,t);if(i){let s=JSON.parse(JSON.stringify(i));-1===i[t]&&(s[t]=0);let o=this._getCellByIndex(s);if(o){let s={index:i,position:this._getRelativePosition(e,t,o,!1),axis:t};if(this.m_dropRowIndex)return this._invokeDropCallback("rows","dragEnter",e,s);if(this.m_dropColumnIndex)return this._invokeDropCallback("columns","dragEnter",e,s)}}else if(this._databodyEmptyState()){i=this.createIndex(0,0);let s={index:i,position:"before",axis:t},o="rows";return"row"===t?this.m_dropRowIndex=0:(o="columns",this.m_dropColumnIndex=0),this._invokeDropCallback(o,"dragEnter",e,s)}},A.prototype.handleRowDragLeave=function(e){let t=this._getDropContext(e,this.m_dropRowIndex,"row");var i=this._invokeDndCallback("drop","rows","dragLeave",e,t);return this.m_dropRowIndex=null,i},A.prototype.handleRowDrag=function(e){return!this.m_dragImageAttached&&this.m_utils.isTouchDevice()&&(document.body.appendChild(this.m_dndContainer),this.m_dragImageAttached=!0),this._invokeDndCallback("drag","rows","drag",e)},A.prototype.handleRowDrop=function(e){if(this.m_pivotInProgress)this._handlePivotDropOnHeader(e);else if(this._matchDragDataType(e,"rows")||!e.dataTransfer.types.length){let t=this.m_dropRowIndex;if(null===this.m_dropRowIndex&&(t=this._getOverIndex(e,"row")),this.m_dragFrozenIndicator){let i=this.m_freezeIndicatorAxis,s=t;if("column"===i){if(this.m_utils.containsCSSClassName(e.target,this.getMappedStyle("endheadercell")))return;s=-1}else{"before"===this._getDropContext(e,s,"row").position&&(s-=1)}this.m_dropRowIndex=null,this.handleFreezeIndicatorDrop(s,i,e)}else if(this._destroyDragImage(),this._removeDropTargetLine("row"),this._removeDropTargetClass(),this.m_dropRowIndex=null,this._unhighlightDragSource(),this._enableChildElements(),this._resetDragInternals(),null!==t){let i=this._getDropContext(e,t,"row");this._invokeDropCallback("rows","drop",e,i)}this._isSelectionEnabled()&&this.m_utils.isTouchDevice()&&this.m_selection.length>0&&this._moveTouchSelectionAffordance()}else this._matchDragDataType(e,"rowLabels")&&this._handlePivotDropOnHeader(e)},A.prototype.handleColumnDragEnd=function(e){let t="column";return this._destroyDragImage(),this._unhighlightDragSource(),this._removeDragStyle(t),this._removeDropTargetLine(t),this._removeDropTargetClass(),this._enableChildElements(),this.m_dragIndex=null,this._invokeDndCallback("drag","columns","dragEnd",e)},A.prototype.handleColumnDragOver=function(e){let t;if(this.m_pivotInProgress)this._handlePivotDragOverOnHeader(e);else if(this.m_dragFrozenIndicator){let i=this._getOverIndex(e,"column"),s=this.m_freezeIndicatorAxis;if("row"===s){if(this.m_utils.containsCSSClassName(e.target,this.getMappedStyle("endheadercell")))return t;i=-1}null==i||null!=this.m_dropTarget&&i===this._getAttribute(this.m_dropTarget,"dropIndex",!0)?e.preventDefault():this.handleFreezeIndicatorDragOver(e,i,s)}else if(this._matchDragDataType(e,"columns")){let i=this._getOverIndex(e,"column");this.m_databodyReorder=!0;let s="column",o=-1===i?0:i,n=this.getResources().isRTLMode()?"right":"left",r=this._getHeaderByIndex(o,s,this.m_columnHeaderLevelCount-1);if(this.m_utils.containsCSSClassName(r,this.getMappedStyle("disabledElement"))||this.m_utils.containsCSSClassName(r,this.getMappedStyle("dragSourceOpaque")))this._removeDropTargetLine(s),this._removeDropTargetClass(),this.m_dropColumnIndex=null;else if(void 0!==i&&r){let l=this._getRelativePosition(e,s,r,!0),a={axis:"column",position:l,index:this.m_dropColumnIndex};if(t=this._invokeDropCallback("columns","dragOver",e,a),(!1===t||e.defaultPrevented)&&(null==this.m_dropTarget||i!==this._getAttribute(this.m_dropTarget,"dropIndex",!0)))if(this._removeDropTargetLine(s),this._removeDropTargetClass(),"inside"===l)this._highlightElement(r,["dropTarget"]),this._highlightCellsAlongAxis(i,s,"index","add",["dropTarget"]);else{let e=this.getElementDir(r,n);e+=-1===i?0:this.getElementWidth(r),this._hasFrozenColumns()&&i>this.m_frozenColIndex&&(e+=this.getElementWidth(this.m_databodyFrozenCol)),this._addDropTargetLine(s,0,n,e,o)}return t}}else this._matchDragDataType(e,"columnLabels")&&this._handlePivotDragOverOnHeader(e)},A.prototype.handleColumnDragEnter=function(e){this._getOverIndex(e,"column");let t=this._getDropContext(e,this.m_dropColumnIndex,"column");return this._invokeDropCallback("columns","dragEnter",e,t)},A.prototype.handleColumnDragLeave=function(e){let t=this._getDropContext(e,this.m_dropColumnIndex,"column");var i=this._invokeDndCallback("drop","columns","dragLeave",e,t);return this.m_dropColumnIndex=null,i},A.prototype.handleColumnDrag=function(e){return this._invokeDndCallback("drag","columns","drag",e)},A.prototype.handleColumnDrop=function(e){if(this.m_pivotInProgress)this._handlePivotDropOnHeader(e);else if(this._matchDragDataType(e,"columns")||!e.dataTransfer.types.length){let t=this.m_dropColumnIndex;if(null===this.m_dropColumnIndex&&(t=this._getOverIndex(e,"column")),this.m_dragFrozenIndicator){let i=this.m_freezeIndicatorAxis,s=t;if("row"===i){if(this.m_utils.containsCSSClassName(e.target,this.getMappedStyle("endheadercell")))return;s=-1}else{"before"===this._getDropContext(e,s,"column").position&&(s-=1)}this.handleFreezeIndicatorDrop(s,i,e)}else if(this._destroyDragImage(),this._removeDropTargetLine("column"),this._removeDropTargetClass(),this._unhighlightDragSource(),this._enableChildElements(),this._resetDragInternals(),null!==t){let i=this._getDropContext(e,t,"column");this._invokeDropCallback("columns","drop",e,i)}this.m_dropColumnIndex=null,this._isSelectionEnabled()&&this.m_utils.isTouchDevice()&&this.m_selection.length>0&&this._moveTouchSelectionAffordance()}else this._matchDragDataType(e,"columnLabels")&&this._handlePivotDropOnHeader(e)},A.prototype._computeDndContainerOffsetHeight=function(e,t,i,s){let o=0;if("row"===e)for(let e=0;e<t.length;e++){o+=t[e].offsetHeight}else{let e=t[0].offsetHeight;i&&(e+=s[0].offsetHeight),o=this.m_databody.offsetHeight+e}return o},A.prototype._computeDndContainerOffsetWidth=function(e,t,i,s){let o=0;if("row"===e){let e=t[0].offsetWidth;i&&(e+=s[0].offsetWidth),o=this.m_databody.offsetWidth+e}else for(let e=0;e<t.length;e++){o+=t[e].offsetWidth}return o},A.prototype._getCellsForDndContainer=function(e,t,i,s){let o,n,r=[],l=this.getResources().isRTLMode()?"right":"left",a=this.m_databody.scrollLeft,h=this.m_databody.scrollTop,d=0,m=0;n="row"===e?-1!==this.m_endRowEndHeader:-1!==this.m_endColEndHeader,o="row"===e?"width":"height";let c=Math.abs(a);"column"===e&&(l="top",c=h);for(let a=0,h=0;a<t.length;a++)for(let u=t[a].startIndex[e];u<=t[a].endIndex[e];u++){let t,a=this._getAxisCellsByIndex(u,e);i[h]&&r.push(i[h]);for(let e=0;e<a.length;e++)if(this.getElementDir(a[e],l)>c){t=e-1;break}a=a.slice(t,a.length);let _=0,g=this.getElementDir(this.m_databody,o);"row"===e&&this._hasFrozenColumns()&&(g+=this.getElementWidth(this.m_databodyFrozenCol)),"column"===e&&this._hasFrozenRows()&&(g+=this.getElementHeight(this.m_databodyFrozenRow));for(let e=0;e<a.length;e++)if(_+=this.getElementDir(a[e],o),_>g){t=e;break}t>0&&(a=a.slice(0,t+1)),r.push(...a),n&&i?.length&&r.push(i[Math.ceil(i.length/2+h)]),"row"!==e||d?"column"===e&&(d+=i[h]?this.getElementDir(i[h],"width"):this.getElementWidth(r[0])):d=this._computeContainerDimension(r,"width"),"column"!==e||m?"row"===e&&(m+=i[h]?this.getElementDir(i[h],"height"):this.getElementHeight(r[0])):m=this._computeContainerDimension(r,"height"),h+=1,s=a.length}return[r,s,d,m]},A.prototype._computeContainerDimension=function(e,t){let i=0;for(let s=0;s<e.length;s++)i+=this.getElementDir(e[s],t);return i},A.prototype._setDragImage=function(e,t,i,s,o,n,r,l,a){let h=this.getResources().isRTLMode()?"right":"left",d=this._populateDndContainer(i,t,h,n,l,a,s,o),m=Math.max(0,e.offsetX),c=Math.max(0,e.offsetY);r?(m="row"===t&&"left"===h?s-m:m,c="column"===t?o-c:c):m="row"===t&&"left"===h?m:s-m,e.dataTransfer.setDragImage(d,m,c)},A.prototype._computeDndContainerCellCountInRow=function(e,t){let i,s=e,o=1;return i="row"===t||"rowEnd"===t?-1!==this.m_endRowEndHeader:-1!==this.m_endColEndHeader,i&&(o=2),s+=o,s},A.prototype._populateDndContainer=function(e,t,i,s,o,n,r,l){let a=document.getElementById("dndContainer");a||(a=document.createElement("div"),a.setAttribute("id","dndContainer"),a.setAttribute("class","dndContainer"));let h=[this.getMappedStyle("focus"),this.getMappedStyle("hover"),this.getMappedStyle("active"),this.getMappedStyle("topSelected"),this.getMappedStyle("startSelected"),this.getMappedStyle("bottomSelected"),this.getMappedStyle("endSelected"),this.getMappedStyle("selected")],d=0,m=0,c=0,u=0;this._headersDragged=[];let _=this._computeDndContainerCellCountInRow(s,t);[u,c]=this._appendNestedHeadersToContainer(i,t,a,d,m,o,!1),m=u,d=c;for(let s=0;s<e.length;s++){let o=e[s],n=o.cloneNode(!0);n.classList.remove(...h),n.setAttribute("draggable",!1),n.style.top=`${d}px`,n.style[i]=`${m}px`,"row"===t?(s%_==0?m=u+o.offsetWidth:m+=o.offsetWidth,s%_==_-1&&(d+=o.offsetHeight,s===e.length-1?d=0:m=u)):(s%_==0?d=c+o.offsetHeight:d+=o.offsetHeight,s%_==_-1&&(m+=o.offsetWidth,s===e.length-1?m=0:d=c)),a.appendChild(n),o.classList.add("drag-source-opaque")}return[u,c]=this._appendNestedHeadersToContainer(i,t,a,d,m,n,!0),a.style.width=`${r}px`,a.style.height=`${l}px`,"column"===t?a.style.height=`${l+c}px`:a.style.width=`${r+u}px`,this.m_utils.isTouchDevice()?(this.m_dragImageAttached=!1,this.m_dndContainer=a):document.body.appendChild(a),a},A.prototype._appendNestedHeadersToContainer=function(e,t,i,s,o,n,r){let l;r?(this.m_rowEndHeaderLevelCount||this.m_columnEndHeaderLevelCount)&&(l="row"===t?this.m_rowEndHeaderLevelCount-1:this.m_columnEndHeaderLevelCount-1):l="row"===t?this.m_rowHeaderLevelCount-1:this.m_columnHeaderLevelCount-1;let a=Object.keys(n),h=[this.getMappedStyle("focus"),this.getMappedStyle("hover"),this.getMappedStyle("active"),this.getMappedStyle("selected")];r&&(a=a.reverse());for(let r=0;r<a.length;r++){let d=parseInt(a[r],10);if(d!==l){let r=n[d].length;for(let l=0;l<n[d].length;l++){let a=n[d][l];this._headersDragged.push(a);let m=a.cloneNode(!0);m.classList.remove(...h),m.style.top=`${s}px`,m.style[e]=`${o}px`,"row"===t?(l%r==0?s=a.offsetHeight:s+=a.offsetHeight,l===r-1&&(o+=a.offsetWidth,s=0)):(l%r==0?o=a.offsetWidth:o+=a.offsetWidth,l===r-1&&(o=0,s+=a.offsetHeight)),i.appendChild(m),a.classList.add("drag-source-opaque")}}}return[o,s]},A.prototype._destroyDragImage=function(){let e=document.getElementById("dndContainer");e&&e.parentNode.removeChild(e),this.m_dragImageAttached=!1,this.m_dndContainer=null},A.prototype._setDragRowsData=function(e,t){if(t){let i=e.dataTransfer,s=JSON.stringify(this.m_selection);if("string"==typeof t)i.setData(t,s);else for(let e=0;e<t.length;e++)i.setData(t[e],s)}},A.prototype._getOverIndex=function(e,t){let i,s,o,n=e.target,r=this.getResources().isRTLMode()?"right":"left",l=n.getBoundingClientRect(),a=this.findHeader(n),h=!1,d=!1;if(a?(s=a[this.getResources().getMappedAttribute("context")],o=s.index,"column"===t?this.m_dropColumnIndex=o:this.m_dropRowIndex=o,h=this._isParentNode(s),d=this._isLeafNode(s)):(i=this.findCell(n),i&&(s=i[this.getResources().getMappedAttribute("context")],o=s.indexes,"column"===t?this.m_dropColumnIndex=s.indexes[t]:this.m_dropRowIndex=s.indexes[t])),void 0!==o){let n,m="width";if("column"===t?n=Math.abs(e.clientX-l[r]):(n=e.clientY-l.top,m="height"),a&&(h||d))n<.25*l[m]&&(o-=1);else if(n<.4*l[m])if(a)o-=1;else if(i&&void 0!==o){let e=s.indexes.row,i=s.indexes.column;o="row"===t?this.createIndex(e-1,i):this.createIndex(e,i-1)}}return o},A.prototype._getRelativePosition=function(e,t,i,s){let o,n=e.target,r=this.getResources().isRTLMode()?"right":"left",l=n.getBoundingClientRect(),a=!1,h=!1,d="before";if(s){let e=i[this.getResources().getMappedAttribute("context")];a=this._isParentNode(e),h=this._isLeafNode(e)}let m="width";return"column"===t?o=Math.abs(e.clientX-l[r]):(o=e.clientY-l.top,m="height"),i&&(a||h)?o>=.25*l[m]&&o<=.75*l[m]?d="inside":o>.75*l[m]&&(d="after"):o>.4*l[m]&&(d="after"),d},A.prototype._addDropTargetLine=function(e,t,i,s,o){let n="row"===e?"rowDropTargetLine":"colDropTargetLine";this.m_dropTarget=document.createElement("div"),this.m_dropHeaderTarget=document.createElement("div"),this.m_dropEndHeaderTarget=document.createElement("div"),this._setAttribute(this.m_dropTarget,"dropIndex",o);let r=this.m_databody,l=this.m_rowHeader,a=this.m_rowEndHeader;"column"===e&&(l=this.m_colHeader,a=this.m_colEndHeader),"row"===e&&this._hasFrozenRows()&&o<=this.m_frozenRowIndex?(r=this.m_databodyFrozenRow,l=this.m_rowHeaderFrozen,a=this.m_rowEndHeaderFrozen):"column"===e&&this._hasFrozenColumns()&&o<=this.m_frozenColIndex&&(r=this.m_databodyFrozenCol,l=this.m_colHeaderFrozen,a=this.m_colEndHeaderFrozen);const h=function(t,s,o,n,r,a,h,d,m){let c="row"===e?this._getCornerDimensions("height"):this._getCornerDimensions("width");if("row"===e){let e=Math.abs(this.getElementDir(l.firstChild,"top"));0!==e&&(s-=e),t=s+=c,o=s,this._hasFrozenColumns()&&(h+=this.getElementWidth(this.m_databodyFrozenCol))}else{let e=Math.abs(this.getElementDir(l.firstChild,i));0!==e&&(r-=e),n=r+=c,a=r,this._hasFrozenRows()&&(h+=this.getElementHeight(this.m_databodyFrozenRow))}return[t,s,o,n,r,a,h,d,m]}.bind(this);this._addVisualIndicator(e,t,i,s,n,this.m_dropTarget,this.m_dropHeaderTarget,this.m_dropEndHeaderTarget,r,l,a,h),this._addDnDVisualIndicatorEventListener()},A.prototype._addVisualIndicator=function(e,t,i,s,o,n,r,l,a,h,d,m){let c,u="width",_="width";"row"===e?c=-1!==this.m_endRowEndHeader:(u="height",_="height",c=-1!==this.m_endColEndHeader);let[g,p,f,C,y,w,E,v,x]=this._calculateVisualIndicatorPosition(a,h,d,t,s,i,e);m&&"function"==typeof m&&([g,p,f,C,y,w,E,v,x]=m(g,p,f,C,y,w,E,v,x)),this._setVisualIndicatorStyle(n,o,g,i,C,E,u),this._setVisualIndicatorStyle(r,o,p,i,y,v,_),c&&this._setVisualIndicatorStyle(l,o,f,i,w,x,_),this.m_root.appendChild(n),this.m_root.appendChild(r),c&&this.m_root.appendChild(l)},A.prototype._addDnDVisualIndicatorEventListener=function(){this.m_dropTarget.addEventListener("dragover",this.handleDropTargetDragOver.bind(this),!1),this.m_dropHeaderTarget.addEventListener("dragover",this.handleDropTargetDragOver.bind(this),!1),this.m_dropEndHeaderTarget.addEventListener("dragover",this.handleDropTargetDragOver.bind(this),!1),this.m_dropTarget.addEventListener("drop",this.handleDropTargetDrop.bind(this),!1),this.m_dropHeaderTarget.addEventListener("drop",this.handleDropTargetDrop.bind(this),!1),this.m_dropEndHeaderTarget.addEventListener("drop",this.handleDropTargetDrop.bind(this),!1)},A.prototype._setVisualIndicatorStyle=function(e,t,i,s,o,n,r){this.m_utils.addCSSClassName(e,this.getMappedStyle(t)),this.setElementDir(e,i,"top"),this.setElementDir(e,o,s),"width"===r?this.setElementWidth(e,n):this.setElementHeight(e,n)},A.prototype._calculateVisualIndicatorPosition=function(e,t,i,s,o,n,r){let l=s,a=o,h=s,d=o,m=s,c=o,u=0,_=0,g=0,p="row"===r?this.getElementWidth.bind(this):this.getElementHeight.bind(this);return u=p(e.firstChild),_=p(t.firstChild),g=p(i.firstChild),"column"===r?l+=_:a+=_,"row"===r&&this.m_rowEndHeader?c=o+this.getElementDir(this.m_rowEndHeader,n):"column"===r&&this.m_colEndHeader&&(m=s+this.getElementDir(this.m_colEndHeader,"top")),[l,h,m,a,d,c,u,_,g]},A.prototype._getCornerDimensions=function(e){let t=0,i=0;return this.m_corner&&(t=this.getElementHeight(this.m_corner),i=this.getElementWidth(this.m_corner)),e?"height"===e?t:i:[t,i]},A.prototype._setDropTargetLineStyle=function(e,t,i,s,o,n,r){this.m_utils.addCSSClassName(e,this.getMappedStyle(t)),this.setElementDir(e,i,"top"),this.setElementDir(e,o,s),"width"===r?this.setElementWidth(e,n):this.setElementHeight(e,n)},A.prototype._removeDropTargetLine=function(){this._removeDropTargetEventListeners(),this.m_dropTarget&&this.m_dropTarget.removeAttribute(this.getResources().getMappedAttribute("dropIndex")),this._remove(this.m_dropTarget),this._remove(this.m_dropHeaderTarget),this.m_dropEndHeaderTarget&&this._remove(this.m_dropEndHeaderTarget)},A.prototype._removeDropTargetEventListeners=function(){this.m_dropTarget&&(this.m_dropTarget.removeEventListener("dragover",this.handleDropTargetDragOver,!1),this.m_dropTarget.removeEventListener("drop",this.handleDropTargetDrop,!1)),this.m_dropHeaderTarget&&(this.m_dropHeaderTarget.removeEventListener("dragover",this.handleDropTargetDragOver,!1),this.m_dropHeaderTarget.removeEventListener("drop",this.handleDropTargetDrop,!1)),this.m_dropEndHeaderTarget&&(this.m_dropEndHeaderTarget.removeEventListener("dragover",this.handleDropTargetDragOver,!1),this.m_dropEndHeaderTarget.removeEventListener("drop",this.handleDropTargetDrop,!1))},A.prototype._removeDropTargetClass=function(){let e=document.querySelectorAll(`.${this.getMappedStyle("dropTarget")}`);e&&e.length&&this._unhighlightElementsByClassName(e,["dropTarget"])},A.prototype._isHeaderWithinSelection=function(e,t){let i=this.getHeaderCellIndex(e),s=!1;if(this.m_selection&&this.m_selection.length)for(let o=0;o<this.m_selection.length;o++){let n=this._getHeadersWithinSelection(this.m_selection[o],i,t);for(let t=0;t<n.length;t++)if(n[t]===e&&n[n.length-1]!==e){s=!0;break}}return s},A.prototype._invokeDndCallback=function(e,t,i,s,o){let n,r=this.m_options.options.dnd[e];if(r&&r[t]){let e=r[t][i];if(e&&"function"==typeof e)try{this.m_customElement?e(s,o):n=e(s,o)}catch(e){throw new Error(e)}}return n},A.prototype._invokeDropCallback=function(e,t,i,s){var o=this._invokeDndCallback("drop",e,t,i,s);return void 0===o&&this._matchDragDataType(i,e)&&i.preventDefault(),o},A.prototype._matchDragDataType=function(e,t){var i=e.dataTransfer.types,s=this.m_options.options.dnd.drop;if(s&&s[t]&&s[t].dataTypes)for(var o=s[t].dataTypes,n="string"==typeof o?[o]:o,r=0;r<i.length;r++)if(n.indexOf(i[r])>=0)return!0;return!1},A.prototype.handleCancelDrag=function(){this._unhighlightDragSource(),this._enableChildElements(),this._resetDragInternals()},A.prototype._resetDragInternals=function(){this._draggedElements=[],this._cellsDragged=[],this._headersDragged=[],this.m_dragIndex=null,this.m_dragHeader=null,this.m_databodyReorder=!1},A.prototype._disableChildElements=function(e){const t=this.getResources().getMappedAttribute("context");let i="row"===e?this.m_rowHeader:this.m_colHeader;i=i.querySelectorAll(`.${this.getResources().getMappedStyle("headercell")}`);let s=this._getLogicalChildHeaderNodes(i,e,this.m_dragHeader,this.m_dragIndex+1);for(let i=0;i<s.length;i++){let o=s[i][t].index;this._highlightCellsAlongAxis(o,e,"index","add",["disabledElement"]),this._highlightElement(s[i],["disabledElement"])}},A.prototype._getLogicalChildHeaderNodes=function(e,t,i,s){const o=this.getResources().getMappedAttribute("context");let n=[];if("row"===t){let t=i[o].metadata.treeDepth;for(let i=s;i<e.length;i++){if(!(t<e[i][o].metadata.treeDepth))break;n.push(e[i])}}else{let t=i[o].level;for(let i=s;i<e.length;i++){if(!(t<e[i][o].level))break;n.push(e[i])}}return n},A.prototype._enableChildElements=function(){let e=this.getMappedStyle("disabledElement"),t=document.querySelectorAll(`.${e}`);this._unhighlightElementsByClassName(t,["disabledElement"])},A.prototype._unhighlightDragSource=function(){let e=["draggableItem","dragSourceOpaque"];this._cellsDragged?.length&&this._unhighlightElementsByClassName(this._cellsDragged,e),this._headersDragged?.length&&this._unhighlightElementsByClassName(this._headersDragged,e)},A.prototype._removeDragStyle=function(e){let t="row"===e?this.m_rowHeader:this.m_colHeader,i="row"===e?this.m_rowEndHeader:this.m_colEndHeader,s=this.getMappedStyle("dragging"),o=t.firstChild.querySelectorAll(`.${s}`);this._unhighlightElementsByClassName(o,["dragging"]),-1!==this.m_endRowEndHeader&&(o=i.firstChild.querySelectorAll(`.${s}`),this._unhighlightElementsByClassName(o,["dragging"]))},A.prototype._getDropContext=function(e,t,i){let s=e.target,o=this.findHeader(s);return{index:t,axis:i,position:this._getRelativePosition(e,i,o,!0)}},A.prototype.handleDropTargetDragOver=function(e){if(this.m_dragFrozenIndicator)return void e.preventDefault();let t=e.target,i=this.m_utils.containsCSSClassName(t,this.getMappedStyle("rowDropTargetLine"))?"row":"column",s={axis:i,position:"after",index:this._getAttribute(this.m_dropTarget,"dropIndex")},o="row"===i||"rowEnd"===i?"rows":"columns";this._invokeDropCallback(o,"dragOver",e,s)},A.prototype.handleDropTargetDrop=function(e){let t=e.target,i=this.m_utils.containsCSSClassName(t,this.getMappedStyle("rowDropTargetLine"))?"row":"column",s=this._getAttribute(this.m_dropTarget,"dropIndex");if("row"===i?this.m_dropRowIndex=null:this.m_dropColumnIndex=null,this.m_dragFrozenIndicator)return void this.handleFreezeIndicatorDrop(s,i,e);let o="row"===i||"rowEnd"===i?"rows":"columns";if(this._destroyDragImage(),this._removeDropTargetLine(i),this._removeDropTargetClass(),this._unhighlightDragSource(),this._enableChildElements(),this._resetDragInternals(),null!==s){let t={axis:i,position:"after",index:s};this._invokeDropCallback(o,"drop",e,t)}},A.prototype._populateFrozenContainer=function(e,t,i,s,o,n,r,l){let a=document.createDocumentFragment(),h=this._addCellsToFragment(a,t,i,s,o,n,r,l);return this._populateDatabody(e,a),this.m_initialized||(this.setElementHeight(e.parentElement,h.totalRowHeight),this.setElementWidth(e.parentElement,h.totalColumnWidth)),h},A.prototype._addFrozenIndicator=function(e,t,i,s,o){const n="row"===e?"rowFrozenIndicator":"colFrozenIndicator",r="FrozenIndicator",l=this.createSubId(`databody${e}${r}`),a=this.createSubId(`${e}header${r}`),h=this.createSubId(`${e}endHeader${r}`);if(null===document.getElementById(l)){const t=this._createFrozenIndicatorElement(l);"row"===e?this.m_databodyRowFrozenTarget=t:this.m_databodyColFrozenTarget=t,this._setAttribute(t,"index",o)}if(null===document.getElementById(a)){const t=this._createFrozenIndicatorElement(a);"row"===e?this.m_rowHeaderFrozenTarget=t:this.m_colHeaderFrozenTarget=t}if(null===document.getElementById(h)){const t=this._createFrozenIndicatorElement(h);"row"===e?this.m_rowEndHeaderFrozenTarget=t:this.m_colEndHeaderFrozenTarget=t}const d=function(t,s,o,n,r,l,a,h,d){let m="row"===e?this.getElementWidth.bind(this):this.getElementHeight.bind(this);return this._hasFrozenRows()&&this._hasFrozenColumns()?a+=m(this.m_databodyFrozenCorner.firstChild):this._hasFrozenRows()&&"column"===e?a+=m(this.m_databodyFrozenRow.firstChild):this._hasFrozenColumns()&&"row"===e&&(a+=m(this.m_databodyFrozenCol.firstChild)),"row"===e&&-1===this.m_endRowHeader&&this.m_headerLabels.column&&this.m_headerLabels.column.length&&(n=this._hasFrozenColumns()?this.getElementDir(this.m_databodyFrozenCol,i):this.getElementDir(this.m_databody,i)),"column"===e&&-1===this.m_endColHeader&&this.m_headerLabels.row&&this.m_headerLabels.row.length&&(t=this.getElementHeight(this.m_headerLabels.row[0])),[t,s,o,n,r,l,a,h,d]}.bind(this);"row"===e?this._addVisualIndicator(e,t,i,s,n,this.m_databodyRowFrozenTarget,this.m_rowHeaderFrozenTarget,this.m_rowEndHeaderFrozenTarget,this.m_databodyFrozenRow,this.m_rowHeaderFrozen,this.m_rowEndHeaderFrozen,d):this._addVisualIndicator(e,t,i,s,n,this.m_databodyColFrozenTarget,this.m_colHeaderFrozenTarget,this.m_colEndHeaderFrozenTarget,this.m_databodyFrozenCol,this.m_colHeaderFrozen,this.m_colEndHeaderFrozen,d)},A.prototype._addFreezeVisualIndicatorEventListener=function(e){e.addEventListener("mousedown",this.handleFreezeIndicatorMouseDown.bind(this),!1),e.addEventListener("mouseup",this.handleFreezeIndicatorMouseUpOrOut.bind(this),!1),e.addEventListener("mouseout",this.handleFreezeIndicatorMouseUpOrOut.bind(this),!1),e.addEventListener("dragstart",this.handleFreezeIndicatorDragStart.bind(this),!1),e.addEventListener("dragend",this.handleFreezeIndicatorDragEnd.bind(this),!1),e.addEventListener("drop",this.handleFreezeIndicatorDrop.bind(this),!1)},A.prototype._removeFrozenIndicator=function(e){if("column"===e){let e=-1!==this.m_endColEndHeader;this.m_root.removeChild(this.m_databodyColFrozenTarget),this.m_root.removeChild(this.m_colHeaderFrozenTarget),e&&this.m_root.removeChild(this.m_colEndHeaderFrozenTarget)}else{let e=-1!==this.m_endRowEndHeader;this.m_root.removeChild(this.m_databodyRowFrozenTarget),this.m_root.removeChild(this.m_rowHeaderFrozenTarget),e&&this.m_root.removeChild(this.m_rowEndHeaderFrozenTarget)}},A.prototype._setFrozenContainerDimension=function(e,t,i,s,o,n){const r=this.getResources().isRTLMode()?"right":"left",l=this.m_databodyFrozenCol,a=this.m_databodyFrozenRow,h=this.m_databodyFrozenCorner,d=this.m_colHeader,m=this.m_colEndHeader,c=this.m_rowHeader,u=this.m_rowEndHeader,_=this.getHeight(),g=this.getWidth(),p=t,f=e;let C,y,w,E=0,v=0;if(this._hasFrozenColumns()&&(E=this.getElementWidth(l),i+s+E>g&&(E=g-i-s),(null==E||0===E&&this._databodyEmptyState())&&(-1!==this.m_endColHeader||-1!==this.m_endColEndHeader))){let e=-1!==this.m_endColHeader?"column":"columnEnd";E+=this._computeHeaderDimension(e,!0,"width")}if(this._hasFrozenRows()&&(v=this.getElementHeight(a),o+n+v>_&&(v=_-o-n),(null==v||0===v&&this._databodyEmptyState())&&(-1!==this.m_endRowHeader||-1!==this.m_endRowEndHeader))){let e=-1!==this.m_endRowHeader?"row":"rowEnd";v+=this._computeHeaderDimension(e,!0,"height")}if(this._hasFrozenColumns()&&this._hasFrozenRows()&&(y=v||this.getElementHeight(h),C=E||this.getElementWidth(h),null==E&&(E=C),null==v&&(v=y)),l&&(w=o),this._hasFrozenColumns()&&this._hasFrozenRows()&&(this._setElementDimension(h,o,i,y,C),w=_-o-n<=y?y+o+n:y+o),this._hasFrozenColumns()&&this._setElementDimension(l,w,i,p,E),this.m_colHeaderFrozen){let e=this.getElementHeight(this.m_colHeaderFrozen);this._setElementDimension(this.m_colHeaderFrozen,0,i,e,E)}if(this.m_colEndHeaderFrozen){let e=this.getElementHeight(this.m_colEndHeaderFrozen),s=t+o+v;this._setElementDimension(this.m_colEndHeaderFrozen,s,i,e,E),this.setElementDir(m,s,"top")}const x=this.m_frozenColIndex;if(this._hasFrozenColumns()&&this._addFrozenIndicator("column",0,r,i+E,x),i+=E,this.setElementDir(d,i,r),this.setElementDir(m,i,r),this.setElementHeight(d,o),this.setElementHeight(m,n),this.getElementDir(m,"top")+n>this.getHeight()){let e=this.getHeight()-n;this.setElementDir(m,e,"top")}if(a&&this._setElementDimension(a,o,i,v,f),this.m_rowHeaderFrozen){let e=this.getElementWidth(this.m_rowHeaderFrozen);this._setElementDimension(this.m_rowHeaderFrozen,o,0,v,e)}if(this.m_rowEndHeaderFrozen){let t=this.getElementWidth(this.m_rowEndHeaderFrozen),s=e+i;this._setElementDimension(this.m_rowEndHeaderFrozen,o,s,v,t),this.setElementDir(u,s,r)}const H=this.m_frozenRowIndex;return this._hasFrozenRows()&&this._addFrozenIndicator("row",o+v,r,0,H),o+=v,this.setElementDir(c,o,"top"),this.setElementDir(u,o,"top"),this.setElementWidth(c,i-E),this.setElementWidth(u,s),[i,o]},A.prototype._setElementDimension=function(e,t,i,s,o){const n=this.getResources().isRTLMode()?"right":"left";null!==o&&this.setElementWidth(e,o),null!==s&&this.setElementHeight(e,s),null!==t&&this.setElementDir(e,t,"top"),null!==i&&this.setElementDir(e,i,n)},A.prototype._buildFrozenHeaders=function(e,t,i,s,o){let n=s.start,r={headerStart:s.start,endHeaderStart:s.start,headerFetchCount:0,endHeaderFetchCount:0};if(null===this.m_options._getFreezeIndex(e)||-1===this.m_options._getFreezeIndex(e)||!this._isFreezeFeasible(e,t,i,n,0)){r={headerStart:n,endHeaderStart:n},t&&(r.headerFetchCount=t.getCount()),i&&(r.endHeaderFetchCount=i.getCount()),"column"===e?this.m_frozenColIndex=this.m_options.isFreezeEnabled(e)?-1:null:this.m_frozenRowIndex=this.m_options.isFreezeEnabled(e)?-1:null;let s=this.m_rowHeaderFrozen,o=this.m_rowEndHeaderFrozen;return"column"===e&&(s=this.m_colHeaderFrozen,o=this.m_colEndHeaderFrozen),s&&(this.m_root.removeChild(s),"column"===e?this.m_colHeaderFrozen=null:this.m_rowHeaderFrozen=null),o&&(this.m_root.removeChild(o),"column"===e?this.m_colEndHeaderFrozen=null:this.m_rowEndHeaderFrozen=null),r}return r=this._buildFrozenAxisHeaders(e,t,i,s,o,r),r},A.prototype._isFreezeFeasible=function(e,t,i,s,o){let n=!1;if(this.m_initialized&&("row"===e&&!this._hasFrozenRows()||"column"===e&&!this._hasFrozenColumns()))return n;if(t&&i){if("column"===e&&!this.m_initialized&&(this.m_frozenColIndex>=t.getCount()||this.m_frozenColIndex>=i.getCount())||"row"===e&&!this.m_initialized&&(this.m_frozenRowIndex>=t.getCount()||this.m_frozenRowIndex>=i.getCount()))return n;const r=t.getExtent(s,o),l=i.getExtent(s,o);if(r.more.after||l.more.after)return n;let a=r.extent,h=l.extent;a===h||1===a||1===h?n=!0:a>h?(h+=i.getExtent(s+1,o).extent,a===h&&(n=!0)):(a+=t.getExtent(s+1,o).extent,a===h&&(n=!0));const d=r.extent>l.extent?r.extent:l.extent;if(n&&d>1){const t="row"===e?this.m_frozenRowIndex:this.m_frozenColIndex;let i=this._adjustFrozenIndexBasedOnExtent(t,d);"row"===e?this.m_frozenRowIndex=i:this.m_frozenColIndex=i}}else t&&(!this.m_initialized&&("column"===e&&this.m_frozenColIndex<t.getCount()||"row"===e&&this.m_frozenRowIndex<t.getCount())||this.m_initialized)||i&&(!this.m_initialized&&("column"===e&&this.m_frozenColIndex<i.getCount()||"row"===e&&this.m_frozenRowIndex<i.getCount())||this.m_initialized)?n=!0:t||i||(n=!0);return n},A.prototype._adjustFrozenIndexBasedOnExtent=function(e,t){let i;return i=e>=t?e+(t-e%t)-1:t-1,i},A.prototype._buildFrozenAxisHeaders=function(e,t,i,s,o,n){let r=s.start,l=this.getDataSource().getCount(e),a=this.buildRowHeaders.bind(this),h=this.buildRowEndHeaders.bind(this),d=this.m_frozenRowIndex,m=this.m_rowHeaderFrozen,c=this.m_rowEndHeaderFrozen,u=this.m_options.getScrollPosition();if("column"===e&&(d=this.m_frozenColIndex,m=this.m_colHeaderFrozen,c=this.m_colEndHeaderFrozen,a=this.buildColumnHeaders.bind(this),h=this.buildColumnEndHeaders.bind(this)),null!=t){let i=t.getCount();if(n.headerFetchCount=i,null!==d&&-1!==d){!1===this.m_initialized&&o&&(i-=d+1);let s=d+1;if(!this._isHighWatermarkScrolling()&&void 0!==u.rowIndex&&0!==u.rowIndex&&void 0!==u.columnIndex&&0!==u.columnIndex&&i>d+1&&(s=i),m&&m.firstChild&&!m.firstChild.childNodes.length){a(m,t,r,l,!1,!1,s,!0);let h=m.firstChild.querySelectorAll(`.${this.getMappedStyle("groupingcontainer")}`);r=this._calculateFrozenIndex(d+1,h),i=t.getCount()-r,"column"===e?(this.m_endColHeaderPixel=0,this.m_frozenColIndex=o?r-1:t.getCount()-1):(this.m_endRowHeaderPixel=0,this.m_frozenRowIndex=o?r-1:t.getCount()-1),n.headerFetchCount=i,n.headerStart=r}}}if(null!=i){let t=i.getCount();if(n.endHeaderFetchCount=t,null!==d&&-1!==d&&(!1===this.m_initialized&&o&&(t-=d+1),c&&c.firstChild&&!c.firstChild.childNodes.length)){let a=d+1;!this._isHighWatermarkScrolling()&&void 0!==u.rowIndex&&0!==u.rowIndex&&void 0!==u.columnIndex&&0!==u.columnIndex&&t>d+1&&(a=t),r=s.start,h(c,i,r,l,!1,!1,a,!0),"column"===e?this.m_endColEndHeaderPixel=0:this.m_endRowEndHeaderPixel=0,r=d+1;let m=c.firstChild.querySelectorAll(`.${this.getMappedStyle("groupingcontainer")}`);m.length&&(r=this._calculateFrozenIndex(d+1,m)),t=i.getCount()-r,n.endHeaderFetchCount=t,n.endHeaderStart=r,"column"===e?this.m_frozenColIndex=o?r-1:i.getCount()-1:(this.m_frozenRowIndex=i.getCount()-1,o&&(this.m_frozenRowIndex=r-1))}}return n},A.prototype._handleFreezeRow=function(e){let t;if(this._isSelectionEnabled()&&this.isMultipleSelection()&&this.m_selection&&this.m_selection.length){let e=[],i=[];-1===this.m_endRowHeader&&-1===this.m_endRowEndHeader||([e,i]=this._getHeadersInSelection(this.m_rowHeaderLevelCount-1,this.m_selection,"row"),-1!==this.m_endRowHeader&&e&&Object.keys(e).length?(e=e[Object.keys(e)],t=e[e.length-1]):-1!==this.m_endRowEndHeader&&i&&Object.keys(i).length&&(i=i[0],t=i[i.length-1]))}t||(t=this.findHeader(e.target));let i,s="row",o=!0;const n=this.getResources().getMappedAttribute("context");let r=!1;if(null===t){let l,a;i=this.findCell(e.target),this._isSelectionEnabled()&&this.isMultipleSelection()&&this.m_selection&&this.m_selection.length&&(i=this._getCellByIndex(this.m_selection[0].endIndex));const h=i[n].indexes;if(h.row<this.m_frozenRowIndex+1&&(r=!0),-1!==this.m_endRowHeader&&-1!==this.m_endRowEndHeader){let e=this._isDynamicFreezeFeasible(h.row,s,r);o=e.isFeasible,l=e.headerIndex,a=e.endHeaderIndex,t=this._getMaxExtentNestedHeader(s,l,a,r)}else-1!==this.m_endRowHeader?s="row":-1!==this.m_endRowEndHeader&&(s="rowEnd"),t=this.getHeaderFromCell(i,s)}else{let e,i=t[n].index;if(i<this.m_frozenRowIndex+1&&(r=!0),-1!==this.m_endRowHeader&&-1!==this.m_endRowEndHeader){let n=this._isDynamicFreezeFeasible(i,s,r);o=n.isFeasible,i=n.headerIndex,e=n.endHeaderIndex,t=this._getMaxExtentNestedHeader(s,i,e,r)}}if((this._isHighWatermarkScrolling()||r||!(this._hasFrozenColumns()&&this.m_startCol>this.m_frozenColIndex+1||this._hasFrozenRows()&&this.m_startRow>this.m_frozenRowIndex+1||this._hasFrozenColumns()&&this._hasFrozenRows()&&(this.m_startCol>this.m_frozenColIndex+1||this.m_startRow>this.m_frozenRowIndex+1)||!this._hasFrozenRows()&&this.m_startRow>0))&&o){if(this._mutateRowFrozenContainer(t,i,s),!this._isHighWatermarkScrolling()){const e=this.m_currentScrollLeft,t=this.getResources().isRTLMode()?"right":"left";this.m_databodyFrozenRow?.firstChild&&this.setElementDir(this.m_databodyFrozenRow.firstChild,-e,t),this.m_startRow=this.m_frozenRowIndex+1,this.m_startRowHeader=this.m_frozenRowIndex+1,this.m_startRowEndHeader=this.m_frozenRowIndex+1}this.deleteAndApplyHiddenIndicators();let o={event:e,ui:{frozenCount:this.m_frozenRowIndex+1}};this.fireEvent("rowFreeze",o)}},A.prototype._handleFreezeCol=function(e){let t;if(this._isSelectionEnabled()&&this.isMultipleSelection()&&this.m_selection&&this.m_selection.length){let e,i;-1===this.m_endColHeader&&-1===this.m_endColEndHeader||([e,i]=this._getHeadersInSelection(this.m_columnHeaderLevelCount-1,this.m_selection,"column"),-1!==this.m_endColHeader&&e&&Object.keys(e).length?(e=e[Object.keys(e)],t=e[e.length-1]):-1!==this.m_endColEndHeader&&i&&Object.keys(i).length&&(i=i[0],t=i[i.length-1]))}t||(t=this.findHeader(e.target));let i,s="column",o=!0,n=!1;const r=this.getResources().getMappedAttribute("context");if(null===t){i=this.findCell(e.target),this._isSelectionEnabled()&&this.isMultipleSelection()&&this.m_selection&&this.m_selection.length&&(i=this._getCellByIndex(this.m_selection[0].endIndex));let l,a,h=i[r].indexes;if(h.column<this.m_frozenColIndex+1&&(n=!0),-1!==this.m_endColHeader&&-1!==this.m_endColEndHeader){let e=this._isDynamicFreezeFeasible(h.column,s,n);o=e.isFeasible,l=e.headerIndex,a=e.endHeaderIndex,t=this._getMaxExtentNestedHeader(s,l,a,n)}else-1!==this.m_endColHeader?s="column":-1!==this.m_endColEndHeader&&(s="columnEnd"),t=this.getHeaderFromCell(i,s)}else{let e,i=t[r].index;if(i<this.m_frozenColIndex+1&&(n=!0),-1!==this.m_endColHeader&&-1!==this.m_endColEndHeader){let r=this._isDynamicFreezeFeasible(i,s,n);o=r.isFeasible,i=r.headerIndex,e=r.endHeaderIndex,t=this._getMaxExtentNestedHeader(s,i,e,n)}}if((this._isHighWatermarkScrolling()||n||!(this._hasFrozenColumns()&&this.m_startCol>this.m_frozenColIndex+1||this._hasFrozenRows()&&this.m_startRow>this.m_frozenRowIndex+1||this._hasFrozenColumns()&&this._hasFrozenRows()&&(this.m_startCol>this.m_frozenColIndex+1||this.m_startRow>this.m_frozenRowIndex+1)||!this._hasFrozenColumns()&&this.m_startCol>0))&&o){if(this._mutateColumnFrozenContainer(t,i,s),!this._isHighWatermarkScrolling()){const e=this.m_currentScrollTop;this.m_databodyFrozenCol?.firstChild&&this.setElementDir(this.m_databodyFrozenCol.firstChild,-e,"top"),this.m_startCol=this.m_frozenColIndex+1,this.m_startColHeader=this.m_frozenColIndex+1,this.m_startColEndHeader=this.m_frozenColIndex+1}this.deleteAndApplyHiddenIndicators();let o={event:e,ui:{frozenCount:this.m_frozenColIndex+1}};this.fireEvent("columnFreeze",o)}},A.prototype._getMaxExtentNestedHeader=function(e,t,i,s){let o,n=t,r=s?this.m_colHeaderFrozen:this.m_colHeader,l=s?this.m_colEndHeaderFrozen:this.m_colEndHeader,a="column"===e?this.m_columnHeaderLevelCount:this.m_rowHeaderLevelCount,h="column"===e?this.m_startColHeader:this.m_startRowHeader;"row"===e&&(r=s?this.m_rowHeaderFrozen:this.m_rowHeader,l=s?this.m_rowEndHeaderFrozen:this.m_rowEndHeader);let d=r;return t<i&&(n=i,a="column"===e?this.m_columnEndHeaderLevelCount:this.m_rowEndHeaderLevelCount,d=l,h="column"===e?this.m_startColEndHeader:this.m_startRowEndHeader),o=this._getHeaderByIndexFromRoot(n,a-1,d,a,h),o},A.prototype._isDynamicFreezeFeasible=function(e,t,i){let s=!1,o=e,n=e,r=this.m_frozenRowIndex,l=i?this.m_rowHeaderFrozen:this.m_rowHeader,a=i?this.m_rowEndHeaderFrozen:this.m_rowEndHeader,h=this.m_rowHeaderLevelCount,d=this.m_rowEndHeaderLevelCount;"column"===t&&(r=this.m_frozenColIndex,l=i?this.m_colHeaderFrozen:this.m_colHeader,a=i?this.m_colEndHeaderFrozen:this.m_colEndHeader,h=this.m_columnHeaderLevelCount,d=this.m_columnEndHeaderLevelCount),i||null==r||(1===h&&(o=e-(r+1)),1===d&&(n=e-(r+1)));let m,c,u=1,_=1,g=o,p=n;h>1&&(m=this._getHeaderContainer(o,0,l,h),u=this._getExtent(m,t),g=this._getAttribute(m,"start",!0)+u),d>1&&(c=this._getHeaderContainer(n,0,a,d),_=this._getExtent(c,t),p=this._getAttribute(c,"start",!0)+_),u!==_&&1!==u&&1!==_&&g!==p||(s=!0);const f=u>_?u:_;return s&&f>1&&(f===u?o=this._adjustFrozenIndexBasedOnExtent(o,f):n=this._adjustFrozenIndexBasedOnExtent(n,f)),{isFeasible:s,headerIndex:o,endHeaderIndex:n}},A.prototype._getOutermostHeaderFromNestedHeaders=function(e){let t=!1;const i=this.getMappedStyle("groupingcontainer"),s=this.getMappedStyle("endheadercell"),o=this.getMappedStyle("headercell");for(;e.parentNode.classList.contains(i);)e.classList.contains(s)&&(t=!0),e=e.parentNode;return e.classList.contains(i)&&(e=t?e.querySelector(`.${s}`):e.querySelector(`.${o}`)),e},A.prototype._mutateColumnFrozenContainer=function(e,t,i){const s=this.getResources().getMappedAttribute("context"),o=this.getResources().isRTLMode()?"right":"left";if(e){e=this._getOutermostHeaderFromNestedHeaders(e);let t=this.getHeaderCellIndex(e),n=e[s].extent;n>1&&(t+=n-1);const r=this.m_utils.containsCSSClassName(e,this.getMappedStyle("frozenHeader"));let l,a;this._hasFrozenColumns()?r?t!==this.m_frozenColIndex&&this._removeCellsFromFrozenColumnContainer(t,e):this._appendCellsToFrozenColumnContainer(t,e,!1):null!==this.m_frozenColIndex&&-1!==this.m_frozenColIndex||(this._createColumnFrozenSectionAndMutate(i,t,e),a=!0,l=!0,this.m_shouldFocus=!1);let h=this._getElementFromActiveObject(this.m_active);h&&this.getElementDir(h,o)<this.getElementWidth(this.m_colHeaderFrozen)&&this._setActive(h,this.m_active,null,null,null,l,a)}else{let o=t[s].indexes.column;if(o=this._calculateIndexFromHeaderExtent(e,o),null===this.m_frozenColIndex||-1===this.m_frozenColIndex)this._createColumnFrozenSectionAndMutate(i,o,null);else{let e,i,s=!1;this.m_utils.containsCSSClassName(t,this.getMappedStyle("frozenCell"))&&(this.m_databodyFrozenCorner?.querySelector(`#${t.id}`)||this.m_databodyFrozenCol?.querySelector(`#${t.id}`))&&(s=!0),s?this._removeCellsFromFrozenColumnContainer(o):this._appendCellsToFrozenColumnContainer(o,null,!1),this.getElementWidth(this.m_databody)||(e=!0,i=!0),this._setActive(t,this._createActiveObject(t),null,null,null,e,i)}}this._isSelectionEnabled()&&this.m_utils.isTouchDevice()&&this.m_selection.length>0&&this._moveTouchSelectionAffordance()},A.prototype._createColumnFrozenSectionAndMutate=function(e,t,i){this._createFrozenHeaderElements("column",this.getMappedStyle("colHeaderFrozen"),this.getMappedStyle("colEndHeaderFrozen"));const s=this._createDatabodyElement("databodyFrozenCol");if(this.m_root.insertBefore(s,this.m_status),this.m_databodyFrozenCol=s,this._hasFrozenRows()){const e=this._createDatabodyElement("databodyFrozenCorner");this.m_root.insertBefore(e,this.m_status),this.m_databodyFrozenCorner=e}this._addListenersOnFrozenSections(null,null,this.m_colHeaderFrozen,this.m_colEndHeaderFrozen),this._appendCellsToFrozenColumnContainer(t,i,!0)},A.prototype._mutateRowFrozenContainer=function(e,t,i){const s=this.getResources().getMappedAttribute("context");if(e){e=this._getOutermostHeaderFromNestedHeaders(e);let t=this.getHeaderCellIndex(e),o=e[s].extent;o>1&&(t+=o-1);const n=this.m_utils.containsCSSClassName(e,this.getMappedStyle("frozenHeader"));let r,l;this._hasFrozenRows()?n?t!==this.m_frozenRowIndex&&this._removeCellsFromFrozenRowContainer(t):this._appendCellsToFrozenRowContainer(t,e,!1):null!==this.m_frozenRowIndex&&-1!==this.m_frozenRowIndex||(this._createRowFrozenSectionAndMutate(i,t,e),l=!0,r=!0,this.m_shouldFocus=!1);let a=this._getElementFromActiveObject(this.m_active);a&&this.getElementDir(a,"top")<this.getElementHeight(this.m_rowHeaderFrozen)&&this._setActive(a,this.m_active,null,null,null,r,l)}else{let o,n,r=t[s].indexes.row;if(r=this._calculateIndexFromHeaderExtent(e,r),null===this.m_frozenRowIndex||-1===this.m_frozenRowIndex)this._createRowFrozenSectionAndMutate(i,r,null);else{let e=!1;this.m_utils.containsCSSClassName(t,this.getMappedStyle("frozenCell"))&&(this.m_databodyFrozenRow?.querySelector(`#${t.id}`)||this.m_databodyFrozenCorner?.querySelector(`#${t.id}`))&&(e=!0),e?this._removeCellsFromFrozenRowContainer(r):this._appendCellsToFrozenRowContainer(r,null,!1)}this.getElementHeight(this.m_databody)||(o=!0,n=!0),this._setActive(t,this.m_active,null,null,null,o,n)}this._isSelectionEnabled()&&this.m_utils.isTouchDevice()&&this.m_selection.length>0&&this._moveTouchSelectionAffordance()},A.prototype._createRowFrozenSectionAndMutate=function(e,t,i){this._createFrozenHeaderElements("row",this.getMappedStyle("rowHeaderFrozen"),this.getMappedStyle("rowEndHeaderFrozen"));const s=this._createDatabodyElement("databodyFrozenRow");if(this.m_root.insertBefore(s,this.m_status),this.m_databodyFrozenRow=s,this._hasFrozenColumns()){const e=this._createDatabodyElement("databodyFrozenCorner");this.m_root.insertBefore(e,this.m_status),this.m_databodyFrozenCorner=e}this._addListenersOnFrozenSections(this.m_rowHeaderFrozen,this.m_rowEndHeaderFrozen,null,null),this._appendCellsToFrozenRowContainer(t,i,!0)},A.prototype._updateFrozenSection=function(e,t){if(-1===e||null==e)this._handleUnFreeze(t);else if(this.m_options.isFreezeEnabled(t)){if(!this._isHighWatermarkScrolling()&&"row"===t&&e>this.m_frozenRowIndex+1&&this.m_startRow>this.m_frozenRowIndex+1||"column"===t&&e>this.m_frozenColIndex+1&&this.m_startCol>this.m_frozenColIndex+1)return;let i=this.createIndex(0,e);"row"===t&&(i=this.createIndex(e,0)),this._isHighWatermarkScrolling()||(i="row"===t?this.createIndex(e,this.m_startCol):this.createIndex(this.m_startRow,e));let s,o,n=null,r=this._getCellByIndex(i),l=!0,a=!1;if("column"===t){if(e<this.m_frozenColIndex+1&&(a=!0),-1!==this.m_endColHeader&&-1!==this.m_endColEndHeader){let i=this._isDynamicFreezeFeasible(e,t,a);l=i.isFeasible,s=i.headerIndex,o=i.endHeaderIndex,n=this._getMaxExtentNestedHeader(t,s,o,a)}else(-1!==this.m_endColHeader&&e>this.m_endColHeader||-1!==this.m_endColEndHeader&&e>this.m_endColEndHeader)&&(l=!1);l&&(this._mutateColumnFrozenContainer(n,r,t),this._isHighWatermarkScrolling()||(this.m_startCol=this.m_frozenColIndex+1,this.m_startColHeader=this.m_frozenColIndex+1,this.m_startColEndHeader=this.m_frozenColIndex+1))}else{if(e<this.m_frozenRowIndex+1&&(a=!0),-1!==this.m_endRowHeader&&-1!==this.m_endRowEndHeader){let i=this._isDynamicFreezeFeasible(e,t,a);l=i.isFeasible,s=i.headerIndex,o=i.endHeaderIndex,n=this._getMaxExtentNestedHeader(t,s,o,a)}else(-1!==this.m_endRowHeader&&e>this.m_endRowHeader||-1!==this.m_endRowEndHeader&&e>this.m_endRowEndHeader)&&(l=!1);l&&(this._mutateRowFrozenContainer(n,r,t),this._isHighWatermarkScrolling()||(this.m_startRow=this.m_frozenRowIndex+1,this.m_startRowHeader=this.m_frozenRowIndex+1,this.m_startRowEndHeader=this.m_frozenRowIndex+1))}}},A.prototype._appendCellsToFrozenColumnContainer=function(e,t,i){const s=this.m_frozenColIndex,o="column",n=this.getResources().isRTLMode()?"right":"left";let r=this.getElementWidth(this.m_databodyFrozenCol),l=this.getElementDir(this.m_databodyFrozenCol,n);i&&(l=this.getElementDir(this.m_databody,n));let a=this.getElementWidth(this.m_databody);this.m_databodyFrozenRow&&this._hasFrozenRows()&&(a=this.getElementWidth(this.m_databodyFrozenRow));let h=r,d=e+1,m=0;null!==s&&(m=s+1);let c=e,u=e+1,_=e+1;null!==s&&-1!==s||(u=this.m_columnHeaderLevelCount>1?e+1:0,_=this.m_columnEndHeaderLevelCount>1?e+1:0),d-=m;let g=[],{cells:p,cellsDimensionToAdjust:f}=this._getCellsToFreeze(m,c,o),C=!1;0===f&&(C=!0);let{headers:y,endHeaders:w}=this._getColumnHeadersToFreeze(t,e,c,m);if(this.m_databodyFrozenCorner){if(g=this._getFrozenAxisCells(o,c),C&&p.length>0){let e=g[g.length-1];f=this.getElementDir(e,n)+this.getElementWidth(e)}for(let e=0;e<g.length;e++)this.setElementDir(g[e],h,n),this.m_databodyFrozenCorner.firstChild.appendChild(g[e]),e%d==d-1?h=r:h+=this.getElementWidth(g[e])}let E,v,x=h;if(0!==p.length?h=this._appendElementsToFrozenContainer(o,p,this.m_databodyFrozenCol,x,n,this.getMappedStyle("frozenCell"),d):0!==y.length?y.forEach(e=>{f+=this.getElementWidth(e)}):w.forEach(e=>{f+=this.getElementWidth(e)}),this._appendElementsToFrozenContainer(o,y,this.m_colHeaderFrozen,x,n,this.getMappedStyle("frozenHeader"),d),w.length&&this._appendElementsToFrozenContainer(o,w,this.m_colEndHeaderFrozen,x,n,this.getMappedStyle("frozenHeader"),d),c+1<=this._getMaxRight()){this._shiftCellsAlongAxis(o,-f,c+1,!0),this.m_databodyFrozenRow&&this._hasFrozenRows()&&p.length>0&&this._shiftFrozenCellsAlongAxis(o,-f,c+1,!0);const e=this.getResources().getMappedAttribute("context");let i=t?t[e].extent:1;!this._isHighWatermarkScrolling()&&this.m_startCol>0&&1===i&&(u=this.m_startCol,_=this.m_startCol),this._shiftHeadersAlongAxisInContainer(this.m_colHeader.firstChild,u,-f,this.getResources().isRTLMode()?"right":"left",this.getMappedStyle("colheadercell")),this._shiftHeadersAlongAxisInContainer(this.m_colEndHeader.firstChild,_,-f,this.getResources().isRTLMode()?"right":"left",this.getMappedStyle("colendheadercell"))}if(this.m_endColPixel-=f,this.m_endColHeaderPixel-=f,this.m_endColEndHeaderPixel-=f,0!==p.length)E=l+h,v=a-f;else{const e=this.m_colHeaderFrozen?this.getElementWidth(this.m_colHeaderFrozen):this.getElementWidth(this.m_colEndHeaderFrozen);E=f+l+e,h=E-l,v=this._getViewportRight()-this._getViewportLeft()-f}if(v=v<0?0:v,this.m_endRowEndHeader){const e=this.getElementDir(this.m_rowEndHeader,n);h=h>e?e-l:h,E=l+h}this._setElementDimension(this.m_databody,null,E,null,v),this._setElementDimension(this.m_colHeader,null,E,null,v),this.m_colEndHeader&&this._setElementDimension(this.m_colEndHeader,null,E,null,v),i?(this._setElementDimension(this.m_databodyFrozenCol,this.getElementDir(this.m_databody,"top"),l,this.getElementHeight(this.m_databody),h),this._setElementDimension(this.m_colHeaderFrozen,this.getElementDir(this.m_colHeader,"top"),l,this.getElementHeight(this.m_colHeader),h),this.m_colEndHeader&&this._setElementDimension(this.m_colEndHeaderFrozen,this.getElementDir(this.m_colEndHeader,"top"),l,this.getElementHeight(this.m_colEndHeader),h),this.m_databodyFrozenCorner&&this._setElementDimension(this.m_databodyFrozenCorner,this.getElementDir(this.m_databodyFrozenRow,"top"),this.getElementDir(this.m_databodyFrozenRow,n),this.getElementHeight(this.m_databodyFrozenRow),h)):(this.setElementWidth(this.m_databodyFrozenCol,h),this.setElementWidth(this.m_colHeaderFrozen,h),this.m_colEndHeaderFrozen&&this.setElementWidth(this.m_colEndHeaderFrozen,h),this.m_databodyFrozenCorner&&this.setElementWidth(this.m_databodyFrozenCorner,h)),this.m_databodyFrozenRow&&this._setElementDimension(this.m_databodyFrozenRow,null,E,null,v),this._addFrozenIndicator(o,0,n,l+h,c),this.m_frozenColIndex=c},A.prototype._appendCellsToFrozenRowContainer=function(e,t,i){const s=this.m_frozenRowIndex,o="row",n=this.getResources().isRTLMode()?"right":"left";let r=this.getElementHeight(this.m_databodyFrozenRow),l=this.getElementDir(this.m_databodyFrozenRow,"top");i&&(l=this.getElementDir(this.m_databody,"top"));let a=this.getElementHeight(this.m_databody);this.m_databodyFrozenCol&&this._hasFrozenColumns()&&(a=this.getElementHeight(this.m_databodyFrozenCol));let h=r,d=e+1,m=0;null!==s&&(m=s+1);let c=e,u=e+1,_=e+1;null!==s&&-1!==s||(u=this.m_rowHeaderLevelCount>1?e+1:0,_=this.m_rowEndHeaderLevelCount>1?e+1:0),d-=m;let g=[],{cells:p,cellsDimensionToAdjust:f}=this._getCellsToFreeze(m,c,o),C=!1;0===f&&(C=!0);let{headers:y,endHeaders:w}=this._getRowHeadersToFreeze(t,e,c,m);if(this.m_databodyFrozenCorner){g=this._getFrozenAxisCells(o,c);for(let e=0;e<g.length;e++)this.setElementDir(g[e],h,"top"),this.m_databodyFrozenCorner.firstChild.appendChild(g[e]),e%(this.m_frozenColIndex+1)===this.m_frozenColIndex&&(h+=this.getElementHeight(g[e]),C&&(f+=this.getElementHeight(g[e])))}let E,v,x=r;if(0!==p.length?h=this._appendElementsToFrozenContainer(o,p,this.m_databodyFrozenRow,x,"top",this.getMappedStyle("frozenCell"),d):0!==y.length?y.forEach(e=>{f+=this.getElementHeight(e)}):w.forEach(e=>{f+=this.getElementHeight(e)}),this._appendElementsToFrozenContainer(o,y,this.m_rowHeaderFrozen,x,"top",this.getMappedStyle("frozenHeader"),d),w.length&&this._appendElementsToFrozenContainer(o,w,this.m_rowEndHeaderFrozen,x,"top",this.getMappedStyle("frozenHeader"),d),c+1<=this._getMaxBottom()){this._shiftCellsAlongAxis(o,-f,c+1,!0),this.m_databodyFrozenCol&&this._hasFrozenColumns()&&p.length>0&&this._shiftFrozenCellsAlongAxis(o,-f,c+1,!0);const e=this.getResources().getMappedAttribute("context");let i=t?t[e].extent:1;!this._isHighWatermarkScrolling()&&this.m_startRow>0&&1===i&&(u=this.m_startRow,_=this.m_startRow),this._shiftHeadersAlongAxisInContainer(this.m_rowHeader.firstChild,u,-f,"top",this.getMappedStyle("rowheadercell")),this._shiftHeadersAlongAxisInContainer(this.m_rowEndHeader.firstChild,_,-f,"top",this.getMappedStyle("rowendheadercell"))}if(this.m_endRowPixel-=f,this.m_endRowHeaderPixel-=f,this.m_endRowEndHeaderPixel-=f,0!==p.length)E=l+h,v=a-f;else{const e=this.m_rowHeaderFrozen?this.getElementHeight(this.m_rowHeaderFrozen):this.getElementHeight(this.m_rowEndHeaderFrozen);E=f+l+e,h=E-l,v=this._getViewportBottom()-this._getViewportTop()-f}if(v=v<0?0:v,-1!==this.m_endColEndHeader){const e=this.getElementDir(this.m_colEndHeader,"top");h=h>e?e-l:h,E=l+h}this._setElementDimension(this.m_databody,E,null,v,null),this._setElementDimension(this.m_rowHeader,E,null,v,null),this.m_rowEndHeader&&this._setElementDimension(this.m_rowEndHeader,E,null,v,null),i?(this._setElementDimension(this.m_databodyFrozenRow,l,this.getElementDir(this.m_databody,n),h,this.getElementWidth(this.m_databody)),this._setElementDimension(this.m_rowHeaderFrozen,l,this.getElementDir(this.m_rowHeader,n),h,this.getElementWidth(this.m_rowHeader)),this.m_rowEndHeader&&this._setElementDimension(this.m_rowEndHeaderFrozen,l,this.getElementDir(this.m_rowEndHeader,n),h,this.getElementWidth(this.m_rowEndHeader)),this.m_databodyFrozenCorner&&this._setElementDimension(this.m_databodyFrozenCorner,l,this.getElementDir(this.m_databodyFrozenCol,n),h,this.getElementWidth(this.m_databodyFrozenCol))):(this.setElementHeight(this.m_databodyFrozenRow,h),this.setElementHeight(this.m_rowHeaderFrozen,h),this.m_rowEndHeaderFrozen&&this.setElementHeight(this.m_rowEndHeaderFrozen,h),this.m_databodyFrozenCorner&&this.setElementHeight(this.m_databodyFrozenCorner,h)),this.m_databodyFrozenCol&&this._setElementDimension(this.m_databodyFrozenCol,E,null,v,null),this._addFrozenIndicator(o,E,n,0,c),this.m_frozenRowIndex=c},A.prototype._getCellsToFreeze=function(e,t,i){const s="row"===i?this.getElementHeight.bind(this):this.getElementWidth.bind(this);let o=0,n=[];for(let r=e,l=0;r<=t;r+=1,l+=1){let e=this._getAxisCellsByIndex(r,i);e=e.filter(e=>!e.classList.contains(this.getMappedStyle("frozenCell"))),e.length&&(o+=s(e[0]),n.push(...e))}return{cells:n,cellsDimensionToAdjust:o}},A.prototype._getColumnHeadersToFreeze=function(e,t,i,s){let o=[],n=[];if(-1!==this.m_endColHeader)if(1===this.m_columnHeaderLevelCount)for(let e=s;e<=i;e++){let t=this._getHeadersByIndex(e,"column");o.push(...t)}else{let i=!1,n=s,r=e;for(this.m_utils.containsCSSClassName(r,this.getMappedStyle("headercell"))||(r=this._getHeaderByIndex(t,"column",0));!i;){let e=this._getHeaderContainer(n,0,this.m_colHeader,this.m_columnHeaderLevelCount);e.querySelector(`#${r.id}`)?i=!0:n+=this._getAttribute(e,"extent",!0),o.push(e)}}if(-1!==this.m_endColEndHeader)if(1===this.m_columnEndHeaderLevelCount)for(let e=s;e<=i;e++){let t=this._getHeadersByIndex(e,"columnEnd");n.push(...t)}else{let i=!1,o=s;let r=e;for(this.m_utils.containsCSSClassName(e,this.getMappedStyle("endheadercell"))||(r=this._getHeaderByIndex(t,"columnEnd",0));!i;){let e=this._getHeaderContainer(o,0,this.m_colEndHeader,this.m_columnEndHeaderLevelCount);e.querySelector(`#${r.id}`)?i=!0:o+=this._getAttribute(e,"extent",!0),n.push(e)}}return{headers:o,endHeaders:n}},A.prototype._getRowHeadersToFreeze=function(e,t,i,s){let o=[],n=[];if(-1!==this.m_endRowHeader)if(1===this.m_rowHeaderLevelCount)for(let e=s;e<=i;e++){let t=this._getHeadersByIndex(e,"row");o.push(...t)}else{let i=!1,n=s,r=e;for(this.m_utils.containsCSSClassName(r,this.getMappedStyle("headercell"))||(r=this._getHeaderByIndex(t,"row",0));!i;){let e=this._getHeaderContainer(n,0,this.m_rowHeader,this.m_rowHeaderLevelCount);e.querySelector(`#${r.id}`)?i=!0:n+=this._getAttribute(e,"extent",!0),o.push(e)}}if(-1!==this.m_endRowEndHeader)if(1===this.m_rowEndHeaderLevelCount)for(let e=s;e<=i;e++){let t=this._getHeadersByIndex(e,"rowEnd");n.push(...t)}else{let i=!1,o=s;let r=e;for(this.m_utils.containsCSSClassName(e,this.getMappedStyle("endheadercell"))||(r=this._getHeaderByIndex(t,"rowEnd",0));!i;){let e=this._getHeaderContainer(o,0,this.m_rowEndHeader,this.m_rowEndHeaderLevelCount);e.querySelector(`#${r.id}`)?i=!0:o+=this._getAttribute(e,"extent",!0),n.push(e)}}return{headers:o,endHeaders:n}},A.prototype._removeCellsFromFrozenColumnContainer=function(e){const t=this.m_frozenColIndex,i="column",s=this.getResources().isRTLMode()?"right":"left";let o=this.getElementWidth(this.m_databodyFrozenCol),n=this.getElementWidth(this.m_databody);this.m_databodyFrozenRow&&this._hasFrozenRows()&&(n=this.getElementWidth(this.m_databodyFrozenRow));const r=this.getElementDir(this.m_databodyFrozenCol,s);let l=-1===e?t+1:t-e,a=0,h=[],d=[],m=this.m_columnHeaderLevelCount>1?t+1:e+1,c=this.m_columnEndHeaderLevelCount>1?t+1:e+1;!this._isHighWatermarkScrolling()&&this.m_startCol>0&&(m=this.m_startCol,c=this.m_startCol);let{headers:u,endHeaders:_}=this._getColumnHeadersToUnFreeze(e+1),g=0;null!==this.m_frozenRowIndex?(g=this.m_frozenRowIndex+1,!this._isHighWatermarkScrolling()&&this.m_startRow>0&&(g=this.m_startRow)):this._isHighWatermarkScrolling()||(g=this.m_startRow);for(let t=g;t<=this.m_endRow;t++)for(let i=e+1;i<=this.m_frozenColIndex;i++){let e=this._getFrozenCellByIndex(this.createIndex(t,i),"row");t===g&&(a+=this.getElementWidth(e)),h.push(e)}let p=a;for(let t=g,i=0;i<=e;i++){const e=this._getFrozenCellByIndex(this.createIndex(t,i),"row");e&&(p+=this.getElementWidth(e))}if(!p)for(let t=0,i=0;t<=e;t++){let e=this._getFrozenCellByIndex(this.createIndex(t,i),"row",!0);e&&(p+=this.getElementWidth(e))}let f=0;if(this.m_databodyFrozenCorner)if(d=this._getFrozenAxisCells(i,e+1,!0),!this._isHighWatermarkScrolling()&&this.m_startCol>this.m_frozenColIndex+1)for(let e=0;e<d.length;e++)d[e].remove();else{let e=this.m_databodyFrozenRow.firstChild.firstChild;!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&(e=this._getCellByIndex({row:0,column:this.m_frozenColIndex+1}));for(let t=0;t<d.length;t++)this.setElementDir(d[t],f,s),this.m_databodyFrozenRow.firstChild.insertBefore(d[t],e),t%l==l-1?f=0:f+=this.getElementWidth(d[t])}if(!h.length&&d.length){let e=d[d.length-1];a=this.getElementWidth(e)+this.getElementDir(e,s),p+=a}f=0;let C=this.m_databody.firstChild.firstChild;if(!this._isHighWatermarkScrolling()){let e=0,t=0;this._hasFrozenColumns()&&(t=this.m_frozenColIndex+1),this._hasFrozenRows()&&(e=this.m_frozenRowIndex+1),C=this._getCellByIndex({row:e,column:t})}if(0!==h.length)for(let e=0;e<h.length;e++)this.setElementDir(h[e],f,s),this.m_utils.removeCSSClassName(h[e],this.getMappedStyle("frozenCell")),this.m_databody.firstChild.insertBefore(h[e],C),e%l==l-1?f=0:f+=this.getElementWidth(h[e]);else 0===u.length&&0===_.length||(0!==u.length?u.forEach(e=>{p+=this.getElementWidth(e)}):_.forEach(e=>{p+=this.getElementWidth(e)}),a=p);let y=this.m_colHeader.firstChild.firstChild;const w=this.getMappedStyle("frozenHeader");f=-a,o=p;let E,v,x=o-a;if(this.m_columnHeaderLevelCount>1&&(f=-x),!this._isHighWatermarkScrolling()&&this.m_startCol>this.m_frozenColIndex+1)for(let e=0;e<u.length;e++)u[e].remove();else this._insertFrozenElementsToContainer(i,u,this.m_colHeader,y,f,s,w,l);if(this.m_colEndHeader)if(!this._isHighWatermarkScrolling()&&this.m_startCol>this.m_frozenColIndex+1)for(let e=0;e<_.length;e++)_[e].remove();else{f=-a,this.m_columnEndHeaderLevelCount>1&&(f=-x);let e=this.m_colEndHeader.firstChild.firstChild;this._insertFrozenElementsToContainer(i,_,this.m_colEndHeader,e,f,s,w,l)}if((this._isHighWatermarkScrolling()&&t+1<=this.m_endCol||!this._isHighWatermarkScrolling()&&(0===this.m_startCol||this.m_startCol<=this.m_frozenColIndex+1))&&(this._shiftCellsAlongAxis(i,a,t+1,!0),this.m_databodyFrozenRow&&this._shiftFrozenCellsAlongAxis(i,a,t+1,!0)),(this._isHighWatermarkScrolling()||!this._isHighWatermarkScrolling()&&0===this.m_startCol||this.m_startCol<=this.m_frozenColIndex+1)&&(this._shiftHeadersAlongAxisInContainer(this.m_colHeader.firstChild,m,a,this.getResources().isRTLMode()?"right":"left",this.getMappedStyle("colheadercell")),this._shiftHeadersAlongAxisInContainer(this.m_colEndHeader.firstChild,c,a,this.getResources().isRTLMode()?"right":"left",this.getMappedStyle("colendheadercell"))),(this._isHighWatermarkScrolling()||!this._isHighWatermarkScrolling()&&this.m_startCol<=this.m_frozenColIndex+1)&&(this.m_endColPixel+=a,this.m_endColHeaderPixel+=a,this.m_endColEndHeaderPixel+=a),!this._isHighWatermarkScrolling()&&-1===e&&this.m_startCol<=this.m_frozenColIndex+1&&(this.m_startCol=0,this.m_startColHeader=0,this.m_startColEndHeader=0),0!==h.length)E=x+r,v=n+a,E+v>this.getWidth()&&(v=this.getWidth()-E);else{const e=this.m_colHeaderFrozen?this.getElementWidth(this.m_colHeaderFrozen):this.getElementWidth(this.m_colEndHeaderFrozen);E=e-a+r,x=E-r,v=this._getViewportRight()-this._getViewportLeft()+e+E}if(-1!==this.m_endRowEndHeader){const e=this.getElementDir(this.m_rowEndHeader,s);v=E+v>e?e-E:v}this._setElementDimension(this.m_databody,null,E,null,v),this._setElementDimension(this.m_colHeader,null,E,null,v),this.m_colEndHeader&&this._setElementDimension(this.m_colEndHeader,null,E,null,v),this.setElementWidth(this.m_databodyFrozenCol,x),this.setElementWidth(this.m_colHeaderFrozen,x),this.m_colEndHeaderFrozen&&this.setElementWidth(this.m_colEndHeaderFrozen,x),this.m_databodyFrozenRow&&this._setElementDimension(this.m_databodyFrozenRow,null,E,null,v),this.m_databodyFrozenCorner&&this.setElementWidth(this.m_databodyFrozenCorner,x),-1===e?this._removeFrozenIndicator(i):this._addFrozenIndicator(i,0,s,E,e),this.m_frozenColIndex=e},A.prototype._removeCellsFromFrozenRowContainer=function(e){const t=this.m_frozenRowIndex,i="row",s=this.getResources().isRTLMode()?"right":"left";let o=this.getElementHeight(this.m_databodyFrozenRow),n=this.getElementDir(this.m_databodyFrozenRow,"top"),r=this.getElementHeight(this.m_databody);this.m_databodyFrozenCol&&this._hasFrozenColumns()&&(r=this.getElementHeight(this.m_databodyFrozenCol));let l=-1===e?t+1:t-e,a=0,h=[],d=[],{headers:m,endHeaders:c}=this._getRowHeadersToUnFreeze(e+1),u=this.m_rowHeaderLevelCount>1?t+1:e+1,_=this.m_rowEndHeaderLevelCount>1?t+1:e+1;!this._isHighWatermarkScrolling()&&this.m_startRow>0&&(u=this.m_startRow,_=this.m_startRow);let g=0;this._hasFrozenColumns()?(g=this.m_frozenColIndex+1,!this._isHighWatermarkScrolling()&&this.m_startCol>0&&(g=this.m_startCol)):this._isHighWatermarkScrolling()||(g=this.m_startCol);for(let t=e+1;t<=this.m_frozenRowIndex;t++)for(let e=g;e<=this.m_endCol;e++){let i=this._getFrozenCellByIndex(this.createIndex(t,e),"column");e===g&&(a+=this.getElementHeight(i)),h.push(i)}let p=a;for(let t=0,i=g;t<=e;t++){let e=this._getFrozenCellByIndex(this.createIndex(t,i),"column");e&&(p+=this.getElementHeight(e))}if(!p)for(let t=0,i=0;t<=e;t++){let e=this._getFrozenCellByIndex(this.createIndex(t,i),"column",!0);e&&(p+=this.getElementHeight(e))}let f=0;if(this.m_databodyFrozenCorner)if(d=this._getFrozenAxisCells(i,e+1,!0),!this._isHighWatermarkScrolling()&&this.m_startRow>this.m_frozenRowIndex+1)for(let e=0;e<d.length;e++)d[e].remove();else{let e=this.m_databodyFrozenCol.firstChild.firstChild;!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&(e=this._getCellByIndex({row:this.m_frozenRowIndex+1,column:0}));for(let t=0;t<d.length;t++)this.setElementDir(d[t],f,"top"),this.m_databodyFrozenCol.firstChild.insertBefore(d[t],e),(t+1)%(this.m_frozenColIndex+1)==0&&(f+=this.getElementHeight(d[t]))}if(!h.length&&d.length){let e=d[d.length-1];a=this.getElementHeight(e)+this.getElementDir(e,"top"),p+=a}f=0;let C=this.m_databody.firstChild.firstChild;if(!this._isHighWatermarkScrolling()){let e=0,t=0;this._hasFrozenColumns()&&(t=this.m_frozenColIndex+1),this._hasFrozenRows()&&(e=this.m_frozenRowIndex+1),C=this._getCellByIndex({row:e,column:t})}if(0!==h.length)if(!this._isHighWatermarkScrolling()&&this.m_startRow>this.m_frozenRowIndex+1)for(let e=0;e<h.length;e++)h[e].remove();else for(let e=0;e<h.length;e++)this.setElementDir(h[e],f,"top"),this.m_utils.removeCSSClassName(h[e],this.getMappedStyle("frozenCell")),this.m_databody.firstChild.insertBefore(h[e],C),(e+1)%Math.floor(h.length/l)==0&&(f+=this.getElementHeight(h[e]));else 0===m.length&&0===c.length||(0!==m.length?m.forEach(e=>{p+=this.getElementHeight(e)}):c.forEach(e=>{p+=this.getElementHeight(e)}),a=p);let y=this.m_rowHeader.firstChild.firstChild;const w=this.getMappedStyle("frozenHeader");o=p;let E,v,x=o-a;if(f=-a,this.m_rowHeaderLevelCount>1&&(f=-x),!this._isHighWatermarkScrolling()&&this.m_startRow>this.m_frozenRowIndex+1)for(let e=0;e<m.length;e++)m[e].remove();else this._insertFrozenElementsToContainer(i,m,this.m_rowHeader,y,f,"top",w,l);if(this.m_rowEndHeader)if(!this._isHighWatermarkScrolling()&&this.m_startRow>this.m_frozenRowIndex+1)for(let e=0;e<c.length;e++)c[e].remove();else{f=-a,this.m_rowEndHeaderLevelCount>1&&(f=-x);let e=this.m_rowEndHeader.firstChild.firstChild;this._insertFrozenElementsToContainer(i,c,this.m_rowEndHeader,e,f,"top",w,l)}if((this._isHighWatermarkScrolling()&&t+1<=this.m_endRow||!this._isHighWatermarkScrolling()&&(0===this.m_startRow||this.m_startRow<=this.m_frozenRowIndex+1))&&(this._shiftCellsAlongAxis(i,a,t+1,!0),this.m_databodyFrozenCol&&this._shiftFrozenCellsAlongAxis(i,a,t+1,!0)),(this._isHighWatermarkScrolling()||!this._isHighWatermarkScrolling()&&0===this.m_startRow||this.m_startRow<=this.m_frozenRowIndex+1)&&(this._shiftHeadersAlongAxisInContainer(this.m_rowHeader.firstChild,u,a,"top",this.getMappedStyle("rowheadercell")),this._shiftHeadersAlongAxisInContainer(this.m_rowEndHeader.firstChild,_,a,"top",this.getMappedStyle("rowendheadercell"))),0!==h.length)E=x+n,v=r+a,E+v>this.getHeight()&&(v=this.getHeight()-E);else{const e=this.m_rowHeaderFrozen?this.getElementHeight(this.m_rowHeaderFrozen):this.getElementHeight(this.m_rowEndHeaderFrozen);E=e-a+n,x=E-n,v=this._getViewportBottom()-this._getViewportTop()+e+E}if(-1!==this.m_endColEndHeader){const e=this.getElementDir(this.m_colEndHeader,"top");v=E+v>e?e-E:v}(this._isHighWatermarkScrolling()||!this._isHighWatermarkScrolling()&&this.m_startRow<=this.m_frozenRowIndex+1)&&(this.m_endRowPixel+=a,this.m_endRowHeaderPixel+=a,this.m_endRowEndHeaderPixel+=a),!this._isHighWatermarkScrolling()&&-1===e&&this.m_startRow<=this.m_frozenRowIndex+1&&(this.m_startRow=0,this.m_startRowHeader=0,this.m_startRowEndHeader=0),this._setElementDimension(this.m_databody,E,null,v,null),this._setElementDimension(this.m_rowHeader,E,null,v,null),this.m_rowEndHeader&&this._setElementDimension(this.m_rowEndHeader,E,null,v,null),this.setElementHeight(this.m_databodyFrozenRow,x),this.setElementHeight(this.m_rowHeaderFrozen,x),this.m_rowEndHeaderFrozen&&this.setElementHeight(this.m_rowEndHeaderFrozen,x),this.m_databodyFrozenCol&&this._setElementDimension(this.m_databodyFrozenCol,E,null,v,null),this.m_databodyFrozenCorner&&this.setElementHeight(this.m_databodyFrozenCorner,x),-1===e?this._removeFrozenIndicator(i):this._addFrozenIndicator(i,E,s,0,e),this.m_frozenRowIndex=e},A.prototype._getColumnHeadersToUnFreeze=function(e){let t=[],i=[];if(this.m_colHeaderFrozen&&-1!==this.m_endColHeader)if(1===this.m_columnHeaderLevelCount)for(let i=e;i<=this.m_frozenColIndex;i++){let e=this._getHeadersByIndex(i,"column");t.push(...e)}else for(let i=e;i<=this.m_frozenColIndex;){let e=this._getHeaderContainer(i,0,this.m_colHeaderFrozen,this.m_columnHeaderLevelCount);t.push(e);i+=this._getAttribute(e,"extent",!0)}if(this.m_colEndHeaderFrozen&&-1!==this.m_endColEndHeader)if(1===this.m_columnEndHeaderLevelCount)for(let t=e;t<=this.m_frozenColIndex;t++){let e=this._getHeadersByIndex(t,"columnEnd");i.push(...e)}else for(let t=e;t<=this.m_frozenColIndex;){let e=this._getHeaderContainer(t,0,this.m_colEndHeaderFrozen,this.m_columnEndHeaderLevelCount);i.push(e);t+=this._getAttribute(e,"extent",!0)}return{headers:t,endHeaders:i}},A.prototype._getRowHeadersToUnFreeze=function(e){let t=[],i=[];if(this.m_rowHeaderFrozen&&-1!==this.m_endRowHeader)if(1===this.m_rowHeaderLevelCount)for(let i=e;i<=this.m_frozenRowIndex;i++){let e=this._getHeadersByIndex(i,"row");t.push(...e)}else for(let i=e;i<=this.m_frozenRowIndex;){let e=this._getHeaderContainer(i,0,this.m_rowHeaderFrozen,this.m_rowHeaderLevelCount);t.push(e);i+=this._getAttribute(e,"extent",!0)}if(this.m_rowEndHeaderFrozen&&-1!==this.m_endRowEndHeader)if(1===this.m_rowEndHeaderLevelCount)for(let t=e;t<=this.m_frozenRowIndex;t++){let e=this._getHeadersByIndex(t,"rowEnd");i.push(...e)}else for(let t=e;t<=this.m_frozenRowIndex;){let e=this._getHeaderContainer(t,0,this.m_rowEndHeaderFrozen,this.m_rowEndHeaderLevelCount);i.push(e);t+=this._getAttribute(e,"extent",!0)}return{headers:t,endHeaders:i}},A.prototype._appendElementsToFrozenContainer=function(e,t,i,s,o,n,r){let l=this.getElementHeight.bind(this);"column"===e&&(l=this.getElementWidth.bind(this));for(let e=0;e<t.length;e++)n===this.getMappedStyle("frozenHeader")&&t[e].classList.contains(this.getMappedStyle("groupingcontainer"))?(this._adjustContainerElementsDirValue(t[e],s,o,n,!1),i.firstChild.appendChild(t[e])):(this.setElementDir(t[e],s,o),this.m_utils.addCSSClassName(t[e],n),i.firstChild.appendChild(t[e]),(e+1)%Math.floor(t.length/r)==0&&(s+=l(t[e])));return s},A.prototype._adjustContainerElementsDirValue=function(e,t,i,s,o){let n=e.childNodes;for(let e=0;e<n.length;e++)if(n[e].classList&&(n[e].classList.contains(this.getMappedStyle("headercell"))||n[e].classList.contains(this.getMappedStyle("endheadercell")))){let r=this.getElementDir(n[e],i)+t;o?this.m_utils.removeCSSClassName(n[e],s):this.m_utils.addCSSClassName(n[e],s),this.setElementDir(n[e],r,i)}else this._adjustContainerElementsDirValue(n[e],t,i,s,o);return t},A.prototype._insertFrozenElementsToContainer=function(e,t,i,s,o,n,r,l){let a=this.getElementHeight.bind(this);"column"===e&&(a=this.getElementWidth.bind(this));for(let e=0;e<t.length;e++)r===this.getMappedStyle("frozenHeader")&&t[e].classList.contains(this.getMappedStyle("groupingcontainer"))?(this._adjustContainerElementsDirValue(t[e],o,n,r,!0),i.firstChild.insertBefore(t[e],s)):(this.setElementDir(t[e],o,n),this.m_utils.removeCSSClassName(t[e],r),i.firstChild.insertBefore(t[e],s),(e+1)%(t.length/l)==0&&(o+=a(t[e])))},A.prototype._getFrozenAxisCells=function(e,t,i){const s=this.m_frozenRowIndex,o=this.m_frozenColIndex;let n=0,r=s,l=o+1,a=t,h=[];null===o&&(l=0),"row"!==e||i||(s&&(n=s+1),r=t,l=0,a=o),i&&(n="row"===e?t:0,l="row"===e?0:t,a=o,r=s);for(let t=n;t<=r;t++)for(let s=l;s<=a;s++){let o=this._getFrozenCellByIndex(this.createIndex(t,s),e,i);o&&h.push(o)}return h},A.prototype._createFrozenHeaderElements=function(e,t,i){const s=this.getMappedStyle("scroller");let o;o="column"===e?"frozenColumn":"frozenRow";const n=this._createHeaderElement(o,t,s,!1);if(this.m_root.insertBefore(n,this.m_status),"column"===e?this.m_colHeaderFrozen=n:this.m_rowHeaderFrozen=n,"column"===e&&this.m_colEndHeader||"row"===e&&this.m_rowEndHeader){const t=this._createHeaderElement(o,i,s,!0);this.m_root.insertBefore(t,this.m_status),"column"===e?this.m_colEndHeaderFrozen=t:this.m_rowEndHeaderFrozen=t}},A.prototype._handleUnFreeze=function(e,t){if("column"===e&&-1!==this.m_frozenColIndex){if(this._removeCellsFromFrozenColumnContainer(-1),this.m_root.removeChild(this.m_databodyFrozenCol),this.m_databodyFrozenCol=null,this._hasFrozenRows()&&(this.m_root.removeChild(this.m_databodyFrozenCorner),this.m_databodyFrozenCorner=null),this.m_colHeaderFrozen&&(this.m_root.removeChild(this.m_colHeaderFrozen),this.m_colHeaderFrozen=null),this.m_colEndHeaderFrozen&&(this.m_root.removeChild(this.m_colEndHeaderFrozen),this.m_colEndHeaderFrozen=null),this.deleteAndApplyHiddenIndicators(),t){let e={event:t,ui:{frozenCount:0}};this.fireEvent("columnFreeze",e)}}else if("row"===e&&-1!==this.m_frozenRowIndex&&(this._removeCellsFromFrozenRowContainer(-1),this.m_root.removeChild(this.m_databodyFrozenRow),this.m_databodyFrozenRow=null,this._hasFrozenColumns()&&(this.m_root.removeChild(this.m_databodyFrozenCorner),this.m_databodyFrozenCorner=null),this.m_rowHeaderFrozen&&(this.m_root.removeChild(this.m_rowHeaderFrozen),this.m_rowHeaderFrozen=null),this.m_rowEndHeaderFrozen&&(this.m_root.removeChild(this.m_rowEndHeaderFrozen),this.m_rowEndHeaderFrozen=null),this.deleteAndApplyHiddenIndicators(),t)){let e={event:t,ui:{frozenCount:0}};this.fireEvent("rowFreeze",e)}},A.prototype._hasFrozenRows=function(){let e=!1;return null!==this.m_frozenRowIndex&&-1!==this.m_frozenRowIndex&&(e=!0),e},A.prototype._hasFrozenColumns=function(){let e=!1;return null!==this.m_frozenColIndex&&-1!==this.m_frozenColIndex&&(e=!0),e},A.prototype.handleFreezeIndicatorDragStart=function(e){const t=e.target,i=this.m_utils.containsCSSClassName(t,this.getMappedStyle("rowFrozenIndicator"))?"row":"column";let s;this.m_dragFrozenIndicator=!0,this.m_freezeIndicatorAxis=i,this._setFreezeIndicatorDragImage(e,i),s="row"===i?[this.m_rowHeaderFrozenTarget,this.m_databodyRowFrozenTarget,this.m_rowEndHeaderFrozenTarget]:[this.m_colHeaderFrozenTarget,this.m_databodyColFrozenTarget,this.m_colEndHeaderFrozenTarget],s.forEach(e=>{e&&e.classList.add(this.getMappedStyle("disabledElement"))})},A.prototype._setFreezeIndicatorDragImage=function(e,t){const i=this.getResources().isRTLMode()?"right":"left";let s=document.getElementById("dndContainer");s||(s=document.createElement("div"),s.setAttribute("id","dndContainer"),s.setAttribute("class","dndContainer"));let o=0,n=0,r=0,l=0,a=Math.max(0,e.offsetX),h=Math.max(0,e.offsetY);if("row"===t){if(this.m_rowHeaderFrozenTarget){let e=this.m_rowHeaderFrozenTarget.cloneNode(!0);e.style.top=`${o}px`,e.style[i]=`${n}px`,n+=this.getElementWidth(this.m_rowHeaderFrozenTarget),s.appendChild(e)}e.target===this.m_databodyRowFrozenTarget&&(a+=n);let t=this.m_databodyRowFrozenTarget.cloneNode(!0);if(t.style.top=`${o}px`,t.style[i]=`${n}px`,s.appendChild(t),n+=this.getElementWidth(this.m_databodyRowFrozenTarget),this.m_rowEndHeaderFrozenTarget){e.target===this.m_rowEndHeaderFrozenTarget&&(a+=n);let t=this.m_rowEndHeaderFrozenTarget.cloneNode(!0);t.style.top=`${o}px`,t.style[i]=`${n}px`,n+=this.getElementWidth(this.m_rowEndHeaderFrozenTarget),s.appendChild(t)}l=this.getElementHeight(this.m_databodyRowFrozenTarget),r=n}else{if(this.m_colHeaderFrozenTarget){let e=this.m_colHeaderFrozenTarget.cloneNode(!0);e.style.top=`${o}px`,e.style[i]=`${n}px`,o+=this.getElementHeight(this.m_colHeaderFrozenTarget),s.appendChild(e)}e.target===this.m_databodyColFrozenTarget&&(h+=o);let t=this.m_databodyColFrozenTarget.cloneNode(!0);if(t.style.top=`${o}px`,t.style[i]=`${n}px`,s.appendChild(t),o+=this.getElementHeight(this.m_databodyColFrozenTarget),this.m_colEndHeaderFrozenTarget){e.target===this.m_colEndHeaderFrozenTarget&&(h+=o);let t=this.m_colEndHeaderFrozenTarget.cloneNode(!0);t.style.top=`${o}px`,t.style[i]=`${n}px`,o+=this.getElementHeight(this.m_colEndHeaderFrozenTarget),s.appendChild(t)}r=this.getElementWidth(this.m_databodyColFrozenTarget),l=o}s.style.width=`${r}px`,s.style.height=`${l}px`,document.body.appendChild(s),e.dataTransfer.setDragImage(s,a,h)},A.prototype.handleFreezeIndicatorDragEnd=function(e){e.target.classList.remove(this.getMappedStyle("dragging")),this._clearFreezeIndicatorDrag(this.m_freezeIndicatorAxis)},A.prototype.handleFreezeIndicatorDragOver=function(e,t,i){this._removeDropTargetLine(i),this._removeDropTargetClass();let s,o=-1===t?0:t,n=this.getResources().isRTLMode()?"right":"left",r=this._getHeaderByIndex(o,i,"row"===i?this.m_rowHeaderLevelCount:this.m_columnHeaderLevelCount);if(r)s=r;else{let e={row:0,column:0};e[i]=o,s=this._getCellByIndex(e)}let l=this.getElementDir(s,"row"===i?"top":n);"row"===i?(l+=-1===t?0:this.getElementHeight(s),this._hasFrozenRows()&&t>this.m_frozenRowIndex&&(l+=this.getElementHeight(this.m_databodyFrozenRow)),this._addDropTargetLine(i,l,n,0,o)):(l+=-1===t?0:this.getElementWidth(s),this._hasFrozenColumns()&&t>this.m_frozenColIndex&&(l+=this.getElementWidth(this.m_databodyFrozenCol)),this._addDropTargetLine(i,0,n,l,o)),e.preventDefault()},A.prototype.handleFreezeIndicatorDrop=function(e,t,i){if(this._clearFreezeIndicatorDrag(t),!(!this._isHighWatermarkScrolling()&&"row"===t&&e>this.m_frozenRowIndex+1&&this.m_startRow>this.m_frozenRowIndex+1||"column"===t&&e>this.m_frozenColIndex+1&&this.m_startCol>this.m_frozenColIndex+1))if(this._updateFrozenSection(e,t),"row"===t){const e={event:i,ui:{frozenCount:this.m_frozenRowIndex+1}};this.fireEvent("rowFreeze",e)}else{const e={event:i,ui:{frozenCount:this.m_frozenColIndex+1}};this.fireEvent("columnFreeze",e)}},A.prototype._clearFreezeIndicatorDrag=function(e){let t;this._destroyDragImage(),this._removeDropTargetLine(e),this._removeDropTargetClass(),this.m_dragFrozenIndicator=!1,this.m_freezeIndicatorAxis=null,t="row"===e?[this.m_rowHeaderFrozenTarget,this.m_databodyRowFrozenTarget,this.m_rowEndHeaderFrozenTarget]:[this.m_colHeaderFrozenTarget,this.m_databodyColFrozenTarget,this.m_colEndHeaderFrozenTarget],t.forEach(e=>{e&&e.classList.remove(this.getMappedStyle("disabledElement"))})},A.prototype.handleFreezeIndicatorMouseDown=function(e){null==this.m_active&&this.m_root.focus();e.target.classList.add(this.getMappedStyle("dragging"))},A.prototype.handleFreezeIndicatorMouseUpOrOut=function(e){e.target.classList.remove(this.getMappedStyle("dragging"))},A.prototype._createFrozenIndicatorElement=function(e){const t=document.createElement("div");return t.id=e,this.m_utils.isTouchDevice()||(t.setAttribute("draggable",!0),t.classList.add(this.getMappedStyle("draggableItem")),this._addFreezeVisualIndicatorEventListener(t)),t},A.prototype._calculateIndexFromHeaderExtent=function(e,t){const i=this.getResources().getMappedAttribute("context");let s,o,{headers:n,endHeaders:r}=this._getColumnHeadersToFreeze(e,t,t,this.m_frozenColIndex+1),l=0,a=0;if(n.length&&(e=this._getOutermostHeaderFromNestedHeaders(n[0]),l=this.getHeaderCellIndex(e),s=e[i].extent,s>1&&(l+=s-1)),r.length){let e=this._getOutermostHeaderFromNestedHeaders(r[0]);a=this.getHeaderCellIndex(e),o=e[i].extent,o>1&&(a+=o-1)}let h=Math.max(l,a);return t=t>h?t:h},A.prototype.showStatusText=function(e){const t=this;"block"===this.m_status.style.display||this.m_showStatusTimeout||(this.m_showStatusTimeout=setTimeout(function(){const i=t.getResources().getTranslatedText("msgFetchingData");let s,o;if(t.m_status.setAttribute("aria-label",i),t.m_status.style.display="block",e){const e=document.createElement("div");e.className=t.getMappedStyle("loadingicon"),t.m_status.appendChild(e),s=t.getWidth()/2-t.m_status.offsetWidth/2,o=t.getHeight()/2-t.m_status.offsetHeight/2}else{s=0,o=0;const e=document.createDocumentFragment();t.buildSkeletonGrid(e),t.m_status.appendChild(e)}t.getResources().isRTLMode()?t.m_status.style.right=s+"px":t.m_status.style.left=s+"px",t.m_status.style.top=o+"px",t.m_showStatusTimeout=null},this.getShowStatusDelay()))},A.prototype.buildSkeletonGrid=function(e){const t=this.getWidth(),i=this.getHeight(),s=this.getDefaultColumnWidth(),o=this.getDefaultRowHeight(),n=Math.max(1,Math.ceil(i/o)),r=Math.max(1,Math.ceil(t/s));let l=0;for(let t=0;t<n;t++){let i=0;for(let a=0;a<r;a++){const h=this.createSkeletonCell(s,o,i,l);a===r-1&&h.classList.add(this.getMappedStyle("borderVerticalNone")),t===n-1&&h.classList.add(this.getMappedStyle("borderHorizontalNone")),e.appendChild(h),i+=s}l+=o}},A.prototype.isSkeletonSupport=function(){return"skeleton"===this.getResources().getDefaultOption("loadIndicator")},A.prototype.getShowStatusDelay=function(){const e=_.getCSSTimeUnitAsMillis(this.getResources().getDefaultOption("showIndicatorDelay"));return isNaN(e)?0:e},A.prototype.hideStatusText=function(){this.m_showStatusTimeout&&(clearTimeout(this.m_showStatusTimeout),this.m_showStatusTimeout=null),this.m_status.style.display="none",this.m_utils.empty(this.m_status),this.isSkeletonSupport()&&this._removeAllSkeletons()},A.prototype._removeAllSkeletons=function(){this._resetSkeletonProperties();const e=this._getAllSkeletonContainers(this.m_root);if(e.length>0)for(let t=0;t<e.length;t++)this._remove(e[t])},A.prototype.addSkeletonCells=function(e,t,i,s,o,n,r,l,a,h){const d=this.getDefaultColumnWidth(),m=this.getDefaultRowHeight(),c=document.createDocumentFragment(),u=document.createDocumentFragment(),_=document.createDocumentFragment(),g=[],p=[];let f,C,y=n,w=r;const E=this.m_databody.firstChild;let v,x;if(this._hasFrozenRows()&&(v=this.m_databodyFrozenRow.firstChild),this._hasFrozenColumns()&&(x=this.m_databodyFrozenCol.firstChild),!this._databodyEmptyState()){for(let n=0;n<t;n++){w=r,f=a?s+n:s+(t-1-n),"column"===e&&this._hasFrozenRows()&&f===this.m_frozenRowIndex+1&&(y-=m*(this.m_frozenRowIndex+1));for(let s=0;s<i;s++){if(C=h?o+s:o+(i-1-s),null==p[n]||null==g[s]){const e=this._getCellOrHeaderByIndex(f,"row"),t=this._getCellOrHeaderByIndex(C,"column");if(e){const t=e[this.getResources().getMappedAttribute("context")];t&&(p[n]=this._getCellDimension(null,f,t.keys?t.keys.row:t.key,"row","height"))}if(t){const e=t[this.getResources().getMappedAttribute("context")];e&&(g[s]=this._getCellDimension(null,C,e.keys?e.keys.column:e.key,"column","width"))}null==p[n]&&(p[n]=m),null==g[s]&&(g[s]=d)}"row"===e&&this._hasFrozenColumns()&&C===this.m_frozenColIndex+1&&(w-=d*(this.m_frozenColIndex+1));const r=this.createIndex(f,C);if(l||!this._skeletonSetHas(r)){const e=this.createSkeletonCell(g[s],p[n],h?w:w-g[s],a?y:y-p[n]);this._addIndexToSkeletonSet(r),s===i-1&&this.m_utils.addCSSClassName(e,this.getMappedStyle("borderVerticalNone")),n===t-1&&this.m_utils.addCSSClassName(e,this.getMappedStyle("borderHorizontalNone")),this._hasFrozenColumns()&&C<this.m_frozenColIndex+1?_.appendChild(e):this._hasFrozenRows()&&f<this.m_frozenRowIndex+1?u.appendChild(e):c.appendChild(e)}w=h?w+g[s]:w-g[s]}y=a?y+p[n]:y-p[n]}this.m_skeletonRowStart=s,this.m_skeletonRowEnd=s+t-1,this.m_skeletonColStart=o,this.m_skeletonColEnd=o+i-1,this.m_skeletonColStartPixel=h?r:w,this.m_skeletonColEndPixel=h?w:r,this.m_skeletonRowStartPixel=a?n:y,this.m_skeletonRowEndPixel=a?y:n}if(c.childElementCount>0){let e=this._getAllSkeletonContainers(E);e=0===e.length?this._createSkeletonContainer():e[0],e.appendChild(c),E.appendChild(e)}if(_.childElementCount>0){let e=this._getAllSkeletonContainers(x);e=0===e.length?this._createSkeletonContainer():e[0],e.appendChild(_),x.appendChild(e)}if(u.childElementCount>0){let e=this._getAllSkeletonContainers(v);e=0===e.length?this._createSkeletonContainer():e[0],e.appendChild(u),v.appendChild(e)}if(!l)if("row"===e){if(this.m_hasRowHeader&&this.createHeaderSkeletonCells(this.m_rowHeader,"row",t,this.m_rowHeaderLevelWidths,0,n,a),this.m_hasRowEndHeader&&this.createHeaderSkeletonCells(this.m_rowEndHeader,"row",t,this.m_rowEndHeaderLevelWidths,0,n,a),this._databodyEmptyState()){const e=this.m_databody.firstChild;this.m_skeletonRowStart=s,this.m_skeletonRowEnd=s+t-1,a?(this.m_skeletonRowStartPixel=n,this.m_skeletonRowEndPixel=n+t*this.getDefaultRowHeight()):(this.m_skeletonRowStartPixel=n-t*this.getDefaultRowHeight(),this.m_skeletonRowEndPixel=n),this._isHighWatermarkScrolling()&&(this._setScrollerDimension(e,this.m_skeletonRowEndPixel,this._getMaxRightPixel()),this.m_scrollHeight=this.getElementHeight(e)-Math.min(this.getElementHeight(e),this.getElementHeight(this.m_databody)-(this.m_hasHorizontalScroller?this.m_utils.getScrollbarSize():0)))}}else if("column"===e&&(this.m_hasColHeader&&this.createHeaderSkeletonCells(this.m_colHeader,"column",i,this.m_columnHeaderLevelHeights,r,0,h),this.m_hasColEndHeader&&this.createHeaderSkeletonCells(this.m_colEndHeader,"column",i,this.m_columnEndHeaderLevelHeights,r,0,h),this._databodyEmptyState())){const e=this.m_databody.firstChild;this.m_skeletonColStart=o,this.m_skeletonColEnd=o+i-1,h?(this.m_skeletonColStartPixel=r,this.m_skeletonColEndPixel=r+i*this.getDefaultColumnWidth()):(this.m_skeletonColStartPixel=r-i*this.getDefaultColumnWidth(),this.m_skeletonColEndPixel=r),this._isHighWatermarkScrolling()&&(this._setScrollerDimension(e,this._getMaxBottomPixel(),this.m_skeletonColEndPixel),this.m_scrollWidth=this.getElementWidth(e)-Math.min(this.getElementWidth(e),this.getElementWidth(this.m_databody)-(this.m_hasVerticalScroller?this.m_utils.getScrollbarSize():0)))}},A.prototype.createSkeletonCell=function(e,t,i,s){const o=this.getResources().isRTLMode()?"right":"left",n=document.createElement("div");n.className=this.getMappedStyle("skeletonCell");const r=document.createElement("div");return r.classList.add(this.getMappedStyle("skeleton"),this.getMappedStyle("skeletonAnimation")),n.appendChild(r),this.setElementHeight(n,t),this.setElementWidth(n,e),this.setElementDir(n,s,"top"),this.setElementDir(n,i,o),n},A.prototype.createHeaderSkeletonCells=function(e,t,i,s,o,n,r){let l=i,a=s.length,h=this.getDefaultColumnWidth(),d=this.getDefaultRowHeight();"column"===t&&(l=s.length,a=i);const m=document.createDocumentFragment();let c=n;for(let e=0;e<l;e++){let i=o;for(let o=0;o<a;o++){let n;"row"===t?h=s[o]:d=s[e],r?(n=this.createSkeletonCell(h,d,i,c),i+=h):"row"===t?(n=this.createSkeletonCell(h,d,i,c-d),i+=h):(n=this.createSkeletonCell(h,d,i-h,c),i-=h),m.appendChild(n)}r||"column"===t?c+=d:c-=d}if(m.childElementCount>0){let t=this._getAllSkeletonContainers(e);t=0===t.length?this._createSkeletonContainer():t[0],t.appendChild(m),e.firstChild.appendChild(t)}},A.prototype.loadSkeletons=function(e,t,i,s,o,n){let r,l,a,h,d,m=this.getFetchSize("row"),c=this.getFetchSize("column"),u=!0,_=!0;const g=this._getViewportLeft(),p=this._getViewportRight(),f=this._getViewportTop()<0?0:this._getViewportTop(),C=this._getViewportBottom(),y=null!=this.m_skeletonRowStart?this.m_skeletonRowStart:this._getMaxTop(),w=null!=this.m_skeletonRowStartPixel?this.m_skeletonRowStartPixel:this._getMaxTopPixel(),E=null!=this.m_skeletonRowEnd?this.m_skeletonRowEnd:this._getMaxBottom(),v=null!=this.m_skeletonRowEndPixel?this.m_skeletonRowEndPixel:this._getMaxBottomPixel(),x=null!=this.m_skeletonColStart?this.m_skeletonColStart:this._getMaxLeft(),H=null!=this.m_skeletonColStartPixel?this.m_skeletonColStartPixel:this._getMaxLeftPixel(),b=null!=this.m_skeletonColEnd?this.m_skeletonColEnd:this._getMaxRight(),S=null!=this.m_skeletonColEndPixel?this.m_skeletonColEndPixel:this._getMaxRightPixel();if(this.m_prevScrollLeft>t&&H>g)r=!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&i===this.m_frozenRowIndex+1?0:i,h=o,m=Math.max(E,this._getMaxBottom(),0)-Math.min(y,r)+1,l=Math.min(x-c,s),!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&(l=l<=this.m_frozenColIndex?this.m_frozenColIndex+1:l),a=Math.min(H,n+c*this.getDefaultColumnWidth()),_=!1,d="column";else if(!(this.m_prevScrollLeft<t&&S<=p)||this.m_stopColumnHeaderFetch&&this.m_stopColumnEndHeaderFetch&&this.m_stopColumnFetch)if(this.m_prevScrollTop>e&&w>f)l=!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&s===this.m_frozenColIndex+1?0:s,a=n,c=Math.max(b,this._getMaxRight(),0)-Math.min(x,l)+1,r=Math.min(y-m,i),!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&(r=r<=this.m_frozenRowIndex?this.m_frozenRowIndex+1:r),h=Math.min(w,o+m*this.getDefaultRowHeight()),u=!1,d="row";else{if(!(this.m_prevScrollTop<e&&v<=C)||this.m_stopRowHeaderFetch&&this.m_stopRowEndHeaderFetch&&this.m_stopRowFetch)return;this._isHighWatermarkScrolling()||this._isCountUnknown("row")&&this.m_maxRowYet===this._getMaxBottom()?(r=this._getMaxBottom()+1,l=this._getMaxLeft(),u=i+this.hiddenItemsInRange(i,this._getMaxBottom(),"row")>=this._getMaxTop(),h=u?this._getMaxBottomPixel():this._getMaxTopPixel(),a=this._getMaxLeftPixel(),m=A.SKELETON_DEFAULT_COUNT,c=this._getMaxRight()-this._getMaxLeft()+1):(l=this._hasFrozenColumns()&&s===this.m_frozenColIndex+1?0:s,a=n,c=Math.max(b,this._getMaxRight(),0)-Math.min(x,l)+1,r=Math.max(E+1,i),h=Math.max(v,o),m=this.getFetchCount("row",r)),d="row"}else this._isHighWatermarkScrolling()||this._isCountUnknown("column")&&this.m_maxColYet===this._getMaxRight()?(m=this._getMaxBottom()-this._getMaxTop()+1,c=A.SKELETON_DEFAULT_COUNT,r=this._getMaxTop(),l=this._getMaxRight()+1,_=l>=this._getMaxLeft(),h=this._getMaxTopPixel(),a=_?this._getMaxRightPixel():this._getMaxLeftPixel()):(r=this._hasFrozenRows()&&i===this.m_frozenRowIndex+1?0:i,h=o,m=Math.max(E,this._getMaxBottom(),0)-Math.min(y,r)+1,l=Math.max(b+1,s),a=Math.max(S,n),c=this.getFetchCount("column",l)),d="column";(!this._isHighWatermarkScrolling()||null==this.m_skeletonRowStart&&null==this.m_skeletonColStart)&&this.addSkeletonCells(d,m,c,r,l,h,a,!1,u,_)},A.prototype.loadSkeletonsOnHeaderLoad=function(e,t,i,s){let o=i&&i.getCount()||s&&s.getCount();if(0===o||!this.isSkeletonSupport())return;let n=o,r=this.isLongScroll()?this.getFetchSize("column"):this.m_endCol-this.m_startCol+1,l=t,a=this.m_startCol,h=l>=this.m_startRow,d=!0,m=!this.isLongScroll()&&h?this.m_endRowPixel:this.m_startRowPixel,c=this.m_startColPixel;"column"===e&&(n=this.isLongScroll()?this.getFetchSize("row"):this.m_endRow-this.m_startRow+1,r=o,l=this.m_startRow,a=t,h=!0,d=a>=this.m_startCol,m=this.m_startRowPixel,c=!this.isLongScroll()&&d?this.m_endColPixel:this.m_startColPixel),this.isLongScroll()&&(h=!0,d=!0),this.isHeaderFetchComplete()&&!this.m_headerInvalid&&(this.hideStatusText(),this.addSkeletonCells(e,n,r,l,a,m,c,!0,h,d),"row"===e&&!this._isHighWatermarkScrolling()&&this._hasFrozenColumns()&&this.addSkeletonCells(e,n,this.m_frozenColIndex+1,l,0,m,c,!0,h,d),"column"===e&&!this._isHighWatermarkScrolling()&&this._hasFrozenRows()&&this.addSkeletonCells(e,this.m_frozenRowIndex+1,r,0,a,m,c,!0,h,d))},A.prototype._addIndexToSkeletonSet=function(e){const t="r"+e.row+"c"+e.column;this.m_skeletonSet.add(t)},A.prototype._skeletonSetHas=function(e){const t="r"+e.row+"c"+e.column;return this.m_skeletonSet.has(t)},A.prototype._getAllNonSkeletonContainerNodes=function(e){return e.querySelectorAll(`:scope > div:not(.${this.getMappedStyle("skeletonContainer")})`)},A.prototype._removeAllNonSkeletonContainerNodes=function(e){this._getAllNonSkeletonContainerNodes(e).forEach(e=>{this._remove(e)})},A.prototype._getAllSkeletonContainers=function(e){return e.querySelectorAll(`.${this.getMappedStyle("skeletonContainer")}`)},A.prototype._createSkeletonContainer=function(){const e=document.createElement("div");return e.classList.add(this.getMappedStyle("skeletonContainer")),e},A.prototype._scrollSkeletonHeadersIntoViewport=function(e,t,i,s){const o={index:s?e+A.SKELETON_DEFAULT_COUNT:Math.max(0,e-A.SKELETON_DEFAULT_COUNT),axis:t,level:i};this.scrollToHeader(o),o.index=s?e+1:e-1,this.m_scrollHeaderAfterFetch=o},A.prototype._scrollSkeletonCellsIntoViewport=function(e,t,i,s){let o=e,n=t;"column"===i?(n=s?t+A.SKELETON_DEFAULT_COUNT:Math.max(0,t-A.SKELETON_DEFAULT_COUNT),t=s?t+1:t-1):(o=s?e+A.SKELETON_DEFAULT_COUNT:Math.max(0,e-A.SKELETON_DEFAULT_COUNT),e=s?e+1:e-1),this.scrollToIndex(this.createIndex(o,n),!1),this.m_scrollIndexAfterFetch=this.createIndex(e,t)},A.prototype._resetSkeletonProperties=function(){this.m_skeletonRowStart=null,this.m_skeletonRowEnd=null,this.m_skeletonColStart=null,this.m_skeletonColEnd=null,this.m_skeletonColStartPixel=null,this.m_skeletonColEndPixel=null,this.m_skeletonRowStartPixel=null,this.m_skeletonRowEndPixel=null,this.m_skeletonSet=new Set},A.prototype.handleCornerDragStart=function(e){let t=e.target,i=this.findLabel(t);const s=this.getResources().isRTLMode()?"right":"left",o=this.getResources().getMappedAttribute("context");if(i&&this.m_options._isDragEnabledOnLabel(i[o].axis)){this.m_pivotInProgress=!0,this.m_utils.addCSSClassName(i,this.getMappedStyle("dragging"));const t=i[o].axis,n=i[o].level;this.m_dragLabel=i;let r=0,l=0,a="column"===t||"columnEnd"===t?"width":"height",h=[];h.push(i),h=this._getDropHeaderTargets(t,n,h),h=this._getHeadersInView(h,t);let d=h.length;"column"===t||"columnEnd"===t?(r=this._computeContainerDimension(h,a),l=this.getElementHeight(h[1])):"row"!==t&&"rowEnd"!==t||(l=this._computeContainerDimension(h,a),r=this.getElementWidth(h[1])),this._headersDragged=h;let m=this._populateContainer(h,t,s,d,r,l),c=Math.max(0,e.offsetX),u=Math.max(0,e.offsetY);e.dataTransfer.setDragImage(m,c,u);let _=this.m_options.options.dnd.drag,g="row"===t||"rowEnd"===t?_.rowLabels.dataTypes:_.columnLabels.dataTypes;this._setDragLabelData(e,g);for(let e=0;e<h.length;e++)this._highlightElement(h[e],["dragSourceOpaque","selected"]);let p={level:n,axis:t};this._invokeDndCallback("drag",`${t}Labels`,"dragStart",e,p)}},A.prototype._getHeadersInView=function(e,t){let i="column"===t||"columnEnd"===t?"width":"height",s=this.getElementDir(this.m_databody,i);("column"===t||"columnEnd"===t)&&null!==this.m_frozenColIndex&&this.m_frozenColIndex>=0?s+=this.getElementDir(this.m_databodyFrozenCol,i):("row"===t||"rowEnd"===t)&&null!==this.m_frozenRowIndex&&this.m_frozenRowIndex>=0&&(s+=this.getElementDir(this.m_databodyFrozenRow,i));let o=0,n=0;for(let t=0;t<e.length;t++)if(o+=this.getElementDir(e[t],i),o>s){n=t;break}return n>0&&(e=e.slice(0,n+1)),e},A.prototype._highlightHeaderRange=function(e,t,i,s){if(0===i)"column"===t||"columnEnd"===t?s.push("topFloodfill"):s.push("startFloodfill");else{let e=[];const o=this.m_headerLabels[t][i-1];e.push(o),e=this._getDropHeaderTargets(t,i-1,e),e=this._getHeadersInView(e,t);for(let t=0;t<e.length;t++)this._highlightElement(e[t],s)}let o=[],n=[];"column"===t||"columnEnd"===t?(o.push("startFloodfill"),n.push("endFloodfill")):(o.push("topFloodfill"),n.push("bottomFloodfill")),this._highlightElement(e[0],o);for(let t=0;t<e.length;t++)this._highlightElement(e[t],s),t===e.length-1&&this._highlightElement(e[t],n)},A.prototype._populateContainer=function(e,t,i,s,o,n){let r=document.getElementById("dndContainer");r||(r=document.createElement("div"),r.setAttribute("id","dndContainer"),r.setAttribute("class","dndContainer"));let l=[this.getMappedStyle("focus"),this.getMappedStyle("hover"),this.getMappedStyle("active"),this.getMappedStyle("topSelected"),this.getMappedStyle("startSelected"),this.getMappedStyle("bottomSelected"),this.getMappedStyle("endSelected"),this.getMappedStyle("selected")],a=0,h=0,d=s;h=0,a=0;for(let s=0;s<e.length;s++){let o=e[s],n=o.cloneNode(!0);n.classList.remove(...l),n.setAttribute("draggable",!1),n.style.top=`${a}px`,n.style[i]=`${h}px`,"column"===t||"columnEnd"===t?(s%d==0?h=0+o.offsetWidth:h+=o.offsetWidth,s%d==d-1&&(a+=o.offsetHeight,s===e.length-1?a=0:h=0)):(s%d==0?a=0+o.offsetHeight:a+=o.offsetHeight,s%d==d-1&&(h+=o.offsetWidth,s===e.length-1?h=0:a=0)),r.appendChild(n),o.classList.add("drag-source-opaque")}return r.style.width=`${o}px`,r.style.height=`${n}px`,"row"===t||"rowEnd"===t?r.style.height=`${n+0}px`:r.style.width=`${o+0}px`,this.m_utils.isTouchDevice()?(this.m_dragImageAttached=!1,this.m_dndContainer=r):document.body.appendChild(r),r},A.prototype.handleCornerDragEnd=function(){const e=this.getResources().getMappedAttribute("context"),t=this.m_dragLabel[e].axis;this.m_utils.removeCSSClassName(this.m_dragLabel,this.getMappedStyle("dragging")),this._unhighlightElementsByClassName(this._headersDragged,["draggableItem","dragSourceOpaque","selected"]),this._destroyDragImage(),this._resetPivotDragInternals(),this._removePivotDropTargetLine(),this._enableChildElements(),this._removeDragStyle(t),this.m_dragLabel=null,this.m_pivotInProgress=!1},A.prototype.handleCornerDragOver=function(e){const t=this.getResources().getMappedAttribute("context"),i=this.getResources().isRTLMode()?"right":"left";let s,o,n,r,l,a=this.findLabel(e.target);if(a){if(s=a[t].axis,o=a[t].level,!this._matchDragDataType(e,`${a[t].axis}Labels`))return void this._removePivotDropTargetLine();e.preventDefault(),l=this._getLabelRelativePosition(e,s,a),n=this.getElementDir(a,"top")+("after"===l?this.getElementHeight(a):0),"columnEnd"===s&&(n+=this.getElementDir(this.m_rowHeaderScrollbarSpacer,"top")),r=this.getElementDir(a,i)+("after"===l?this.getElementWidth(a):0),"rowEnd"===s&&(r+=this.getElementDir(this.m_columnHeaderScrollbarSpacer,i))}else{const e=this.m_dragLabel;if(!e)return;const h=e[t].axis;l="after","column"===h&&-1===this.m_endRowHeader?(a=this.m_headerLabels[h][this.m_columnHeaderLevelCount-1],s="row",o=a[t].level,n=this.getElementDir(a,"top")+this.getElementHeight(a),r=this.getElementDir(a,i)+this.getElementWidth(a)):"row"===h&&-1===this.m_endColHeader&&(a=this.m_headerLabels[h][this.m_rowHeaderLevelCount-1],s="column",l="before",o=a[t].level,n=0,r=this.getElementDir(a,i))}if(a){null!=this.m_pivotDropTarget&&this._getAttribute(this.m_pivotDropTarget,"dropLevel",!0)===o&&this._getAttribute(this.m_pivotDropTarget,"dropAxis")===s||this._addPivotDropTargetLine(s,n,i,r,l,a);let t={level:o,axis:s,position:l};this._invokeDropCallback(`${s}Labels`,"dragOver",e,t)}},A.prototype._addPivotDropTargetLine=function(e,t,i,s,o,n){let r="column"===e||"columnEnd"===e?"rowDropTargetLine":"colDropTargetLine";const l=n[this.getResources().getMappedAttribute("context")].level;this._removePivotDropTargetLine(),this.m_pivotDropTarget=document.createElement("div"),this.m_pivotDropHeaderTarget=document.createElement("div"),this._setAttribute(this.m_pivotDropTarget,"dropLevel",l),this._setAttribute(this.m_pivotDropTarget,"dropAxis",e);let a=n,h=this.m_colHeader;"columnEnd"===e?h=this.m_colEndHeader:"row"===e?h=this.m_rowHeader:"rowEnd"===e&&(h=this.m_rowEndHeader);const d=function(t,i,s,n,r,a){if(("column"===e||"row"===e)&&"column"===e&&this._isHeaderLabelCollision()&&l===this.m_columnHeaderLevelCount-1&&"after"===o){let i=this._getHeaderByIndex(0,e,l);t=this.getElementDir(i,"top")+this.getElementHeight(i)}let h="row"===e||"rowEnd"===e?this._getCornerDimensions("height"):this._getCornerDimensions("width");return"column"===e||"columnEnd"===e?(s=h,null!==this.m_frozenColIndex&&this.m_frozenColIndex>=0&&(r+=this.getElementDir(this.m_databodyFrozenCol,"width"))):(t=h,null!==this.m_frozenRowIndex&&this.m_frozenRowIndex>=0&&(r+=this.getElementDir(this.m_databodyFrozenRow,"height"))),[t,i,s,n,r,a]}.bind(this);this._addPivotVisualIndicator(e,t,i,s,r,this.m_pivotDropTarget,this.m_pivotDropHeaderTarget,h,a,d),this._addPivotVisualIndicatorEventListener()},A.prototype._addPivotVisualIndicator=function(e,t,i,s,o,n,r,l,a,h){let d="width",m="width";"row"!==e&&"rowEnd"!==e||(d="height",m="height");let[c,u,_,g,p,f]=this._calculatePivotVisualIndicatorPosition(l,a,t,s,i,e);h&&"function"==typeof h&&([c,u,_,g,p,f]=h(c,u,_,g,p,f)),this._setVisualIndicatorStyle(n,o,c,i,_,p,d),this._setVisualIndicatorStyle(r,o,u,i,g,f,m),this.m_root.appendChild(n),this.m_root.appendChild(r)},A.prototype._calculatePivotVisualIndicatorPosition=function(e,t,i,s,o,n){let r=i,l=s,a="row"===n||"rowEnd"===n?this.getElementDir(t,"top"):i,h="row"===n||"rowEnd"===n?s:this.getElementDir(t,o),d=0,m=0,c="column"===n||"columnEnd"===n?this.getElementWidth.bind(this):this.getElementHeight.bind(this);return d=c(e),m=c(t),[r,a,l,h,d,m]},A.prototype._getLabelRelativePosition=function(e,t){let i,s=e.target,o=this.getResources().isRTLMode()?"right":"left",n=s.getBoundingClientRect(),r="before",l="width";return"row"===t||"rowEnd"===t?i=Math.abs(e.clientX-n[o]):(i=Math.abs(e.clientY-n.top),l="height"),i>.4*n[l]&&(r="after"),r},A.prototype.handleCornerDrop=function(e){let t=this.findLabel(e.target);const i=this.getResources().getMappedAttribute("context");let s,o,n;if(this._destroyDragImage(),this._removePivotDropTargetLine(),this._removeDropTargetClass(),this._unhighlightDragSource(),this._enableChildElements(),this.m_pivotInProgress=!1,this.m_utils.removeCSSClassName(this.m_dragLabel,this.getMappedStyle("dragging")),t){if(!this._matchDragDataType(e,`${t[i].axis}Labels`))return;s=t[i].level,o=t[i].axis,n=this._getLabelRelativePosition(e,o,t)}else{const e=this.m_dragLabel[i].axis;n="after","column"===e&&-1===this.m_endRowHeader?(t=this.m_headerLabels[e][this.m_columnHeaderLevelCount-1],o="row"):"row"===e&&-1===this.m_endColHeader&&(n="before",t=this.m_headerLabels[e][this.m_rowHeaderLevelCount-1],o="column"),t&&(s=t[i].level)}if(t){let t={level:s,axis:o,position:n};this._invokeDropCallback(`${o}Labels`,"drop",e,t)}},A.prototype.handleCornerDragEnter=function(e){e.preventDefault()},A.prototype._removePivotDropTargetLine=function(){this._remove(this.m_pivotDropTarget),this.m_pivotDropTarget&&(this.m_pivotDropTarget.removeAttribute(this.getResources().getMappedAttribute("dropLevel")),this.m_pivotDropTarget.removeAttribute(this.getResources().getMappedAttribute("dropAxis"))),this._remove(this.m_pivotDropHeaderTarget),this.m_pivotDropTarget=null,this.m_pivotDropHeaderTarget=null},A.prototype._addPivotVisualIndicatorEventListener=function(){this.m_pivotDropTarget.addEventListener("dragover",this.handlePivotDropTargetDragOver.bind(this),!1),this.m_pivotDropHeaderTarget.addEventListener("dragover",this.handlePivotDropTargetDragOver.bind(this),!1),this.m_pivotDropTarget.addEventListener("dragEnter",this.handlePivotDropTargetDragEnter,!1),this.m_pivotDropHeaderTarget.addEventListener("dragEnter",this.handlePivotDropTargetDragEnter,!1),this.m_pivotDropTarget.addEventListener("drop",this.handlePivotDropTargetDrop.bind(this),!1),this.m_pivotDropHeaderTarget.addEventListener("drop",this.handlePivotDropTargetDrop.bind(this),!1)},A.prototype._removePivotVisualIndicatorEventListeners=function(){this.m_pivotDropTarget&&(this.m_pivotDropTarget.removeEventListener("dragover",this.handlePivotDropTargetDragOver,!1),this.m_pivotDropTarget.removeEventListener("drop",this.handlePivotDropTargetDrop,!1),this.m_pivotDropTarget.removeEventListener("dragEnter",this.handlePivotDropTargetDragEnter,!1)),this.m_pivotDropHeaderTarget&&(this.m_pivotDropHeaderTarget.removeEventListener("dragover",this.handlePivotDropTargetDragOver,!1),this.m_pivotDropHeaderTarget.removeEventListener("drop",this.handlePivotDropTargetDrop,!1),this.m_pivotDropHeaderTarget.removeEventListener("dragEnter",this.handlePivotDropTargetDragEnter,!1))},A.prototype._resetPivotDragInternals=function(){this._headersDragged=[],this.m_dragLabel=null},A.prototype._getDropHeaderTargets=function(e,t,i){const s=this.getResources().getMappedAttribute("context");let o=this.m_startColHeader,n=this.m_endColHeader;"columnEnd"===e?(o=this.m_startColEndHeader,n=this.m_endColEndHeader):"row"===e?(o=this.m_startRowHeader,n=this.m_endRowHeader):"rowEnd"===e&&(o=this.m_startRowEndHeader,n=this.m_endRowEndHeader);for(let r=o;r<=n;){let o=this._getHeaderByIndex(r,e,t);if(!o)break;i.push(o),r+=o[s].extent}return i},A.prototype.handlePivotDropTargetDragOver=function(e){e.preventDefault();let t=this._getAttribute(this.m_pivotDropTarget,"axis"),i={level:this._getAttribute(this.m_pivotDropTarget,"level"),axis:t,position:"after"};this._invokeDropCallback(`${t}Labels`,"dragOver",e,i)},A.prototype.handlePivotDropTargetDrop=function(e){e.preventDefault();let t=this._getAttribute(this.m_pivotDropTarget,"axis"),i=this._getAttribute(this.m_pivotDropTarget,"level");this._destroyDragImage(),this._removePivotDropTargetLine(),this._removeDropTargetClass(),this._unhighlightDragSource(),this._enableChildElements();let s={level:i,axis:t,position:"after"};this._invokeDropCallback(`${t}Labels`,"drop",e,s)},A.prototype.handlePivotDropTargetDragEnter=function(e){e.preventDefault()},A.prototype._handlePivotDragOverOnHeader=function(e){let t=this.findHeader(e.target);if(t){const i=this.getResources().isRTLMode()?"right":"left",s=this.getResources().getMappedAttribute("context"),o=t[s];let n,r,l,a,h,d=this.m_headerLabels[o.axis][o.level];if(d&&this._matchDragDataType(e,`${d[s].axis}Labels`)){e.preventDefault(),n=d[s].axis,r=d[s].level,h=this._getLabelRelativePosition(e,n,d),null!=this.m_pivotDropTarget&&this._getAttribute(this.m_pivotDropTarget,"dropLevel",!0)===r&&this._getAttribute(this.m_pivotDropTarget,"dropAxis")===n||(l=this.getElementDir(d,"top")+("after"===h?this.getElementHeight(d):0),"columnEnd"===n&&(l+=this.getElementDir(this.m_rowHeaderScrollbarSpacer,"top")),a=this.getElementDir(d,i)+("after"===h?this.getElementWidth(d):0),"rowEnd"===n&&(a+=this.getElementDir(this.m_columnHeaderScrollbarSpacer,i)),this._addPivotDropTargetLine(n,l,i,a,h,d));let t={level:r,axis:n,position:h};this._invokeDropCallback(`${n}Labels`,"dragOver",e,t)}}},A.prototype._handlePivotDropOnHeader=function(e){let t=this.findHeader(e.target);if(t){const i=this.getResources().getMappedAttribute("context"),s=t[i];let o=this.m_headerLabels[s.axis][s.level];if(o&&this._matchDragDataType(e,`${o[i].axis}Labels`)){let t=o[i].level,s=o[i].axis,n={level:t,axis:s,position:this._getLabelRelativePosition(e,s,o)};this._invokeDropCallback(`${s}Labels`,"drop",e,n)}}},A.prototype._setDragLabelData=function(e,t){if(t){let i=e.dataTransfer;const s=this.getResources().getMappedAttribute("context"),o={axis:this.m_dragLabel[s].axis,level:this.m_dragLabel[s].level,data:this.m_dragLabel[s].data};let n=JSON.stringify(o);if("string"==typeof t)i.setData(t,n);else for(let e=0;e<t.length;e++)i.setData(t[e],n)}},A.prototype.setHiddenColumns=function(e){void 0!==e&&(this.m_hiddenColumns=null===e?[]:e)},A.prototype.setHiddenRows=function(e){void 0!==e&&(this.m_hiddenRows=null===e?[]:e)},A.prototype.deleteHiddenIndicators=function(e,t){const i=this.getResources().getMappedAttribute("hiddenIndicatorIndex");e.forEach(e=>{const s=t.querySelector(`[${i}="${e}"]`);s&&s.parentNode&&s.parentNode.removeChild(s)})},A.prototype.getActiveDatabodyIndicators=function(){const e=this.getResources().getMappedStyle("colHiddenIndicator"),t=this.getResources().getMappedStyle("rowHiddenIndicator"),i=[];return this.m_root.querySelectorAll(`.${e}, .${t}`).forEach(e=>i.push(this._getAttribute(e,"hiddenIndicatorIndex",!0))),i.length>0?i:null},A.prototype.getIndexesByHeader=function(e){let t=e[this.getResources().getMappedAttribute("context")],i=[],s=t.index,o=t.extent;for(let e=s;e<s+o;e++)i.push(e);return i},A.prototype.applyHiddenIndicatorToRange=function(e,t,i,s){const o=this.getResources().isRTLMode()?"right":"left";let n,r,l,a,h,d,m;"column"===s?(n=this.m_hiddenColumns,r=this.m_columnHeaderLevelCount,l="width",a=this.m_colHeader,h=this.m_colEndHeader,d=this.m_colHeaderFrozen,m=this.m_colEndHeaderFrozen):"row"===s&&(n=this.m_hiddenRows,r=this.m_rowHeaderLevelCount,l="height",a=this.m_rowHeader,h=this.m_rowEndHeader,d=this.m_rowHeaderFrozen,m=this.m_rowEndHeaderFrozen),n.sort((e,t)=>e-t);let c="column"===s?this.m_hiddenColumns:this.m_hiddenRows,u={};for(let a=e;a<=t;a++)if(c.includes(a)){let e,t=-1===a?0:a,h="column"===s?this.m_hasColHeader||this.m_hasColEndHeader:this.m_hasRowHeader||this.m_hasRowEndHeader;if(1===r&&h){let e=this._getHeaderByIndex(t,s,0);if(e){let n="column"===s?this.getElementDir(e,o):this.getElementDir(e,"top");n+=-1===a?0:this.getElementDir(e,l),u=this.renderHiddenAxisVisualIndicator(s,"column"===s?0:n,o,"column"===s?n:0,t,i,u)}}else{let r,h=this._getHeadersByIndex(a,s);for(let a=h.length-1;a>=0;a--)if(e=h[a],r=this.getIndexesByHeader(e),this.isArraySubset(r,n)){let h=this.getElementDir(e,"top"),d=this.getElementDir(e,o);d+=-1===a?0:this.getElementDir(e,l),u=this.renderHiddenAxisVisualIndicator(s,h,o,d,t,i,u),n=n.filter(e=>!r.includes(e))}}}if(u.header&&a.firstChild.appendChild(u.header),u.endHeader&&h.firstChild.appendChild(u.endHeader),u.frozenHeader&&d.firstChild.appendChild(u.frozenHeader),u.frozenEndHeader&&m.firstChild.appendChild(u.frozenEndHeader),u.databody&&this.m_databody.firstChild.appendChild(u.databody),u.frozenDatabody){("column"===s?this.m_databodyFrozenCol:this.m_databodyFrozenRow).firstChild.appendChild(u.frozenDatabody)}u.frozenCornerDatabody&&this.m_databodyFrozenCorner.firstChild.appendChild(u.frozenCornerDatabody),u.frozenRowDatabody&&this.m_databodyFrozenRow.firstChild.appendChild(u.frozenRowDatabody)},A.prototype.renderHiddenAxisVisualIndicator=function(e,t,i,s,o,n,r){const l="column"===e&&this._hasFrozenColumns()&&o<=this.m_frozenColIndex||"row"===e&&this._hasFrozenRows()&&o<=this.m_frozenRowIndex;let a,h,d,m,c,u,_="column"===e?l?this.m_colHeaderFrozen:this.m_colHeader:l?this.m_rowHeaderFrozen:this.m_rowHeader,g="column"===e?l?this.m_colEndHeaderFrozen:this.m_colEndHeader:l?this.m_rowEndHeaderFrozen:this.m_rowEndHeader;"row"===e?(h="width",a="width",d="rowHeaderHiddenIndicator",m="rowHiddenIndicator",c=this.m_hasRowHeader,u=this.m_hasRowEndHeader):"column"===e&&(h="height",a="height",d="colHeaderHiddenIndicator",m="colHiddenIndicator",c=this.m_hasColHeader,u=this.m_hasColEndHeader);let p=0,f=0,C=0;C=this.getElementDir(this.m_databody.firstChild,h);let y="row"===e?s:t;p=this.getElementDir(_.firstChild,a)-y,f=this.getElementDir(g.firstChild,a)-y;let w=0,E=0;if(this.isFirstOrFirstNonHiddenIndex(o+1,e)?(w=2,E=1):this.isLastOrLastNonHiddenIndex(o-1,e)&&(w=-2,E=-1),c){let n=document.createElement("div");this._setAttribute(n,"hiddenIndicatorIndex",o),this._setVisualIndicatorStyle(n,d,"row"===e?t+w-2:t,i,"row"===e?s:s+w-2,p,a),l?(r.frozenHeader||(r.frozenHeader=document.createDocumentFragment()),r.frozenHeader.appendChild(n)):(r.header||(r.header=document.createDocumentFragment()),r.header.appendChild(n))}if(u){let n=document.createElement("div");this._setAttribute(n,"hiddenIndicatorIndex",o),this._setVisualIndicatorStyle(n,d,"row"===e?t+w-2:0,i,"row"===e?0:s+w-2,f,a),l?(r.frozenEndHeader||(r.frozenEndHeader=document.createDocumentFragment()),r.frozenEndHeader.appendChild(n)):(r.endHeader||(r.endHeader=document.createDocumentFragment()),r.endHeader.appendChild(n))}if(n&&n.includes(o)){let n=document.createElement("div");this._setAttribute(n,"hiddenIndicatorIndex",o),this._setVisualIndicatorStyle(n,m,"row"===e?t+E-1:0,i,"row"===e?0:s+E-1,C,h),l?(r.frozenDatabody||(r.frozenDatabody=document.createDocumentFragment()),r.frozenDatabody.appendChild(n)):(r.databody||(r.databody=document.createDocumentFragment()),r.databody.appendChild(n));let a="column"===e?this._hasFrozenRows():this._hasFrozenColumns(),d="column"===e?this._hasFrozenColumns()&&o<=this.m_frozenColIndex:this._hasFrozenRows()&&o<=this.m_frozenRowIndex;if(a)if(d){let n=document.createElement("div"),l=0,a=this.m_databodyFrozenCorner;l=this.getElementDir(a.firstChild,h),this._setAttribute(n,"hiddenIndicatorIndex",o),this._setVisualIndicatorStyle(n,m,"row"===e?t+E-1:0,i,"row"===e?0:s+E-1,l,h),r.frozenCornerDatabody||(r.frozenCornerDatabody=document.createDocumentFragment()),r.frozenCornerDatabody.appendChild(n)}else{let n=document.createElement("div"),l=0,a=this.m_databodyFrozenRow;l=this.getElementDir(a.firstChild,h),this._setAttribute(n,"hiddenIndicatorIndex",o),this._setVisualIndicatorStyle(n,m,"row"===e?t+E-1:0,i,"row"===e?0:s+E-1,l,h),r.frozenRowDatabody||(r.frozenRowDatabody=document.createDocumentFragment()),r.frozenRowDatabody.appendChild(n)}}return r},A.prototype.isHidden=function(e,t){let i;return"column"===e||"columnEnd"===e?i=this.m_hiddenColumns:"row"!==e&&"rowEnd"!==e||(i=this.m_hiddenRows),!!i.includes(t)},A.prototype.isCellHidden=function(e){let t=this.getCellIndexes(e),i=t.row,s=t.column;return!(!this.isHidden("column",s)&&!this.isHidden("row",i))},A.prototype.isHeaderHidden=function(e){let t,i,s,o,n,r=[];if(e&&(t=e[this.getResources().getMappedAttribute("context")],i=t.extent,o=t.axis,s=t.index),"column"===o||"columnEnd"===o?n=this.m_hiddenColumns:"row"!==o&&"rowEnd"!==o||(n=this.m_hiddenRows),1===i){if(n.includes(s))return!0}else if(r=this.getIndexesByHeader(e),this.isArraySubset(r,n))return!0;return!1},A.prototype.arrayIndices=function(e,t){let i;i=this._isCountUnknownOrHighwatermark("column")?this._getMaxRight():Math.max(0,this.getDataSource().getCount("column")-1);let s=[];if(t.left)for(let t=0;t<=e;t++)s.push(t);else if(t.right)for(let t=e;t<=i;t++)s.push(t);return s},A.prototype.isArraySubset=function(e,t){return e.every(e=>t.includes(e))},A.prototype.hiddenColumnsInDirection=function(e,t){let i=new Set(this.arrayIndices(e,t));return this.m_hiddenColumns.filter(e=>i.has(e))},A.prototype._getHiddenCountBeforeIndex=function(e,t){let i=0;return("column"===t||"columnEnd"===t?this.m_hiddenColumns:this.m_hiddenRows).forEach(t=>{t<e&&(i+=1)}),i},A.prototype.isFirstOrFirstNonHiddenIndex=function(e,t){let i;if("column"===t||"columnEnd"===t?i=this.m_hiddenColumns:"row"!==t&&"rowEnd"!==t||(i=this.m_hiddenRows),e>=0){for(let t=0;t<=e-1;t++)if(!i.includes(t))return!1;return!0}return!1},A.prototype.findNextNonHiddenIndex=function(e,t){let i,s=e;for("column"===t||"columnEnd"===t?i=this.m_hiddenColumns:"row"!==t&&"rowEnd"!==t||(i=this.m_hiddenRows);i.includes(s)&&s>0;)s-=1;return s},A.prototype.isLastOrLastNonHiddenIndex=function(e,t){if(e>=0){let i,s;this._isCountUnknownOrHighwatermark(t)?"column"===t||"columnEnd"===t?i=this._getMaxRight():"row"!==t&&"rowEnd"!==t||(i=this._getMaxBottom()):i=Math.max(0,this.getDataSource().getCount(t)-1),"column"===t||"columnEnd"===t?s=this.m_hiddenColumns:"row"!==t&&"rowEnd"!==t||(s=this.m_hiddenRows);for(let t=i;t>=e+1;t--)if(!s.includes(t))return!1;return!0}return!1},A.prototype.getVisibleCellIndexInDirection=function(e,t,i){let s,o,n=this.getDataSource().getCount("row"),r=this.getDataSource().getCount("column"),l=t;if("column"===e||"columnEnd"===e?(s=this.m_hiddenColumns,o=-1!==r?r:Number.MAX_VALUE):"row"!==e&&"rowEnd"!==e||(s=this.m_hiddenRows,o=-1!==n?n:Number.MAX_VALUE),s.length)if(i.right||i.down){for(;s.includes(l)&&l>=0;)if(l+=1,l>=o)return t}else if(i.left||i.up)for(;s.includes(l)&&l>=0;)l-=1;return l},A.prototype._handleHideAxis=function(e,t){this.isMultipleSelection()&&this._removeTouchSelectionAffordance();let i,s,o,n,r=this.findHeader(e.target),l=this.findCell(e.target),a=this.m_selection,h=this.m_options.options.selectionMode,d=h.cell,m=h.row,c=[];if("column"===t?(i="multiple"===d,s=this.m_hiddenColumns):"row"===t&&(i="multiple"===m||"multiple"===d,s=this.m_hiddenRows),a.length&&i)for(let e=0;e<a.length;e++){let i=a[e].startIndex[t],s=a[e].endIndex[t];for(let e=i;e<=s;e++)c.push(e)}else if("single"===d)if(a.length){let e=a[0].startIndex[t];c.push(e)}else r&&(c=this.getIndexesByHeader(r));else if("none"===d&&"none"===m)r?c=this.getIndexesByHeader(r):l&&c.push(this._getIndex(l,t));else{if(("column"!==t||"multiple"!==m)&&"single"!==m)return;if(!r)return;c=this.getIndexesByHeader(r)}for(let e=0;e<c.length;e++){let i=c[e];s.includes(i)||s.push(i),this.shiftAxisForHidability(i,!0,t)}this.focusNextVisibleAxis(r,l,e,t),this.deleteAndApplyHiddenIndicators(c,t),this.fillViewport(),"column"===t?(o={event:e,ui:{hiddenColumns:new Set(this.m_hiddenColumns)}},n="columnHide"):"row"===t&&(o={event:e,ui:{hiddenRows:new Set(this.m_hiddenRows)}},n="rowHide"),this.fireEvent(n,o)},A.prototype.focusNextVisibleAxis=function(e,t,i,s){let o,n;if(e)o=this._getIndex(e,s);else{if(!t)return;o=this._getIndex(t,s)}n=this.isLastOrLastNonHiddenIndex(o,s)?"column"===s?this.getVisibleCellIndexInDirection("column",o,{left:!0}):this.getVisibleCellIndexInDirection("row",o,{up:!0}):"column"===s?this.getVisibleCellIndexInDirection("column",o,{right:!0}):this.getVisibleCellIndexInDirection("row",o,{down:!0});let r=this.getResources().getMappedAttribute("context");if(e){let t=e[r].level;var l=this._getHeaderByIndex(n,s,t);this._setActive(l,{type:"header",index:n,level:t,axis:s})}else if(t){let e="column"===s?t[r].indexes.row:t[r].indexes.column,o="column"===s?this.createIndex(e,n):this.createIndex(n,e);this._setActiveByIndex(o,i)}},A.prototype._updateHiddenSection=function(e,t){let i="column"===t?this.m_hiddenColumns:this.m_hiddenRows,s=i.filter(t=>!e.includes(t)),o=e.filter(e=>!i.includes(e));if("column"===t?this.m_hiddenColumns=e:"row"===t&&(this.m_hiddenRows=e),this.m_initialized){for(let e=0;e<o.length;e++){let i=o[e];this.shiftAxisForHidability(i,!0,t)}for(let e=0;e<s.length;e++){let i=s[e];this.shiftAxisForHidability(i,!1,t)}this.deleteAndApplyHiddenIndicators(o,t),this.fillViewport()}if(this.m_active&&("row"===t||"column"===t)){const e="row"===t?{down:!0}:{right:!0},i="row"===t?this.m_hiddenRows:this.m_hiddenColumns;let s,o;i.length&&("cell"===this.m_active.type&&this.m_active.indexes&&i.includes(this.m_active.indexes[t])?(this.m_shouldFocus=!1,s=this.getVisibleCellIndexInDirection(t,this.m_active.indexes[t],e),o="row"===t?this._getCellByIndex(this.createIndex(s,this.m_active.indexes.column)):this._getCellByIndex(this.createIndex(this.m_active.indexes.row,s)),this._setActive(o)):"header"===this.m_active.type&&this.m_active.index&&i.includes(this.m_active.index)&&(this.m_shouldFocus=!1,s=this.getVisibleCellIndexInDirection(t,this.m_active.index,e),o=this._getHeaderByIndex(s,t),this._setActive(o,{type:"header",index:this.m_active.index,level:this.m_active.level,axis:t})))}},A.prototype.containsHiddenItems=function(e,t){let i,s="column"===t?this.m_hiddenColumns:this.m_hiddenRows;return i=e.filter(e=>s.includes(e)),i.sort((e,t)=>e-t),i},A.prototype.hiddenItemsInRange=function(e,t,i){return("column"===i?this.m_hiddenColumns:this.m_hiddenRows).filter(i=>i>=e&&i<=t).length},A.prototype._handleUnhideAxis=function(e,t,i){let s,o,n="column"===t?this.m_hiddenColumns:this.m_hiddenRows,r=[];if(null==i){let i=this.findHeader(e.target),s=this.findCell(e.target),o=this.getAxisSelectionIndexArray(t),l=this.m_selection,a=this.m_options.options.selectionMode,h=a.cell,d=a.row,m=this.containsHiddenItems(o,t);const c=e=>{let t=[],i=[];for(let s=0;s<e.length;s++){let o=0;for(;n.includes(e[s]-1-o);)t.push(e[s]-1-o),o+=1;let r=0;for(;n.includes(e[s]+1+r);)i.push(e[s]+1+r),r+=1}return[...t,...i]};let u,_,g=this.areAllAxisElementsSelectedViaOtherAxis(t);if("column"===t?(u="multiple"===h,_=this._getMaxRight()):"row"===t&&(u="multiple"===d||"multiple"===h,_=this._getMaxBottom()),!0===g)r=[...n];else if(l.length&&u)for(let e=0;e<o.length;e++){let i=o[e];if(m.length){r=m;break}if(this.isFirstOrFirstNonHiddenIndex(i,t)&&this.isLastOrLastNonHiddenIndex(i,t))r=c([i]);else if(this.isFirstOrFirstNonHiddenIndex(i,t)){let e=[];for(let t=0;t<=i-1;t++)e.push(t);r=e}else if(this.isLastOrLastNonHiddenIndex(i,t)){let e=[];for(let t=i+1;t<=_;t++)e.push(t);r=e}}else if("single"===h)l.length?r=c(o):i&&(o=this.getIndexesByHeader(i),r=c(o));else if("none"===h&&"none"===d)i?(o=this.getIndexesByHeader(i),r=c(o)):s&&(o.push(this._getIndex(s,"column")),r=c(o));else{if(("column"!==t||"multiple"!==d)&&"single"!==d)return;if(!i)return;o=this.getIndexesByHeader(i),r=c(o)}}else r=[i];this.unhighlightSelection();for(let e=0;e<r.length;e++){let i=r[e],s=n.indexOf(i);-1!==s&&n.splice(s,1),this.shiftAxisForHidability(i,!1,t)}this.deleteAndApplyHiddenIndicators(),this.applySelection(),this._resetHeaderHighLight(),this.resizeGrid(),"column"===t?(s={event:e,ui:{hiddenColumns:new Set(this.m_hiddenColumns)}},o="columnHide"):"row"===t&&(s={event:e,ui:{hiddenRows:new Set(this.m_hiddenRows)}},o="rowHide"),this.fireEvent(o,s)},A.prototype.shiftAxisForHidability=function(e,t,i){if(this._isAxisIndexInViewport(e,i)===A.INSIDE){var s;let o,n,r,l,a,h,d,m;"column"===i?(s=this.getResources().isRTLMode()?"right":"left",o=this.getMappedStyle("colheadercell"),n=this.getMappedStyle("colendheadercell"),a="width",r=this.m_startRow,l=e):"row"===i&&(s="top",o=this.getMappedStyle("rowheadercell"),n=this.getMappedStyle("rowendheadercell"),a="height",r=e,l=this.m_startCol);let c,u,_,g,p,f,C,y=this.createIndex(r,l);if(h=this._getCellByIndex(y),m=h[this.getResources().getMappedAttribute("context")],d="column"===i?m.keys.column:m.keys.row,c="column"===i?this.getElementWidth(h):this.getElementHeight(h),_=this.m_sizingManager.getSize(i,d),u=t?0:_,p=u-c,0!==p){let t,h,d,m,c,u,_=!1;if("column"===i?(t=this.m_databodyFrozenCol,h=this.m_endRowEndHeader,d=this.m_hasColHeader,m=this.m_hasColEndHeader,u=this.m_frozenColIndex,c=l,this._hasFrozenColumns()&&e<=this.m_frozenColIndex?(_=!0,f=this.m_colHeaderFrozen,C=this.m_colEndHeaderFrozen):(f=this.m_colHeader,C=this.m_colEndHeader)):"row"===i&&(t=this.m_databodyFrozenRow,h=this.m_endColEndHeader,d=this.m_hasRowHeader,m=this.m_hasRowEndHeader,u=this.m_frozenRowIndex,c=r,this._hasFrozenRows()&&e<=this.m_frozenRowIndex?(_=!0,f=this.m_rowHeaderFrozen,C=this.m_rowEndHeaderFrozen):(f=this.m_rowHeader,C=this.m_rowEndHeader)),null==this.m_databody.firstChild||_){if(_&&t){let e=this.getElementDir(t,a),o=this.getElementDir(t,s);if(-1!==h){let t="column"===i?this.m_rowEndHeader:this.m_colEndHeader,n=this.getElementDir(t,s);p=o+e+p>n?n-(o+e):p}g=e+p,this.setElementDir(t,g,a),this.m_databodyFrozenCorner&&this.setElementDir(this.m_databodyFrozenCorner,g,a)}}else{g=this.getElementDir(this.m_databody.firstChild,a)+p,this._setAllScrollableRegions(a,g)}let y=!1;d&&(this._shiftHeadersAlongAxisInContainer(f.firstChild,c,p,s,o,i,!0),_||("column"===i?this.m_endColHeaderPixel+=p:this.m_endRowHeaderPixel+=p)),m&&(this._shiftHeadersAlongAxisInContainer(C.firstChild,c,p,s,n,i,!0),_||("column"===i?this.m_endColEndHeaderPixel+=p:this.m_endRowEndHeaderPixel+=p)),_?("column"===i&&this.m_databodyFrozenCol||"row"===i&&this.m_databodyFrozenRow)&&(y=!0,this._shiftCellsAlongAxis(i,p,c,null,u,y,!0)):(this._shiftCellsAlongAxis(i,p,c,!1,void 0,void 0,!0),("column"===i&&this.m_databodyFrozenRow||"row"===i&&this.m_databodyFrozenCol)&&this._shiftFrozenCellsAlongAxis(i,p,c,!1,!0),"column"===i?this.m_endColPixel+=p:this.m_endRowPixel+=p)}}this.manageResizeScrollbars()},A.prototype.deleteAndApplyHiddenIndicators=function(e,t){let i="column"===t?this.m_startCol:this.m_startRow,s="column"===t?this.m_endCol:this.m_endRow;this.deleteAllHiddenVisualIndicators(t),t?this.applyHiddenIndicatorToRange(i,s,e,t):(this.applyHiddenIndicatorToRange(this.m_startCol,this.m_endCol,e,"column"),this.applyHiddenIndicatorToRange(this.m_startRow,this.m_endRow,e,"row")),this._isHighWatermarkScrolling()||(this._hasFrozenColumns()&&this.applyHiddenIndicatorToRange(0,this.m_frozenColIndex+1,e,"column"),this._hasFrozenRows()&&this.applyHiddenIndicatorToRange(0,this.m_frozenRowIndex+1,e,"row"))},A.prototype.deleteAllHiddenVisualIndicators=function(e){this.deleteDatabodyHiddenVisualIndicators(),"column"===e?this.m_root.querySelectorAll(`.${this.getResources().getMappedStyle("colHeaderHiddenIndicator")}`).forEach(e=>this._remove(e)):"row"===e?this.m_root.querySelectorAll(`.${this.getResources().getMappedStyle("rowHeaderHiddenIndicator")}`).forEach(e=>this._remove(e)):this.m_root.querySelectorAll(`.${this.getResources().getMappedStyle("rowHeaderHiddenIndicator")},\n            .${this.getResources().getMappedStyle("colHeaderHiddenIndicator")}`).forEach(e=>this._remove(e))},A.prototype.deleteDatabodyHiddenVisualIndicators=function(){if(this.m_databody){this.m_databody.firstChild.querySelectorAll(`.${this.getResources().getMappedStyle("colHiddenIndicator")},\n            .${this.getResources().getMappedStyle("rowHiddenIndicator")}`).forEach(e=>this._remove(e))}if(this._hasFrozenColumns()){this.m_databodyFrozenCol.firstChild.querySelectorAll(`.${this.getResources().getMappedStyle("colHiddenIndicator")},\n                        .${this.getResources().getMappedStyle("rowHiddenIndicator")}`).forEach(e=>this._remove(e))}if(this._hasFrozenRows()){this.m_databodyFrozenRow.firstChild.querySelectorAll(`.${this.getResources().getMappedStyle("colHiddenIndicator")},\n                           .${this.getResources().getMappedStyle("rowHiddenIndicator")}`).forEach(e=>this._remove(e))}if(this._hasFrozenColumns()&&this._hasFrozenRows()){this.m_databodyFrozenCorner.firstChild.querySelectorAll(`.${this.getResources().getMappedStyle("colHiddenIndicator")},\n                         .${this.getResources().getMappedStyle("rowHiddenIndicator")}`).forEach(e=>this._remove(e))}},A.prototype.updateHiddenAxisForInsertion=function(e,t,i){let s=!1,o="row"===i?this.m_hiddenRows:this.m_hiddenColumns;for(let i=0;i<o.length;i++)o[i]>=e&&(o[i]+=t,s=!0);if(s){let e;"column"===i?(e={event:null,ui:{hiddenColumns:new Set(this.m_hiddenColumns)}},this.fireEvent("columnHide",e)):"row"===i&&(e={event:null,ui:{hiddenRows:new Set(this.m_hiddenRows)}},this.fireEvent("rowHide",e))}},A.prototype.updateHiddenAxisForDeletion=function(e,t){let i=!1,s="row"===t?this.m_hiddenRows:this.m_hiddenColumns;if(e.forEach(e=>{let o=s.indexOf(t=>t===e);-1!==o&&(i=!0,s.splice(o,1));let n=s.map(t=>t>e?(i=!0,t-1):t);"column"===t?this.m_hiddenColumns=n:"row"===t&&(this.m_hiddenRows=n)}),i){let e;"column"===t?(e={event:null,ui:{hiddenColumns:new Set(this.m_hiddenColumns)}},this.fireEvent("columnHide",e)):"row"===t&&(e={event:null,ui:{hiddenRows:new Set(this.m_hiddenRows)}},this.fireEvent("rowHide",e))}},A.prototype.canHide=function(e){let t,i,s,o=this.m_selection;"column"===e||"columnEnd"===e?(t=this.m_endCol-this.m_startCol+1,s=this.m_hiddenColumns,i=s.length):"row"!==e&&"rowEnd"!==e||(t=this.m_endRow-this.m_startRow+1,s=this.m_hiddenRows,i=s.length);let n,r,l,a=[];if(o.length&&this.isMultipleSelection()){if("column"===e||"columnEnd"===e){if(this.areAllAxisElementsSelectedViaOtherAxis("column"))return!1;l="column"}else if("row"===e||"rowEnd"===e){if(this.areAllAxisElementsSelectedViaOtherAxis("row"))return!1;l="row"}for(let e=0;e<o.length;e++){let t=o[e].startIndex[l],i=o[e].endIndex[l];for(let e=t;e<=i;e++)s.includes(e)||a.push(e)}n=a.length}else n=1;return r=t-i-n,r>0},A.prototype.isHiddenAdjacent=function(e){let t,i=e.cell,s=e.header,o=e.index,n=e.axis;if("column"===n||"columnEnd"===n?t=this.m_hiddenColumns:"row"!==n&&"rowEnd"!==n||(t=this.m_hiddenRows),i){let e=o-1,i=o+1;return!(!t||!t.includes(e))||!(!t||!t.includes(i))}if(s){let e=[],i=[];for(let s=0;s<o.length;s++){let n=0;for(;t&&t.includes(o[s]-1-n);)e.push(o[s]-1-n),n+=1;let r=0;for(;t&&t.includes(o[s]+1+r);)i.push(o[s]+1+r),r+=1}return e.length>0||i.length>0}return!1},A.prototype.getAxisSelectionIndexArray=function(e){let t=this.m_selection,i=[];if(t.length&&!this.areAllAxisElementsSelectedViaOtherAxis(e)){for(let s=0;s<t.length;s++){let o=t[s].startIndex[e],n=t[s].endIndex[e];for(let e=o;e<=n;e++)i.push(e)}i.sort((e,t)=>e-t)}return i},A.prototype.areAllAxisElementsSelectedViaOtherAxis=function(e){let t=this.m_selection,i=this.m_options.options.selectionMode,s=i.cell,o=i.row,n="multiple"===o||"single"===o;if(t.length&&("multiple"===s||"column"===e&&n))for(let i=0;i<t.length;i++){let s=t[i].startIndex[e],o=t[i].endIndex[e];if(0===s&&-1===o||null==s&&null==o)return!0}return!1},A.prototype._getCellHidabilityContextMenuCapability=function(e,t){let i=this.m_options.options.selectionMode,s=i.cell,o=i.row,n=!1,r=!1,l=this.getAxisSelectionIndexArray(t);const a=this.getResources().getMappedAttribute("context");let h,d;if("column"===t||"columnEnd"===t?(h="column",d=this.m_hiddenColumns):"row"!==t&&"rowEnd"!==t||(h="row",d=this.m_hiddenRows),this._isSelectionEnabled())if(this.isMultipleSelection())if("multiple"===s){if(this.canHide(t)&&(n=!0),l.length>0){let e=l[0],i=l[l.length-1];(this.containsHiddenItems(l,t).length>0||this.isFirstOrFirstNonHiddenIndex(e,t)||this.isLastOrLastNonHiddenIndex(i,t))&&(r=!0)}}else this.areAllAxisElementsSelectedViaOtherAxis(h)&&d.length>0&&(r=!0);else"single"===s||"single"===o?(this.canHide(t)&&(n=!0),this.isHiddenAdjacent({cell:!0,index:l[0],axis:t})&&(r=!0)):this.areAllAxisElementsSelectedViaOtherAxis(h)&&d.length>0&&(r=!0);else if("none"===s&&"none"===o){this.canHide(t)&&(n=!0);let i=e[a].indexes.column;this.isHiddenAdjacent({cell:!0,index:i,axis:t})&&(r=!0)}return{canHide:n,canUnhide:r}},A.prototype._getHeaderHidabilityContextMenuCapability=function(e,t){let i,s,o,n,r=this.m_options.options.selectionMode,l=r.cell,a=r.row,h=!1,d=!1,m=this.getAxisSelectionIndexArray(t),c=this.m_utils.containsCSSClassName(e,this.getMappedStyle("selected"));if("column"===t||"columnEnd"===t?(i="multiple"===l,s="multiple"===a,o="column",n=this.m_hiddenColumns):"row"!==t&&"rowEnd"!==t||(s="multiple"===l,i="multiple"===a||s,o="row",n=this.m_hiddenRows),this._isSelectionEnabled()&&i)if(c&&this.canHide(t)&&(h=!0),m.length>0){let e,i=m[0],s=m[m.length-1];this._isCountUnknownOrHighwatermark(t)?"column"===t||"columnEnd"===t?e=this._getMaxRight():"row"!==t&&"rowEnd"!==t||(e=this._getMaxBottom()):e=Math.max(0,this.getDataSource().getCount(t)-1),(this.containsHiddenItems(m,o).length>0||this.isFirstOrFirstNonHiddenIndex(i,o)&&0!==i||this.isLastOrLastNonHiddenIndex(s,o)&&s!==e)&&(d=!0)}else this.areAllAxisElementsSelectedViaOtherAxis(o)&&n.length>0&&(d=!0);else if(s||"single"===l||"single"===a||"none"===l&&"none"===a){let i=e[this.getResources().getMappedAttribute("context")].index;h=!0,this.isHiddenAdjacent({header:!0,index:[i],axis:t})&&n.length>0&&(d=!0)}return{canHide:h,canUnhide:d}},A.prototype._buildFilterIcon=function(e){const t=document.createElement("div");t.classList.add(this.getMappedStyle("iconContainer"),this.getMappedStyle("filterIcon"));const i=document.createElement("div");return i.classList.add(this.getMappedStyle("icon"),this.getMappedStyle("clickableicon")),"filtered"===e.metadata.filter?i.classList.add(this.getMappedStyle("filtered")):(i.classList.add(this.getMappedStyle("filterable")),t.classList.add(this.getMappedStyle("iconHidden"))),i.setAttribute("title",this.getResources().getTranslatedText("labelFilter")),t.appendChild(i),t.addEventListener("mouseover",this._handleFilterContainerMouseOver.bind(this)),t},A.prototype._handleFilterContainerMouseOver=function(e){const t=e.target,i=this.findHeader(t),s=this._getFilterIcon(i),o=this._getFilterContainer(i);e.currentTarget.classList.contains(this.getMappedStyle("filterIcon"))&&(e.currentTarget.classList.add(this.getMappedStyle("hover")),s.classList.add(this.getMappedStyle("hover")),o&&o.classList.remove(this.getMappedStyle("iconHidden")))},A.prototype._handleFilterMouseOut=function(e){if(!this._databodyEmpty()){const t=e.target,i=this.findHeader(t),s=this._getFilterIcon(i),o=i[this.getResources().getMappedAttribute("context")];s&&s.classList.remove(this.getMappedStyle("hover"));const n=this._getFilterContainer(i);n&&(n.classList.remove(this.getMappedStyle("hover")),"filtered"!==o.metadata.filter&&n.classList.add(this.getMappedStyle("iconHidden")))}},A.prototype._getFilterIcon=function(e){return this._getFilterContainer(e).firstChild},A.prototype._getFilterContainer=function(e){return e.querySelector("."+this.getMappedStyle("filterIcon"))},A.prototype._handleHeaderFilter=function(e,t){if(!this._databodyEmpty()){const i=e.target;let s=this.findHeader(i);if(null==s){null!=this.findCell(i)&&(s=this.getHeaderFromCell(i,t))}null!=s&&this._fireFilterRequestEvent(e,s)}},A.prototype._fireFilterRequestEvent=function(e,t){const i=t[this.getResources().getMappedAttribute("context")],s=t[this.getResources().getMappedAttribute("metadata")];var o={event:e,ui:{item:this.buildHeaderTemplateContext(i,s).item,axis:this._getAxis(t),anchor:t,launcher:this._getFilterIcon(t)}};this.fireEvent("filterRequest",o)},A.prototype._isFilterIcon=function(e){return e.classList.contains(this.getMappedStyle("filterable"))||e.classList.contains(this.getMappedStyle("filtered"))||e.classList.contains(this.getMappedStyle("filterIcon"))},A.TOOL_TIP_OPEN_DURATION=1e3,A.TOOL_TIP_CLOSE_DURATION=1e3,A.TOOL_TIP_CENTER_POSITION_OFFSET=4,A.TOOL_TIP_CORNER_POSITION_OFFSET=8,A.prototype._showToolTip=function(e,t,i){const s=`${this.m_root.getAttribute("id")}ToolTip`;let o=document.getElementById(s);if(!o){o=document.createElement("oj-popup"),o.setAttribute("id",s),o.setAttribute("data-oj-binding-provider","none"),o.style.maxHeight="25vh";const e=document.createElement("span");o.appendChild(e),o.addEventListener("mouseenter",this._handleMouseEnterToolTip.bind(this),!1),o.addEventListener("mouseleave",this._handleMouseLeaveToolTip.bind(this),!1),this.m_root.appendChild(o)}const n={collision:"flipfit"};if(i)n.at={horizontal:"center",vertical:"top"},n.my={horizontal:"center",vertical:"bottom"},e.addEventListener("mouseout",this._setToolTipCloseTimeout.bind(this),{once:!0}),o.style.overflow="unset",o.style.maxWidth="unset";else{o.style.overflow="auto",o.style.maxWidth="288px";const t=e[this.getResources().getMappedAttribute("context")],i=null!=this.findLabel(e),s="row"===t.axis||"rowEnd"===t.axis,{verticalAlignment:r,horizontalAlignment:l}=this._getHeaderAlignments(t,s,i),{widthOffset:a,heightOffset:h}=this._calculateToolTipOffset(i,s,r,l,e,t);n.my={horizontal:this._getOppositeHorizontalAlignment(l),vertical:this._getOppositeVerticalAlignment(r)},n.at={horizontal:l,vertical:r},n.offset={y:h,x:a},"top"===r||"bottom"===r?("top"===r?n.offset.y+=A.TOOL_TIP_CORNER_POSITION_OFFSET:n.offset.y-=A.TOOL_TIP_CORNER_POSITION_OFFSET,"start"===l||"left"===l?n.offset.x+=A.TOOL_TIP_CORNER_POSITION_OFFSET:"end"!==l&&"right"!==l||(n.offset.x-=A.TOOL_TIP_CORNER_POSITION_OFFSET)):"center"===r&&("center"===l?(n.at.vertical="top",n.my.vertical="bottom",n.offset.y+=A.TOOL_TIP_CENTER_POSITION_OFFSET):"start"===l||"left"===l?n.offset.x+=A.TOOL_TIP_CENTER_POSITION_OFFSET:"end"!==l&&"right"!==l||(n.offset.x-=A.TOOL_TIP_CENTER_POSITION_OFFSET))}c.getContext(o).getBusyContext().whenReady().then(()=>{o.querySelector("span").textContent=t,o.open(e,n)})},A.prototype._getOppositeHorizontalAlignment=function(e){return"start"===e?"end":"end"===e?"start":"left"===e?"right":"right"===e?"left":"center"},A.prototype._getOppositeVerticalAlignment=function(e){return"top"===e?"bottom":"bottom"===e?"top":"center"},A.prototype._calculateToolTipOffset=function(e,t,i,s,o){let n=0,r=0;if(!e){const e=this.getResources().isRTLMode();let l;l=t?this.getElementDir(o,"top"):this.getElementDir(o,e?"right":"left"),t?"center"===i?l+=o.offsetHeight/2:"bottom"===i&&(l+=o.offsetHeight):t||("center"===s?l+=o.offsetWidth/2:("right"===s||"end"===s&&!e||"start"===s&&e)&&(l+=o.offsetWidth));const a=t?this.m_databody.scrollTop:this.m_databody.scrollLeft,h=t?a+this.m_databody.offsetHeight-this.m_utils.getScrollbarSize():a+this.m_databody.offsetWidth-this.m_utils.getScrollbarSize();l>h&&t?n=-(l-h):l<a&&t?n=a-l:l>h&&!t?r=-(l-h):l<a&&!t&&(r=a-l)}return{widthOffset:r,heightOffset:n}},A.prototype._getHeaderAlignments=function(e,t,i){let s=this.m_options.getHorizontalAlignment(e.axis,e),o=this.m_options.getVerticalAlignment(e.axis,e);if(!s||"auto"===s)if(t)s="start";else{const t="column"===e.axis?this.m_columnHeaderLevelCount-1:this.m_columnEndHeaderLevelCount-1;s=e.level===t||i?"end":"center"}if(!o||"auto"===o)if(t){const t="row"===e.axis?this.m_rowHeaderLevelCount-1:this.m_rowEndHeaderLevelCount-1;o=e.level===t||i?"center":"top"}else o="center";return{verticalAlignment:o,horizontalAlignment:s}},A.prototype._handleMouseEnterToolTip=function(){clearTimeout(this.m_toolTipCloseTimeoutId)},A.prototype._handleMouseLeaveToolTip=function(e){this._setToolTipCloseTimeout(e,!0)},A.prototype._setToolTipOpenTimeout=function(e,t,i){this._isIcon(e.target)||t&&i&&(clearTimeout(this.m_toolTipOpenTimeoutId),this.m_toolTipOpenTimeoutId=setTimeout(()=>{this._showToolTip(t,i,null,e)},A.TOOL_TIP_OPEN_DURATION))},A.prototype._setToolTipCloseTimeout=function(e){clearTimeout(this.m_toolTipOpenTimeoutId),clearTimeout(this.m_toolTipCloseTimeoutId),this.m_toolTipCloseTimeoutId=setTimeout(()=>{this._closeToolTip(e)},A.TOOL_TIP_CLOSE_DURATION)},A.prototype._isIcon=function(e){return this.m_utils.containsCSSClassName(e,this.getMappedStyle("icon"))||this.m_utils.containsCSSClassName(e,this.getMappedStyle("iconContainer"))},A.prototype._getToolTip=function(){const e=`${this.m_root.getAttribute("id")}ToolTip`;return document.getElementById(e)},A.prototype._closeToolTip=function(){const e=this._getToolTip();e&&e.close()},A.prototype._getToolTipDescription=function(e,t){const i=e[this.getResources().getMappedAttribute("context")],s=this.m_options.getDescription(i.axis,t);return s?s(i):i.metadata?.description}});
//# sourceMappingURL=ojdatagrid.js.map