define(['exports', 'preact/jsx-runtime', './mergeProps-bcfa6a92', './classNames-08d99695', './useTranslationBundle-27bf6340', './size-0127b66b', './stringUtils-4ffd9d59', './filePickerUtils-e4392bf2', './clientHints-6d361eaa', './usePress-949a0d03', 'preact/hooks', './TabbableModeContext-a9c97640', './useTabbableMode-df433329', './useTestId-a2e433c2', './useComponentTheme-5aa41a8f', './useInteractionStyle-15a2bdd0', './UNSAFE_FilePicker/themes/redwood/FilePickerTheme'], (function(e,t,r,s,i,a,n,l,o,d,c,u,p,f,y,h,m){"use strict";const v=({ariaLabel:e,isDisabled:t,translations:r,primaryText:s,secondaryText:i,selectionMode:a})=>e||`${t?"":r.filePicker_addFiles()+". "}${T(s,r)}. ${g(i,r,a)}`,b=(e,t)=>({width:e?a.sizeToCSS(e):void 0,height:t?a.sizeToCSS(t):void 0}),T=(e,t)=>e||t.filePicker_dropzonePrimaryText(),g=(e,t,r)=>{const s="multiple"===r?t.filePicker_dropzoneSecondaryTextMultiple():t.filePicker_dropzoneSecondaryText();return e||s},x=(e,t,r)=>{const s=[],i=[];let a,n;if(e)for(let l=0;l<e.length;l++){a=e[l];const o=a.name;if(n=r.filePicker_unknownFileTypeUploadError(),o){const e=o.split(".");n=e.length>1?"."+e.pop():n}n=a.type?a.type:n,-1===s.indexOf(n)&&-1===i.indexOf(n)&&(k(a,t)?s.push(n):i.push(n))}return{accepted:s,rejected:i}},P=e=>{const t={length:{value:e.length},item:{value(e){return this[e]}}};for(let r=0;r<e.length;r++)t[r]={value:e[r],enumerable:!0};return Object.create(FileList.prototype,t)},D=(e,t)=>"single"!==t||1===e.length,S=(e,t)=>{const r=[];return 1===e.length?r.push({severity:"error",summary:t.filePicker_singleTypeUploadError({fileType:e[0]})}):r.push({severity:"error",summary:t.filePicker_multipleFileTypeUploadError({fileTypes:e.join(t.plural_separator())})}),r},k=(e,t)=>{const r=t;if(!r||0===r.length||!e)return!0;let s;for(let t=0;t<r.length;t++){if(s=n.f(r[t]),!s)return!0;if(s.startsWith(".",0)){if(!e.name||e.name&&e.name.toLowerCase().endsWith(s.toLowerCase()))return!0}else{if(!e.type)return!1;if("image/*"===s){if(e.type.startsWith("image/",0))return!0}else if("video/*"===s){if(e.type.startsWith("video/",0))return!0}else if("audio/*"===s){if(e.type.startsWith("audio/",0))return!0}else if(e.type===s)return!0}}return!1},j=(e,t,r)=>{let s;const i=t?new Promise((e=>{s=e})):null;return r?.({messages:e,until:i}),s},H=(e,t)=>{const r=P(e);t?.({files:r})},M=(e,t,r)=>{const{callback:s,validation:i}=w(e),{pressProps:a}=d.usePress(s);return{validation:i,dragAndDropProps:C(e.accept,e.selectionMode,j,H,t,e.translations,e.onCommit,e.onReject,r),pressProps:a}},w=e=>{const t=t=>{if(t.length>0){const r=x(t,e.accept,e.translations).rejected;r.length>0?j(S(r,e.translations),!1,e.onReject):H(t,e.onCommit)}};return{callback:r=>{("click"===r.type||"keyup"===r.type&&"Enter"===r.code)&&(r.preventDefault(),l.pickFiles(t,{accept:e.accept,selectionMode:e.selectionMode??"multiple",capture:e.capture??"none"}))},validation:t}},C=(e,t,r,s,i,a,n,l,d)=>{const u=c.useRef(!1),p=c.useRef(!1),f=c.useRef(),y=(e,t=!1)=>{u.current&&(e.preventDefault(),e.stopPropagation(),i.current?.contains(e.relatedTarget)||(u.current=!1,d?.("NA"),p.current||t||f.current?.()))};return{onDragEnter:e=>{e.preventDefault(),e.stopPropagation()},onDragOver:s=>{if(s.preventDefault(),s.stopPropagation(),u.current)return;const i=o.getClientHints().browser;if(u.current=!0,p.current=!0,"safari"!==i){if(!s.dataTransfer)return;const i=P(s.dataTransfer.items);let n=[];const o=D(i,t),c=x(i,e,a);o&&0===c.rejected.length?d?.("valid"):(p.current=!1,o?n=S(c.rejected,a):n.push({severity:"error",summary:a.filePicker_singleFileUploadError()}),d?.("invalid"),f.current=r(n,!0,l))}else d?.("valid")},onDragLeave:y,onDrop:i=>{if(u.current){if(i.preventDefault(),i.stopPropagation(),!i.dataTransfer)return void(u.current=!1);const o=P(i.dataTransfer.files);let d=!1;if(p.current){let i=[];if(D(o,t)){const t=x(o,e,a);t.rejected.length>0&&(i=S(t.rejected,a),d=!0)}else i.push({severity:"error",summary:a.filePicker_singleFileUploadError()});i.length>0&&(p.current=!1,r(i,!1,l)),p.current&&s(o,n)}y(i,d)}}}},F=({isDisabled:e,primaryText:r,secondaryText:s,translations:i,selectionMode:a})=>{const{styles:{disabledPrimaryTextStyle:n,primaryTextStyle:l,disabledSecondaryTextStyle:o,secondaryTextStyle:d}}=y.useComponentTheme(m.FilePickerRedwoodTheme);return t.jsxs(t.Fragment,{children:[t.jsx("div",{class:e?n:l,children:T(r,i)}),t.jsx("div",{class:e?o:d,children:g(s,i,a)})]})};const R=e=>{const i=f.useTestId(e.testId),{interactionProps:a,applyActiveStyle:n,applyHoverStyle:l,applyPseudoHoverStyle:o}=h.useInteractionStyle({isDisabled:!1}),{classes:d,styles:{maxWidth:u,inner:T,activeStyle:g,innerNeedsEventsHoverStyle:x,innerPseudoHoverStyle:P,invalidDrop:D,validDrop:S}}=y.useComponentTheme(m.FilePickerRedwoodTheme,{hoveredState:l?"isHover":void 0,pseudoHoveredState:o?"isPseudoHover":void 0}),k=[n?g:"",l?x:"",o?P:""],[j,H]=c.useState("NA"),w="valid"===j?S:"invalid"===j?D:void 0,C=c.useRef(null),{validation:R,dragAndDropProps:I,pressProps:_}=M(e,C,H),L=r.mergeProps(_,a);E(I,R,e.testHandlersRef||null);const N=s.classNames([d,void 0===e.width&&u]),{isTabbable:U}=p.useTabbableMode(),{primaryText:W,secondaryText:A,translations:z,selectionMode:O,width:$,height:B}=e;return t.jsx("div",{...i,...L,class:N,tabIndex:U?0:-1,role:"button","aria-label":v({ariaLabel:e["aria-label"],isDisabled:!1,translations:z,primaryText:W,secondaryText:A,selectionMode:O}),ref:C,style:b($,B),children:t.jsx("div",{class:s.classNames([T,w,...k]),...I,children:t.jsx(F,{...e,isDisabled:!1})})})},I=({children:e,primaryText:r,secondaryText:i,translations:a,width:n,height:l,testId:o,...d})=>{const c=f.useTestId(o),{classes:u,styles:{maxWidth:p,inner:h,noChildrenMargin:T}}=y.useComponentTheme(m.FilePickerRedwoodTheme,{disabledState:"isDisabled"});return t.jsx("div",{class:s.classNames([u,h,T,void 0===n&&p]),role:"button","aria-label":v({ariaLabel:d["aria-label"],isDisabled:!0,translations:a,primaryText:r,secondaryText:i}),"aria-hidden":"true",...c,style:b(n,l),children:e||t.jsx(F,{secondaryText:i,primaryText:r,...d,isDisabled:!0,translations:a})})},_=e=>{const i=f.useTestId(e.testId),{interactionProps:a,applyHoverStyle:n,applyPseudoHoverStyle:l}=h.useInteractionStyle({isDisabled:!1}),{classes:o,styles:{maxWidth:d,noChildrenMargin:u}}=y.useComponentTheme(m.FilePickerRedwoodTheme,{hoveredState:n?"isHover":void 0,pseudoHoveredState:l?"isPseudoHover":void 0}),T=c.useRef(null),{validation:g,dragAndDropProps:x,pressProps:P}=M(e,T),D=r.mergeProps(P,x,a);E(x,g,e.testHandlersRef||null);const S=s.classNames([o,u,void 0===e.width&&d]),{translations:k,selectionMode:j}=e,{isTabbable:H}=p.useTabbableMode();return t.jsx("div",{class:s.classNames([S]),tabIndex:H?void 0:-1,role:"button","aria-label":v({ariaLabel:e["aria-label"],isDisabled:!1,translations:k,selectionMode:j}),ref:T,style:b(e.width,e.height),...i,...D,children:e.children})},E=(e,t,r)=>{c.useImperativeHandle(r,(()=>({onDragEnter:e.onDragEnter,onDragOver:e.onDragOver,onDrop:e.onDrop,onDragLeave:e.onDragLeave,onClickSelected:t})))};e.FilePicker=function({capture:e="none",isDisabled:r=!1,selectionMode:s="multiple",children:a,...n}){const l=n.__testHandlerSymbol,o={capture:e,selectionMode:s,translations:i.useTranslationBundle("@oracle/oraclejet-preact"),...n};return r?t.jsx(I,{...o,children:a}):a?t.jsx(_,{testHandlersRef:l,...o,children:a}):t.jsx(R,{testHandlersRef:l,...o})}}));
//# sourceMappingURL=FilePicker-e5a20eaa.js.map
