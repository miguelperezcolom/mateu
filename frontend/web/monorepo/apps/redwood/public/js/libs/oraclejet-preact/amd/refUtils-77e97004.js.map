{"version":3,"file":"refUtils-77e97004.js","sources":["../../src/utils/PRIVATE_refUtils/refUtils.ts"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport { Ref } from 'preact';\n\ntype CleanupFuncType = () => void;\nexport function assignRef<T>(ref: Ref<T> | undefined, value: T | null): void | CleanupFuncType {\n  if (ref == null) return;\n\n  if (typeof ref === 'function') {\n    return ref(value);\n  }\n\n  try {\n    ref.current = value;\n  } catch (error) {\n    throw new Error(`Cannot assign value '${value}' to ref '${ref}'`);\n  }\n}\n\nexport function mergeRefs<T>(...refs: (Ref<T> | undefined)[]) {\n  return (node: T | null) => {\n    let cleanupFunc;\n\n    // We need to keep track of cleanup functions from ref callbacks\n    // (Preact feature added in PR https://github.com/preactjs/preact/pull/4436).\n    // When cleanup functions are detected, create a wrapper around them\n    // that will be executed when a component is disconnected from DOM.\n    const cleanupFuncArray = refs.reduce<CleanupFuncType[]>((acc, ref) => {\n      const cleanupFunc = assignRef(ref, node);\n      if (typeof cleanupFunc === 'function') {\n        acc.push(cleanupFunc);\n      }\n      return acc;\n    }, []);\n\n    if (cleanupFuncArray.length > 0) {\n      cleanupFunc = () => {\n        cleanupFuncArray.forEach((func) => func());\n      };\n    }\n    return cleanupFunc;\n  };\n}\n"],"names":["assignRef","ref","value","current","error","Error","refs","node","cleanupFunc","cleanupFuncArray","reduce","acc","push","length","forEach","func"],"mappings":"6CAUgB,SAAAA,EAAaC,EAAyBC,GACpD,GAAW,MAAPD,EAAJ,CAEA,GAAmB,mBAARA,EACT,OAAOA,EAAIC,GAGb,IACED,EAAIE,QAAUD,CACf,CAAC,MAAOE,GACP,MAAM,IAAIC,MAAM,wBAAwBH,cAAkBD,KAC3D,CAVuB,CAW1B,2BAEgB,YAAgBK,GAC9B,OAAQC,IACN,IAAIC,EAMJ,MAAMC,EAAmBH,EAAKI,QAA0B,CAACC,EAAKV,KAC5D,MAAMO,EAAcR,EAAUC,EAAKM,GAInC,MAH2B,mBAAhBC,GACTG,EAAIC,KAAKJ,GAEJG,CAAG,GACT,IAOH,OALIF,EAAiBI,OAAS,IAC5BL,EAAc,KACZC,EAAiBK,SAASC,GAASA,KAAO,GAGvCP,CAAW,CAEtB"}