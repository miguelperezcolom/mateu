/**
 * @license
 * Copyright (c) 2014, 2025, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["exports","ojs/ojdvt-toolkit","ojs/ojdvt-timecomponent","ojs/ojtimeaxis-toolkit"],function(e,t,i,a){"use strict";var s={_DEFAULT_TIMEAXES_LABEL_STYLE:t.BaseComponentDefaults.FONT_FAMILY_ALTA_12+"color: #333333;",_DEFAULT_ZOOM_CONTROL_DIAMETER:31,_DEFAULT_ZOOM_CONTROL_PADDING:10.5,_DEFAULT_ZOOM_CONTROL_SPACING:9,_DEFAULT_COMPONENT_PADDING:0,_DEFAULT_STANDALONE_TASK_HEIGHT:22,_DEFAULT_BASELINE_MARGIN_TOP:0,_DEFAULT_BASELINE_TASK_HEIGHT:6,_DEFAULT_TASK_DOWNTIME_HEIGHT:4,_DEFAULT_TASK_ATTRIBUTE_HEIGHT:5,_DEFAULT_SUMMARY_THICKNESS:3,_DEFAULT_TASK_LABEL_PADDING:5,_DEFAULT_TASK_PADDING:5,_DEFAULT_TASK_EFFECT_MARGIN:2,_DEFAULT_TASK_TINT_FILTER_ID:"ojGanttTaskTintFilter",_DEFAULT_TASK_SHADE_FILTER_ID:"ojGanttTaskShadeFilter",_DEFAULT_TASK_TINT_ALPHA:.3,_DEFAULT_TASK_SHADE_ALPHA:.35,_DEFAULT_AXIS_HEIGHT:23,_ROW_LABELS_AXIS_GAP:0,_ROW_LABEL_EXPAND_COLLAPSE_BUTTON_SIZE:24,_ROW_LABEL_INDENT_SIZE:24,_ROW_LABEL_BUTTON_CONTENT_GAP_SIZE:8,_ROW_LABEL_CONTAINER_PADDING:8,_DEFAULT_DEPENDENCY_LINE_INNER_COLOR:"#ffffff",_DEFAULT_DEPENDENCY_LINE_INNER_WIDTH:2,_DEFAULT_ANIMATION_DURATION:.5,_DEPENDENCY_LINE_ARC_RADIUS:6,_DEPENDENCY_LINE_TASK_FLANK_LENGTH:20,_DEPENDENCY_TRIANGLE_MARKER_HEIGHT:8,_DEPENDENCY_TRIANGLE_MARKER_WIDTH:6,_DEPENDENCY_ANGLE_MARKER_HEIGHT:12,_DEPENDENCY_ANGLE_MARKER_WIDTH:8,_DEPENDENCY_CIRCLE_MARKER_RADIUS:3,_DEPENDENCY_TRIANGLE_MARKER_ID:"ojGanttDependencyMarkerEndTriangle",_DEPENDENCY_ANGLE_MARKER_ID:"ojGanttDependencyMarkerEndAngle",_DEPENDENCY_OPEN_CIRCLE_MARKER_ID:"ojGanttDependencyMarkerOpenCircle",_DEPENDENCY_CLOSED_CIRCLE_MARKER_ID:"ojGanttDependencyMarkerClosedCircle",_AUTOPAN_EDGE_THRESHOLD:20,_DEFAULT_TASK_RESIZE_HANDLE_WIDTH:5,_DEFAULT_TASK_RESIZE_HANDLE_WIDTH_TOUCH:20,getHorizontalScrollbarStyle:()=>new t.CSSStyle(s._DEFAULT_HORIZONTAL_SCROLLBAR_STYLE),getVerticalScrollbarStyle:()=>new t.CSSStyle(s._DEFAULT_VERTICAL_SCROLLBAR_STYLE),getStandaloneTaskHeight:e=>{var t=e?e._resources:null;return t&&t.taskDefaults&&null!=t.taskDefaults.height?s.getSizeInPixels(t.taskDefaults.height):s._DEFAULT_STANDALONE_TASK_HEIGHT},getActualTaskHeight:(e,t)=>"alta"===t.getThemeBehavior()?s.getStandaloneTaskHeight(e)-s.getBaselineMarginTop(e)-s.getBaselineTaskHeight(e):s.getStandaloneTaskHeight(e),getBaselineMarginTop:e=>{var t=e?e._resources:null;return t&&t.baselineMarginTop?s.getSizeInPixels(t.baselineMarginTop):s._DEFAULT_BASELINE_MARGIN_TOP},getBaselineTaskHeight:e=>{var t=e?e._resources:null;return t&&t.taskDefaults&&t.taskDefaults.baseline&&null!=t.taskDefaults.baseline.height?s.getSizeInPixels(t.taskDefaults.baseline.height):s._DEFAULT_BASELINE_TASK_HEIGHT},getTaskDowntimeHeight:e=>{var t=e?e._resources:null;return t&&t.taskDowntimeHeight?s.getSizeInPixels(t.taskDowntimeHeight):s._DEFAULT_TASK_DOWNTIME_HEIGHT},getTaskAttributeHeight:e=>{var t=e?e._resources:null;return t&&t.taskAttributeHeight?s.getSizeInPixels(t.taskAttributeHeight):s._DEFAULT_TASK_ATTRIBUTE_HEIGHT},getMilestoneBaselineYOffset:e=>s.getBaselineTaskHeight(e),getSummaryThickness:()=>s._DEFAULT_SUMMARY_THICKNESS,getRowPaddingTop:e=>{var t=e?e._resources:null;return t&&null!=t.rowPaddingTop?s.getSizeInPixels(t.rowPaddingTop):s._DEFAULT_TASK_PADDING},getRowPaddingBottom:e=>{var t=e?e._resources:null;return t&&null!=t.rowPaddingBottom?s.getSizeInPixels(t.rowPaddingBottom):s._DEFAULT_TASK_PADDING},getTaskPadding:e=>{var t=e?e._resources:null;return t&&null!=t.taskPaddingLeft?s.getSizeInPixels(t.taskPaddingLeft):s._DEFAULT_TASK_LABEL_PADDING},getTaskMargin:e=>{var t=e?e._resources:null;return t&&null!=t.taskMarginLeft?s.getSizeInPixels(t.taskMarginLeft):s._DEFAULT_TASK_LABEL_PADDING},getTaskLabelMargin:e=>{var t=e?e._resources:null;return t&&null!=t.taskLabelMarginLeft?s.getSizeInPixels(t.taskLabelMarginLeft):s._DEFAULT_TASK_LABEL_PADDING},getTaskEffectMargin:()=>s._DEFAULT_TASK_EFFECT_MARGIN,getTaskTintFilterId:()=>s._DEFAULT_TASK_TINT_FILTER_ID,getTaskShadeFilterId:()=>s._DEFAULT_TASK_SHADE_FILTER_ID,getTaskTintAlpha:()=>s._DEFAULT_TASK_TINT_ALPHA,getTaskShadeAlpha:()=>s._DEFAULT_TASK_SHADE_ALPHA,getTimeAxisHeight:(e,t)=>{var i=e[t];if(i&&i.height)return i.height;var a=e._resources;return a&&a[t]&&null!=a[t].height?s.getSizeInPixels(a[t].height):s._DEFAULT_AXIS_HEIGHT},getMajorAxisLabelStyle:e=>{var i=e._resources,a=s._DEFAULT_TIMEAXES_LABEL_STYLE;return i&&(a=i.majorAxisLabelFontProp),new t.CSSStyle(a)},getMinorAxisLabelStyle:e=>{var i=e._resources,a=s._DEFAULT_TIMEAXES_LABEL_STYLE;return i&&(a=i.minorAxisLabelFontProp),new t.CSSStyle(a)},getRowAxisGap:()=>s._ROW_LABELS_AXIS_GAP,getDependencyLineTaskFlankLength:()=>s._DEPENDENCY_LINE_TASK_FLANK_LENGTH,getDependencyLineArcRadius:e=>"alta"===e.getThemeBehavior()?0:s._DEPENDENCY_LINE_ARC_RADIUS,getDependencyLineTriangleMarkerWidth:()=>s._DEPENDENCY_TRIANGLE_MARKER_WIDTH,getDependencyLineTriangleMarkerHeight:()=>s._DEPENDENCY_TRIANGLE_MARKER_HEIGHT,getDependencyLineAngleMarkerWidth:()=>s._DEPENDENCY_ANGLE_MARKER_WIDTH,getDependencyLineAngleMarkerHeight:()=>s._DEPENDENCY_ANGLE_MARKER_HEIGHT,getDependencyLineCircleMarkerRadius:()=>s._DEPENDENCY_CIRCLE_MARKER_RADIUS,getDependencyLineTriangleMarkerId:()=>s._DEPENDENCY_TRIANGLE_MARKER_ID,getDependencyLineAngleMarkerId:()=>s._DEPENDENCY_ANGLE_MARKER_ID,getDependencyLineOpenCircleMarkerId:()=>s._DEPENDENCY_OPEN_CIRCLE_MARKER_ID,getDependencyLineClosedCircleMarkerId:()=>s._DEPENDENCY_CLOSED_CIRCLE_MARKER_ID,getDependencyLineTaskGap:e=>s.getRowPaddingTop(e)-1,getAutoPanEdgeThreshold:()=>s._AUTOPAN_EDGE_THRESHOLD,getTaskLabelStyle:e=>{var i=e._resources,a="";return i&&(a=i.taskLabelFontProp),new t.CSSStyle(a)},getRowLabelStyle:e=>{var i=e._resources,a="";return i&&(a=i.rowLabelFontProp),new t.CSSStyle(a)},getRowLabelPaddingStart:e=>{var t=e?e._resources:null;return t&&null!=t.rowLabelPaddingStart?s.getSizeInPixels(t.rowLabelPaddingStart):s._ROW_LABEL_CONTAINER_PADDING},getRowLabelPaddingEnd:e=>{var t=e?e._resources:null;return t&&null!=t.rowLabelPaddingEnd?s.getSizeInPixels(t.rowLabelPaddingEnd):s._ROW_LABEL_CONTAINER_PADDING},getRowLabelButtonSize:()=>s._ROW_LABEL_EXPAND_COLLAPSE_BUTTON_SIZE,getRowLabelIndentSize:()=>s._ROW_LABEL_INDENT_SIZE,getRowLabelButtonContentGapSize:()=>s._ROW_LABEL_BUTTON_CONTENT_GAP_SIZE,getChartStrokeWidth:e=>{var i=e._resources;if(i){var a=i.chartArea;if(a){var s=a.strokeWidth;if(s)return t.CSSStyle.toNumber(s)}}return 1},getComponentPaddingStart:e=>{var t=e?e._resources:null;return t&&null!=t.componentPaddingStart?s.getSizeInPixels(t.componentPaddingStart):s._DEFAULT_COMPONENT_PADDING},getHorizontalGridlineWidth:e=>e._resources?t.CSSStyle.toNumber(e._resources.horizontalGridlineWidth):1,getAnimationDuration:e=>{var i,a=s._DEFAULT_ANIMATION_DURATION;return e._resources&&(i=e._resources.animationDuration)&&(a=t.CSSStyle.getTimeMilliseconds(i)/1e3),a},getFocusedDependencyLineInnerColor:()=>s._DEFAULT_DEPENDENCY_LINE_INNER_COLOR,getFocusedDependencyLineInnerWidth:()=>s._DEFAULT_DEPENDENCY_LINE_INNER_WIDTH,getTaskResizeHandleWidth:()=>t.Agent.isTouchDevice()?s._DEFAULT_TASK_RESIZE_HANDLE_WIDTH_TOUCH:s._DEFAULT_TASK_RESIZE_HANDLE_WIDTH,getSizeInPixels:(e,t)=>{if("string"==typeof e){if("%"===e.slice(-1))return t*Number(e.slice(0,-1))/100;if("px"===e.slice(-2))return Number(e.slice(0,-2));e=Number(e)}return"number"==typeof e?e<=1&&null!=t?t*e:e:0},hasClass:(e,t)=>e.getElem().classList.contains(t)};class n extends t.Container{constructor(e){super(e.getCtx(),null),this._gantt=e,this._gantt.getEventManager().associate(this,this),this.nodeType="dependency"}getGantt(){return this._gantt}getId(){return this._dependencyObj.id}setLayoutObject(e){this._dependencyObj=e}getLayoutObject(){return this._dependencyObj}getValue(e){var t;switch(e){case"type":t=this._dependencyObj.type;break;case"predecessorTaskId":t=this._dependencyObj.predecessorTaskObj.id;break;case"successorTaskId":t=this._dependencyObj.successorTaskObj.id;break;default:t=this._dependencyObj.data[e]}return t}getPredecessorNode(){return this._dependencyObj.predecessorTaskObj.node}getSuccessorNode(){return this._dependencyObj.successorTaskObj.node}static _getTaskStart(e,i){var a=t.Agent.isRightToLeft(e.getGantt().getCtx()),n=e.getGantt().getOptions(),r=e.getTask().getShape("main"),o=e.getTaskLabel(),h=o.getLabelOutputText(),l=o.getEffectiveLabelPosition(),d=s.getTaskLabelMargin(n),g=i?0:s.getTaskMargin(n);return a?i||null==h||null==h.getParent()||"end"!==l?e.getFinalX()+r.getFinalX()-r.getFinalWidth()-r.getPhysicalEndOffset()-g:e.getFinalX()+r.getFinalX()-r.getFinalWidth()-r.getPhysicalEndOffset()-h.getDimensions().w-2*d:i||null==h||null==h.getParent()||"start"!==l?e.getFinalX()+r.getFinalX()-r.getPhysicalStartOffset()-g:e.getFinalX()+r.getFinalX()-r.getPhysicalStartOffset()-h.getDimensions().w-2*d}static _getTaskMiddle(e){var t=e.getTask(),i=t.getShape("main"),a=e.getGantt().getCtx().getThemeBehavior(),s=t.isSummary("main")&&"alta"===a?e.getLayoutObject().height:i.getFinalHeight();return n._getTaskTop(e)+i.getFinalY()+Math.round(s/2)}static _getTaskEnd(e,i){var a=t.Agent.isRightToLeft(e.getGantt().getCtx()),n=e.getGantt().getOptions(),r=e.getTask().getShape("main"),o=e.getTaskLabel(),h=o.getLabelOutputText(),l=o.getEffectiveLabelPosition(),d=s.getTaskLabelMargin(n),g=i?0:s.getTaskMargin(n);return a?i||null==h||null==h.getParent()||"start"!==l?e.getFinalX()+r.getFinalX()+r.getPhysicalStartOffset()+g:e.getFinalX()+r.getFinalX()+r.getPhysicalStartOffset()+h.getDimensions().w+2*d:i||null==h||null==h.getParent()||"end"!==l?e.getFinalX()+r.getFinalX()+r.getFinalWidth()+r.getPhysicalEndOffset()+g:e.getFinalX()+r.getFinalX()+r.getFinalWidth()+r.getPhysicalEndOffset()+h.getDimensions().w+2*d}static _getTaskTop(e){return e.getFinalY()}static _getTaskBottom(e,t){var i=t?e.getLayoutObject().height:e.getFinalHeight();return n._getTaskTop(e)+i}static _isValidType(e){return e===n.START_START||e===n.START_FINISH||e===n.FINISH_START||e===n.FINISH_FINISH}isCustomContent(){var e=this._gantt.getOptions();return e.dependencyContent&&e.dependencyContent.renderer}getRendererContext(e){var t=this._gantt.getOptions(),i=this._gantt.getCtx(),a=this.getValue("type"),s=this.getPredecessorNode(),r=this.getSuccessorNode(),o=n._getRenderingTypeState(i,a),h=n._getEndPoints(s,r,o.isTypeBeginFinish,o.isTypeEndFinish,!0,!0),l={data:this.getLayoutObject().data,itemData:t.dependencyData?this.getLayoutObject()._itemData:null,content:{predecessorX:h.predecessorX,predecessorY:h.predecessorY,successorX:h.successorX,successorY:h.successorY},state:e};return i.fixRendererContext(l)}_renderCustomContent(e){var i=this.getGantt(),a=i.getOptions();this._content&&this.removeChild(this._content),this._content=new t.Container(i.getCtx()),this._content.setClassName(i.GetStyleClass("dependencyLineCustom")),this.addChild(this._content);var s=this._content.getContainerElem(),n=(0,a.dependencyContent.renderer)(this.getRendererContext(e));n&&(Array.isArray(n)?n.forEach(e=>{t.ToolkitUtils.appendChildElem(s,e)}):t.ToolkitUtils.appendChildElem(s,n))}render(e,i){i=!1!==i;this.getParent()!=e&&e.addChild(this),this.setAriaRole("img");var a=this.getGantt(),r=a.getCtx(),o=this.getValue("type"),h=this.getPredecessorNode(),l=this.getSuccessorNode();if(t.Agent.deferAriaCreation()||this.setAriaProperty("label",this.getAriaLabel()),this.isCustomContent())this._content&&!i||this._renderCustomContent({focused:!1});else{if("ie"!==t.Agent.browser&&"edge"!==t.Agent.browser||this._cleanup(),null!=this._line){this._line.setCmds(n._calcDepLine(r,h,l,o));var d=this._line.getElem()}else{var g=new t.Path(r,n._calcDepLine(r,h,l,o));0===s.getDependencyLineArcRadius(r)&&g.setPixelHinting(!0),d=g.getElem(),this.addChild(g);var _=new t.Stroke(s.getFocusedDependencyLineInnerColor(),1,s.getFocusedDependencyLineInnerWidth()),c=new t.Stroke("#000",1,1);g.setHoverStroke(_,c),this._line=g}var u=this.getValue("svgStyle");u&&this._line.setStyle(u);var p=a.GetStyleClass("dependencyLine");"straight"===a.getOptions().dependencyLineShape?(p+=" "+a.GetStyleClass("dependencyStraightLine"),h.isSelected()?p+=" "+a.GetStyleClass("dependencyStartOpenStraightLine"):p+=" "+a.GetStyleClass("dependencyStartClosedStraightLine"),l.isSelected()?p+=" "+a.GetStyleClass("dependencyEndOpenStraightLine"):p+=" "+a.GetStyleClass("dependencyEndClosedStraightLine")):p+=" "+a.GetStyleClass("dependencyRectilinearLine");var m=this.getValue("svgClassName");m?t.ToolkitUtils.setAttrNullNS(d,"class",p+" "+m):t.ToolkitUtils.setAttrNullNS(d,"class",p)}}hide(){this.setAlpha(0)}show(){this.setAlpha(1)}_cleanup(){null!=this._line&&(this.removeChild(this._line),this._line=null)}_calcConflict(){var e=!1,t=!1,i=this.getValue("type"),a=this.getGantt().getNavigableDependencyLinesForTask(this.getPredecessorNode(),"predecessor");if(null!=a)for(var s=0;s<a.length;s++){var r=a[s].getValue("type");(i!==n.START_START&&i!==n.START_FINISH||r!==n.START_START&&r!==n.FINISH_START)&&(i!==n.FINISH_FINISH&&i!==n.FINISH_START||r!==n.FINISH_FINISH&&r!==n.START_FINISH)||(e=!0)}if(null!=(a=this.getGantt().getNavigableDependencyLinesForTask(this.getSuccessorNode(),"successor")))for(s=0;s<a.length;s++)r=a[s].getValue("type"),(i!==n.START_START&&i!==n.FINISH_START||r!==n.START_START&&r!==n.START_FINISH)&&(i!==n.FINISH_FINISH&&i!==n.START_FINISH||r!==n.FINISH_FINISH&&r!==n.FINISH_START)||(t=!0);return e&&t?n.CONFLICT_BOTH:e?n.CONFLICT_PREDECESSOR:t?n.CONFLICT_SUCCESSOR:n.CONFLICT_NONE}static _getEndPoints(e,t,i,a,s,r){return{predecessorX:i?n._getTaskEnd(e,s):n._getTaskStart(e,s),predecessorY:r||e.getTask().isMilestone("main")?n._getTaskMiddle(e):n._getTaskBottom(e,!0),successorX:a?n._getTaskEnd(t,s):n._getTaskStart(t,s),successorY:r||t.getTask().isMilestone("main")?n._getTaskMiddle(t):n._getTaskTop(t)}}static _getRenderingTypeState(e,i){var a=t.Agent.isRightToLeft(e);switch(i){case n.START_START:return a?{isTypeBeginFinish:!0,isTypeEndFinish:!0}:{isTypeBeginFinish:!1,isTypeEndFinish:!1};case n.START_FINISH:return a?{isTypeBeginFinish:!0,isTypeEndFinish:!1}:{isTypeBeginFinish:!1,isTypeEndFinish:!0};case n.FINISH_START:return a?{isTypeBeginFinish:!1,isTypeEndFinish:!0}:{isTypeBeginFinish:!0,isTypeEndFinish:!1};case n.FINISH_FINISH:return a?{isTypeBeginFinish:!1,isTypeEndFinish:!1}:{isTypeBeginFinish:!0,isTypeEndFinish:!0}}return null}static _calcDepLine(e,t,i,a){var s=this._getRenderingTypeState(e,a);return"straight"===t.getGantt().getOptions().dependencyLineShape?n._calcStraightLine(t,i,s.isTypeBeginFinish,s.isTypeEndFinish):n._calcRectilinearLine(t,i,s.isTypeBeginFinish,s.isTypeEndFinish)}static _calcStraightLine(e,i,a,s){var r=n._getEndPoints(e,i,a,s,!0,!1),o=r.predecessorX,h=r.successorX,l=r.predecessorY,d=r.successorY;return t.PathUtils.moveTo(o,l)+t.PathUtils.lineTo(h,d)}static _calcRectilinearLine(e,i,a,r){var o=e.getGantt(),h=s.getDependencyLineArcRadius(o.getCtx()),l=s.getDependencyLineTaskFlankLength(),d=n._getEndPoints(e,i,a,r,!1,!0),g=d.predecessorX,_=d.successorX,c=d.predecessorY,u=d.successorY,p=o.getOptions(),m=s.getDependencyLineTaskGap(p),b=u>=c?n._getTaskBottom(e)+m:n._getTaskTop(e)-m;g=Math.round(g)+.5,_=Math.round(_)+.5,c=Math.round(c)+.5,u=Math.round(u)+.5,b=Math.round(b)+.5;var v=g+(a?1:-1)*l,S=r?_+l:_-l,D=t.PathUtils.moveTo(g,c);return a&&S<v||!a&&S>v?(D+=t.PathUtils.horizontalLineTo(v+(a?-1:1)*h),u>c?(D+=t.PathUtils.arcTo(h,h,Math.PI/2,a?1:0,v,c+h),a&&r||!a&&!r?(D+=t.PathUtils.verticalLineTo(u-h),D+=t.PathUtils.arcTo(h,h,Math.PI/2,a?1:0,v+(a?-1:1)*h,u)):(D+=t.PathUtils.verticalLineTo(b-h),D+=t.PathUtils.arcTo(h,h,Math.PI/2,a?1:0,v+(a?-1:1)*h,b),D+=t.PathUtils.horizontalLineTo(S+(a?1:-1)*h),D+=t.PathUtils.arcTo(h,h,Math.PI/2,a?0:1,S,b+h),D+=t.PathUtils.verticalLineTo(u-h),D+=t.PathUtils.arcTo(h,h,Math.PI/2,a?0:1,S+(a?1:-1)*h,u))):u<c?(D+=t.PathUtils.arcTo(h,h,Math.PI/2,a?0:1,v,c-h),a&&r||!a&&!r?(D+=t.PathUtils.verticalLineTo(u+h),D+=t.PathUtils.arcTo(h,h,Math.PI/2,a?0:1,v+(a?-1:1)*h,u)):(D+=t.PathUtils.verticalLineTo(b+h),D+=t.PathUtils.arcTo(h,h,Math.PI/2,a?0:1,v+(a?-1:1)*h,b),D+=t.PathUtils.horizontalLineTo(S+(a?1:-1)*h),D+=t.PathUtils.arcTo(h,h,Math.PI/2,a?1:0,S,b-h),D+=t.PathUtils.verticalLineTo(u+h),D+=t.PathUtils.arcTo(h,h,Math.PI/2,a?1:0,S+(a?1:-1)*h,u))):(D+=t.PathUtils.arcTo(h,h,Math.PI/2,a?1:0,v,c+h),D+=t.PathUtils.verticalLineTo(b-h),D+=t.PathUtils.arcTo(h,h,Math.PI/2,a?1:0,v+(a?-1:1)*h,b),D+=t.PathUtils.horizontalLineTo(S+(a?1:-1)*h),D+=t.PathUtils.arcTo(h,h,Math.PI/2,a?1:0,S,b-h),D+=t.PathUtils.verticalLineTo(u+h),D+=r?t.PathUtils.arcTo(h,h,Math.PI/2,0,S-h,u):t.PathUtils.arcTo(h,h,Math.PI/2,1,S+h,u))):u>c?(D+=t.PathUtils.horizontalLineTo(S+(a?-1:1)*h),D+=t.PathUtils.arcTo(h,h,Math.PI/2,a?1:0,S,c+h),D+=t.PathUtils.verticalLineTo(u-h),D+=r?t.PathUtils.arcTo(h,h,Math.PI/2,1,S-h,u):t.PathUtils.arcTo(h,h,Math.PI/2,0,S+h,u)):u<c?(D+=t.PathUtils.horizontalLineTo(S+(a?-1:1)*h),D+=t.PathUtils.arcTo(h,h,Math.PI/2,a?0:1,S,c-h),D+=t.PathUtils.verticalLineTo(u+h),D+=r?t.PathUtils.arcTo(h,h,Math.PI/2,0,S-h,u):t.PathUtils.arcTo(h,h,Math.PI/2,1,S+h,u)):(a&&r||!a&&!r)&&(D+=t.PathUtils.horizontalLineTo(v+(a?-1:1)*h),D+=t.PathUtils.arcTo(h,h,Math.PI/2,a?1:0,v,c+h),D+=t.PathUtils.verticalLineTo(b-h),D+=t.PathUtils.arcTo(h,h,Math.PI/2,a?0:1,v+(a?1:-1)*h,b),D+=t.PathUtils.horizontalLineTo(S-h),D+=t.PathUtils.arcTo(h,h,Math.PI/2,a?0:1,S,b-h),D+=t.PathUtils.verticalLineTo(u+h),D+=t.PathUtils.arcTo(h,h,Math.PI/2,a?0:1,S+(a?-1:1)*h,u)),D+=t.PathUtils.lineTo(_,u)}getNextNavigable(e){if(e.keyCode===t.KeyboardEvent.UP_ARROW||e.keyCode===t.KeyboardEvent.DOWN_ARROW){var i=this.getKeyboardFocusTask();i||(i=this.getPredecessorNode());var a=this,s=this.getGantt().getEventManager().getKeyboardHandler();if(s&&s.getNextNavigableDependencyLine){var n=i===this.getPredecessorNode()?"successor":"predecessor",r=this.getGantt().getNavigableDependencyLinesForTask(i,n);a=s.getNextNavigableDependencyLine(i,this,e,r)}return a.setKeyboardFocusTask(i),a}return e.keyCode===t.KeyboardEvent.RIGHT_ARROW||e.keyCode===t.KeyboardEvent.LEFT_ARROW?t.Agent.isRightToLeft(this.getGantt().getCtx())?e.keyCode===t.KeyboardEvent.LEFT_ARROW?this.getSuccessorNode():this.getPredecessorNode():e.keyCode===t.KeyboardEvent.RIGHT_ARROW?this.getSuccessorNode():this.getPredecessorNode():e.type===t.MouseEvent.CLICK?this:null}setKeyboardFocusTask(e){this._keyboardNavNode=e}getKeyboardFocusTask(){return this._keyboardNavNode}getKeyboardBoundingBox(e){return this.getDimensions(e)}getTargetElem(){return this._content?this._content.getContainerElem():this._line.getElem()}showKeyboardFocusEffect(){this.isCustomContent()?(this._renderCustomContent({focused:!0}),this._isShowingKeyboardFocusEffect=!0):this._line&&(t.ToolkitUtils.addClassName(this._line.getElem(),this._gantt.GetStyleClass("focus")),this._line.showHoverEffect(),this._isShowingKeyboardFocusEffect=!0)}hideKeyboardFocusEffect(){this.isShowingKeyboardFocusEffect()&&(this.isCustomContent()?this._renderCustomContent({focused:!1}):(this._line.hideHoverEffect(),t.ToolkitUtils.removeClassName(this._line.getElem(),this._gantt.GetStyleClass("focus"))),this._isShowingKeyboardFocusEffect=!1)}isShowingKeyboardFocusEffect(){return this._isShowingKeyboardFocusEffect}getDatatip(e,t,i){return this.getAriaLabel()}getAriaLabel(){return this._dependencyObj.ariaLabel}}n.START_START="startStart",n.START_FINISH="startFinish",n.FINISH_START="finishStart",n.FINISH_FINISH="finishFinish",n.CONFLICT_NONE=0,n.CONFLICT_PREDECESSOR=1,n.CONFLICT_SUCCESSOR=2,n.CONFLICT_BOTH=3;class r{constructor(e,t){this._rowAxis=e,this._gantt=e._gantt,this._contentType=t,this.nodeType="rowLabel"}render(e){var i=e.data;this._labelString=null!=i.label?i.label:"";var a=null!=i.shortDesc?i.shortDesc:"";this._shortDesc="function"==typeof a?a({data:e.data,itemData:e.data._itemData}):a;var s=t.Agent.isRightToLeft(this._gantt.getCtx()),n=this._rowAxis.getAvailableWidth();this._contentBackground||(this._contentBackground=new t.Rect(this._gantt.getCtx(),0,e.y,0,e.height),this._contentBackground.setPixelHinting(!0),this._contentBackground.setClassName(this._gantt.GetStyleClass("row")),this._gantt.getEventManager().associate(this._contentBackground,this,!0)),this._rowAxis.addLabelBackground(this._contentBackground,e.isSticky),this._content||(this._content="custom"===this._contentType?this._getCustomContent(e,n):this._getTextContent(e),this._content.setAriaRole("rowheader",!0)),this._contentDisplayable||(this._contentDisplayable=this._gantt.isRowsHierarchical()?this._addExpandCollapseButton(this._content,e):this._content,this._gantt.getEventManager().associate(this._contentDisplayable,this,!0),this._contentDisplayableContainer=this._contentDisplayable,this._gantt.isRowsHierarchical()||(this._contentDisplayableContainer=new t.Container(this._gantt.getCtx()),this._contentDisplayableContainer.addChild(this._contentDisplayable)),this._contentDisplayableContainer.setAriaRole("row",!0)),this._rowAxis.addLabelContent(this._contentDisplayableContainer,e.isSticky);var r=this._contentDisplayable.getDimensions();"g"===this.getDisplayableType()?(this._width=s?-Math.min(0,r.x):r.x+r.w,this._width=Math.max(0,this._width),this._yTopOFfset=r.y):(this._width=Math.min(r.w,n.calculatedWidth),this._yTopOFfset=0),this._height=r.h,this._contentDisplayable.setAriaProperty("label",this.getAriaLabel()),this._contentDisplayable.setAriaProperty("hidden",null)}_getCustomContent(e,i){var a=e.data,n=new t.Container(this._gantt.getCtx()),r=a.labelStyle;null!=r&&n.setStyle(r);var o=this._gantt.getOptions(),h=o.rowAxis.label.renderer,l=s.getRowLabelPaddingStart(o)+s.getRowLabelPaddingEnd(o),d=this._gantt.getRowAxisMaxWidth();if(-1===i.width&&null!=d&&"none"===d)var g=-1;else g=this._gantt.isRowsHierarchical()?Math.max(0,i.calculatedWidth-this._rowAxis.getLabelContentIndentSize(e))-l:Math.max(0,i.calculatedWidth-l);var _=e.height,c=n.getContainerElem(),u=h(this.getRendererContext(e,g,_,c));return u&&(Array.isArray(u)?u.forEach(e=>{t.ToolkitUtils.appendChildElem(c,e)}):t.ToolkitUtils.appendChildElem(c,u)),n}_getTextContent(e){var i=e.data,a=new t.OutputText(this._gantt.getCtx(),this._labelString,0,0),s=i.labelStyle;return null!=s&&""!==s&&0!==Object.keys(s).length&&a.setStyle(s),a.setCSSStyle(this._rowAxis._getCSSStyle(s)),a}_addExpandCollapseButton(e,i){var a=t.Agent.isRightToLeft(this._gantt.getCtx()),n=new t.Container(this._gantt.getCtx()),r=this._rowAxis.getLabelContentIndentSize(i),o=a?-r:r;if(a&&"text"===this._contentType&&(o-=e.getDimensions().w),e.setTranslateX(o),n.addChild(e),this._rowAxis.addLabelContent(n,i.isSticky),null!=i.expanded){var h=s.getRowLabelButtonSize(),l=r-(h+s.getRowLabelButtonContentGapSize());l=a?-(l+h):l;var d=(e.getDimensions().h-h)/2,g=this._gantt.getEventManager(),_=this._createExpandCollapseButton(this._gantt.getCtx(),this._gantt.getOptions()._resources,i.expanded?"open":"closed",l,d,h,g.onExpandCollapseButtonClick,g);this._button=_,n.addChild(_)}else this._button=null;return n}_createExpandCollapseButton(e,i,a,s,n,r,o,h){var l=t.ToolkitUtils.getIconStyle(e,i[a]),d=new t.IconButton(e,"borderless",{style:l,size:r},null,null,o,h);return d.setTranslate(s,n),d.setAriaRole("button"),d.setAriaProperty("label",this.getAriaLabel()),this._gantt.getEventManager().associate(d,this),d}getRendererContext(e,t,a,s){var n=this._gantt.getOptions(),r=this._gantt.getDataLayoutManager(),o=e.data,h=o.tasks,l=[],d=n.rowData||n.taskData;if(d)for(var g=0;g<h.length;g++)l.push(h[g]._itemData);var _=r.getParentRowObj(e),c={component:n._widgetConstructor,parentElement:s,rowData:i.TimeComponent.sanitizeData(o,"row"),itemData:d?l:null,maxWidth:t,maxHeight:a,data:n.rowData?o._itemData:null,depth:e.depth,leaf:null==e.expanded,parentKey:_?_.id:null};return this._gantt.getCtx().fixRendererContext(c)}getRow(){return this._rowNode}setRow(e){this._rowNode=e}getRowIndex(){return this._rowIndex}setRowIndex(e){this._rowIndex=e}getRowLayoutObject(){return this._gantt.getRowLayoutObjs()[this.getRowIndex()]}getDisplayable(){return this._contentDisplayable}getDisplayableContainer(){return this._contentDisplayableContainer}getBackground(){return this._contentBackground}getExpandCollapseButton(){return this._button}getLabelString(){return this._labelString}getDisplayableType(){return this._gantt.isRowsHierarchical()||"custom"===this._contentType?"g":"text"}getContentType(){return this._contentType}getX(){return"text"===this.getDisplayableType()?this._contentDisplayable.getX():this._contentDisplayable.getTranslateX()}setX(e){"text"===this.getDisplayableType()?this._contentDisplayable.setX(e):this._contentDisplayable.setTranslateX(e)}getY(){return"text"===this.getDisplayableType()?this._contentDisplayable.getY():this._contentDisplayable.getTranslateY()}setY(e){"text"===this.getDisplayableType()?this._contentDisplayable.setY(e):this._contentDisplayable.setTranslateY(e)}getWidth(){return this._width}getHeight(){return this._height}getYTopOffset(){return this._yTopOFfset}getAriaLabel(){var e=this._gantt.getOptions().translations,i=[],a=this.getRowLayoutObject();null!=a.expanded&&i.push(e[a.expanded?"stateExpanded":"stateCollapsed"]);var s=this._shortDesc||this.getLabelString();return this._gantt.isRowsHierarchical()&&(s=e.labelLevel+" "+a.depth+", "+s),t.Displayable.generateAriaLabel(s,i)}ensureInDOM(){const e=this.getRowLayoutObject();this._rowAxis.addLabelBackground(this._contentBackground,e?.isSticky),this._rowAxis.addLabelContent(this._contentDisplayableContainer,e?.isSticky)}remove(){this._rowAxis.removeLabelBackground(this._contentBackground),this._rowAxis.removeLabelContent(this._contentDisplayableContainer)}getNextNavigable(e){var i=t.Agent.isRightToLeft(this._gantt.getCtx()),a=this._gantt.getEventManager(),s=this._gantt.getDataLayoutManager(),n=this._gantt.getRowLayoutObjs(),r=this.getRowLayoutObject();if(e.altKey&&(!i&&e.keyCode===t.KeyboardEvent.RIGHT_ARROW||i&&e.keyCode===t.KeyboardEvent.LEFT_ARROW)){if(0===r.taskObjs.length)return this;var o=a.getLastFocusedItem();if(o&&t.Obj.compareValues(this._gantt.getCtx(),o.getLayoutObject().rowObj.id,r.id))return s.ensureInDOM(o.getLayoutObject(),"task"),o;var h=r.taskObjs[0];s.ensureInDOM(h,"task");var l=h.node;return a.setLastFocusedItem(l),l}if(e.keyCode===t.KeyboardEvent.UP_ARROW){var d=n[Math.max(0,r.index-1)];return s.ensureInDOM(d,"row"),d.node.getRowLabelContent()}if(e.keyCode===t.KeyboardEvent.DOWN_ARROW){var g=n[Math.min(n.length-1,r.index+1)];return s.ensureInDOM(g,"row"),g.node.getRowLabelContent()}return this}getTargetElem(){return this._contentDisplayable.getElem()}getKeyboardBoundingBox(e){return this._contentDisplayable.getDimensions(e)}showKeyboardFocusEffect(){this._isShowingKeyboardFocusEffect=!0,this.getRowLayoutObject().node.scrollIntoView(!0);var e=this._contentBackground.getElem();t.ToolkitUtils.addClassName(e,this._gantt.GetStyleClass("focusHighlight"))}hideKeyboardFocusEffect(){var e=this._contentBackground.getElem();t.ToolkitUtils.removeClassName(e,this._gantt.GetStyleClass("focusHighlight")),this._isShowingKeyboardFocusEffect=!1}isShowingKeyboardFocusEffect(){return this._isShowingKeyboardFocusEffect}getDatatip(){return this._shortDesc}}class o extends t.Path{constructor(e,t,i,a,s,n,r,o,h){var l;switch(super(e,null,h),this._context=e,this._x=t,this._y=i,this._w=a,this._h=s,this._r=null!=n?n:"0",this._task=r,this._type=o,this._isHighlighted=!1,this._renderState="add",this._typeCmdGeneratorMap={main:this._generateRepShapeCmd,mainBackground:this._generateRepShapeCmd,mainSelect:this._generateRepShapeCmd,mainHover:this._generateRepShapeCmd,mainFocus:this._generateRepShapeCmd,mainDragFeedback:this._generateRepShapeCmd,mainResizeHandleStart:this._generateRectCmd,mainResizeHandleEnd:this._generateRectCmd,mainResizeHandleDragFeedback:this._generateRectCmd,progress:this._generateRectCmd,progressZero:this._generateRectCmd,progressFull:this._generateRectCmd,baseline:this._generateRepShapeCmd,baselineSelect:this._generateRepShapeCmd,baselineHover:this._generateRepShapeCmd,overtime:this._generateRectCmd,downtime:this._generateRectCmd,attribute:this._generateRectCmd},l=this.generateCmd(this._x,this._y,this._w,this._h,this._r),this.setCmds(l),this.applyStyleClasses(),this._type){case"mainDragFeedback":case"mainResizeHandleDragFeedback":this.setMouseEnabled(!1);case"mainResizeHandleStart":case"mainResizeHandleEnd":r.getGantt().getEventManager().associate(this,r.getContainer());case"main":case"progress":case"progressZero":case"progressFull":case"baseline":case"overtime":case"downtime":case"attribute":this.setPixelHinting("alta"===e.getThemeBehavior())}}_generateRepShapeCmd(e,i,a,n,r){var h,l=t.Agent.isRightToLeft(this._context),d=(o.MAIN_EFFECT_TYPES.indexOf(this._type)>-1||o.BASELINE_EFFECT_TYPES.indexOf(this._type)>-1)*s.getTaskEffectMargin();return"alta"!==this._context.getThemeBehavior()&&"mainHover"===this._type&&(d=0),this._task.isMilestone(this._type)&&0===a?(h=d*Math.sqrt(2),this._generateDiamondCmd(e,i-h,n+2*h,r)):this._task.isSummary(this._type)&&"main"===this._type?this._generateSummaryCmd(e,i,a,n,r):this._generateRectCmd(l?e+d:e-d,i-d,a+2*d,n+2*d,r)}_generateRectCmd(e,i,a,s,n){var r=t.Agent.isRightToLeft(this._context);return"0"===n||"0px"===n?t.PathUtils.moveTo(e,i)+t.PathUtils.horizontalLineTo(r?e-a:e+a)+t.PathUtils.verticalLineTo(i+s)+t.PathUtils.horizontalLineTo(e)+t.PathUtils.closePath():t.PathUtils.rectangleWithBorderRadius(e-r*a,i,a,s,n,Math.min(a,s),"0")}_generateSummaryCmd(e,i,a,n,r){if("alta"===this._context.getThemeBehavior()){var o=t.Agent.isRightToLeft(this._context),h=s.getSummaryThickness();if("0"===r||"0px"===r)return a>2*h?t.PathUtils.moveTo(e,i+n)+t.PathUtils.verticalLineTo(i)+t.PathUtils.horizontalLineTo(o?e-a:e+a)+t.PathUtils.verticalLineTo(i+n)+t.PathUtils.horizontalLineTo(o?e-a+h:e+a-h)+t.PathUtils.verticalLineTo(i+h)+t.PathUtils.horizontalLineTo(o?e-h:e+h)+t.PathUtils.verticalLineTo(i+n)+t.PathUtils.closePath():this._generateRectCmd(e,i,a,n,r);var l=Math.min(new t.CSSStyle({"border-radius":r}).getBorderRadius(),Math.min(a,n)),d=Math.max(l-h,0);return a>2*h?t.PathUtils.moveTo(e,i+n)+t.PathUtils.verticalLineTo(i+l)+t.PathUtils.arcTo(l,l,Math.PI/2,o?0:1,o?e-l:e+l,i)+t.PathUtils.horizontalLineTo(o?e-a+l:e+a-l)+t.PathUtils.arcTo(l,l,Math.PI/2,o?0:1,o?e-a:e+a,i+l)+t.PathUtils.verticalLineTo(i+n)+t.PathUtils.horizontalLineTo(o?e-a+h:e+a-h)+t.PathUtils.verticalLineTo(i+h+d)+t.PathUtils.arcTo(d,d,Math.PI/2,o?1:0,o?e-a+h+d:e+a-h-d,i+h)+t.PathUtils.horizontalLineTo(o?e-h-d:e+h+d)+t.PathUtils.arcTo(d,d,Math.PI/2,o?1:0,o?e-h:e+h,i+h+d)+t.PathUtils.verticalLineTo(i+n)+t.PathUtils.closePath():t.PathUtils.rectangleWithBorderRadius(e-o*a,i,a,n,l+"px "+l+"px 0px 0px",Math.min(a,n),"0")}return this._generateRectCmd(e,i,a,n,r)}_generateDiamondCmd(e,i,a,s){var n=a/2;if("0"===s||"0px"===s)return t.PathUtils.moveTo(e,i)+t.PathUtils.lineTo(e+n,i+n)+t.PathUtils.lineTo(e,i+a)+t.PathUtils.lineTo(e-n,i+n)+t.PathUtils.closePath();var r=Math.min(new t.CSSStyle({"border-radius":s}).getBorderRadius(),a/(2*Math.sqrt(2))),o=r/Math.sqrt(2),h=r,l=r;return t.PathUtils.moveTo(e-o,i+o)+t.PathUtils.arcTo(h,l,0,1,e+o,i+o)+t.PathUtils.lineTo(e+n-o,i+n-o)+t.PathUtils.arcTo(h,l,0,1,e+n-o,i+n+o)+t.PathUtils.lineTo(e+o,i+a-o)+t.PathUtils.arcTo(h,l,0,1,e-o,i+a-o)+t.PathUtils.lineTo(e-n+o,i+n+o)+t.PathUtils.arcTo(h,l,0,1,e-n+o,i+n-o)+t.PathUtils.closePath()}generateCmd(e,t,i,a,s){var n=this._task.getGantt(),r=n.getRenderingPrecision();return null===r?this._typeCmdGeneratorMap[this._type].call(this,e,t,i,a,s):this._typeCmdGeneratorMap[this._type].call(this,n.round(e,r),n.round(t,r),n.round(i,r),n.round(a,r),s)}getDefaultStyleClasses(){let e,t,i,a;const s=this._task.getGantt(),n=s.getEventManager().IsDragSupported("tasks");switch(this._type){case"main":case"mainSelect":case"mainHover":case"mainFocus":e=s.GetStyleClass("task"),t=s.GetStyleClass("taskMilestone"),i=s.GetStyleClass("taskBar"),a=s.GetStyleClass("taskSummary"),this._task.isMilestone(this._type)&&0===this._w?e+=" "+t:(e+=" "+(this._task.isSummary(this._type)?a:i),"main"===this._type&&null!=this._task.getProgressValue()&&(e+=" "+s.GetStyleClass("taskUnprogress"))),"main"===this._type&&n?e+=" "+s.GetStyleClass("draggable"):"mainSelect"===this._type?e+=" "+s.GetStyleClass("selected"):"mainHover"===this._type?e+=" "+s.GetStyleClass("hover"):"mainFocus"===this._type&&(e+=" "+s.GetStyleClass("focus"));break;case"mainBackground":e=s.GetStyleClass("taskBackdrop");break;case"progress":case"progressZero":case"progressFull":e=s.GetStyleClass("taskProgress"),this._task.isSummary("main")&&(e+=" "+s.GetStyleClass("taskSummaryProgress")),n&&(e+=" "+s.GetStyleClass("draggable"));break;case"overtime":case"downtime":case"attribute":e=s.GetStyleClass(`task${this._type[0].toUpperCase()}${this._type.slice(1)}`),n&&(e+=" "+s.GetStyleClass("draggable"));break;case"mainDragFeedback":case"mainResizeHandleDragFeedback":e=s.GetStyleClass("taskDragImage");break;case"mainResizeHandleStart":case"mainResizeHandleEnd":e=s.GetStyleClass("taskResizeHandle")+" "+s.GetStyleClass("draggable");break;case"baseline":case"baselineSelect":case"baselineHover":e=s.GetStyleClass("baseline"),t=s.GetStyleClass("baselineMilestone"),i=s.GetStyleClass("baselineBar"),this._task.isMilestone(this._type)&&0===this._w?e+=" "+t:e+=" "+i;break;default:e=""}return e}applyStyleClasses(e){if(("mainHover"===this._type||"mainFocus"===this._type)&&"alta"===this._context.getThemeBehavior()){const e={fill:"none"},i=this._task.getFillColor();null!=i&&(this.setStroke(t.SelectionEffectUtils.createSelectingStroke(i.fill)),e.stroke=i.fill,"none"===i.filter&&(e.filter="none")),this.setStyle(e)}this._svgClassName=e;const i=this.getDefaultStyleClasses();this.setClassName(e?`${i} ${e}`:i)}setClassName(e){this.getClassName()!==e&&(super.setClassName(e),this._fillColor=void 0,this._isHighlighted&&this.highlight())}setStyle(e){this.getStyle()!==e&&(super.setStyle(e),this._fillColor=void 0)}highlight(){this._isHighlighted||t.ToolkitUtils.addClassName(this._elem,this._task.getGantt().GetStyleClass("taskHighlight")),this._isHighlighted=!0}unhighlight(){this._isHighlighted&&t.ToolkitUtils.removeClassName(this._elem,this._task.getGantt().GetStyleClass("taskHighlight")),this._isHighlighted=!1}isHighlighted(){return this._isHighlighted}getFillColor(){if(this._fillColor)return this._fillColor.fromShapeCache=!0,this._fillColor;const e=this._task.getGantt().getCache(),i=`FILL_(${JSON.stringify(this.getClassName())||""})_${JSON.stringify(this.getStyle())||""}`,a=e.getFromCache(i);if(a)return this._fillColor=a,a;var n,r,o,h,l,d,g,_;n=(n=null!=(n=this.getElem()).firstChild?n.firstChild:n).cloneNode(!1),(r=this._task.getGantt().getCtx().getSvgDocument()).appendChild(n);try{if(h=(o=window.getComputedStyle(n)).fill,_=Number(o.fillOpacity),d=o.filter,!(String.prototype.startsWith?h.startsWith("url("):0===h.indexOf("url("))){switch(d){case"url("+JSON.stringify("#"+s.getTaskTintFilterId())+")":case"url(#"+s.getTaskTintFilterId()+")":l=t.ColorUtils.getBrighter(h,s.getTaskTintAlpha());break;case"url("+JSON.stringify("#"+s.getTaskShadeFilterId())+")":case"url(#"+s.getTaskShadeFilterId()+")":l=t.ColorUtils.getDarker(h,s.getTaskShadeAlpha());break;default:l=h}1===_||Number.isNaN(_)||(l=t.ColorUtils.getBrighter(l,1-_)),g={fill:h,computedFill:l,filter:d,stroke:o.stroke,fromShapeCache:!1}}}finally{r.removeChild(n)}return this._fillColor=g,e.putToCache(i,g),g}getType(){return this._type}setType(e){this._type=e}getTask(){return this._task}getPhysicalStartOffset(){return(o.MAIN_TYPES.indexOf(this._type)>-1||o.BASELINE_TYPES.indexOf(this._type)>-1)&&this._task.isMilestone(this._type)?this._finalHeight/2:0}getPhysicalEndOffset(){return(o.MAIN_TYPES.indexOf(this._type)>-1||o.BASELINE_TYPES.indexOf(this._type)>-1)&&this._task.isMilestone(this._type)?this._finalHeight/2:0}getType(){return this._type}getRenderState(){return this._renderState}setRenderState(e){this._renderState=e}getWidth(){return this._w}getFinalWidth(){return this._finalWidth}setWidth(e){var t;!(o.MAIN_TYPES.indexOf(this._type)>-1||o.BASELINE_TYPES.indexOf(this._type)>-1)||0!==this._w&&0!==e||(this._w=e,this.applyStyleClasses(this._svgClassName)),this._w=e,t=this.generateCmd(this._x,this._y,this._w,this._h,this._r),this.setCmds(t)}setFinalWidth(e){this._finalWidth=e}getHeight(){return this._h}getFinalHeight(){return this._finalHeight}setHeight(e){var t;this._h=e,t=this.generateCmd(this._x,this._y,this._w,this._h,this._r),this.setCmds(t)}setFinalHeight(e){this._finalHeight=e}getX(){return this._x}getFinalX(){return this._finalX}setX(e){var t;this._x=e,t=this.generateCmd(this._x,this._y,this._w,this._h,this._r),this.setCmds(t)}setFinalX(e){this._finalX=e}getY(){return this._y}getFinalY(){return this._finalY}setY(e){var t;this._y=e,t=this.generateCmd(this._x,this._y,this._w,this._h,this._r),this.setCmds(t)}setFinalY(e){this._finalY=e}getBorderRadius(){return this._r}setBorderRadius(e){var t;this._r=null!=e?e:"0",t=this.generateCmd(this._x,this._y,this._w,this._h,this._r),this.setCmds(t)}setDimensions(e,t,i,a,s){var n;!(o.MAIN_TYPES.indexOf(this._type)>-1||o.BASELINE_TYPES.indexOf(this._type)>-1)||0!==this._w&&0!==i||(this._w=i,this.applyStyleClasses(this._svgClassName)),this._x=e,this._y=t,this._w=i,this._h=a,this._r=null!=s?s:"0",n=this.generateCmd(this._x,this._y,this._w,this._h,this._r),this.setCmds(n)}}o.MAIN_TYPES=["main","mainBackground","mainSelect","mainHover","mainFocus"],o.MAIN_EFFECT_TYPES=["mainSelect","mainHover","mainFocus"],o.BASELINE_TYPES=["baseline","baselineSelect","baselineHover"],o.BASELINE_EFFECT_TYPES=["baselineSelect","baselineHover"],o.PROGRESS_TYPES=["progress","progressZero","progressFull"];var h={getDatatipColor:e=>{var t=e.getCtx(),i=e.getTask().getFillColor();return i?"alta"===t.getThemeBehavior()?i.fill:i.stroke:null},getDatatip:(e,i,a)=>{var s=e.getGantt();if(s.getEventManager().isKeyboardDnDScaleChanged()){var n=s.getEventManager().getKeyboardDnDNavigationScale(),r="move"===s.getEventManager().getKeyboardDnDMode()?"MoveBy":"ResizeBy",o=h._addDatatipRow("",s,"",r,n.charAt(0).toUpperCase()+n.slice(1),i);return h._processDatatip(o,s,i)}var l=s.getOptions().tooltip,d=l?l.renderer:null;if(i&&d){var g=s.getCtx().getTooltipManager(),_=s.getEventManager().isDnDDragging()?e.getSandboxDataContext():e.getDataContext();return g.getCustomTooltip(d,_)}var c=e.getValue("shortDesc");if(null!=c)return c;if(a&&!s.getCtx().isCustomElement()){var u=s.getOptions().valueFormats;if(!u||0===u.length){var p=e.getTask(),m=e.getValue("start"),b=e.getValue("end"),v=e.getValue("baseline","start"),S=e.getValue("baseline","end"),D=p.getProgressValue(),T=s.getOptions(),y=T.translations,C=p.isMilestone("main"),f=p.isMilestone("baseline"),k=!(null==m&&null==b),E=!(null==v&&null==S);if(k)if(C)var O=s.getTimeAxis().formatDate(new Date(null!=m?m:b),null,"general"),w=t.ResourceUtils.format(y.accessibleMilestoneInfo,[O]);else{var R=s.getTimeAxis().formatDate(new Date(m),null,"general"),A=s.getTimeAxis().formatDate(new Date(b),null,"general"),x=e.getDuration(m,b);w=t.ResourceUtils.format(y.accessibleTaskInfo,[R,A,x])}if(E)if(f)var L=s.getTimeAxis().formatDate(new Date(null!=v?v:S),null,"general"),M=y.labelBaselineDate+": "+L;else{var P=s.getTimeAxis().formatDate(new Date(v),null,"general"),j=s.getTimeAxis().formatDate(new Date(S),null,"general");M=(M=y.labelBaselineStart+": "+P)+"; "+y.labelBaselineEnd+": "+j}if(k){var I=e.getValue("label");if(null!=I)var F=y.labelLabel+": "+I;if(null!=D){var H=T._resources;if(H){var N=H.percentConverter;if(N){var B=N.format(D);if(null!=B)var U=y.labelProgress+": "+B}}}}var Y=e.getLayoutObject().rowObj,V=Y.data.label;null==V&&(V=Y.index+1);var G=t.ResourceUtils.format(y.accessibleRowInfo,[V]);return w&&(G=G+"; "+w),M&&(G=G+"; "+M),F&&(G=G+"; "+F),U&&(G=G+"; "+U),G}}var W="";return W=h._addRowDatatip(W,e,i),W=h._addTaskDatatip(W,e,i),h._processDatatip(W,s,i)},_processDatatip:(e,t,i)=>""===e?null:i?'<table class="'+t.GetStyleClass("tooltipTable")+'">'+e+"</table>":e,_addRowDatatip:(e,t,i)=>{var a=t.getGantt();if(a.getEventManager().isDnDDragging())var s=t.getSandboxValue("_rowNode");else s=t.getRowNode();var n=s?s.getLayoutObject():t.getLayoutObject().rowObj,r=n.data.label;return null==r&&(r=n.index+1),h._addDatatipRow(e,a,"row","Row",r,i)},_addTaskDatatip:(e,t,i)=>{var a=t.getGantt(),s=a.getEventManager().isDnDDragging()?t.getSandboxValue:t.getValue,n=t.getTask(),r=s.call(t,"start"),o=s.call(t,"end"),l=s.call(t,"overtime","start"),d=s.call(t,"overtime","end"),g=s.call(t,"downtime","start"),_=s.call(t,"downtime","end"),c="on"===s.call(t,"attribute","rendered")?s.call(t,"attribute","shortDesc"):null,u=s.call(t,"baseline","start"),p=s.call(t,"baseline","end"),m=s.call(t,"label"),b=n.getProgressValue(),v=!(null==r&&null==o),S=!(null==u&&null==p),D=!(null==l&&null==d),T=!(null==g&&null==_),y=null!=c,C=n.isMilestone("main"),f=n.isMilestone("baseline");return v?(C?(e=h._addDatatipRow(e,a,"date","Date",null!=r?r:o,i),f?e=h._addDatatipRow(e,a,"baselineDate","BaselineDate",null!=u?u:p,i):S&&(e=h._addDatatipRow(e,a,"baselineStart","BaselineStart",u,i),e=h._addDatatipRow(e,a,"baselineEnd","BaselineEnd",p,i))):f?(e=h._addDatatipRow(e,a,"start","Start",r,i),e=h._addDatatipRow(e,a,"end","End",o,i),e=h._addDatatipRow(e,a,"baselineDate","BaselineDate",null!=u?u:p,i)):S?(e=h._addDatatipRow(e,a,"start","Start",r,i),e=h._addDatatipRow(e,a,"baselineStart","BaselineStart",u,i),e=h._addDatatipRow(e,a,"end","End",o,i),e=h._addDatatipRow(e,a,"baselineEnd","BaselineEnd",p,i)):(e=h._addDatatipRow(e,a,"start","Start",r,i),e=h._addDatatipRow(e,a,"end","End",o,i)),D&&(e=h._addDatatipRow(e,a,"overtimeStart","OvertimeStart",l,i),e=h._addDatatipRow(e,a,"overtimeEnd","OvertimeEnd",d,i)),T&&(e=h._addDatatipRow(e,a,"downtimeStart","DowntimeStart",g,i),e=h._addDatatipRow(e,a,"downtimeEnd","DowntimeEnd",_,i)),y&&(e=h._addDatatipRow(e,a,"attribute","Attribute",c,i)),e=h._addDatatipRow(e,a,"label","Label",m,i),null!=b&&(e=h._addDatatipRow(e,a,"progress","Progress",b,i))):S&&(e=h._addDatatipRow(e,a,"baselineStart","BaselineStart",u,i),e=h._addDatatipRow(e,a,"baselineEnd","BaselineEnd",p,i)),e},_addDatatipRow:(e,i,a,s,n,r,o)=>{if(null==n||""===n)return e;var l,d=h.getValueFormat(i,a);return"off"===d.tooltipDisplay?e:("string"==typeof d.tooltipLabel&&(l=d.tooltipLabel),null==l&&(l=null==s?"":i.getOptions().translations["label"+s]),n=h.formatValue(i,a,d,n),r?e+'<tr><td class="'+i.GetStyleClass("tooltipLabel")+'">'+l+'</td><td class="'+i.GetStyleClass("tooltipValue")+'">'+n+"</td></tr>":(e.length>0&&(e+="<br>"),e+t.ResourceUtils.format(i.getOptions().translations.labelAndValue,[l,n])))},getValueFormat:(e,t)=>{var i=e.getOptions().valueFormats;if(!i)return{};if(i instanceof Array){for(var a={},s=0;s<i.length;s++){var n=i[s];a[n.type]=n}e.getOptions().valueFormats=a,i=a}return i[t]?i[t]:{}},formatValue:(e,t,i,a)=>{var s=i.converter;if("start"===t||"end"===t||"date"===t||"baselineStart"===t||"baselineEnd"===t||"baselineDate"===t||"overtimeStart"===t||"overtimeEnd"===t||"downtimeStart"===t||"downtimeEnd"===t)return e.getTimeAxis().formatDate(new Date(a),s,"general");if(s&&s.format)return s.format(a);if("progress"===t){var n=e.getOptions()._resources;if(n){var r=n.percentConverter;if(r)return r.format(a)}}return a}};class l extends t.OutputText{constructor(e,t,i,a,s,n,r,o,h){super(e,t,0,0),this._timeAxis=n,this._isDrillable=r,this._callback=o,this._callbackObj=h,this.intervalStartDate=a,this.intervalEndDate=s,this.nodeType="timeAxisLabel",this.setCSSStyle(i);const l=[DvtTimeAxisStyleUtils.getAxisLabelClass(n.Options),r?DvtTimeAxisStyleUtils.getAxisDrillableLabelClass(n.Options):void 0].filter(Boolean).join(" ");l&&this.getElem().setAttribute("class",l),r&&(n.parentComp.getEventManager().associate(this,this),this.setAriaProperty("hidden","false"),this.setAriaRole("button")),this.setupListeners()}isDrillable(){return this._isDrillable}getAxisType(){return this._timeAxis.axisType}OnMouseOver(){const e=DvtTimeAxisStyleUtils.getHoverClass(this._timeAxis.Options);e&&this.getElem().classList.add(e)}OnMouseOut(){const e=DvtTimeAxisStyleUtils.getHoverClass(this._timeAxis.Options);e&&this.getElem().classList.remove(e)}OnClick(e){if(this._isDrillable&&this._callback){var t=this._timeAxis.parentComp.getEventManager();const i=t.getFocus();i&&i.hideKeyboardFocusEffect(),this._timeAxis.setLastFocusedLabel(this),this.getCtx().setActiveElement(this),t.setFocus(this),this._callback.call(this._callbackObj,this,e),e.stopPropagation(),e.preventDefault()}}handleKeyboardEvent(e){e.keyCode==t.KeyboardEvent.ENTER&&this._isDrillable&&this._callback&&(this._callback.call(this._callbackObj,this,e),e.stopPropagation(),e.preventDefault())}setupListeners(){this._isDrillable?(this.addEvtListener(t.MouseEvent.MOUSEOVER,this.OnMouseOver,!1,this),this.addEvtListener(t.MouseEvent.MOUSEOUT,this.OnMouseOut,!1,this),this.addEvtListener(t.MouseEvent.CLICK,this.OnClick,{capture:!1},this),this.addEvtListener(t.TouchEvent.TOUCHSTART,this.OnClick,{capture:!1,passive:!1},this)):(this.removeEvtListener(t.MouseEvent.MOUSEOVER,this.OnMouseOver,!1,this),this.removeEvtListener(t.MouseEvent.MOUSEOUT,this.OnMouseOut,!1,this),this.removeEvtListener(t.MouseEvent.CLICK,this.OnClick,{capture:!1},this),this.removeEvtListener(t.TouchEvent.TOUCHSTART,this.OnClick,{capture:!1,passive:!1},this))}getFullTextString(){return this.isTruncated()?this.getUntruncatedTextString():this.getTextString()}identity(){return this._timeAxis._labels.find(e=>e.intervalStartDate.getTime()===this.intervalStartDate.getTime()&&e.intervalEndDate.getTime()===this.intervalEndDate.getTime())}getAriaLabel(){const e=this.getFullTextString(),t=this._timeAxis.parentComp.getMajorAxis();if(t&&this._timeAxis!==t){const i=t.findAttachedAxisLabelIntervalWithTime(this.intervalStartDate.getTime());if(i)return`${e}, ${i.getFullTextString()}`}return e}getNextNavigable(e){var i=t.Agent.isRightToLeft(this.getCtx()),a=this._timeAxis.parentComp.getEventManager();if(e.altKey&&e.keyCode===t.KeyboardEvent.DOWN_ARROW){const e=a.getLastFocusedItem(),t=this._timeAxis.parentComp.getViewPort(),i=this._timeAxis.parentComp.getDataLayoutManager(),s=this.intervalStartDate.getTime(),n=this.intervalEndDate.getTime();if(e){const a=e.getLayoutObject().rowObj,n=a.index;if(n>=t.minRowInd&&n<=t.maxRowInd){const{taskObjs:e}=i.getLayoutObjectsInViewBox({minRowInd:a.index,maxRowInd:a.index,viewStartTime:t.viewStartTime,viewEndTime:t.viewEndTime}),n=i.getClosestTaskLayoutObjToTime(e,s);if(n)return n.node}}const{taskObjs:r}=i.getLayoutObjectsInViewBox(t);if(0===r.length){if(e)return e;const t=a.getKeyboardHandler()?.getDefaultNavigable();return t??this.identity()}const o=i.getTaskLayoutObjectsOverlappingRange(r,s,n,!1),h=i.getClosestTaskLayoutObjToTime(o,s);if(h)return h.node;const l=i.getClosestTaskLayoutObjToTime(r,s);return l?.node??this.identity()}if(e.keyCode===t.KeyboardEvent.UP_ARROW){const e=this._timeAxis.parentComp.getDrillableAxisAbove(this._timeAxis);if(e){const t=e.getLastFocusedLabel();if(t&&(TimeAxisUtils_isIntervalContains([this.intervalStartDate.getTime(),this.intervalEndDate.getTime()],[t.intervalStartDate.getTime(),t.intervalEndDate.getTime()])||TimeAxisUtils_isIntervalContains([t.intervalStartDate.getTime(),t.intervalEndDate.getTime()],[this.intervalStartDate.getTime(),this.intervalEndDate.getTime()])))return t.identity();const i=e.getAxisLabelIntervalWithTime(this.intervalStartDate.getTime());if(i)return i}}if(e.keyCode===t.KeyboardEvent.DOWN_ARROW){const e=this._timeAxis.parentComp.getDrillableAxisBelow(this._timeAxis);if(e){const t=e.getLastFocusedLabel();if(t&&(TimeAxisUtils_isIntervalContains([this.intervalStartDate.getTime(),this.intervalEndDate.getTime()],[t.intervalStartDate.getTime(),t.intervalEndDate.getTime()])||TimeAxisUtils_isIntervalContains([t.intervalStartDate.getTime(),t.intervalEndDate.getTime()],[this.intervalStartDate.getTime(),this.intervalEndDate.getTime()])))return t.identity();const i=e.getAxisLabelIntervalWithTime(this.intervalStartDate.getTime());if(i)return i}}if(!i&&e.keyCode===t.KeyboardEvent.RIGHT_ARROW||i&&e.keyCode===t.KeyboardEvent.LEFT_ARROW){const e=this._timeAxis.getAxisLabelIntervalWithTime(this.intervalEndDate.getTime());if(e)return e}if(!i&&e.keyCode===t.KeyboardEvent.LEFT_ARROW||i&&e.keyCode===t.KeyboardEvent.RIGHT_ARROW){const e=this._timeAxis.getAxisLabelIntervalWithTime(this.intervalStartDate.getTime()-1);if(e)return e}return this.identity()}getTargetElem(){return this.getElem()}getKeyboardBoundingBox(e){return this.getDimensions(e)}showKeyboardFocusEffect(){this._isShowingKeyboardFocusEffect=!0;const e=DvtTimeAxisStyleUtils.getFocusClass(this._timeAxis.Options);e&&this.getElem().classList.add(e),this._timeAxis.setLastFocusedLabel(this),this.getCtx().setActiveElement(this)}hideKeyboardFocusEffect(){const e=DvtTimeAxisStyleUtils.getFocusClass(this._timeAxis.Options);e&&this.getElem().classList.remove(e),this._isShowingKeyboardFocusEffect=!1}isShowingKeyboardFocusEffect(){return this._isShowingKeyboardFocusEffect}}class d extends i.TimeComponentEventManager{constructor(e){super(e),this._HIGH_LEVEL_DND_NAVIGATION_SCALES=["milliseconds","seconds","minutes","hours","days","weeks","months","quarters","years"],this._HIGH_LEVEL_DND_DRAGSTART_DELTA_THRESHOLD=2}getFocus(){var e=super.getFocus(this),i=e&&"task"===e.nodeType;if(i&&null==e.getParent())return null;if(i&&null==e.getRowNode().getParent()){for(var a=e.getLayoutObject(),s=a.rowObj,n=this._comp.getDataLayoutManager();(null==a||!n.isRoot(s)&&n.isHiddenCollapsed(s))&&(s=n.getParentRowObj(s),null!=a||null!=s);){var r=s.taskObjs;a=r.length>0?r[0]:null}if(a){if("delete"!==a.renderState)return a.node;const e=n.getRowObjs();for(let i=0;i<e.length;i++)if(t.Obj.compareValues(this._comp.getCtx(),e[i].id,s.id)){const s=e[i].taskObjs;for(let e=0;e<s.length;e++)if(t.Obj.compareValues(this._comp.getCtx(),s[e].id,a.id))return s[e].node;return null}}return null}return e}setFocus(e){super.setFocus(e);var t=this.getFocus();t&&"task"===t.nodeType&&(this._lastFocusedTask=t)}getLastFocusedItem(){const e=this._comp.getDataLayoutManager();return this._lastFocusedTask?e.getTaskObjWithId(this._lastFocusedTask.getLayoutObject().id)?.node:null}setLastFocusedItem(e){this._lastFocusedTask=e}hideTooltip(){this._preventHideTooltip||super.hideTooltip(),this._preventHideTooltip=!1}ProcessMarqueeEvent(e){if(this._comp.isMarqueeSelectEnabled()){var i=this.getSelectionHandler();if("start"===e.subtype)this._initSelectedIds=i.getSelectedIds(),this._initSelectionTargets=i.getSelection(),this._initMarqueeSelection=e.ctrlKey?this._initSelectedIds:[],this._initMarqueeSelectionTargets=e.ctrlKey?this._initSelectionTargets:[];else if("move"===e.subtype){this._isMarqueeDragging=!0;var a=this._comp.getMarqueeArtifactsContainer().stageToLocal(e._relPos);this._comp.autoPanOnEdgeDrag(a,s.getAutoPanEdgeThreshold(),!1,!1,!0);var n=this._comp.getDataLayoutManager().getLayoutObjectsInBBox(new t.Rectangle(e.x,e.y,e.w,e.h)).taskObjs.map(e=>e.node);i.processInitialSelections(this._initMarqueeSelection,this._initMarqueeSelectionTargets),i.processGroupSelection(n,!0)}else"end"===e.subtype&&(this._isMarqueeDragging=!1,this._initSelectedIds=null,this._initSelectionTargets=null,this.fireSelectionEvent())}}cancelMarquee(e){super.cancelMarquee(),this._isMarqueeDragging&&this._initSelectedIds&&this._initSelectionTargets&&this.getSelectionHandler().processInitialSelections(this._initSelectedIds,this._initSelectionTargets),this._isMarqueeDragging=!1}isMarqueeDragging(){return this._isMarqueeDragging}isDndSupported(){return!0}isDnDDragging(){return this._isDndDragging}_dragStartSetup(){this._dragInitialX=this._comp.getTimeZoomCanvas().getTranslateX(),this._dragInitialY=this._comp.getDatabody().getTranslateY(),this._dragInitialViewportStart=this._comp.getViewportStartTime(),this._dragInitialViewportEnd=this._comp.getViewportEndTime(),this._comp.getReferenceLinesContainer().setMouseEnabled(!1),this._comp.getReferenceAreasContainer().setMouseEnabled(!1),this._comp.getRowReferenceObjectsContainer().setMouseEnabled(!1),this._comp.getStickyRowReferenceObjectsContainer()?.setMouseEnabled(!1),this._comp.getDependenciesContainer()?.setMouseEnabled(!1),"highlightDependencies"===this._comp.getOptions().selectionBehavior&&this._comp.undimDatabody()}_dragCancelCleanup(){if(this._dragInitialX){var e=this._comp.getTimeZoomCanvas().getTranslateX()-this._dragInitialX,t=this._comp.getDatabody().getTranslateY()-this._dragInitialY;0===e&&0===t||(this._comp.panBy(e,t,!0),this._comp.setViewportStartTime(this._dragInitialViewportStart),this._comp.setViewportEndTime(this._dragInitialViewportEnd))}this._dragInitialX=null,this._dragInitialY=null,this._dragInitialViewportStart=null,this._dragInitialViewportEnd=null,this._comp.getReferenceLinesContainer().setMouseEnabled(!0),this._comp.getReferenceAreasContainer().setMouseEnabled(!0),this._comp.getRowReferenceObjectsContainer().setMouseEnabled(!0),this._comp.getStickyRowReferenceObjectsContainer()?.setMouseEnabled(!0),this._comp.getDependenciesContainer()?.setMouseEnabled(!0);var i=this.DragSource.getDragObject();i&&"task"===i.nodeType&&i.dragCancelCleanup()}_dropCleanup(){null==this._dragInitialViewportStart||this._dragInitialViewportStart===this._comp.getViewportStartTime()&&this._dragInitialViewportEnd===this._comp.getViewportEndTime()||this._comp.dispatchEvent(this._comp.createViewportChangeEvent()),this._dragInitialX=null,this._dragInitialY=null,this._dragInitialViewportStart=null,this._dragInitialViewportEnd=null,this._comp.getReferenceLinesContainer().setMouseEnabled(!0),this._comp.getReferenceAreasContainer().setMouseEnabled(!0),this._comp.getRowReferenceObjectsContainer().setMouseEnabled(!0),this._comp.getStickyRowReferenceObjectsContainer()?.setMouseEnabled(!0),this._comp.getDependenciesContainer()?.setMouseEnabled(!0),this._isDndDragging=!1}getKeyboardDnDMode(){return this._keyboardDnDMode}_handleKeyboardDnDInitiation(e,i,a,s,n){var r=t.Agent.isRightToLeft(this._comp.getCtx())?-1:1;this._isDndDragging=!0,this._dragStartSetup();var o=i.getTask().getShape("main");this._comp.registerAndConstructGlassPane();var h=this._comp.installGlassPane();this._keyboardDnDScaleRampIndex=this._HIGH_LEVEL_DND_NAVIGATION_SCALES.indexOf(this._comp.getTimeAxis().getScale()),i.setDraggedObject(a),i.dragStartSetup();var l=i.localToStage({x:o.getFinalX()+("end"===s)*r*o.getFinalWidth(),y:o.getFinalY()});this._keyboardDnDFeedbackLocalPos=this._comp.getDnDArtifactsContainer().stageToLocal(l),i.showDragFeedback(e,this._keyboardDnDFeedbackLocalPos,i.getRowNode(),{x:0,y:0},!0),h&&(this._preventHideTooltip=!0),this._keyboardDnDSourceObj=i,this._keyboardDnDTargetObj=i.getRowNode();var d=i.getValue("start"),g=i.getValue("end"),_=i.getValue("baseline","start")||null,c=i.getValue("baseline","end")||null;this._keyboardDnDFeedbackTime={start:d,end:g,baselineStart:_,baselineEnd:c};var u=this._comp.getOptions().translations,p=u[n.initiated];if(this._comp.isSelectionSupported()&&this._keyboardDnDSourceObj.isSelected()){var m=this._comp.getSelectionHandler().getSelectedCount();m>1&&(p+=". "+t.ResourceUtils.format(u[n.selectionInfo],[m-1]))}p+=". "+u[n.instruction]+".",this._comp.updateLiveRegionText(p)}handleKeyboardMoveInitiation(e,t){this._keyboardDnDMode=d.KEYBOARD_MOVE;var i=t.getTask().getShape("main");this._handleKeyboardDnDInitiation(e,t,i,"start",{initiated:"taskMoveInitiated",selectionInfo:"taskMoveSelectionInfo",instruction:"taskMoveInitiatedInstruction"})}handleKeyboardResizeStartInitiation(e,t){this._keyboardDnDMode=d.KEYBOARD_RESIZE_START;var i=t.getTask().getShape("mainResizeHandleStart");this._handleKeyboardDnDInitiation(e,t,i,"start",{initiated:"taskResizeStartInitiated",selectionInfo:"taskResizeSelectionInfo",instruction:"taskResizeInitiatedInstruction"})}handleKeyboardResizeEndInitiation(e,t){this._keyboardDnDMode=d.KEYBOARD_RESIZE_END;var i=t.getTask().getShape("mainResizeHandleEnd");this._handleKeyboardDnDInitiation(e,t,i,"end",{initiated:"taskResizeEndInitiated",selectionInfo:"taskResizeSelectionInfo",instruction:"taskResizeInitiatedInstruction"})}_handleKeyboardDnDChronologically(e,i){var s,n,r=t.Agent.isRightToLeft(this._comp.getCtx()),o=this.getKeyboardDnDNavigationScale(),l=this._comp.getStartTime(),g=this._comp.getEndTime(),_=this._comp.getContentLength(),c=this._comp.getTimeAxis(),u="forward"===i?"next":"previous",p=c.getAdjacentDate(this._keyboardDnDFeedbackTime.start,o,u).getTime(),m=c.getAdjacentDate(this._keyboardDnDFeedbackTime.end,o,u).getTime(),b="auto";switch(this._keyboardDnDMode){case d.KEYBOARD_MOVE:("forward"===i&&p<=g||"backward"===i&&m>=l)&&(n=a.TimeAxisUtils.getDatePosition(l,g,this._keyboardDnDFeedbackTime.start,_),this._keyboardDnDFeedbackTime.start=p,this._keyboardDnDFeedbackTime.end=m,this._keyboardDnDFeedbackTime.baselineStart&&(this._keyboardDnDFeedbackTime.baselineStart=c.getAdjacentDate(this._keyboardDnDFeedbackTime.baselineStart,o,u).getTime(),this._keyboardDnDFeedbackTime.baselineEnd=c.getAdjacentDate(this._keyboardDnDFeedbackTime.baselineEnd,o,u).getTime()),s=a.TimeAxisUtils.getDatePosition(l,g,this._keyboardDnDFeedbackTime.start,_));break;case d.KEYBOARD_RESIZE_START:var v=this._keyboardDnDSourceObj.getValue("end");("forward"===i&&p<=v||"backward"===i&&p>=l)&&(n=a.TimeAxisUtils.getDatePosition(l,g,this._keyboardDnDFeedbackTime.start,_),this._keyboardDnDFeedbackTime.start=p,s=a.TimeAxisUtils.getDatePosition(l,g,this._keyboardDnDFeedbackTime.start,_)),b="start";break;case d.KEYBOARD_RESIZE_END:var S=this._keyboardDnDSourceObj.getValue("start");("forward"===i&&m<=g||"backward"===i&&m>=S)&&(n=a.TimeAxisUtils.getDatePosition(l,g,this._keyboardDnDFeedbackTime.end,_),this._keyboardDnDFeedbackTime.end=m,s=a.TimeAxisUtils.getDatePosition(l,g,this._keyboardDnDFeedbackTime.end,_)),b="end"}null!=s&&(s=r?_-s:s,n=r?_-n:n,this._keyboardDnDFeedbackLocalPos.x+=s-n),this._keyboardDnDSourceObj.showDragFeedback(e,this._keyboardDnDFeedbackLocalPos,this._keyboardDnDTargetObj,{x:0,y:0},!0),this._keyboardDnDSourceObj.scrollIntoView(b,"auto"),this._comp.updateLiveRegionText(t.AriaUtils.processAriaLabel(h.getDatatip(this._keyboardDnDSourceObj,!1)))}handleKeyboardDnDForward(e){this._handleKeyboardDnDChronologically(e,"forward")}handleKeyboardDnDBackward(e){this._handleKeyboardDnDChronologically(e,"backward")}_handleKeyboardDnDScaleChange(e,i){this._isKeyboardDnDScaleChanged=!0,this._keyboardDnDScaleRampIndex=Math.max(0,Math.min(this._keyboardDnDScaleRampIndex+i,this._HIGH_LEVEL_DND_NAVIGATION_SCALES.length-1)),this._keyboardDnDSourceObj.showDragFeedback(e,this._keyboardDnDFeedbackLocalPos,this._keyboardDnDTargetObj,{x:0,y:0},!0),this._comp.updateLiveRegionText(t.AriaUtils.processAriaLabel(h.getDatatip(this._keyboardDnDSourceObj,!1))),this._isKeyboardDnDScaleChanged=!1}isKeyboardDnDScaleChanged(){return this._isKeyboardDnDScaleChanged}getKeyboardDnDNavigationScale(){return this._HIGH_LEVEL_DND_NAVIGATION_SCALES[this._keyboardDnDScaleRampIndex]}handleKeyboardDnDScaleUp(e){this._handleKeyboardDnDScaleChange(e,1)}handleKeyboardDnDScaleDown(e){this._handleKeyboardDnDScaleChange(e,-1)}_handleKeyboardMoveRowDirection(e,i){var a=this._comp.getRowLayoutObjs(),n=this._keyboardDnDTargetObj.getIndex();if("above"===i&&n>0)var r=a[n-1];else"below"===i&&n<a.length-1&&(r=a[n+1]);if(r){this._comp.getDataLayoutManager().ensureInDOM(r,"row"),this._keyboardDnDTargetObj=r.node;var o=this._comp.getOptions(),l=this._keyboardDnDTargetObj.localToStage({x:0,y:this._keyboardDnDTargetObj.getFinalY()+s.getRowPaddingTop(o)});this._keyboardDnDFeedbackLocalPos.y=this._comp.getDnDArtifactsContainer().stageToLocal(l).y}this._keyboardDnDSourceObj.showDragFeedback(e,this._keyboardDnDFeedbackLocalPos,this._keyboardDnDTargetObj,{x:0,y:0},!0),this._keyboardDnDSourceObj.scrollIntoView("auto","below"===i?"bottom":"top"),this._comp.updateLiveRegionText(t.AriaUtils.processAriaLabel(h.getDatatip(this._keyboardDnDSourceObj,!1)))}handleKeyboardMoveRowAbove(e){this._handleKeyboardMoveRowDirection(e,"above")}handleKeyboardMoveRowBelow(e){this._handleKeyboardMoveRowDirection(e,"below")}handleKeyboardDnDFinalize(e){var i,a,s,n,r,o;this._dropCleanup();var h=this._comp.getOptions().translations;if(this._keyboardDnDMode===d.KEYBOARD_MOVE){i=this._getDragDataContexts(this._keyboardDnDSourceObj),a=new Date(this._keyboardDnDFeedbackTime.start).toISOString(),s=new Date(this._keyboardDnDFeedbackTime.end).toISOString();var l=null==this._keyboardDnDFeedbackTime.baselineStart?null:new Date(this._keyboardDnDFeedbackTime.baselineStart).toISOString(),g=null==this._keyboardDnDFeedbackTime.baselineEnd?null:new Date(this._keyboardDnDFeedbackTime.baselineEnd).toISOString();n=a;var _=this._keyboardDnDTargetObj.getDataContext();r=t.EventFactory.newGanttMoveEvent(i,n,a,s,l,g,_),o=h.taskMoveFinalized}else if(this._keyboardDnDMode===d.KEYBOARD_RESIZE_END||this._keyboardDnDMode===d.KEYBOARD_RESIZE_START){var c;i=this._getDragDataContexts(this._keyboardDnDSourceObj).map(e=>e.dataContext),a=new Date(this._keyboardDnDFeedbackTime.start).toISOString(),s=new Date(this._keyboardDnDFeedbackTime.end).toISOString(),this._keyboardDnDMode===d.KEYBOARD_RESIZE_END?(n=s,c="end"):this._keyboardDnDMode===d.KEYBOARD_RESIZE_START&&(n=a,c="start"),r=t.EventFactory.newGanttResizeEvent(i,n,a,s,c),o=h.taskResizeFinalized}r&&(this._comp.dispatchEvent(r),this._comp.updateLiveRegionText(o)),this._keyboardDnDCleanup()}handleKeyboardDnDCancel(){var e=this._comp.getOptions().translations;this._keyboardDnDMode===d.KEYBOARD_MOVE?this._comp.updateLiveRegionText(e.taskMoveCancelled):this._keyboardDnDMode!==d.KEYBOARD_RESIZE_END&&this._keyboardDnDMode!==d.KEYBOARD_RESIZE_START||this._comp.updateLiveRegionText(e.taskResizeCancelled),this._dragCancelCleanup(),this._keyboardDnDCleanup()}handleHighLevelMouseDnDCancel(e){this._onDnDDragEnd(e),this._highLevelDnDEndExecuted=!0}_keyboardDnDCleanup(){null!=this._keyboardDnDMode&&(this._keyboardDnDSourceObj.dragEndCleanup(),this._keyboardDnDMode=null,this._isDndDragging=!1,this._keyboardDnDSourceObj=null,this._keyboardDnDTargetObj=null,this._keyboardDnDFeedbackTime=null,this._keyboardDnDScaleRampIndex=null,this._comp.unregisterAndDestroyGlassPane())}getDnDTaskSubType(e){if(e instanceof o){var t=e.getType();if("main"===t||"progress"===t)return"tasks";if("mainResizeHandleStart"===t||"mainResizeHandleEnd"===t)return"taskResizeHandles";if("baseline"===t)return null}return"tasks"}GetDragSourceType(e){switch(this._keyboardDnDMode){case d.KEYBOARD_MOVE:return this.IsDragSupported("tasks")?"tasks":null;case d.KEYBOARD_RESIZE_END:case d.KEYBOARD_RESIZE_START:return this.IsDragSupported("taskResizeHandles")?"taskResizeHandles":null}var i=this.DragSource.getDragObject();if(i&&"task"===i.nodeType){if(e&&"dragstart"===e.getNativeEvent().type){var a=e.getNativeEvent(),s=a.clientX,n=a.clientY,r=a.offsetX,o=a.offsetY;if(null==s&&null==n||("ie"===t.Agent.browser||"edge"===t.Agent.browser)&&isNaN(r)&&isNaN(o)){var h=e.target?e.target:i.getTask().getShape("main");i.setDraggedObject(h)}}var l=this.getDnDTaskSubType(i.getDraggedObject());return this.IsDragSupported(l)?l:null}return null}_getDragDataContexts(e,i){if(e&&"task"===e.nodeType){var a=e.getDraggedObject(),s=a.getType?a.getType():null;if(null!=this.getDnDTaskSubType(a)){var n=e=>{var a=e.getDataContext();switch(i&&t.ToolkitUtils.cleanDragDataContext(a),s){case"mainResizeHandleStart":return{dataContext:a,type:"start"};case"mainResizeHandleEnd":return{dataContext:a,type:"end"}}return a},r=[n(e)];if(this._comp.isSelectionSupported()&&e.isSelected()&&this._comp.getSelectionHandler().getSelectedCount()>1)for(var o=this._comp.getSelectionHandler().getSelection(),h=0;h<o.length;h++){var l=o[h];l&&"task"===l.nodeType&&l!==e&&r.push(n(l))}return r}}return null}GetDragDataContexts(e){var t=this.DragSource.getDragObject();return this._getDragDataContexts(t,e)}GetDropOffset(e){var i=this.DragSource.getDragObject();if(i&&"task"===i.nodeType&&"tasks"===this.getDnDTaskSubType(i.getDraggedObject())){var a=i.getValue("start"),s=i.getValue("end"),n=i.getTask().getTimeSpanDimensions(a,s),r=this._context.pageToStageCoords(e.pageX,e.pageY),o=this._comp.getDnDArtifactsContainer().stageToLocal(r);return new t.Point(n.startPos-o.x,i.getFinalY()-o.y)}return new t.Point(0,0)}_getDropObject(e){if(e){var t=this.GetLogicalObject(e.target),i=this._comp.getOptions().dnd,a=this._comp.isHighLevelDnDEnabled(),s=i&i.drop&&i.drop.tasks&&(i.drop.tasks.dataTypes||i.drop.tasks.drop);t&&"task"===t.nodeType&&a&&!s?this._dropObj=t.getRowNode():this._dropObj=t}return this._dropObj}GetDropTargetType(e){var t=this._getDropObject(e);return null==t?null:"row"===t.nodeType?"rows":"task"===t.nodeType?"tasks":null}GetDropEventPayload(e){var i=e.getNativeEvent().dataTransfer,s=i?Number(i.getData(t.EventManager.DROP_OFFSET_X_DATA_TYPE))||0:this._dropOffset.x,n=t.Agent.isRightToLeft(this._comp.getCtx()),r=this._getDropObject(e);if(null==r)return null;if("row"===r.nodeType||"task"===r.nodeType){var o=this._context.pageToStageCoords(e.pageX,e.pageY),h=this._comp.getTimeZoomCanvas().stageToLocal(o),l=this._comp.getStartTime(),d=this._comp.getEndTime(),g=this._comp.getContentLength(),_={value:new Date(a.TimeAxisUtils.getPositionDate(l,d,n?g-h.x:h.x,g)).toISOString(),start:null,end:null,baselineStart:null,baselineEnd:null,dataContext:r.getDataContext()},c=this.DragSource.getDragObject();if(c&&"task"===c.nodeType){var u=c.getValue("start"),p=c.getValue("end"),m=c.getValue("baseline","start")||null,b=c.getValue("baseline","end")||null,v=c.getDraggedObject(),S=this.getDnDTaskSubType(v);if("tasks"===S)_.start=a.TimeAxisUtils.getPositionDate(l,d,n?g-(h.x+s):h.x+s,g),_.end=_.start+(p-u),null==m&&null==b||(_.baselineStart=new Date(m-u+_.start).toISOString(),_.baselineEnd=new Date(b-p+_.end).toISOString()),_.start=new Date(_.start).toISOString(),_.end=new Date(_.end).toISOString();else if("taskResizeHandles"===S){"mainResizeHandleEnd"===(v.getType?v.getType():null)?(_.start=new Date(u).toISOString(),_.end=new Date(_.value).getTime()-u<0?u:_.value):(_.start=p-new Date(_.value).getTime()<0?p:_.value,_.end=new Date(p).toISOString())}}return _}return null}ShowDropEffect(e){const i=this._activeDropObj,a=this._getDropObject(e);this._activeDropObj=a;const n=this._currDragSourceType,r=this._currDropEffectCursorTarget;this._currDropEffectCursorTarget=e.target,!t.Agent.isTouchDevice()&&this._comp.isHighLevelDnDEnabled()&&e.target!==r&&(r&&s.hasClass(r,this._currDropEffectCursorStyleClass)&&r.removeClassName(this._currDropEffectCursorStyleClass),s.hasClass(e.target,this._currDropEffectCursorStyleClass)||e.target.addClassName(this._currDropEffectCursorStyleClass));this._comp.isTaskResizeEnabled()&&"taskResizeHandles"===n||a&&"row"===a.nodeType&&a!==i&&(i&&"row"===i.nodeType&&(i.removeEffect("invalidDrop"),i.removeEffect("activeDrop")),a.showEffect("activeDrop"))}ShowRejectedDropEffect(e){var t=this._activeDropObj,i=this._getDropObject(e);this._activeDropObj=i,this._currDropEffectCursorTarget=e.target,this._comp.isTaskResizeEnabled()&&"taskResizeHandles"===this._currDragSourceType||i&&"row"===i.nodeType&&i!==t&&i.showEffect("invalidDrop")}ClearDropEffect(){!t.Agent.isTouchDevice()&&this._comp.isHighLevelDnDEnabled()&&this._currDropEffectCursorTarget&&s.hasClass(this._currDropEffectCursorTarget,this._currDropEffectCursorStyleClass)&&this._currDropEffectCursorTarget.removeClassName(this._currDropEffectCursorStyleClass),this._currDropEffectCursorTarget=null;const e=this._getDropObject();e&&"row"===e.nodeType&&(e.removeEffect("invalidDrop"),e.removeEffect("activeDrop")),this._activeDropObj=null}_onDndDragStart(e){(this._isDndDragging||this._keyboardDnDMode)&&e.preventDefault();var i=e.getNativeEvent();if(i.defaultPrevented)this._comp.SetPanningEnabled(!0),this._comp.SetMarqueeEnabled(!0);else{this._isDndDragging=!0,this._dragStartSetup();var a=this.DragSource.getDragObject();if(a&&"task"===a.nodeType){a.dragStartSetup(e);var s=i.dataTransfer;this._dropOffset=s?new t.Point(Number(s.getData(t.EventManager.DROP_OFFSET_X_DATA_TYPE))||0,Number(s.getData(t.EventManager.DROP_OFFSET_Y_DATA_TYPE))||0):this.GetDropOffset(this._highLevelDnDDragStartPagePoint?{pageX:this._highLevelDnDDragStartPagePoint.x,pageY:this._highLevelDnDDragStartPagePoint.y}:e)}else this._dropOffset=new t.Point(0,0)}}_onDnDDragOver(e){var i=this;this._lastKnownDragOverEvent=e,i._isDndDragging=!0,this._isDragOverTicking||this._lastProcessedDragOverEvent&&this._lastKnownDragOverEvent.pageX===this._lastProcessedDragOverEvent.pageX&&this._lastKnownDragOverEvent.pageY===this._lastProcessedDragOverEvent.pageY||(requestAnimationFrame(()=>{i._isDragOverTicking=!1;var e=i.DragSource.getDragObject();if(e&&"task"===e.nodeType&&i._isDndDragging)if("dragover"!==i._lastKnownDragOverEvent.type||i._lastKnownDragOverEvent.getNativeEvent().defaultPrevented){var a=i._comp.getCtx().pageToStageCoords(i._lastKnownDragOverEvent.pageX,i._lastKnownDragOverEvent.pageY),s=i._comp.getDnDArtifactsContainer().stageToLocal(a);if(e.showDragFeedback(i._lastKnownDragOverEvent,s,i._getDropObject(),i._dropOffset),t.Agent.isTouchDevice()){var n=t.AriaUtils.processAriaLabel(h.getDatatip(e,!1));if(i._comp.isSelectionSupported()&&e.isSelected()){var r=i._comp.getSelectionHandler().getSelectedCount();r>1&&(n+=". "+t.ResourceUtils.format(i._comp.getOptions().translations.taskMoveSelectionInfo,[r-1]))}i._prevScreenReaderDragText&&i._prevScreenReaderDragText===n||i._comp.updateLiveRegionText(n),i._prevScreenReaderDragText=n}}else e.removeDragFeedbacks();i._lastProcessedDragOverEvent=i._lastKnownDragOverEvent}),this._isDragOverTicking=!0)}_onDnDDragEnd(e){const i=this.DragSource.getDragObject();i&&"task"===i.nodeType&&i.dragEndCleanup(),this._isDndDragging=!1,this._highLevelDnDDragStartPagePoint=null,this._activeDropObj=null,this._currDragSourceType=null,this._currDropEffectCursorStyleClass=null,this._dropOffset=new t.Point(0,0),(null!=e.keyCode||"dragend"===e.type&&"none"===e.getNativeEvent().dataTransfer.dropEffect)&&(this.ClearDropEffect(),this.handleKeyboardDnDCancel()),this._comp.SetPanningEnabled(!0),this._comp.SetMarqueeEnabled(!0),"highlightDependencies"===this._comp.getOptions().selectionBehavior&&this._comp.dimDatabody()}_onDnDDrop(e){this._dropCleanup();var i=e.getNativeEvent();if("drop"!==e.type||i.defaultPrevented){var a=this.DragSource.getDragObject(),s=a.getDraggedObject?this.getDnDTaskSubType(a.getDraggedObject()):"tasks";if(this._comp.isTaskMoveEnabled()&&"tasks"===s){t.Agent.isTouchDevice()&&this._comp.updateLiveRegionText(this._comp.getOptions().translations.taskMoveFinalized);var n=this.GetDropEventPayload(e),r="drop"!==e.type?this.GetDragDataContexts():JSON.parse(i.dataTransfer.getData(d.MOVE_TASKS_DATA_TYPE)),o=n.value,h=n.start,l=n.end,g=n.baselineStart,_=n.baselineEnd,c=n.dataContext,u=t.EventFactory.newGanttMoveEvent(r,o,h,l,g,_,c);this._comp.dispatchEvent(u)}else if(this._comp.isTaskResizeEnabled()&&"taskResizeHandles"===s){t.Agent.isTouchDevice()&&this._comp.updateLiveRegionText(this._comp.getOptions().translations.taskResizeFinalized);n=this.GetDropEventPayload(e);var p="drop"!==e.type?this.GetDragDataContexts():JSON.parse(i.dataTransfer.getData(d.RESIZE_TASKS_DATA_TYPE)),m=p[0].type;r=p.map(e=>e.dataContext),o=n.value,h=n.start,l=n.end,u=t.EventFactory.newGanttResizeEvent(r,o,h,l,m);this._comp.dispatchEvent(u)}}}OnDndDragStart(e){super.OnDndDragStart(e),this._onDndDragStart(e)}OnDndDragOver(e){super.OnDndDragOver(e),this._onDnDDragOver(e)}OnDndDragEnd(e){super.OnDndDragEnd(e),this._onDnDDragEnd(e)}OnDndDrop(e){super.OnDndDrop(e),this._onDnDDrop(e)}IsDragSupported(e){if("tasks"===e&&this._comp.isTaskMoveEnabled())return!0;if("taskResizeHandles"===e&&this._comp.isTaskResizeEnabled())return!0;if(this.isDndSupported()){var t=this._comp.getOptions(),i=t.dnd&&t.dnd.drag?t.dnd.drag:null;return i&&i[e]&&i[e].dataTypes&&i[e].dataTypes.length>0}return!1}IsDropSupported(e){if("rows"===e&&this._comp.isHighLevelDnDEnabled())return!0;if(this.isDndSupported()){var t=this._comp.getOptions(),i=t.dnd&&t.dnd.drop?t.dnd.drop:null;return i&&i[e]&&i[e].dataTypes}return!1}_onDnDPrePointerDown(e){var t=this.GetLogicalObjectAndDisplayable(e.target);if(t.logicalObject&&"task"===t.logicalObject.nodeType){var i=this.getDnDTaskSubType(t.displayable);if(this.IsDragSupported(i)){this._comp.SetPanningEnabled(!1),this._comp.SetMarqueeEnabled(!1);const e=this._comp.isTaskMoveEnabled(),a=this._comp.isTaskResizeEnabled();this._currDragSourceType=i,e&&"tasks"===i?this._currDropEffectCursorStyleClass=this._comp.GetStyleClass("highLevelDnDMoveDroppable"):a&&"taskResizeHandles"===i&&(this._currDropEffectCursorStyleClass=this._comp.GetStyleClass("highLevelDnDResizeDroppable")),t.logicalObject.setDraggedObject(t.displayable)}}}_onHighLevelDnDPointerDown(e){const i=this._context.pageToStageCoords(e.pageX,e.pageY),a=this.DragSource.getDragTransferable(i.x,i.y),s=this.GetDragSourceType(e);null!=a&&null!=s&&(this._highLevelDnDDragStartPagePoint=new t.Point(e.pageX,e.pageY),this._isDndDragging=!1)}_onHighLevelDnDPrePointerOver(e){null==this.GetDropTargetType(e)?this.ShowRejectedDropEffect(e):this.ShowDropEffect(e)}_onHighLevelDnDPrePointerOut(e){this.ClearDropEffect()}_onHighLevelDnDPointerMove(e){if(!this._isDndDragging&&this._highLevelDnDDragStartPagePoint&&(Math.abs(e.pageX-this._highLevelDnDDragStartPagePoint.x)>this._HIGH_LEVEL_DND_DRAGSTART_DELTA_THRESHOLD||Math.abs(e.pageY-this._highLevelDnDDragStartPagePoint.y)>this._HIGH_LEVEL_DND_DRAGSTART_DELTA_THRESHOLD)){this._context.getTooltipManager().hideTooltip();const t=this.DragSource.getDragObject();this.ProcessSelectionEventHelper(t,e.ctrlKey),t.hideHoverEffect&&t.hideHoverEffect(),this._onDndDragStart(e)}if(this._isDndDragging){if(null==this.GetDropTargetType(e))return void this.ShowRejectedDropEffect(e);this.ShowDropEffect(e),this._onDnDDragOver(e)}}_onHighLevelDnDPointerUp(e){if(this._highLevelDnDDragStartPagePoint=null,this._isDndDragging){this._highLevelDnDEndExecuted=!0;const t=this.GetDropTargetType(e);this.ClearDropEffect();return null==t||this._onDnDDrop(e),this.DragSource.setDragCandidate(null),void this._onDnDDragEnd(e)}this._comp.SetPanningEnabled(!0),this._comp.SetMarqueeEnabled(!0)}PreOnMouseDown(e){this._onDnDPrePointerDown(e),super.PreOnMouseDown(e)}OnMouseDown(e){super.OnMouseDown(e),this._highLevelDnDEndExecuted=!1,0!==e.button||e.ctrlKey||e.shiftKey||!this._comp.isHighLevelDnDEnabled()||this._keyboardDnDMode||this._onHighLevelDnDPointerDown(e)}PreOnMouseOver(e){this._isDndDragging&&!this._keyboardDnDMode&&this._comp.isHighLevelDnDEnabled()?this._onHighLevelDnDPrePointerOver(e):super.PreOnMouseOver(e)}PreOnMouseOut(e){this._isDndDragging&&!this._keyboardDnDMode&&this._comp.isHighLevelDnDEnabled()?this._onHighLevelDnDPrePointerOut(e):super.PreOnMouseOut(e)}OnMouseOut(e){super.OnMouseOut(e);var t=this._comp.getTimeCursor();t&&t.hide()}OnMouseMove(e){if((!this._comp.isHighLevelDnDEnabled()||this._keyboardDnDMode||(this._onHighLevelDnDPointerMove(e),!this._isDndDragging))&&(super.OnMouseMove(e),this._comp.IsTimeCursorEnabled())){var i=this._comp.getTimeCursor();if(i){var s=t.Agent.isRightToLeft(this._comp.getCtx()),n=this._comp.getTimeCursorContainer(),r=this._comp.getStartTime(),o=this._comp.getEndTime(),h=this._comp.getContentLength(),l=this._comp.getCtx().pageToStageCoords(e.pageX,e.pageY),d=n.stageToLocal(l),g=a.TimeAxisUtils.getPositionDate(r,o,s?h-d.x:d.x,h);i.updateRefObjs([{type:"line",value:new Date(g).toISOString()}]),i.show()}}}OnMouseUp(e){this._comp.isHighLevelDnDEnabled()&&!this._keyboardDnDMode&&(this._onHighLevelDnDPointerUp(e),this._highLevelDnDEndExecuted)||(this._highLevelDnDEndExecuted=!1,super.OnMouseUp(e))}OnClick(e){this._highLevelDnDEndExecuted?this._highLevelDnDEndExecuted=!1:super.OnClick(e)}processDrillEvent(e){if(e&&e.isDrillable&&e.isDrillable()&&"timeAxisLabel"===e.nodeType){const i=t.EventFactory.newGanttTimeAxisDrillEvent(e.intervalStartDate,e.intervalEndDate,e.getAxisType());this._comp.dispatchEvent(i)}}onExpandCollapseButtonClick(e,t){var i=this.GetLogicalObject(t).getRowLayoutObject();this.toggleRowExpandCollapse(e,i)}toggleRowExpandCollapse(e,i){if(null!=i.expanded){var a,s,n,r,o=this._comp.getOptions(),h=o.expanded,l=i.id,d=i.data;if(o.rowData)a=d.id,s=d._itemData;else{var g=i.taskObjs[0].data;a=g.id,s=g._itemData}h.has(l)?(r=h.delete([l]),n="collapse"):(r=h.add([l]),n="expand"),this._comp.setRenderState({state:n,payload:i}),this._comp.isSelectionSupported()&&this._comp.getSelectionHandler().clearSelection(),"collapse"===n&&i.isSticky&&i.node&&i.node.scrollIntoView();var _=t.EventFactory.newGanttExpandCollapseEvent(n,a,d,s,r);this._comp.dispatchEvent(_)}}HandleImmediateTouchStartInternal(e){1===e.targetTouches.length&&this._onDnDPrePointerDown(e)}OnTouchMoveBubble(e){this._isDndDragging&&(this._preventHideTooltip=!0),super.OnTouchMoveBubble(e)}}d.MOVE_TASKS_DATA_TYPE="text/_dvtdndmovetasks",d.RESIZE_TASKS_DATA_TYPE="text/_dvtdndresizetasks",d.KEYBOARD_MOVE="move",d.KEYBOARD_RESIZE_START="resizeStart",d.KEYBOARD_RESIZE_END="resizeEnd";class g extends i.TimeComponentKeyboardHandler{constructor(e,t){super(t),this._gantt=e}static _findPreviousTask(e,t,i,a,s){var n=i.taskObjs;if(0===n.length)return 0===a?s:g._findPreviousTask(e,t,t[a-1],a-1,s);var r=n[n.length-1];return e.getDataLayoutManager().ensureInDOM(r,"task"),r.node}static _findNextTask(e,t,i,a,s){var n=i.taskObjs;if(0===n.length)return a===t.length-1?s:g._findNextTask(e,t,t[a+1],a+1,s);var r=n[0];return e.getDataLayoutManager().ensureInDOM(r,"task"),r.node}static getNextNavigable(e,i,a,s){if(null==i||"task"!==i.nodeType)return null;var n=i.getRowNode(),r=e.getRowLayoutObjs(),o=n.getTaskObjs(),h=t.Agent.isRightToLeft(e.getCtx()),l=n.getIndex();switch(a.keyCode){case h?t.KeyboardEvent.RIGHT_ARROW:t.KeyboardEvent.LEFT_ARROW:var d=o.map(e=>e.node).indexOf(i);if(0!==d){var _=o[d-1];return e.getDataLayoutManager().ensureInDOM(_,"task"),_.node}if(l>0)return g._findPreviousTask(e,r,r[l-1],l-1,i);break;case h?t.KeyboardEvent.LEFT_ARROW:t.KeyboardEvent.RIGHT_ARROW:if((d=o.map(e=>e.node).indexOf(i))!==o.length-1){_=o[d+1];return e.getDataLayoutManager().ensureInDOM(_,"task"),_.node}if(l<r.length-1)return g._findNextTask(e,r,r[l+1],l+1,i);break;case t.KeyboardEvent.UP_ARROW:if(l>0&&null!=(i=g._findPreviousTask(e,r,r[l-1],l-1,i))){_=i.getRowNode().getTaskObjs()[0];return e.getDataLayoutManager().ensureInDOM(_,"task"),_.node}break;case t.KeyboardEvent.DOWN_ARROW:if(l<r.length-1&&null!=(i=g._findNextTask(e,r,r[l+1],l+1,i))){_=i.getRowNode().getTaskObjs()[0];return e.getDataLayoutManager().ensureInDOM(_,"task"),_.node}}return i}isNavigationEvent(e){var i=!1;switch(e.keyCode){case t.KeyboardEvent.OPEN_ANGLED_BRACKET:case t.KeyboardEvent.CLOSE_ANGLED_BRACKET:i=!!e.altKey;break;default:i=super.isNavigationEvent(e)}return i}isSelectionEvent(e){var i=this._eventManager.getFocus();return super.isSelectionEvent(e)&&"task"===i?.nodeType&&!(this._gantt.isRowAxisEnabled()&&e.altKey&&(e.keyCode===t.KeyboardEvent.LEFT_ARROW||e.keyCode===t.KeyboardEvent.RIGHT_ARROW))}_getDistance(e){var t=e.getValue("type"),i=e.getPredecessorNode(),a=e.getSuccessorNode(),s=t===n.START_START||t===n.START_FINISH?i.getValue("start"):i.getValue("end");if(t===n.START_START||t===n.FINISH_START)var r=a.getValue("start");else r=a.getValue("end");return Math.abs(r-s)}_getDependencyComparator(){var e=this;return(t,i)=>{var a=e._getDistance(t),s=e._getDistance(i);return a<s?-1:a>s?1:0}}getFirstNavigableDependencyLine(e,i,a){var s=this._gantt.getCtx(),n=i.keyCode;if(!a||a.length<1||!e)return null;for(var r=t.Agent.isRightToLeft(this._gantt.getCtx()),o=null,h=0,l=0;l<a.length;l++){var d=a[l];if(n===t.KeyboardEvent.CLOSE_ANGLED_BRACKET)var g=r?d.getValue("predecessorTaskId"):d.getValue("successorTaskId");else g=r?d.getValue("successorTaskId"):d.getValue("predecessorTaskId");if(!t.Obj.compareValues(s,e.getId(),g)){var _=this._getDistance(d);(null==o||_<h)&&(h=_,o=d)}}return o}getNextNavigableDependencyLine(e,i,a,s){if(!s)return null;if(!i)return s[0];if(!e)return i;s.sort(this._getDependencyComparator());for(var n=a.keyCode===t.KeyboardEvent.DOWN_ARROW,r=0,o=0;o<s.length;o++){if(s[o]===i){r=n?o===s.length-1?0:o+1:0===o?s.length-1:o-1;break}}return s[r]}isMoveInitiationEvent(e){return e.keyCode===t.KeyboardEvent.M&&e.ctrlKey}isResizeStartInitiationEvent(e){return 83===e.keyCode&&e.altKey}isResizeEndInitiationEvent(e){return 69===e.keyCode&&e.altKey}isDnDScaleUpEvent(e){return this._eventManager.getKeyboardDnDMode()&&e.keyCode===t.KeyboardEvent.PAGE_UP}isDnDScaleDownEvent(e){return this._eventManager.getKeyboardDnDMode()&&e.keyCode===t.KeyboardEvent.PAGE_DOWN}isDnDForwardEvent(e){var i=t.Agent.isRightToLeft(this._gantt.getCtx());return this._eventManager.getKeyboardDnDMode()&&e.keyCode===(i?t.KeyboardEvent.LEFT_ARROW:t.KeyboardEvent.RIGHT_ARROW)}isDnDBackwardEvent(e){var i=t.Agent.isRightToLeft(this._gantt.getCtx());return this._eventManager.getKeyboardDnDMode()&&e.keyCode===(i?t.KeyboardEvent.RIGHT_ARROW:t.KeyboardEvent.LEFT_ARROW)}isMoveRowAboveEvent(e){return this._eventManager.getKeyboardDnDMode()===d.KEYBOARD_MOVE&&e.keyCode===t.KeyboardEvent.UP_ARROW}isMoveRowBelowEvent(e){return this._eventManager.getKeyboardDnDMode()===d.KEYBOARD_MOVE&&e.keyCode===t.KeyboardEvent.DOWN_ARROW}isDnDFinalizeEvent(e){return this._eventManager.getKeyboardDnDMode()&&e.keyCode===t.KeyboardEvent.ENTER}isDnDCancelEvent(e){return this._eventManager.getKeyboardDnDMode()&&e.keyCode===t.KeyboardEvent.ESCAPE}isHighLevelMouseDnDCancelEvent(e){return this._eventManager.isDnDDragging()&&null==this._eventManager.getKeyboardDnDMode()&&e.keyCode===t.KeyboardEvent.ESCAPE}getDefaultNavigable(){for(var e=this._gantt.getRowLayoutObjs(),i=0;i<e.length;i++){var a=e[i].taskObjs;if(a.length>0){t.EventManager.consumeEvent(event);var s=a[0];return this._gantt.getDataLayoutManager().ensureInDOM(s,"task"),s.node}}}processKeyDown(e){var i=t.Agent.isRightToLeft(this._gantt.getCtx()),a=e.keyCode;if(a===t.KeyboardEvent.TAB){if(s=this._eventManager.getFocus())return t.EventManager.consumeEvent(e),s;{const e=this.getDefaultNavigable();if(e)return e}}if(this.isMoveInitiationEvent(e)&&((s=this._eventManager.getFocus())&&"task"===s.nodeType&&s.isSelected()&&this._gantt.isTaskMoveEnabled()&&!this._eventManager.isDnDDragging()))return this._eventManager.handleKeyboardMoveInitiation(e,s),t.EventManager.consumeEvent(e),null;if(this.isResizeStartInitiationEvent(e)&&((s=this._eventManager.getFocus())&&"task"===s.nodeType&&s.isSelected()&&this._gantt.isTaskResizeEnabled()&&!this._eventManager.isDnDDragging()))return this._eventManager.handleKeyboardResizeStartInitiation(e,s),t.EventManager.consumeEvent(e),null;if(this.isResizeEndInitiationEvent(e)&&((s=this._eventManager.getFocus())&&"task"===s.nodeType&&s.isSelected()&&this._gantt.isTaskResizeEnabled()&&!this._eventManager.isDnDDragging()))return this._eventManager.handleKeyboardResizeEndInitiation(e,s),t.EventManager.consumeEvent(e),null;if(this.isDnDCancelEvent(e))return this._eventManager.handleKeyboardDnDCancel(),t.EventManager.consumeEvent(e),null;if(this.isDnDScaleUpEvent(e))return this._eventManager.handleKeyboardDnDScaleUp(e),t.EventManager.consumeEvent(e),null;if(this.isDnDScaleDownEvent(e))return this._eventManager.handleKeyboardDnDScaleDown(e),t.EventManager.consumeEvent(e),null;if(this.isDnDForwardEvent(e))return this._eventManager.handleKeyboardDnDForward(e),t.EventManager.consumeEvent(e),null;if(this.isDnDBackwardEvent(e))return this._eventManager.handleKeyboardDnDBackward(e),t.EventManager.consumeEvent(e),null;if(this.isMoveRowAboveEvent(e))return this._eventManager.handleKeyboardMoveRowAbove(e),t.EventManager.consumeEvent(e),null;if(this.isMoveRowBelowEvent(e))return this._eventManager.handleKeyboardMoveRowBelow(e),t.EventManager.consumeEvent(e),null;if(this.isDnDFinalizeEvent(e))return this._eventManager.handleKeyboardDnDFinalize(e),t.EventManager.consumeEvent(e),null;if(this.isHighLevelMouseDnDCancelEvent(e))return this._eventManager.handleHighLevelMouseDnDCancel(e),t.EventManager.consumeEvent(e),null;if(a===t.KeyboardEvent.SPACE&&e.ctrlKey&&e.shiftKey&&((s=this._eventManager.getFocus())&&"task"===s.nodeType))return t.EventManager.consumeEvent(e),this._eventManager.toggleRowExpandCollapse(e,s.getLayoutObject().rowObj),null;if(a===(i?t.KeyboardEvent.LEFT_ARROW:t.KeyboardEvent.RIGHT_ARROW)&&e.ctrlKey){var s=this._eventManager.getFocus();this._gantt.getDataLayoutManager();if(s&&"rowLabel"===s.nodeType){var n=s.getRowLayoutObject();if(this._gantt.getDataLayoutManager().isRowExpandable(n))return t.EventManager.consumeEvent(e),this._eventManager.toggleRowExpandCollapse(e,s.getRowLayoutObject()),null}}if(a===(i?t.KeyboardEvent.RIGHT_ARROW:t.KeyboardEvent.LEFT_ARROW)&&e.ctrlKey&&((s=this._eventManager.getFocus())&&"rowLabel"===s.nodeType)){n=s.getRowLayoutObject();if(this._gantt.getDataLayoutManager().isRowCollapsible(n))return t.EventManager.consumeEvent(e),this._eventManager.toggleRowExpandCollapse(e,n),null}return a===t.KeyboardEvent.ESCAPE?(this._eventManager.cancelMarquee(e),null):super.processKeyDown(e)}}class _ extends t.Container{constructor(e,t){super(e.getCtx(),null),this._gantt=e,this._task=t,this._isHighlighted=!1}render(e){const i=this._gantt.getOptions();this._content&&this.removeChild(this._content),this._content=new t.Container(this._gantt.getCtx()),this._content.setClassName(this._gantt.GetStyleClass("taskCustom"));var a=t.Agent.isRightToLeft(this._gantt.getCtx());if("css"===this._getClipPathCoordSystem()){var s=this._task.getShape("main"),n=s.getWidth()+s.getPhysicalStartOffset()+s.getPhysicalEndOffset(),r=s.getHeight(),o=new t.Rect(this._gantt.getCtx(),a?-n:0,0,n,r);o.setVisible(!1),this._content.addChild(o)}this.addChild(this._content);const h=this._content.getContainerElem(),l=(0,i.taskContent.renderer)(this.getRendererContext(e));l&&(Array.isArray(l)?l.forEach(e=>{t.ToolkitUtils.appendChildElem(h,e)}):t.ToolkitUtils.appendChildElem(h,l));const d=this._getClipPathDim();this._applyClipPath(d),this._isHighlighted?this.highlight():this.unhighlight()}destroy(){this.setClipPath(null),this.removeFromParent()}getRendererContext(e){const t=this._gantt.getCtx(),i=this._task.getShape("main"),a=this._task.getContainer(),s=a.getRowNode(),n=s.getLayoutObject(),r=a.getData()._itemData,o={data:a.getData(!0),rowData:s.getData(!0),itemData:r||null,content:{height:i.getHeight(),width:i.getWidth()+i.getPhysicalStartOffset()+i.getPhysicalEndOffset()},state:{expanded:!!n.expanded,focused:!!a.isShowingKeyboardFocusEffect(),hovered:e,selected:!!a.isSelected()}};return t.fixRendererContext(o)}highlight(){this._isHighlighted=!0,this._content&&t.ToolkitUtils.addClassName(this._content.getElem(),this._gantt.GetStyleClass("taskHighlight"))}unhighlight(){this._isHighlighted=!1,this._content&&t.ToolkitUtils.removeClassName(this._content.getElem(),this._gantt.GetStyleClass("taskHighlight"))}_getClipPathCoordSystem(){return t.Agent.isRightToLeft(this._gantt.getCtx())?"svg":"css"}_getClipPathDim(e){const i=e||{},a=this._task.getShape("main"),s=t.Agent.isRightToLeft(this._gantt.getCtx()),n=this._getClipPathCoordSystem(),r=null!=i.w?i.w:a.getWidth(),o={y:0,translateY:0,w:r+a.getPhysicalStartOffset()+a.getPhysicalEndOffset(),h:null!=i.h?i.h:a.getHeight(),r:null!=i.r?i.r:a.getBorderRadius(),_coordSystem:n};return"svg"===n?(o.x=s?0-r-a.getPhysicalEndOffset():0-a.getPhysicalStartOffset(),o.translateX=s?0+a.getPhysicalStartOffset():0-a.getPhysicalStartOffset()):(o.x=0,o.translateX=0-a.getPhysicalStartOffset()),o}_applyClipPath(e){const{x:i,y:a,w:s,h:n,r:r}=e,o=t.PathUtils.rectangleWithBorderRadius(i,a,s,n,r,Math.min(s,n),"0");if("css"===e._coordSystem)this.getElem().style.clipPath=`path('${o}')`;else{const e=new t.ClipPath;e.addPath(o),this.setClipPath(e)}}setWidth(e){const t=this._getClipPathDim({w:e});this._applyClipPath(t)}setHeight(e){const t=this._getClipPathDim({h:e});this._applyClipPath(t)}setX(e){const t=this._getClipPathDim({x:e});this.setTranslateX(t.translateX),this._applyClipPath(t)}setY(e){const t=this._getClipPathDim({y:e});this.setTranslateY(t.translateY),this._applyClipPath(t)}setBorderRadius(e){const t=this._getClipPathDim({r:e});this._applyClipPath(t)}setDimensions(e,t,i,a,s){const n=this._getClipPathDim({x:e,y:t,w:i,h:a,r:s});this.setTranslate(n.translateX,n.translateY),this._applyClipPath(n)}}class c{constructor(e,t){this._gantt=e,this._container=t}getGantt(){return this._gantt}getContainer(){return this._container}getShape(e){return"main"===e?this._mainShape:"progress"===e?this._progressShape:"baseline"===e?this._baselineShape:"overtime"===e?this._overtimeShape:"downtime"===e?this._downtimeShape:"attribute"===e?this._attributeShape:"mainResizeHandleStart"===e?this._mainHandleStart:"mainResizeHandleEnd"===e?this._mainHandleEnd:void 0}getSvgStyle(e){return null==e?this._container.getValue("svgStyle"):this._container.getValue(e,"svgStyle")}getSvgClassName(e){return null==e?this._container.getValue("svgClassName")||this._container.getValue("className"):this._container.getValue(e,"svgClassName")||this._container.getValue(e,"className")}_applyStyles(e,t){const i=this.getSvgClassName(t),a=this.getSvgStyle(t);e.applyStyleClasses(i),a&&e.setStyle(a)}_applyMainContainerClippath(){if(t.Agent.isRightToLeft(this._gantt.getCtx())&&"firefox"!==t.Agent.browser){var e=this._mainShape.getWidth();this._mainContainer.setStyle({clipPath:`path('${this._mainShape.generateCmd(this._mainShape.getX()+e,this._mainShape.getY(),e,this._mainShape.getHeight(),this._mainShape.getBorderRadius())}')`})}else this._mainContainer.setStyle({clipPath:`path('${this._mainShape.getCmds()}')`})}isMilestone(e){var t,i,a=this._container.getValue("type");return"milestone"===a||"auto"===a&&("mainDragFeedback"===e||o.MAIN_TYPES.indexOf(e)>-1?(t=this._container.getValue("start"),i=this._container.getValue("end")):o.BASELINE_TYPES.indexOf(e)>-1&&(t=this._container.getValue("baseline","start"),i=this._container.getValue("baseline","end")),null!=t&&t==i)}isSummary(e){return"main"===e&&"summary"===this._container.getValue("type")}getTimeSpanDimensions(e,i){var s,n,r=this._gantt.getStartTime(),o=this._gantt.getEndTime(),h=this._gantt.getContentLength(),l=t.Agent.isRightToLeft(this._gantt.getCtx());return null!=e||null!=i?(s=a.TimeAxisUtils.getDatePosition(r,o,e,h),n=a.TimeAxisUtils.getDatePosition(r,o,i,h),l&&(s=h-s,n=h-n),{startPos:s,endPos:n,distance:n-s}):null}getFillColor(){if(null==this._fillColor){if(null==this._mainShape)return null;this._fillColor=this._mainShape.getFillColor()}return this._fillColor}getFinalHeight(e){var t=this._container.getLayoutObject();return e?t.overallHeightNoProgress:t.overallHeight}showEffect(e){if(this.showMainEffect(e),"selected"===e){var t=this._container.getRowNode();t&&t.showEffect("selected")}}removeEffect(e,t){if(this.removeMainEffect(e,t),"selected"===e){var i=this._container.getRowNode();i&&i.removeEffect("selected")}}render(e){var t=this._container.getValue("progress","height");this.renderBaseline(t),this.renderMain(t,e),this.renderProgress(t),this.renderOvertime(),this.renderDowntime(),this.renderAttribute(),"summary"===this._container.getValue("type")&&this._mainShape&&"alta"===this._gantt.getCtx().getThemeBehavior()&&this._container.addChild(this._mainShape),this._mainCustomContent&&this._container.addChild(this._mainCustomContent)}isMainCustomContent(){var e=this._gantt.getOptions();return e.taskContent&&e.taskContent.renderer}getRenderState(e){return"main"===e?this._mainShape.getRenderState():"progress"===e?this._progressShape.getRenderState():"baseline"===e?this._baselineShape.getRenderState():"overtime"===e?this._overtimeShape.getRenderState():"downtime"===e?this._downtimeShape.getRenderState():"attribute"===e?this._attributeShape.getRenderState():void 0}renderBaseline(e){var t,i,a,n,r,h,l,d,g,_,c,u,p,m=this._gantt.getOptions(),b=this._container.getValue("baseline"),v=this;b?(i=this._container.getValue("baseline","start"),a=this._container.getValue("baseline","end"),(d=this.getTimeSpanDimensions(i,"milestone"===this._container.getValue("type")&&i!=a?i:a))?(h=this.getTimeSpanDimensions(this._container.getValue("start"),i),t=this.isMilestone("baseline"),g=h?h.distance:0,c=Math.abs(d.distance),u=this._container.getValue("baseline","height"),n=t?Math.max(this._container.getValue("height"),u)+s.getMilestoneBaselineYOffset(m)-u:this._container.getValue("height")+s.getBaselineMarginTop(m),_=Math.max(0,(e-this._container.getValue("height"))/2)+n,p=t?m._resources.milestoneBaselineBorderRadius:b.borderRadius,null==this._baselineShape?(this._baselineShape=new o(this._gantt.getCtx(),g,_,c,u,p,this,"baseline"),t?this._container.addChildAt(this._baselineShape,0):this._container.addChild(this._baselineShape),this._baselineShape.setRenderState("add")):(this._baselineShape.setRenderState("exist"),t&&this._container.addChildAt(this._baselineShape,0)),this._baselineShape.setFinalWidth(c),this._baselineShape.setFinalHeight(u),this._baselineShape.setFinalX(g),this._baselineShape.setFinalY(_),l=()=>{v._applyStyles(v._baselineShape,"baseline")},r={x:g,y:_,w:c,h:u,r:p},this._gantt.getAnimationManager().preAnimateTaskBaseline(this,this._baselineShape,r,l)):this.removeBaseline()):this.removeBaseline()}removeBaseline(){var e,t=this;this._baselineShape&&(e=()=>{t._container.removeChild(t._baselineShape),t._baselineShape=null},this._gantt.getAnimationManager().preAnimateTaskBaselineRemove(this._baselineShape,e))}renderMain(e,i){var a,s,n,r,h,l,d,g,c,u,p=this._container.getData(),m=this._container.getValue("height"),b=this._container.getValue("start"),v=this._container.getValue("end"),S=this._gantt.getCtx(),D=t.Agent.isRightToLeft(S),T=S.getThemeBehavior(),y=this,C=this._gantt.getOptions();if(p)if(n=this.getTimeSpanDimensions(b,"milestone"===this._container.getValue("type")&&b!=v?b:v)){if(0,r=Math.max(0,(e-m)/2),h=Math.abs(n.distance),l=this.isSummary("main")&&"alta"===T?this._container.getFinalHeight(!0):m,g=this.isMilestone("main"),u=this._gantt.getViewportDensity()>1,"0"===(c=g?C._resources.milestoneBorderRadius:this._container.getValue("borderRadius"))||"0px"===c||u)d="0";else switch(this._container.getLayoutObject().aggregation){case"stackStart":d=D?`0px ${c} ${c} 0px`:`${c} 0px 0px ${c}`;break;case"stackMiddle":d="0";break;case"stackEnd":d=D?`${c} 0px 0px ${c}`:`0px ${c} ${c} 0px`;break;default:d=c}null==this._mainShape?("alta"===T||u||(this._mainBackgroundShape=new o(S,0,r,h,l,d,this,"mainBackground"),this._container.addChild(this._mainBackgroundShape)),this._mainShape=new o(S,0,r,h,l,d,this,"main"),this._container.addChild(this._mainShape),this._mainShape.setRenderState("add")):(this._mainShape.setRenderState("exist"),"alta"!==T&&(u?this._mainBackgroundShape&&(this._container.removeChild(this._mainBackgroundShape),this._mainBackgroundShape=null):this._mainBackgroundShape||(this._mainBackgroundShape=new o(S,0,r,h,l,d,this,"mainBackground"),this._container.addChildAt(this._mainBackgroundShape,this._container.getChildIndex(this._mainShape))))),this._mainShape.setFinalWidth(h),this._mainShape.setFinalHeight(l),this._mainShape.setFinalX(0),this._mainShape.setFinalY(r),this.isMainCustomContent()&&"add"===this._mainShape.getRenderState()&&(this._mainCustomContent&&this._mainCustomContent.destroy(),this._mainCustomContent=new _(this._gantt,this),this._mainCustomContent.render(!1));var f="on"===this._container.getValue("attribute","rendered"),k=null!=this.getProgressValue(),E=null!=this._container.getValue("downtime","start")||null!=this._container.getValue("downtime","end"),O=null!=this._container.getValue("overtime","start")||null!=this._container.getValue("overtime","end");"alta"!==T&&!g&&"0"!==d&&(f||k||E||O)?null==this._mainContainer&&(this._mainContainer=new t.Container(S),this._mainContainerSupport=new t.Rect(this._gantt.getCtx(),D?-h:0,0,h,l),this._mainContainerSupport.setVisible(!1),this._mainContainer.addChild(this._mainContainerSupport),this._applyMainContainerClippath(),this._container.addChild(this._mainContainer)):null!=this._mainContainer&&(this._container.removeChild(this._mainContainer),this._mainContainer=null,this._mainContainerSupport=null),s=()=>{y._fillColor=null,y._applyStyles(y._mainShape),i&&y._mainCustomContent&&"exist"===y._mainShape.getRenderState()&&y._mainCustomContent.render(!1)},a={x:0,y:r,w:h,h:l,r:d},this._gantt.getAnimationManager().preAnimateTaskMain(this,a,s)}else this.removeMain();else this.removeMain()}showMainEffect(e){var t=this._mainShape.getX(),i=this._mainShape.getY(),a=this._mainShape.getWidth(),s=this._mainShape.getHeight(),n=this._mainShape.getBorderRadius(),r=e=>{var t=e.getParent();if(null!=t){var i=e.getRowNode().getLayoutObject(),a=e.getLayoutObject(),s=i.earliestOverlayTaskObj;if(s&&"overlay"!==a._overlayBehavior){var n=s.node;if(n&&n.getParent()){var r=t.getChildIndex(n);t.addChildAt(e,r-1)}else t.addChild(e)}else t.addChild(e)}};if("selected"===e)null==this._mainSelectShape&&(this._mainSelectShape=new o(this._gantt.getCtx(),t,i,a,s,n,this,"mainSelect"),this._container.addChildAt(this._mainSelectShape,0),this._mainCustomContent&&this._mainCustomContent.render(!1),r(this._container));else if(("hover"===e||"focus"===e)&&null==this._mainHoverShape){var h="hover"===e?"mainHover":"mainFocus";this._mainHoverShape=new o(this._gantt.getCtx(),t,i,a,s,n,this,h),this._container.addChildAt(this._mainHoverShape,this._container.getChildIndex(this._mainShape)),this._mainCustomContent&&this._mainCustomContent.render("hover"===e),"on"!==this._gantt.getOptions().taskAggregation&&r(this._container)}this._mainShape.isHighlighted()&&(this._mainSelectShape&&this._mainSelectShape.highlight(),this._mainHoverShape&&this._mainHoverShape.highlight())}removeMainEffect(e,t){var i="on"===this._gantt.getOptions().taskAggregation;if(t=(void 0===t||t)&&!i,"selected"===e?(null!=this._mainSelectShape&&this._container.removeChild(this._mainSelectShape),this._mainSelectShape=null):"hover"!==e&&"focus"!==e||(null!=this._mainHoverShape&&this._container.removeChild(this._mainHoverShape),this._mainHoverShape=null),this._mainCustomContent&&this._mainCustomContent.render(!1),t){var a=this._container.getRowNode().getRenderOrderTaskObjs();if(a.length<2)return;var s=this._container.getParent();if(!s)return;for(var n=this._container.getLayoutObject(),r=this._container,o=a.indexOf(n)-1;o>=0;o--){var h=a[o].node;if(h&&!h.isSelected()&&h.getParent()){var l=s.getChildIndex(h);return void s.addChildAt(r,l)}}s.addChildAt(r,0)}}getMainWidth(){return this._mainShape.getWidth()}_setMainContainerSupportWidth(e){t.Agent.isRightToLeft(this._gantt.getCtx())&&this._mainContainerSupport.setX(-e),this._mainContainerSupport.setWidth(e)}setMainWidth(e){this._mainShape.setWidth(e),this._mainBackgroundShape&&this._mainBackgroundShape.setWidth(e),this._mainSelectShape&&this._mainSelectShape.setWidth(e),this._mainHoverShape&&this._mainHoverShape.setWidth(e),this._mainCustomContent&&this._mainCustomContent.setWidth(e),this._mainContainer&&this._applyMainContainerClippath(),this._mainContainerSupport&&this._setMainContainerSupportWidth(e)}getMainHeight(){return this._mainShape.getHeight()}setMainHeight(e){this._mainShape.setHeight(e),this._mainBackgroundShape&&this._mainBackgroundShape.setHeight(e),this._mainSelectShape&&this._mainSelectShape.setHeight(e),this._mainHoverShape&&this._mainHoverShape.setHeight(e),this._mainCustomContent&&this._mainCustomContent.setHeight(e),this._mainContainer&&this._applyMainContainerClippath(),this._mainContainerSupport&&this._mainContainerSupport.setHeight(e)}getMainX(){return this._mainShape.getX()}setMainX(e){this._mainShape.setX(e),this._mainBackgroundShape&&this._mainBackgroundShape.setX(e),this._mainSelectShape&&this._mainSelectShape.setX(e),this._mainHoverShape&&this._mainHoverShape.setX(e),this._mainCustomContent&&this._mainCustomContent.setX(e),this._mainContainer&&this._applyMainContainerClippath()}getMainY(){return this._mainShape.getY()}setMainY(e){this._mainShape.setY(e),this._mainBackgroundShape&&this._mainBackgroundShape.setY(e),this._mainSelectShape&&this._mainSelectShape.setY(e),this._mainHoverShape&&this._mainHoverShape.setY(e),this._mainCustomContent&&this._mainCustomContent.setY(e),this._mainContainer&&this._applyMainContainerClippath()}getMainBorderRadius(){return this._mainShape.getBorderRadius()}setMainBorderRadius(e){this._mainShape.setBorderRadius(e),this._mainBackgroundShape&&this._mainBackgroundShape.setBorderRadius(e),this._mainSelectShape&&this._mainSelectShape.setBorderRadius(e),this._mainHoverShape&&this._mainHoverShape.setBorderRadius(e),this._mainCustomContent&&this._mainCustomContent.setBorderRadius(e),this._mainContainer&&this._applyMainContainerClippath()}setMainDimensions(e,t,i,a,s){this._mainShape.setDimensions(e,t,i,a,s),this._mainBackgroundShape&&this._mainBackgroundShape.setDimensions(e,t,i,a,s),this._mainSelectShape&&this._mainSelectShape.setDimensions(e,t,i,a,s),this._mainHoverShape&&this._mainHoverShape.setDimensions(e,t,i,a,s),this._mainCustomContent&&this._mainCustomContent.setDimensions(e,t,i,a,s),this._mainContainer&&this._applyMainContainerClippath(),this._mainContainerSupport&&(this._setMainContainerSupportWidth(i),this._mainContainerSupport.setHeight(a))}removeMain(){var e,t=this;this._mainShape&&(e=()=>{t._mainCustomContent&&(t._mainCustomContent.destroy(),t._mainCustomContent=null),t.removeMainEffect("selected",!1),t._mainBackgroundShape&&(t._container.removeChild(t._mainBackgroundShape),t._mainBackgroundShape=null),t._container.removeChild(t._mainShape),t._mainShape=null,t._mainContainer&&(t._container.removeChild(t._mainContainer),t._mainContainer=null)},this._gantt.getAnimationManager().preAnimateTaskMainRemove(this._mainShape,this._mainBackgroundShape,this._mainSelectShape,this._mainHoverShape,this._mainCustomContent,this._mainContainer,e))}getProgressValue(){var e=this._container.getValue("progress","value");return this.isMilestone("main")||"number"!=typeof e?null:e}renderProgress(e){var t,i,a,s,n,r,h=this._container.getValue("height"),l=this.getProgressValue(),d=this;null!==l&&this._mainShape&&!this.isMilestone("main")?(a=Math.max(0,(h-e)/2),s=l*this._mainShape.getFinalWidth(),n=this._container.getValue("progress","borderRadius"),r="progress",0===l?r="progressZero":1===l&&(r="progressFull"),null==this._progressShape?(this._progressShape=new o(this._gantt.getCtx(),0,a,s,e,n,this,r),this._progressShape.setRenderState("add")):(this._progressShape.setType(r),this._progressShape.setRenderState("exist")),(this._mainContainer||this._container).addChild(this._progressShape),this._progressShape.setFinalWidth(s),this._progressShape.setFinalHeight(e),this._progressShape.setFinalX(0),this._progressShape.setFinalY(a),t=()=>{d._applyStyles(d._progressShape,"progress")},i={x:0,y:a,w:s,h:e,r:n},this._gantt.getAnimationManager().preAnimateTaskProgress(this,this._progressShape,i,t)):this.removeProgress()}removeProgress(){var e,t=this;this._progressShape&&(e=()=>{t._progressShape&&(t._progressShape.removeFromParent(),t._progressShape=null)},this._gantt.getAnimationManager().preAnimateTaskProgressRemove(this._progressShape,e))}renderOvertime(){var e=this;if(this._mainShape&&!this.isMilestone("main")){var t=this._container.getValue("overtime","start"),i=this._container.getValue("overtime","end"),a=this.getTimeSpanDimensions(t,i);if(a){var s=this._container.getValue("start"),n=this._container.getLayoutObject(),r=this.getTimeSpanDimensions(s,t).distance,h=n.overtimeHeight,l=Math.abs(a.distance);null==this._overtimeShape?(this._overtimeShape=new o(this._gantt.getCtx(),r,0,l,h,"0",this,"overtime"),this._overtimeShape.setRenderState("add")):this._overtimeShape.setRenderState("exist"),(this._mainContainer||this._container).addChild(this._overtimeShape),this._overtimeShape.setFinalWidth(l),this._overtimeShape.setFinalHeight(h),this._overtimeShape.setFinalX(r),this._overtimeShape.setFinalY(0);var d={x:r,y:0,w:l,h:h,r:"0"};this._gantt.getAnimationManager().preAnimateTaskOvertime(this,this._overtimeShape,d,()=>{e._applyStyles(e._overtimeShape,"overtime")})}else this.removeOvertime()}else this.removeOvertime()}removeOvertime(){var e,t=this;this._overtimeShape&&(e=()=>{t._overtimeShape&&(t._overtimeShape.removeFromParent(),t._overtimeShape=null)},this._gantt.getAnimationManager().preAnimateTaskOvertimeRemove(this._overtimeShape,e))}renderDowntime(){var e=this;if(this._mainShape&&!this.isMilestone("main")){var t=this._container.getValue("downtime","start"),i=this._container.getValue("downtime","end"),a=this.getTimeSpanDimensions(t,i);if(a){var s=this._gantt.getOptions(),n=this._container.getValue("start"),r=this._container.getLayoutObject(),h=this.getTimeSpanDimensions(n,t).distance,l=r.downtimeHeight,d=this._mainShape.getFinalHeight()-l,g=Math.abs(a.distance),_=s._resources.taskDowntimeBorderRadius,c=`${_} ${_} 0px 0px`;null==this._downtimeShape?(this._downtimeShape=new o(this._gantt.getCtx(),h,d,g,l,c,this,"downtime"),this._downtimeShape.setRenderState("add")):this._downtimeShape.setRenderState("exist"),(this._mainContainer||this._container).addChild(this._downtimeShape),this._downtimeShape.setFinalWidth(g),this._downtimeShape.setFinalHeight(l),this._downtimeShape.setFinalX(h),this._downtimeShape.setFinalY(d);var u={x:h,y:d,w:g,h:l,r:c};this._gantt.getAnimationManager().preAnimateTaskDowntime(this,this._downtimeShape,u,()=>{e._applyStyles(e._downtimeShape,"downtime")})}else this.removeDowntime()}else this.removeDowntime()}removeDowntime(){var e,t=this;this._downtimeShape&&(e=()=>{t._downtimeShape&&(t._downtimeShape.removeFromParent(),t._downtimeShape=null)},this._gantt.getAnimationManager().preAnimateTaskDowntimeRemove(this._downtimeShape,e))}renderAttribute(){var e=this;if("on"===this._container.getValue("attribute","rendered")&&this._mainShape&&!this.isMilestone("main")){var t=this._container.getLayoutObject().attributeHeight,i=this._mainShape.getFinalWidth();null==this._attributeShape?(this._attributeShape=new o(this._gantt.getCtx(),0,0,i,t,"0",this,"attribute"),this._attributeShape.setRenderState("add")):this._attributeShape.setRenderState("exist"),(this._mainContainer||this._container).addChild(this._attributeShape),this._attributeShape.setFinalWidth(i),this._attributeShape.setFinalHeight(t),this._attributeShape.setFinalX(0),this._attributeShape.setFinalY(0);var a={x:0,y:0,w:i,h:t,r:"0"};this._gantt.getAnimationManager().preAnimateTaskAttribute(this,this._attributeShape,a,()=>{e._applyStyles(e._attributeShape,"attribute")})}else this.removeAttribute()}removeAttribute(){var e,t=this;this._attributeShape&&(e=()=>{t._attributeShape&&(t._attributeShape.removeFromParent(),t._attributeShape=null)},this._gantt.getAnimationManager().preAnimateTaskAttributeRemove(this._attributeShape,e))}renderMainResizeHandles(e){var i,a,n,r,h,l=t.Agent.isRightToLeft(this._gantt.getCtx())?-1:1;if(this._mainShape){i=s.getTaskResizeHandleWidth(),a=this._mainShape.getX()-l*this._mainShape.getPhysicalStartOffset(),n=this._mainShape.getY(),r=this._mainShape.getWidth()+this._mainShape.getPhysicalStartOffset()+this._mainShape.getPhysicalEndOffset(),h=this._mainShape.getHeight();var d=this,g=(e,i)=>{if(t.Agent.isTouchDevice()||t.Agent.isEnvironmentTest()){var a=d._gantt.getOptions().translations,s="start"===i?a.taskResizeStartHandle:a.taskResizeEndHandle;e.setAriaRole("img"),e.setAriaProperty("label",s)}};this._mainHandleStart?this._mainHandleStart.setDimensions(a,n,i,h,"0"):(this._mainHandleStart=new o(this._gantt.getCtx(),a,n,i,h,"0",this,"mainResizeHandleStart"),g(this._mainHandleStart,"start")),e.addChild(this._mainHandleStart),this._mainHandleEnd?this._mainHandleEnd.setDimensions(a+l*(r-i),n,i,h,"0"):(this._mainHandleEnd=new o(this._gantt.getCtx(),a+l*(r-i),n,i,h,"0",this,"mainResizeHandleEnd"),g(this._mainHandleEnd,"end")),e.addChild(this._mainHandleEnd)}}removeHandles(e){this._mainHandleStart&&e!==this._mainHandleStart&&(this._mainHandleStart.getParent().removeChild(this._mainHandleStart),this._mainHandleStart=null),this._mainHandleEnd&&e!==this._mainHandleEnd&&(this._mainHandleEnd.getParent().removeChild(this._mainHandleEnd),this._mainHandleEnd=null)}highlight(){this._mainShape&&this._mainShape.highlight(),this._mainSelectShape&&this._mainSelectShape.highlight(),this._mainHoverShape&&this._mainHoverShape.highlight(),this._mainCustomContent&&this._mainCustomContent.highlight(),this._baselineShape&&this._baselineShape.highlight(),this._progressShape&&this._progressShape.highlight(),this._attributeShape&&this._attributeShape.highlight(),this._overtimeShape&&this._overtimeShape.highlight(),this._downtimeShape&&this._downtimeShape.highlight()}unhighlight(){this._mainShape&&this._mainShape.unhighlight(),this._mainSelectShape&&this._mainSelectShape.unhighlight(),this._mainHoverShape&&this._mainHoverShape.unhighlight(),this._mainCustomContent&&this._mainCustomContent.unhighlight(),this._baselineShape&&this._baselineShape.unhighlight(),this._progressShape&&this._progressShape.unhighlight(),this._attributeShape&&this._attributeShape.unhighlight(),this._overtimeShape&&this._overtimeShape.unhighlight(),this._downtimeShape&&this._downtimeShape.unhighlight()}}class u{constructor(e,t,i){this._gantt=e,this._container=t,this._associatedShape=i,this._renderState="add"}getGantt(){return this._gantt}getAssociatedShape(){return this._associatedShape}setAssociatedShape(e){this._associatedShape=e}getLabelOutputText(){return this._labelOutputText}getEffectiveLabelPosition(){return this._effectiveLabelPosition}getRenderState(){return this._renderState}_getLabelCSSStyle(e){let t;return null!=e&&Object.keys(e).length>0?(t=s.getTaskLabelStyle(this._gantt.getOptions()),t.parseInlineStyle(e)):t=this._gantt.getCache().getFromCache("baseTaskLabelCSSStyle"),t}_applyStyles(e,t){null!=e&&Object.keys(e).length>0&&this._labelOutputText.getStyle()!==e&&this._labelOutputText.setStyle(e),this._labelOutputText.getCSSStyle()!==t&&this._labelOutputText.setCSSStyle(t)}_placeLabel(e){var i,a,n,r,o,h,l=this._labelOutputText.getDimensions(),d=t.Agent.isRightToLeft(this._gantt.getCtx()),g=this._gantt.getOptions(),_=s.getTaskPadding(g),c=s.getTaskLabelMargin(g),u=_+c;switch("progress"!==e&&"progressStart"!==e||this.setAssociatedShape(this._container.getTask().getShape("progress")),h="main"===this._associatedShape.getType()&&this._container.getTask().isSummary("main")&&"alta"===this._gantt.getCtx().getThemeBehavior()?this._container.getLayoutObject().height:this._associatedShape.getFinalHeight(),o=this._associatedShape.getFinalY()+(h-l.h)/2,this.setFinalY(o),n=this._associatedShape.getFinalWidth(),i=d?this._associatedShape.getPhysicalEndOffset():this._associatedShape.getPhysicalStartOffset(),a=d?this._associatedShape.getPhysicalStartOffset():this._associatedShape.getPhysicalEndOffset(),e){case"end":d?this._labelOutputText.alignRight():this._labelOutputText.alignLeft(),r=n+a+c;break;case"progress":d?this._labelOutputText.alignLeft():this._labelOutputText.alignRight(),r=n-u;break;case"oProgress":d?this._labelOutputText.alignRight():this._labelOutputText.alignLeft(),r=this._container.getTask().getShape("progress").getFinalWidth()+u;break;case"innerStart":case"progressStart":d?this._labelOutputText.alignRight():this._labelOutputText.alignLeft(),r=-i+u;break;case"innerEnd":d?this._labelOutputText.alignLeft():this._labelOutputText.alignRight(),r=n+a-u;break;case"innerCenter":this._labelOutputText.alignCenter(),r=n/2;break;case"start":d?this._labelOutputText.alignLeft():this._labelOutputText.alignRight(),r=-(i+c)}d&&(r=-r),this.setFinalX(r),this._effectiveLabelPosition=e}_getAvailableWidth(e){var i,a,n,r,o,h,l,d,g,_,c,u,p,m,b,v,S,D,T,y,C,f,k=this._container.getLayoutObject(),E=this._container.getTask(),O=s.getTaskPadding(this._gantt.getOptions()),w=s.getTaskLabelMargin(this._gantt.getOptions()),R=O+w,A=t.Agent.isRightToLeft(this._gantt.getCtx()),x=this._gantt.getContentLength(),L=!1;switch(f=x-(C=A?x:0),e){case"end":case"end_ABSOLUTE":if(D="end",a=f,r=k.nextAdjacentTaskObj,o=k.nextAdjMilestoneBaselineTaskObj,r&&r.startTime<k.endTime&&r.endTime>k.endTime){S=0;break}for(;r&&r.startTime<k.endTime&&r.endTime<k.endTime;)r=r.nextAdjacentTaskObj;if(r)if((d=r.node)&&d.getParent())a=d.getTaskShapePhysicalBounds("main").startPos;else if(null!=r.startTime||null!=r.endTime){a=E.getTimeSpanDimensions(r.startTime,r.endTime).startPos}if(o)if((g=o.node)&&g.getParent())a=A?Math.max(a,g.getTaskShapePhysicalBounds("baseline").startPos):Math.min(a,g.getTaskShapePhysicalBounds("baseline").startPos);else if(null!=o.startTime||null!=o.endTime){var M=E.getTimeSpanDimensions(o.baselineStartTime,o.baselineEndTime).startPos;a=A?Math.max(a,M):Math.min(a,M)}S=Math.abs(this._container.getTaskShapePhysicalBounds("main").endPos-a)-2*w;break;case"innerCenter":case"innerStart":case"innerEnd":(r=k.nextAdjacentTaskObj)&&("innerCenter"===e?L=r.startTime<k.startTime+(k.endTime-k.startTime)/2:"innerEnd"===e&&(L=r.startTime<k.endTime));case"innerCenter_ABSOLUTE":case"innerStart_ABSOLUTE":case"innerEnd_ABSOLUTE":if("_ABSOLUTE"===e.slice(-9)&&(e=e.slice(0,-9)),y=this._labelOutputText&&"number"==typeof this._container.getValue("progress","value"),!E.isMilestone("main")){if(L){S=0,D=e;break}if(c=this._container.getTaskShapePhysicalBounds("main"),b=Math.abs(c.endPos-c.startPos),y){if(T=this._labelOutputText.getDimensions(),(u=E.getShape("progress"))?(p=u.getFinalWidth(),m=u.getFinalHeight()):(p=0,m=0),v=b-p,"innerStart"===e){if(S=p-2*R,T.w<=S&&T.h<=m){D="progressStart";break}}else if("innerEnd"===e&&(S=v-2*R,T.w<S)){D="innerEnd";break}T.h<=m&&p>v?(S=p-2*R,D="progress"):(S=v-2*R,D="oProgress");break}S=b-2*R,D=e;break}S=0,D=e;break;case"start":case"start_ABSOLUTE":if(D="start",i=C,n=k.previousAdjacentTaskObj,h=k.previousAdjacentMilestoneBaselineTaskObj,n&&n.endTime>k.startTime&&n.startTime<k.startTime){S=0;break}if(n)if((l=n.node)&&l.getParent())i=l.getTaskShapePhysicalBounds("main",!0).endPos;else if(null!=n.startTime||null!=n.endTime){i=E.getTimeSpanDimensions(n.startTime,n.endTime).endPos}if(h)if((_=h.node)&&_.getParent())i=A?Math.min(i,_.getTaskShapePhysicalBounds("baseline").endPos):Math.max(i,_.getTaskShapePhysicalBounds("baseline").endPos);else if(null!=h.startTime||null!=h.endTime){var P=E.getTimeSpanDimensions(h.baselineStartTime,h.baselineEndTime).endPos;i=A?Math.max(i,P):Math.min(i,P)}S=Math.abs(i-this._container.getTaskShapePhysicalBounds("main").startPos)-2*w;break;default:return null}return[D,S]}_preprocessLabelPosition(e){var t=this._container.getTask().isMilestone("main");if("string"==typeof e){if(t)switch(e){case"innerCenter":case"innerEnd":e="end";break;case"innerStart":e="start"}return[e+"_ABSOLUTE"]}return Array.isArray(e)?t?e.map(e=>{switch(e){case"innerCenter":case"innerEnd":return"end";case"innerStart":return"start";default:return e}}):e:[]}_evaluatePosition(e){for(var i,a,s,n={},r=this._labelOutputText.getDimensions().w,o=0,h=0;h<e.length;h++){var l=e[h];if("max"!==l){if(n[l]?d=n[l]:(d=this._getAvailableWidth(l),n[l]=d),d){if(i=d[0],r<=(a=d[1]))break;a>o&&(o=a,s=l)}}else if(null!=s){var d=n[s];i=d[0],a=d[1];break}}if(null==i)return!1;if(a<=1)return!1;let g=!0;return r>a&&(g=t.TextUtils.fitText(this._labelOutputText,a,1/0,this._container,1)),!!g&&(this._placeLabel(i),!0)}render(){var e,i,a=this._gantt.getCtx(),s=this._container.getValue("label"),n=this._container.getValue("labelPosition"),r=this._container.getValue("labelStyle"),o=this,h=this._gantt.GetStyleClass("taskLabel");if(this._renderState="exist",null!=s&&s.length>0&&"none"!==n&&this._associatedShape){const l=this._getLabelCSSStyle(r),d=this._preprocessLabelPosition(n);if(1===d.length&&"_ABSOLUTE"===d[0].slice(-9)){const e=this._getAvailableWidth(d[0])[1];if(e<=0)return void this.remove();const i=t.TextUtils.getTextStringWidth(a,"|",l);if(i*s.length>e){if(1===s.length)return void this.remove();if(i+t.TextUtils.getTextStringWidth(a,t.TextUtils.ELLIPSIS,l)>e)return void this.remove()}}null==this._labelOutputText&&(this._labelOutputText=new t.OutputText(this._gantt.getCtx(),s,0,0),this._gantt.getEventManager().IsDragSupported("tasks")&&(h+=" "+this._gantt.GetStyleClass("draggable")),this._labelOutputText.setClassName(h),this._renderState="add"),null==this._labelOutputText.getParent()&&this._container.addChild(this._labelOutputText),this._labelOutputText.setTextString(s),this._applyStyles(r,l),this._evaluatePosition(d)?(i=()=>{switch(o._effectiveLabelPosition){case"innerCenter":case"innerEnd":case"innerStart":case"progressStart":case"progress":case"oProgress":const e=o._associatedShape.getFillColor();if(e&&(!e.fromShapeCache||!o._labelOutputText.getFill())&&(!r||!r.color)){const i=t.ColorUtils.getContrastingTextColor(e.computedFill);o._labelOutputText.setFill(new t.SolidFill(i))}break;default:o._labelOutputText.getFill()&&(o._labelOutputText.setFill(),t.ToolkitUtils.setAttrNullNS(o._labelOutputText.getElem(),"fill",void 0))}},e={x:this.getFinalX(),y:this.getFinalY()},this._gantt.getAnimationManager().preAnimateTaskLabel(this._container,e,i)):this.remove()}else this.remove()}remove(){var e,t=this;this._labelOutputText&&(e=()=>{t._container.removeChild(t._labelOutputText),t._labelOutputText=null,t._effectiveLabelPosition=null},this._gantt.getAnimationManager().preAnimateTaskLabelRemove(this._labelOutputText,e))}highlight(){this._labelOutputText&&!this._isHighlighted&&t.ToolkitUtils.addClassName(this._labelOutputText.getElem(),this._gantt.GetStyleClass("taskHighlight")),this._isHighlighted=!0}unhighlight(){this._labelOutputText&&this._isHighlighted&&t.ToolkitUtils.removeClassName(this._labelOutputText.getElem(),this._gantt.GetStyleClass("taskHighlight")),this._isHighlighted=!1}getFinalX(){return this._finalX}setFinalX(e){this._finalX=e}getFinalY(){return this._finalY}setFinalY(e){this._finalY=e}}class p extends t.Container{constructor(e){super(e.getCtx(),null),this._gantt=e,this._task=new c(e,this),this._taskLabel=new u(e,this),this._gantt.getEventManager().associate(this,this),this.nodeType="task"}getId(){return this._taskObj.id}setLayoutObject(e){this._taskObj=e}getLayoutObject(){return this._taskObj}getData(e){return e?i.TimeComponent.sanitizeData(this._taskObj.data,"task"):this._taskObj.data}getValue(e,t){var i,a=this._gantt.getOptions().taskDefaults;switch(e){case"start":i=this._taskObj.startTime;break;case"end":i=this._taskObj.endTime;break;case"height":i=this._taskObj.height;break;case"baseline":if("height"===t){i=this._taskObj.baselineHeight;break}if((i=this._taskObj.data.baseline)&&null!=t)switch(t){case"start":i=this._taskObj.baselineStartTime;break;case"end":i=this._taskObj.baselineEndTime;break;default:i=null!=i[t]?i[t]:a.baseline[t]}break;case"overtime":if((i=this._taskObj.data.overtime)&&null!=t)switch(t){case"start":i=this._taskObj.overtimeStartTime;break;case"end":i=this._taskObj.overtimeEndTime;break;default:i=null!=i[t]?i[t]:a.overtime[t]}break;case"downtime":if((i=this._taskObj.data.downtime)&&null!=t)switch(t){case"start":i=this._taskObj.downtimeStartTime;break;case"end":i=this._taskObj.downtimeEndTime;break;default:i=null!=i[t]?i[t]:a.downtime[t]}break;case"attribute":if((i=this._taskObj.data.attribute)&&null!=t&&(i=null!=i[t]?i[t]:a.attribute[t],"shortDesc"===t&&"function"==typeof i))return i(p.getShortDescContext(this));break;case"progress":if("height"===t){i=this._taskObj.progressHeight;break}(i=this._taskObj.data.progress)&&null!=t&&(i=null!=i[t]?i[t]:a.progress[t]);break;default:i=null!=this._taskObj.data[e]?this._taskObj.data[e]:a[e]}return"shortDesc"===e&&"function"==typeof i?i(p.getShortDescContext(this)):i}getSandboxValue(e,t){var i=this.getSandboxData(),a=this._gantt.getOptions().taskDefaults,s=i[e],n=a[e];return s&&null!=t&&(s=s[t]),n&&null!=t&&(n=n[t]),null!=s?s:n}getSandboxData(){if(!this._sandboxData){this._sandboxData=t.JsonUtils.clone(i.TimeComponent.sanitizeData(this._taskObj.data,"task")),this._sandboxData._rowNode=this.getRowNode(),this._sandboxData.start=this._taskObj.startTime,this._sandboxData.end=this._taskObj.endTime,this._sandboxData.height=this._taskObj.height;var e=this._sandboxData.baseline;e&&(e.start=this._taskObj.baselineStartTime,e.end=this._taskObj.baselineEndTime,e.height=this._taskObj.baselineHeight);var a=this._sandboxData.overtime;a&&(a.start=this._taskObj.overtimeStartTime,a.end=this._taskObj.overtimeEndTime);var s=this._sandboxData.downtime;s&&(s.start=this._taskObj.downtimeStartTime,s.end=this._taskObj.downtimeEndTime);var n=this._sandboxData.progress;n&&(n.height=this._taskObj.progressHeight)}return this._sandboxData}getRowNode(){return this._taskObj.rowObj.node}getGantt(){return this._gantt}getRenderState(){return this._taskObj.renderState}getPreviousAdjacentTaskObj(){return this._taskObj.previousAdjacentTaskObj}getNextAdjacentTaskObj(){return this._taskObj.nextAdjacentTaskObj}getPrevAdjMilestoneBaselineTaskObj(){return this._taskObj.prevAdjMilestoneBaselineTaskObj}getNextAdjMilestoneBaselineTaskObj(){return this._taskObj.nextAdjMilestoneBaselineTaskObj}getTaskShapePhysicalBounds(e,i){var a=t.Agent.isRightToLeft(this._gantt.getCtx()),n=this._gantt.getOptions(),r=a?-1:1,o=this._task.getShape(e),h=o.getFinalX()+this.getFinalX(),l=o.getFinalWidth()+o.getPhysicalEndOffset(),d=h-r*o.getPhysicalStartOffset(),g=h+r*l;if(i){var _=this._taskLabel.getLabelOutputText();if(_&&null!=_.getParent()){var c=this._taskLabel.getEffectiveLabelPosition();"end"===c?g+=r*(s.getTaskLabelMargin(n)+_.getDimensions().w):"start"===c&&(d-=r*(s.getTaskLabelMargin(n)+_.getDimensions().w))}}return{startPos:d,endPos:g}}scrollIntoView(e,i){var a,n,r,o,h=t.Agent.isRightToLeft(this._gantt.getCtx()),l=this._gantt.getDatabody(),g=this._gantt.getOptions();this._gantt.getDataLayoutManager().ensureInDOM(this.getLayoutObject(),"task");var _,c,u=this._gantt.getEventManager().getKeyboardDnDMode();if(u===d.KEYBOARD_MOVE&&this._mainDragFeedbacks&&this._mainDragFeedbacks.length>0){const{dragFeedback:e}=this._mainDragFeedbacks[0];_=e.getTask().getShape("main"),c=e}else if((u===d.KEYBOARD_RESIZE_START||u===d.KEYBOARD_RESIZE_END)&&this._mainResizeHandleDragFeedbacks&&this._mainResizeHandleDragFeedbacks.length>0){const{dragFeedback:e}=this._mainResizeHandleDragFeedbacks[0];_=e.getTask().getShape("main"),c=e}else _=(_=this.getTask().getShape("main"))||this.getTask().getShape("baseline"),c=this;r=_.getWidth()+_.getPhysicalStartOffset()+_.getPhysicalEndOffset(),o=_.getHeight(),a=h?_.getX()-r+_.getPhysicalStartOffset():_.getX()-_.getPhysicalStartOffset(),n=_.getY();var p=l.stageToLocal(c.localToStage({x:a,y:n})),m=new t.Rectangle(p.x,p.y,r,o);this._gantt.scrollIntoView(m,e,i,s.getRowPaddingTop(g),!0),this._updateDragFeedbacks()}setTranslateX(e){var t=this._gantt.getRenderingPrecision(),i=null===t?e:this._gantt.round(e,t);return super.setTranslateX(i)}setTranslateY(e){var t=this._gantt.getRenderingPrecision(this._gantt),i=null===t?e:this._gantt.round(e,t);return super.setTranslateY(i)}setTranslate(e,t){var i=this._gantt.getRenderingPrecision(this._gantt),a=null===i?e:this._gantt.round(e,i),s=null===i?t:this._gantt.round(t,i);return super.setTranslate(a,s)}highlight(){this._task.highlight(),this._taskLabel.highlight()}unhighlight(){this._task.unhighlight(),this._taskLabel.unhighlight()}getDraggedObject(){return this._draggedObj}setDraggedObject(e){this._draggedObj=e}dragStartSetup(){this.hideDnDArtifacts(this._draggedObj)}dragEndCleanup(){if(this.hideDnDArtifacts(),this._sandboxData=null,this._gantt.isSelectionSupported()&&this.isSelected())for(var e=this._gantt.getSelectionHandler().getSelection(),t=0;t<e.length;t++){var i=e[t];i&&"task"===i.nodeType&&(i.show(),i.getPredecessorDependencies().forEach(e=>e.show()),i.getSuccessorDependencies().forEach(e=>e.show()))}}dragCancelCleanup(){if(this._gantt.isSelectionSupported()&&this.isSelected())for(var e=this._gantt.getSelectionHandler().getSelection(),t=0;t<e.length;t++){var i=e[t];if(i&&"task"===i.nodeType){var a=i.getRowNode();a&&a.showEffect("selected")}}}_renderClone(e){var t=new p(this._gantt),i=Object.assign({},this._taskObj);i.node=t,i._overtimeOffset=null!=i.overtimeStartTime?i.overtimeStartTime-i.startTime:0,i._downtimeOffset=null!=i.downtimeStartTime?i.downtimeStartTime-i.startTime:0,t.setLayoutObject(i);var a=this._gantt.getAnimationManager(),s=a.getAnimationMode();a.setAnimationMode("none"),t.render(e);var n=t.getTask(),r=t.getTaskLabel();return r.setAssociatedShape(n.getShape("main")),r.render(),t._selected=!0,n.showMainEffect("selected"),t.setMouseEnabled(!1),a.setAnimationMode(s),t}_renderOutlineClone(e){var t=this.getTask(),i=t.getShape("main"),a=new o(this._gantt.getCtx(),this.getTranslateX()+i.getFinalX(),this.getTranslateY()+i.getFinalY(),i.getFinalWidth(),i.getFinalHeight(),i.getBorderRadius(),t,"mainDragFeedback");return e.addChildAt(a,0),a}_setWidth(e){var i=t.Agent.isRightToLeft(this._gantt.getCtx()),s=i?1:-1,n=this._gantt.getStartTime(),r=this._gantt.getEndTime(),o=this._gantt.getContentLength(),h=i?o-this.getTranslateX():this.getTranslateX(),l=a.TimeAxisUtils.getPositionDate(n,r,h,o),d=this.getTranslateX()-s*e;d=i?o-d:d;var g=a.TimeAxisUtils.getPositionDate(n,r,d,o);if(this._taskObj.startTime=l,this._taskObj.endTime=g,this._taskObj.overtimeStartTime){var _=this._taskObj.overtimeEndTime-this._taskObj.overtimeStartTime;this._taskObj.overtimeStartTime=l+this._taskObj._overtimeOffset,this._taskObj.overtimeEndTime=this._taskObj.overtimeStartTime+_}if(this._taskObj.downtimeStartTime){var c=this._taskObj.downtimeEndTime-this._taskObj.downtimeStartTime;this._taskObj.downtimeStartTime=l+this._taskObj._downtimeOffset,this._taskObj.downtimeEndTime=this._taskObj.downtimeStartTime+c}this._taskObj.x=this.getTranslateX(),this._taskObj.y=this.getTranslateY();var u=this._gantt.getAnimationManager(),p=u.getAnimationMode();u.setAnimationMode("none"),this.render(this.getParent(),!0),this.getTaskLabel().render(),this.getTask().showMainEffect("selected"),u.setAnimationMode(p)}_getWidth(){return this.getTask().getShape("main").getWidth()}hide(e){this.setAlpha(0);var t=this.getRowNode();e&&t&&t.removeEffect("selected")}show(){this.setAlpha(1)}showDragFeedback(e,i,n,r,o){var h=this._gantt.getEventManager();if(this._draggedObj&&h){var l,d,g,_,c,u,p,m,b=h.getDnDTaskSubType(this._draggedObj),v=t.Agent.isRightToLeft(this._gantt.getCtx()),S=v?1:-1,D=this._gantt.getDnDArtifactsContainer(),T=this._gantt.getStartTime(),y=this._gantt.getEndTime(),C=this._gantt.getContentLength();switch(b){case"tasks":if(l=o?{deltaX:0,deltaY:0}:this._gantt.autoPanOnEdgeDrag(i,s.getAutoPanEdgeThreshold(),!1,!1),d=r.x+i.x+l.deltaX,g=r.y+i.y+l.deltaY,!n)return;if(n&&"row"===n.nodeType)m=n;else{if(!n||"task"!==n.nodeType)return;m=n.getRowNode()}this._renderTaskMoveDragFeedback(d,g,D,m),this._renderDependencyLinesDragFeedback(this._mainDragFeedbacks.map(({dragFeedback:e})=>e),D);var f=this.getTask().getShape("main");_=v?C-d:d,u=v?C-(d-f.getFinalWidth()):d+f.getFinalWidth(),c=a.TimeAxisUtils.getPositionDate(T,y,_,C),p=a.TimeAxisUtils.getPositionDate(T,y,u,C),this._showDragFeedbackTooltip(e,c,p,this._mainDragFeedbacks[0].dragFeedback,"center",m);break;case"taskResizeHandles":l=o?{deltaX:0,deltaY:0}:this._gantt.autoPanOnEdgeDrag(i,s.getAutoPanEdgeThreshold(),!1,!0),d=i.x+l.deltaX,this._renderTaskResizeDragFeedback(d,D),this._renderDependencyLinesDragFeedback(this._mainResizeHandleDragFeedbacks.map(({dragFeedback:e})=>e),D);const{dragFeedback:t}=this._mainResizeHandleDragFeedbacks[0];var k="mainResizeHandleEnd"===this._draggedObj.getType();k?(c=this.getValue("start"),u=t.getTranslateX()-S*t._getWidth(),u=v?C-u:u,p=a.TimeAxisUtils.getPositionDate(T,y,u,C)):(_=t.getTranslateX(),_=v?C-_:_,c=a.TimeAxisUtils.getPositionDate(T,y,_,C),p=this.getValue("end")),this._showDragFeedbackTooltip(e,c,p,t,k?"end":"start")}}}_showDragFeedbackTooltip(e,i,a,s,n,r){var o=t.Agent.isRightToLeft(this._gantt.getCtx()),h=this.getSandboxData();r&&(h._rowNode=r);var l=h.start;if(h.start=i,h.end=a,h.overtime&&h.overtime.start){var d=h.overtime.start-l,g=h.overtime.end-h.overtime.start;h.overtime.start=h.start+d,h.overtime.end=h.overtime.start+g}if(h.downtime&&h.downtime.start){var _=h.downtime.start-l,c=h.downtime.end-h.downtime.start;h.downtime.start=h.start+_,h.downtime.end=h.downtime.start+c}var u,p=s.getDimensions(this.getCtx().getStage());switch(n){case"start":u=new t.Point(p.x+o*p.w,p.y);break;case"end":u=new t.Point(p.x+!o*p.w,p.y);break;default:u=p.getCenter()}var m=this.getCtx().stageToPageCoords(u.x,u.y);this._gantt.getEventManager().ProcessObjectTooltip(e,m.x,m.y,this,s.getElem())}_renderTaskMoveDragFeedback(e,i,n,r){var o=this._gantt.getOptions(),h=t.Agent.isRightToLeft(this._gantt.getCtx()),l=this._gantt.getStartTime(),d=this._gantt.getEndTime(),g=this._gantt.getContentLength(),_=this.getTask().getShape("main"),c=null!=o.rowDefaults.height?(o.rowDefaults.height-_.getFinalHeight())/2:s.getRowPaddingTop(o),u=r.localToStage({x:0,y:r.getFinalY()+c}),p=this._gantt.getDnDArtifactsContainer().stageToLocal(u).y,m=(e,t,i)=>{e.setTranslate(t,i),e._taskObj.x=t,e._taskObj.y=i};if(this._mainDragFeedbacks)for(var b=0;b<this._mainDragFeedbacks.length;b++){const t=this._mainDragFeedbacks[b],{source:s,dragFeedback:n,dragOutlineFeedback:r,dropOutlineFeedback:o,dragFeedbackOffset:_}=t;var v=e+_.x;m(n,v,i+_.y);var S=s.getTask().getShape("main");r.setY(s.getFinalY()+S.getFinalY()),0===b&&(o.setX(v),o.setY(p)),t.dragFeedbackStartTime=a.TimeAxisUtils.getPositionDate(l,d,h?g-v:v,g)}else{this.hide(!0);var D=this._renderOutlineClone(n),T=this._renderOutlineClone(n);T.setX(e),T.setY(i);var y=this._renderClone(n);if(m(y,e,i),this._mainDragFeedbacks=[{source:this,dragFeedback:y,dragOutlineFeedback:D,dropOutlineFeedback:T,dragFeedbackOffset:new t.Point(0,0),dragFeedbackStartTime:this.getValue("start")}],this._gantt.isSelectionSupported()&&this.isSelected()&&this._gantt.getSelectionHandler().getSelectedCount()>1){var C=this._gantt.getSelectionHandler().getSelection();for(b=0;b<C.length;b++){var f=C[b];if(f&&"task"===f.nodeType&&f!==this){var k=f.getTask().getShape("main"),E=k.getX()+f.getTranslateX()-(_.getX()+this.getTranslateX()),O=k.getY()+f.getTranslateY()-(_.getY()+this.getTranslateY()),w=e+E,R=i+O;f.hide(!0);var A=f._renderOutlineClone(n),x=f._renderClone(n);m(x,w,R),this._mainDragFeedbacks.push({source:f,dragFeedback:x,dragOutlineFeedback:A,dragFeedbackOffset:new t.Point(E,O),dragFeedbackStartTime:f.getValue("start")})}}}}}_renderTaskResizeDragFeedback(e,i){var a,s,n=t.Agent.isRightToLeft(this._gantt.getCtx()),r=n?1:-1,o=this.getTask().getShape("main"),h="mainResizeHandleEnd"===this._draggedObj.getType();h?(a=o.getFinalX()+this.getTranslateX(),s=n?Math.min(e,a):Math.max(e,a)):(a=o.getFinalX()-r*o.getFinalWidth()+this.getTranslateX(),s=n?Math.max(e,a):Math.min(e,a));var l=Math.abs(s-a)-o.getFinalWidth(),d=(e,t,i)=>{e.setTranslate(t,i),e._taskObj.x=t,e._taskObj.y=i};if(this._mainResizeHandleDragFeedbacks)for(var g=0;g<this._mainResizeHandleDragFeedbacks.length;g++){const{dragFeedback:e,source:t}=this._mainResizeHandleDragFeedbacks[g];var _=t.getTask().getShape("main"),c=Math.max(0,_.getFinalWidth()+l),u=h?e.getTranslateX():_.getFinalX()-r*_.getFinalWidth()+t.getTranslateX()+r*c;d(e,u,t._taskObj.y),e._setWidth(c)}else{this.hide();var p=this._renderClone(i);if(d(p,h?a:s,o.getFinalY()+this.getTranslateY()),this._mainResizeHandleDragFeedbacks=[{source:this,dragFeedback:p}],this._gantt.isSelectionSupported()&&this.isSelected()&&this._gantt.getSelectionHandler().getSelectedCount()>1){var m=this._gantt.getSelectionHandler().getSelection();for(g=0;g<m.length;g++){var b=m[g];if(b&&"task"===b.nodeType&&b!==this){var v,S=b.getTask().getShape("main"),D=S.getFinalWidth()+l;v=h?S.getFinalX()+b.getTranslateX():S.getFinalX()-r*S.getFinalWidth()+b.getTranslateX()+r*D,b.hide();var T=b._renderClone(i);d(T,v,S.getFinalY()+b.getTranslateY()),this._mainResizeHandleDragFeedbacks.push({source:b,dragFeedback:T})}}}}}_renderDependencyLinesDragFeedback(e,t){if(this._mainDependencyLineDragFeedbacks)this._mainDependencyLineDragFeedbacks.forEach(e=>e.render(t,!0));else{this._mainDependencyLineDragFeedbacks=[];const i=new Map;if(this._gantt.isSelectionSupported()&&this.isSelected()){this._gantt.getSelectionHandler().getSelection().forEach(e=>{const t=e.getPredecessorDependencies(),a=e.getSuccessorDependencies();t.forEach(e=>{e.hide(),i.set(e.getLayoutObject(),Object.assign({},e.getLayoutObject()))}),a.forEach(e=>{e.hide(),i.set(e.getLayoutObject(),Object.assign({},e.getLayoutObject()))})})}e.forEach(e=>{const t=e.getLayoutObject();t.predecessorDepObjs=t.predecessorDepObjs.map(e=>{const a=i.get(e);return a.successorTaskObj=t,a}),t.successorDepObjs=t.successorDepObjs.map(e=>{const a=i.get(e);return a.predecessorTaskObj=t,a})}),i.forEach((e,i)=>{const a=new n(this._gantt);a.setLayoutObject(e),e.node=a,a.render(t),a.setMouseEnabled(!1),this._mainDependencyLineDragFeedbacks.push(a)})}}_updateDragFeedbacks(){var e=t.Agent.isRightToLeft(this._gantt.getCtx()),i=this._gantt.getStartTime(),s=this._gantt.getEndTime(),n=this._gantt.getContentLength();if(this._mainDragFeedbacks){var r=a.TimeAxisUtils.getDatePosition(i,s,this._mainDragFeedbacks[0].dragFeedbackStartTime,n);r=e?n-r:r;for(var o=0;o<this._mainDragFeedbacks.length;o++){const{source:t,dragFeedback:g,dragOutlineFeedback:_,dropOutlineFeedback:c,dragFeedbackOffset:u,dragFeedbackStartTime:p}=this._mainDragFeedbacks[o];let m=a.TimeAxisUtils.getDatePosition(i,s,p,n);m=e?n-m:m,u.x=m-r;var h=t.getTask().getShape("main"),l=h.getFinalWidth(),d=g.getTask().getShape("main").getFinalWidth();g.setTranslateX(m),g._taskObj.x=g.getTranslateX(),d!==l&&g._setWidth(l),_.setX(t.getFinalX()+h.getFinalX()),_.setY(t.getFinalY()+h.getFinalY()),_.setWidth(l),0===o&&(c.setX(m),c.setWidth(l)),0===o&&this._gantt.getEventManager()._keyboardDnDFeedbackLocalPos&&(this._gantt.getEventManager()._keyboardDnDFeedbackLocalPos.x=m)}}if(this._mainResizeHandleDragFeedbacks)for(o=0;o<this._mainResizeHandleDragFeedbacks;o++){const{dragFeedback:t,source:r}=this._mainResizeHandleDragFeedbacks[o];var g=a.TimeAxisUtils.getDatePosition(i,s,r.getValue("start"),n),_=a.TimeAxisUtils.getDatePosition(i,s,r.getValue("end"),n);dragFeedbackX=e?n-g:g,t.setTranslateX(dragFeedbackX),t._taskObj.x=t.getTranslateX(),t._setWidth(Math.abs(_-g)),0===o&&this._gantt.getEventManager()._keyboardDnDFeedbackLocalPos&&(this._gantt.getEventManager()._keyboardDnDFeedbackLocalPos.x=dragFeedbackX)}this._mainDependencyLineDragFeedbacks&&this._mainDependencyLineDragFeedbacks.forEach(e=>e.render(e.getParent(),!0))}removeDragFeedbacks(){if(this._mainDragFeedbacks){for(var e=0;e<this._mainDragFeedbacks.length;e++){const{dragFeedback:t,dragOutlineFeedback:i}=this._mainDragFeedbacks[e];t.getParent().removeChild(t),i.getParent().removeChild(i)}const{dropOutlineFeedback:t}=this._mainDragFeedbacks[0];t.getParent().removeChild(t),this._mainDragFeedbacks=null}if(this._mainDependencyLineDragFeedbacks){for(e=0;e<this._mainDependencyLineDragFeedbacks.length;e++)this._mainDependencyLineDragFeedbacks[e].getParent().removeChild(this._mainDependencyLineDragFeedbacks[e]);this._mainDependencyLineDragFeedbacks=null}if(this._mainResizeHandleDragFeedbacks){for(e=0;e<this._mainResizeHandleDragFeedbacks.length;e++){const{dragFeedback:t}=this._mainResizeHandleDragFeedbacks[e];t.getParent().removeChild(t)}this._mainResizeHandleDragFeedbacks=null}this._gantt.getEventManager().hideTooltip()}hideDnDArtifacts(){this.removeDragFeedbacks()}getTask(){return this._task}getTaskLabel(){return this._taskLabel}render(e,i){var a;i=!1!==i;this._gantt.getEventManager().isDnDDragging()||this.show();var s=t.SelectionEffectUtils.getSelectingCursor();this.isSelectable()&&this.getCursor()!==s&&this.setCursor(s),this.getParent()!=e&&e.addChild(this),this._task.render(i),this._getAriaTarget().setAriaRole("img"),this.refreshAriaLabel(),this._updateDragFeedbacks(),a={x:this.getFinalX(),y:this.getFinalY()},this._gantt.getAnimationManager().preAnimateTaskNode(this,a)}remove(){var e,t=this;e=()=>{t.getRowNode().removeChild(t)},this._gantt.getAnimationManager().preAnimateTaskNodeRemove(this,e)}getPredecessorDependencies(){var e=this._gantt.getDataLayoutManager();return this._taskObj.predecessorDepObjs.map(t=>(t.node||e.ensureInDOM(t,"dependency"),t.node))}getSuccessorDependencies(){var e=this._gantt.getDataLayoutManager();return this._taskObj.successorDepObjs.map(t=>(t.node||e.ensureInDOM(t,"dependency"),t.node))}getFinalX(){return this._taskObj.x}getFinalY(){var e=this._taskObj.rowObj;return this._taskObj.y-e.unstickyY+e.y}getFinalHeight(e){return this._task.getFinalHeight(e)}getDuration(e,i){var a=this._gantt.getOptions().translations,s=36e5,n=i-e,r=this._gantt.getMinorAxis().getScale();return"hours"===r||"minutes"===r||"seconds"===r?(n=Math.round(n/s*100)/100,t.ResourceUtils.format(a.accessibleDurationHours,[n])):(n=Math.round(n/864e5*100)/100,t.ResourceUtils.format(a.accessibleDurationDays,[n]))}getDisplayable(){return this}getAriaLabel(){var e=[],i=this._gantt.getOptions().translations,s=this.getLayoutObject().rowObj,n="";if(this._gantt.isRowsHierarchical()&&(n=i.labelLevel+" "+s.depth+", "),null!=this._gantt.getRenderState()){var r=s.data.label;return null==r&&(r=i.labelRow+" "+s.index+1),r=n+r,null!=s.expanded&&e.push(i[s.expanded?"stateExpanded":"stateCollapsed"]),t.Displayable.generateAriaLabel(r,e)}this.isSelectable()&&e.push(i[this.isSelected()?"stateSelected":"stateUnselected"]),null!=(s=this.getLayoutObject().rowObj).expanded&&e.push(i.labelRow+" "+i[s.expanded?"stateExpanded":"stateCollapsed"]);var o=h.getDatatip(this,!1,!0);this._task.isMilestone("main")?o=i.accessibleTaskTypeMilestone+", "+o:this._task.isSummary("main")&&(o=i.accessibleTaskTypeSummary+", "+o),o=n+o;var l=this._taskObj.predecessorDepObjs,d=this._taskObj.successorDepObjs;if(l.length>0||d.length>0){var g="";if(l.length>0&&(g=t.ResourceUtils.format(i.accessiblePredecessorInfo,[l.length]),a.TimeAxisUtils.supportsTouch()||t.Agent.isEnvironmentTest()))for(var _=0;_<l.length;_++)g=g+", "+l[_].ariaLabel;if(d.length>0&&(g.length>0&&(g+=", "),g+=t.ResourceUtils.format(i.accessibleSuccessorInfo,[d.length]),a.TimeAxisUtils.supportsTouch()||t.Agent.isEnvironmentTest()))for(_=0;_<d.length;_++)g=g+", "+d[_].ariaLabel;g.length>0&&(o=o+", "+g)}var c=t.Displayable.generateAriaLabel(o,e),u=this.getAriaProperty("label");return null!=u&&u.indexOf(c)>-1?null:c}_getAriaTarget(){var e=this.getTask().getShape("main");return t.Agent.isTouchDevice()&&this._gantt.isTaskResizeEnabled()&&e?e:this}refreshAriaLabel(){this._updateAriaLabel()}_updateAriaLabel(){t.Agent.deferAriaCreation()||this._getAriaTarget().setAriaProperty("label",this.getAriaLabel())}getDataContext(){var e=this.getData()._itemData,t=this.getTask().getFillColor();return{data:this.getData(!0),rowData:this.getRowNode().getData(!0),itemData:e||null,color:t?t.fill:null,component:this._gantt.getOptions()._widgetConstructor}}static getShortDescContext(e){var t=e.getData()._itemData;return{data:e.getData(!0),rowData:e.getRowNode().getData(!0),itemData:t||null}}getSandboxDataContext(){var e=this.getSandboxData();if(e.start=new Date(e.start).toISOString(),e.end=new Date(e.end).toISOString(),e.baseline){var t=e.baseline.start,i=e.baseline.end;e.baseline.start=null!=t?new Date(t).toISOString():null,e.baseline.end=null!=i?new Date(i).toISOString():null}var a=this._taskObj.data._itemData;return{data:e,rowData:e._rowNode.getData(!0),itemData:a||null,color:h.getDatatipColor(this),component:this._gantt.getOptions()._widgetConstructor}}_setSelected(e,t,i){this._selected=e,this._selected?this._task.showEffect("selected"):this._task.removeEffect("selected",t),this.refreshAriaLabel();const a=this._gantt.getOptions(),s=this._gantt.getEventManager().isMarqueeDragging();if("straight"===a.dependencyLineShape&&("highlightDependencies"!==a.selectionBehavior||s)){var n=this._gantt.getDependenciesContainer();this.getPredecessorDependencies().forEach(e=>{e.render(n,!1)}),this.getSuccessorDependencies().forEach(e=>{e.render(n,!1)})}if((!i||!this._gantt.isInitialRender()||s)&&"highlightDependencies"===a.selectionBehavior){var r=this._gantt.getViewPort();this._gantt.getDataLayoutManager().renderViewportDependencyLines(r,"vpc_translate",{taskObj:this.getLayoutObject(),isSelected:e})}}clearSelectionState(){this._setSelected(!1,!1)}getDatatip(){return h.getDatatip(this,!0)}getDatatipColor(){return h.getDatatipColor(this)}isSelectable(){return"none"!=this._gantt.getOptions().selectionMode}isSelected(){return this._selected}setSelected(e,t){this._setSelected(e,!0,t)}showHoverEffect(){this._task.showEffect("hover")}hideHoverEffect(){this._task.removeEffect("hover")}getNextNavigable(e){var i=t.Agent.isRightToLeft(this._gantt.getCtx()),a=this._gantt.getEventManager().getKeyboardHandler();if(e.type===t.MouseEvent.CLICK||a.isMultiSelectEvent(e))return this;if(e.altKey&&(e.keyCode===t.KeyboardEvent.OPEN_ANGLED_BRACKET||e.keyCode===t.KeyboardEvent.CLOSE_ANGLED_BRACKET)&&a&&a.getFirstNavigableDependencyLine){var s;s=t.Agent.isRightToLeft(this.getGantt().getCtx())?e.keyCode===t.KeyboardEvent.CLOSE_ANGLED_BRACKET?"predecessor":"successor":e.keyCode===t.KeyboardEvent.OPEN_ANGLED_BRACKET?"predecessor":"successor";var n=this._gantt.getNavigableDependencyLinesForTask(this,s),r=a.getFirstNavigableDependencyLine(this,e,n);return r&&r.setKeyboardFocusTask(this),r}if(this._gantt.isRowAxisEnabled()&&e.altKey&&(!i&&e.keyCode===t.KeyboardEvent.LEFT_ARROW||i&&e.keyCode===t.KeyboardEvent.RIGHT_ARROW))return this.getRowNode().getRowLabelContent();const o=this._gantt.getAxisPosition(),h=this._gantt.getMinorAxis(),l=this._gantt.getMajorAxis(),d=this._gantt.isMinorAxisDrillable(),_=this._gantt.isMajorAxisDrillable();if((h&&d||l&&_)&&e.altKey&&("top"===o&&e.keyCode===t.KeyboardEvent.UP_ARROW||"bottom"===o&&e.keyCode===t.KeyboardEvent.DOWN_ARROW)){const e=d?h:l;this.scrollIntoView("start");const t=this._taskObj.startTime;return e.getAxisLabelIntervalWithTime(t)}return a.isNavigationEvent(e)&&null==this._gantt.getEventManager().getKeyboardDnDMode()?g.getNextNavigable(this._gantt,this,e):null}getTargetElem(){return this._task.getShape("main").getElem()}getKeyboardBoundingBox(e){return this.getDimensions(e)}showKeyboardFocusEffect(){this._isShowingKeyboardFocusEffect=!0,this._task.showEffect("focus");var e=this._gantt.getViewportStartTime(),t=this._gantt.getViewportEndTime();this.scrollIntoView(),this._gantt.getViewportStartTime()===e&&this._gantt.getViewportEndTime()===t||this._gantt.dispatchEvent(this._gantt.createViewportChangeEvent())}hideKeyboardFocusEffect(){this.isShowingKeyboardFocusEffect()&&(this._isShowingKeyboardFocusEffect=!1,this.hideHoverEffect())}isShowingKeyboardFocusEffect(){return this._isShowingKeyboardFocusEffect}isDragAvailable(e){return!0}getDragTransferable(e,t){return[this.getId()]}getDragFeedback(e,t){return null}}class m extends t.Container{constructor(e){super(e.getCtx(),null),this._gantt=e,this._referenceObjects=[],this._gantt.getEventManager().associate(this,this),this.nodeType="row"}getId(){return this._rowObj.id}getGantt(){return this._gantt}setLayoutObject(e){this._rowObj=e}getLayoutObject(){return this._rowObj}getData(e){return e?i.TimeComponent.sanitizeData(this._rowObj.data,"row"):this._rowObj.data}getIndex(){return this._rowObj.index}getFinalY(){return this._rowObj.y}getLabel(){return this._rowObj.data.label}setRowLabelContent(e){var t=this._gantt.getEventManager(),i=t.getFocus();this._rowLabelContent!==i&&i instanceof r&&i.getRow()===this&&(t.setFocus(e),e.showKeyboardFocusEffect()),this._rowLabelContent=e}getRowLabelContent(){return this._rowLabelContent}getRowAxisHorizontalLine(){return this._rowAxisHorizontalLine}getRenderState(){return this._rowObj.renderState}getTaskObjs(){return this._rowObj.taskObjs}getRenderOrderTaskObjs(e){var t=e?e.sort((e,t)=>e.startTime-t.startTime):this._rowObj.taskObjs;if(this._rowObj.earliestOverlayTaskObj){var i=[],a=[];return t.forEach(e=>{"overlay"===e.overlapBehavior?i.push(e):a.push(e)}),a.concat(i)}return t}_renderTasks(e){e&&e.tasksDelete.forEach(e=>{e.node.remove()});var t,i=this.getRenderOrderTaskObjs(e?[...e.tasksAdd,...e.tasksUpdate]:null),a=e?e.tasksAdd:new Set,s=!e||e.updateRender;for(let e=0;e<i.length;e++){var n=(d=i[e]).node;n||((n=new p(this._gantt)).setLayoutObject(d),d.node=n);var r=a.has(d);if(s||r){var o=n.getTask(),h=o.getTimeSpanDimensions(n.getValue("start"),n.getValue("end"));h||(h=o.getTimeSpanDimensions(n.getValue("baseline","start"),n.getValue("baseline","end"))),d.x=h.startPos,n.render(this,!0)}!r&&t&&a.has(t)&&this.addChild(n),t=d}var l=e=>{var t=e.node,i=t.getTaskLabel(),a=t.getTask();i.setAssociatedShape(a.getShape("main")),i.render(),this._gantt.isTaskResizeEnabled()?a.renderMainResizeHandles(t):a.removeHandles()};for(let e=0;e<i.length;e++){var d=i[e];r=a.has(d);if(s||r)r&&!s&&d.previousAdjacentTaskObj&&!a.has(d.previousAdjacentTaskObj)&&d.previousAdjacentTaskObj.node&&d.previousAdjacentTaskObj.node.getParent()&&l(d.previousAdjacentTaskObj),l(d);else if(a.has(d.previousAdjacentTaskObj))for(var g=d;g&&!a.has(g);){var _=g.node.getTaskLabel(),c=_.getEffectiveLabelPosition();l(g),g=c===_.getEffectiveLabelPosition()?null:g.nextAdjacentTaskObj}}}render(e,t){const i=this._rowObj.isSticky?this._gantt.getStickyRowBackgroundsContainer():this._gantt.getDatabodyBackground(),a=this._rowObj.isSticky?this._gantt.getStickyRowReferenceObjectsContainer():this._gantt.getRowReferenceObjectsContainer();this._renderTasks(t),this._renderBackground(this._gantt,i),this._renderReferenceObjects(this._gantt,a),this._renderHorizontalGridline(this._gantt,this),e&&(this._gantt.isRowAxisEnabled()&&this._gantt.getRowAxis()&&this._finalizeRowLabelRender(this._gantt),e.addChild(this)),this.getTaskObjs().some(e=>e.node&&e.node.isSelected())||this.removeEffect("selected")}_finalizeRowLabelRender(e){var i=t.Agent.isRightToLeft(e.getCtx()),a=this.getRowLabelContent(),n=this.getFinalY(),r=this._rowObj.height,o=e.getOptions(),h=s.getRowLabelPaddingStart(o),l=h+s.getRowLabelPaddingEnd(o),d=e.getRowAxis();if("g"===a.getDisplayableType())var g=i?d.getWidth()-h:h;else{var _=a.getDisplayable();_.isTruncated()&&_.setTextString(_.getUntruncatedTextString());var c=a.getDisplayableContainer();!t.TextUtils.fitText(_,d.getWidth()-l,r,c,1)&&c&&c.removeFromParent(),i?(_.alignRight(),g=d.getWidth()-h):g=h}var u=n-a.getYTopOffset()+(r-a.getHeight())/2;a.setRow(this);var p={x:g,y:u,backgroundX:.5,backgroundY:this._rowObj.y+.5,backgroundWidth:d.getWidth()-.5,backgroundHeight:this._rowObj.height-.5},m=this.getLabelState();m&&(a.setY(m.y),a.setX(m.x),a.getBackground().setRect(m.backgroundX,m.backgroundY,d.getWidth(),m.backgroundHeight));this.recordLabelState(p),this._gantt.getAnimationManager().preAnimateRowLabel(this,a,p)}_renderBackground(e,i){var a,s=this._rowObj.y,n=e.getContentLength(),r=this._rowObj.height,o="exist";this._background||(this._background=new t.Rect(e.getCtx(),0,s,n,r),this._background.setPixelHinting(!0),this._background.setClassName(e.GetStyleClass("row")),o="add",this._gantt.getEventManager().associate(this._background,this)),i.addChild(this._background),a={y:s,w:n,h:r},this._gantt.getAnimationManager().preAnimateRowBackground(this._background,a,o)}_renderReferenceObjects(e,t){var i=this._rowObj.data.referenceObjects||[],a=e.getEventManager(),s=e.getAnimationManager(),n=this._rowObj.y,r=n+this._rowObj.height,o=n,h=r;this._referenceObjects.length>0&&(o=this._referenceObjects[0].getY1(),h=this._referenceObjects[0].getY2()),this._referenceObjects.forEach(e=>e?.removeFromParent()),this._referenceObjects=e.generateReferenceObjects(i,"area"),this._referenceObjects.forEach(e=>{a.associate(e,this),e.render(t,o,h),s.preAnimateRowReferenceObject(e,{y1:n,y2:r})})}getBackground(){return this._background}_renderHorizontalGridline(e,i){var a,n,r,o,h="exist",l=e.GetStyleClass("hgridline"),d=s.getHorizontalGridlineWidth(e.getOptions())%2*.5,g=this._gantt.getRowAxis(),_=this._gantt.isRowAxisEnabled()&&g;if(e.isHorizontalGridlinesVisible()){if(r=n=this._rowObj.unstickyY+this._rowObj.height+d,0,a=e.getContentLength(),this._horizontalLine||(this._horizontalLine=new t.Line(e.getCtx(),0,n,a,r),this._horizontalLine.setPixelHinting(!0),this._horizontalLine.setMouseEnabled(!1),this._horizontalLine.setClassName(l,!0),i.addChild(this._horizontalLine),h="add"),o={x1:0,x2:a,y1:n,y2:r},this._gantt.getAnimationManager().preAnimateHorizontalGridline(this._horizontalLine,o,h),_){var c={x1:0,x2:g.getWidth(),y1:n-this._rowObj.unstickyY+this._rowObj.y,y2:r-this._rowObj.unstickyY+this._rowObj.y};this._rowAxisHorizontalLine||(this._rowAxisHorizontalLine=new t.Line(this._gantt.getCtx(),this._horizontalLine.getX1(),c.y1,c.x2,c.y2),this._rowAxisHorizontalLine.setPixelHinting(!0),this._rowAxisHorizontalLine.setClassName(l,!0)),g.addHorizontalLine(this._rowAxisHorizontalLine,this._rowObj.isSticky),this._gantt.getAnimationManager().preAnimateHorizontalGridline(this._rowAxisHorizontalLine,c,h)}}else this._horizontalLine&&i.removeChild(this._horizontalLine),this._horizontalLine=null,this._rowAxisHorizontalLine&&g.removeHorizontalLine(this._rowAxisHorizontalLine),this._rowAxisHorizontalLine=null}showEffect(e){const t=this._gantt.GetStyleClass(e);if(this._background){if(s.hasClass(this._background,t))return;this._background.addClassName(t)}const i=this.getRowLabelContent();if(i){const e=i.getBackground();e&&e.addClassName(t)}}removeEffect(e){const t=this._gantt.GetStyleClass(e);if(this._background){if(!s.hasClass(this._background,t))return;this._background.removeClassName(t)}const i=this.getRowLabelContent();if(i){const e=i.getBackground();e&&e.removeClassName(t)}}recordLabelState(e){this._rowLabelState=e}getLabelState(){return this._rowLabelState}remove(){var e,t=this;e=()=>{if(t._background){var e=t._background.getParent();e&&e.removeChild(t._background)}var i=t.getParent();i&&i.removeChild(t)},this._gantt.getAnimationManager().preAnimateRowNodeRemove(this,e),this._removeRowLabel()}_removeRowLabel(){var e,t,i=this.getRowLabelContent(),a=this._gantt.getRowAxis(),s=this;i&&a&&(e=i.getDisplayable())&&(null==e.getParent()&&(i.ensureInDOM(),this._gantt.isHorizontalGridlinesVisible()&&a.addHorizontalLine(this._rowAxisHorizontalLine,this._rowObj?.height)),t=()=>{i.remove(),a.removeHorizontalLine(s._rowAxisHorizontalLine)},this._gantt.getAnimationManager().preAnimateRowLabelRemove(i,this._rowAxisHorizontalLine,t))}getDataContext(){return{rowData:this.getData(!0),component:this._gantt.getOptions()._widgetConstructor}}scrollIntoView(e){var t=this._gantt.getViewportDimensions(e),i=Math.min(this._rowObj.unstickyY-t.y,0),a=Math.max(0,this._rowObj.unstickyY+this._rowObj.height-(t.y+t.h)),s=i<0?i:a;this._gantt.panBy(0,s)}}class b{constructor(e){this._gantt=e,this._ctx=e.getCtx(),this._rowObjs=[],this._dependencyObjs=[],this._contentHeight=0,this._prevHighlightedTaskObjs=new Set,this._prevDependencyObjs=new Set,this._prevViewportStickyRowObj=null,this._viewportStickyRowObj=null}clear(){this._rowObjs=[],this._dependencyObjs=[],this._contentHeight=0,this._clearStickyRowObj(),this._prevViewport=null}getRowObjs(){return this._rowObjs}getDependencyObjs(){return this._dependencyObjs}getContentHeight(){return this._contentHeight}getNumViewportTasks(){return this._numViewportTasks}getTaskObjWithId(e){for(let i=0;i<this._rowObjs.length;i++){const a=this._rowObjs[i].taskObjs;for(let i=0;i<a.length;i++){const s=a[i];if(t.Obj.compareValues(this._ctx,e,s.id))return s}}return null}_getTime(e){if(null==e||""===e)return null;var t=new Date(e).getTime();return isNaN(t)?null:t}_isIntervalOverlap(e,t,i,a,s){return(s=!1!==s)?e<=a&&i<=t:e<a&&i<t}_isOverlap(e,t){return this._isIntervalOverlap(e.overallStartTime,e.overallEndTime,t.overallStartTime,t.overallEndTime,!1)}_calcTaskHeight(e){var t=this._gantt.getOptions(),i=this._gantt.getCtx(),a=t.taskDefaults,n=e.data,r=n.progress,o=n.baseline,h=!1,l=n.type?n.type:a.type,d=null!=n.height?n.height:a.height,g=0,_=s.getBaselineMarginTop(t);!o||null==e.baselineStartTime&&null==e.baselineEndTime||(g=null!=o.height?o.height:a.baseline.height,h="milestone"===l||"auto"===l&&e.baselineStartTime===e.baselineEndTime,null==o.height&&a.baseline.height===s.getBaselineTaskHeight(t)&&(g=h?s.getActualTaskHeight(t,i):a.baseline.height),null==n.height&&a.height===s.getStandaloneTaskHeight(t)&&(d=s.getActualTaskHeight(t,i))),e.height=d,e.baselineHeight=g,e.overtimeHeight=d,e.downtimeHeight=s.getTaskDowntimeHeight(t),e.attributeHeight=s.getTaskAttributeHeight(t);var c=g>0?_:0,u=h?s.getMilestoneBaselineYOffset(t)+Math.max(g,d):d+c+g;if(e.overallHeightNoProgress=u,e.overallHeight=u,e.progressHeight=0,!("milestone"===l||"auto"===l&&e.startTime===e.endTime&&null!=e.startTime)&&r&&"number"==typeof r.value){var p=null!=r.height?r.height:a.progress.height;p="100%"===p?d:s.getSizeInPixels(p,d),e.progressHeight=p,d<p&&(e.overallHeight=Math.max(p,(p-d)/2+u))}}_clearAdjacency(e){e.previousAdjacentTaskObj=null,e.nextAdjacentTaskObj=null,e.prevAdjMilestoneBaselineTaskObj=null,e.nextAdjMilestoneBaselineTaskObj=null}_trackRowLevelBaselineMilestones(e,t){for(var i=e.taskObjs,a=[],s=0;s<t;s++)a.push([]);for(var n=0;n<i.length;n++){var r=i[n],o=this._gantt.getOptions().taskDefaults,h=r.data,l=h.type?h.type:o.type;("milestone"===l||"auto"===l&&r.baselineStartTime===r.baselineEndTime)&&a[r._rowLevel].push(r)}for(s=0;s<t;s++)a[s].sort((e,t)=>t.baselineStartTime-e.baselineStartTime);for(n=0;n<i.length;n++){var d=a[(r=i[n])._rowLevel],g=d.length;if(g>0){var _=d[g-1],c=_.baselineStartTime,u=r.startTime,p=r.endTime;c<u?(r.prevAdjMilestoneBaselineTaskObj=_,d.pop()):c>p&&null==r.nextAdjMilestoneBaselineTaskObj?r.nextAdjMilestoneBaselineTaskObj=_:c!==u&&c!==p||d.pop()}}}_calcRowTaskYHeight(e,t){for(var i,a=e.taskObjs,n=this._gantt.getOptions(),r=n.rowDefaults.height,o=n.taskDefaults.overlap.behavior,h=n.taskDefaults.overlap.offset,l=[],d=[],g=0;g<a.length;g++){var _=a[g];this._calcTaskHeight(_),this._clearAdjacency(_);var c=_.data,u=c.overlap?c.overlap.behavior:null,p=null!=u?u:o;p="auto"===p?null==r?"stack":"stagger":p,_.overlapBehavior=p;var m=h;if("overlay"===p&&null==i&&(i=_),0!==g){var b=a[g-1],v=this._isOverlap(_,b);v?f.push(_):(f=[_],l.push(f));var S=m||0,D=0;switch(p){case"stack":for(var T=!0,y=0;y<d.length;y++){var C=null;if(!this._isOverlap(_,d[y])){C=d[y],d[y]=_,T=!1;break}D+=1}T&&d.push(_),_.y=null!=m?D*m:0,C&&(_.previousAdjacentTaskObj=C,C.nextAdjacentTaskObj=_);break;case"stagger":v?(_._rowLevel=b._rowLevel,d[b._rowLevel]=_,_._staggerDirection=null!=b._staggerDirection?-b._staggerDirection:-1,_.y=b.y-_._staggerDirection*S):(d[D]=_,_._staggerDirection=1,_.y=0),_.previousAdjacentTaskObj=b,b.nextAdjacentTaskObj=_;break;case"overlay":d[D]=_,_.y=0}_._rowLevel=D}else{d.push(_),_._rowLevel=0;var f=[_];l.push(f),"stagger"===p&&(_._staggerDirection=1),_.y=0}}e.earliestOverlayTaskObj=i;var k=s.getRowPaddingTop(n),E=s.getRowPaddingBottom(n),O="alta"===this._gantt.getCtx().getThemeBehavior()?"overallHeight":"height";if(null==r)if(null==m){var w=d.map(()=>0);a.forEach(e=>{e[O]>w[e._rowLevel]&&(w[e._rowLevel]=e[O])});var R=w.map(e=>e+k+E).reduce((e,t,i)=>(e.push((e[i-1]||0)+t),e),[]);a.forEach(e=>{e.y+=(R[e._rowLevel-1]||0)+k}),this._trackRowLevelBaselineMilestones(e,d.length)}else a.forEach(e=>{e.y+=k});var A=l.map(e=>{var t=0;return e.forEach(e=>{var i=e.y+e[O];i>t&&(t=i)}),t});if(null==r){if(0===a.length)return void(e.height=s.getStandaloneTaskHeight(n)+k+E);e.height=A.reduce((e,t)=>Math.max(e,t))+k,null==m?l.forEach((t,i)=>{t.forEach(t=>{var i=w[t._rowLevel];t.y+=(i-t.overallHeight)/2+e.y})}):l.forEach((t,i)=>{t.forEach(t=>{t.y+=e.unstickyY})})}else e.height=r-t,l.forEach((t,i)=>{var a=A[i],s=Number.MAX_VALUE;t.forEach(t=>{t.y+=Math.floor((e.height-t[O])/2),t.y<s&&(s=t.y)});var n=Math.floor((e.height-a)/2)-s;t.forEach(t=>{"overlay"===t.overlapBehavior?t.y+=e.y:t.y+=e.y+n})})}_calcTaskAggregation(e){var t=(e,t)=>e.endTime===t.startTime&&e.startTime!==e.endTime&&t.startTime!==t.endTime&&e.height==t.height&&e.data.borderRadius==t.data.borderRadius,i=e.taskObjs;if(0!==i.length)if(1!==i.length)if(2!==i.length){i[0].aggregation=t(i[0],i[1])?"stackStart":"stackSolo",i[i.length-1].aggregation=t(i[i.length-2],i[i.length-1])?"stackEnd":"stackSolo";for(var a=1;a<i.length-1;a++){var s=i[a-1],n=i[a],r=i[a+1];t(s,n)&&t(n,r)?n.aggregation="stackMiddle":t(s,n)?n.aggregation="stackEnd":t(n,r)?n.aggregation="stackStart":n.aggregation="stackSolo"}}else t(i[0],i[1])?(i[0].aggregation="stackStart",i[1].aggregation="stackEnd"):(i[0].aggregation="stackSolo",i[1].aggregation="stackSolo");else i[0].aggregation="stackSolo"}_generateRowObjs(e){var t=this._gantt.getOptions(),i=0;this._gantt.isHorizontalGridlinesVisible()&&(i=s.getHorizontalGridlineWidth(t));for(var a=[],n=0,r=0;r<e.length;r++){var o=e[r],h=o.tasks;if(null!=h){var l={id:null!=o.id?o.id:h.length>0?h[0].id:null,data:o,index:r,y:n,unstickyY:n,renderState:"add"};null!=o._depth&&(l.depth=o._depth,l.isStickyCandidate=o._isStickyCandidate,l.expanded=o._expanded,l.parent=null==o._parentFlatIndex?null:a[o._parentFlatIndex],o._depth=void 0,o._isStickyCandidate=void 0,o._expanded=void 0,o._parentFlatIndex=void 0,o._flatIndex=void 0);for(var d=[],g=0;g<h.length;g++){var _=h[g],c={id:_.id,data:_,startTime:_.start&&""!==_.start?this._getTime(_.start):this._getTime(_.end),endTime:_.end&&""!==_.end?this._getTime(_.end):this._getTime(_.start),rowObj:l,predecessorDepObjs:[],successorDepObjs:[],renderState:"add"},u=c.startTime,p=c.endTime,m=_.baseline;if(m){var b=m.start&&""!==m.start?this._getTime(m.start):this._getTime(m.end),v=m.end&&""!==m.end?this._getTime(m.end):this._getTime(m.start);null==b&&null==v||(c.baselineStartTime=b,c.baselineEndTime=v,(b<u||null==u)&&(u=b),(v>p||null==p)&&(p=v))}var S=_.overtime;if(S){var D=S.start&&c.startTime?Math.max(this._getTime(S.start),c.startTime):null,T=S.end&&c.endTime?Math.min(this._getTime(S.end),c.endTime):null;c.overtimeStartTime=D,c.overtimeEndTime=T}var y=_.downtime;if(y){var C=y.start&&c.startTime?Math.max(this._getTime(y.start),c.startTime):null,f=y.end&&c.endTime?Math.min(this._getTime(y.end),c.endTime):null;c.downtimeStartTime=C,c.downtimeEndTime=f}null!=u&&null!=p&&(c.overallStartTime=u,c.overallEndTime=p,d.push(c))}d.sort((e,t)=>e.startTime-t.startTime),l.taskObjs=d,a.push(l),this._calcRowTaskYHeight(l,i),n+=l.height+i,"on"===t.taskAggregation&&this._calcTaskAggregation(l)}}return a}_generateDependencyObjs(e,i){var a=[];if(0===e.length)return a;(i=i||this._createIdObjMap(this._rowObjs,"taskObjs")).forEach((e,t)=>{e.successorDepObjs=[],e.predecessorDepObjs=[]});for(var s=0;s<e.length;s++){var r=e[s],o=r.predecessorTaskId,h=r.successorTaskId,l=null==r.type?n.FINISH_START:r.type,d=null!=o&&i.has(o),g=null!=h&&i.has(h);if(n._isValidType(l)&&d&&g&&!t.Obj.compareValues(this._ctx,o,h)){var _,c,u=i.get(o),p=i.get(h),m=u.rowObj,b=p.rowObj;m.index<=b.index?(_=m,c=b):(_=b,c=m);var v=r.shortDesc;if(null==v){var S=this._gantt.getOptions().translations,D=S[l+"DependencyAriaDesc"];v=t.ResourceUtils.format(S.accessibleDependencyInfo,[D,o,h])}var T={id:r.id,data:r,index:s,type:l,predecessorTaskObj:u,successorTaskObj:p,rowObjTop:_,rowObjBottom:c,ariaLabel:v};u.successorDepObjs.push(T),p.predecessorDepObjs.push(T),a.push(T)}}a.sort((e,t)=>e.rowObjTop.index-t.rowObjTop.index);for(var y=0;y<a.length-1;y++)a[y].nextTopDependencyObj=a[y+1],a[y+1].prevTopDependencyObj=a[y];return a.sort((e,t)=>e.rowObjBottom.index-t.rowObjBottom.index),a}_createIdObjMap(e,t){for(var i=new this._ctx.ojMap,a=0;a<e.length;a++){var s=e[a];if(t)for(var n=s[t],r=0;r<n.length;r++){var o=n[r];i.set(o.id,o)}else i.set(s.id,s)}return i}_setDifferenceRenderState(e,t,i,a){for(var s=0;s<e.length;s++){var n=e[s];if(a)for(var r=n[a],o=0;o<r.length;o++){var h=r[o];if(!t.has(h.id)&&(h.renderState=i,"delete"===i)){var l=h.node;if(l&&l.getParent())"delete"!==n.renderState&&l.remove()}}else if(!t.has(n.id)&&(n.renderState=i,"delete"===i)){var d=n.node;d&&d.getParent()&&d.remove()}}}_setIntersectionRenderState(e,i,a){for(var s=0;s<i.length;s++){var n=i[s];if(a)for(var r=n[a],o=0;o<r.length;o++){var h=r[o],l=e.get(h.id);if(l){if(t.Obj.compareValues(this._ctx,l.rowObj.id,n.id))h.renderState="exist";else{h.renderState="migrate";var d=l.node;d&&d.getParent()&&"none"===this._gantt.getAnimationManager().getAnimationMode()&&d.getRowNode().removeChild(d)}h._oldObj=l}}else{var g=e.get(n.id);g&&(n.renderState="exist",n._oldObj=g)}}}_addAnimationFinalStateRowObjs(e,t){this._animationFinalStateRowObjs=this._animationFinalStateRowObjs||new Map,this._animationFinalStateRowObjs.has(e)||this._animationFinalStateRowObjs.set(e,new Set),t&&this._animationFinalStateRowObjs.get(e).add(t)}_prepareAnimationDOM(e,i,a,s,n){var r=this._gantt.getAnimationManager(),o=r.getAnimationMode();r.setAnimationMode("none"),this._animationInitialStateRowObjsDelete=[];var h=this._contentHeight,l=e[e.length-1];this._contentHeight=l.y+l.height;var d=this._gantt.scrollPositionToTranslateY(this._gantt.getOptions().scrollPosition),g=this._gantt.getViewportYBounds(d),_=g.yMin,c=g.yMax;this._contentHeight=h;for(var u=this.findRowIndRange(this._rowObjs,_,c),p=u.minRowInd,m=u.maxRowInd,b=p;b<=m;b++){var v=this._rowObjs[b];if(v){this.ensureInDOM(v,"row"),"delete"===v.renderState&&v.node.getRowLabelContent()&&this._animationInitialStateRowObjsDelete.push(v);var S=a.get(v.id);S&&this._addAnimationFinalStateRowObjs(S);for(var D=v.taskObjs,T=0;T<D.length;T++){var y=D[T],C=n.get(y.id);if(C){var f=C.rowObj;if(!t.Obj.compareValues(this._ctx,f.id,v.id)){var k=i.get(f.id);k&&this.ensureInDOM(k,"row"),this._addAnimationFinalStateRowObjs(f,C)}}}}}var E=this.findRowIndRange(e,_,c),O=E.minRowInd,w=E.maxRowInd;for(b=O;b<=w;b++){var R=e[b];if(R){this._addAnimationFinalStateRowObjs(R);var A=i.get(R.id);A&&this.ensureInDOM(A,"row");var x=R.taskObjs;for(T=0;T<x.length;T++){var L=x[T],M=s.get(L.id);if(M){var P=M.rowObj;if(!t.Obj.compareValues(this._ctx,P.id,R.id)){this.ensureInDOM(M,"task");var j=a.get(P.id);j&&this._addAnimationFinalStateRowObjs(j,L)}}}}}r.setAnimationMode(o)}_associateOldNodesAndNewLayoutObjs(e){for(var t=0;t<e.length;t++){var i=e[t],a=i._oldObj;if(a){var s=a.node;s&&(i.node=s,s.setLayoutObject(i)),i._oldObj=null}for(var n=i.taskObjs,r=0;r<n.length;r++){var o=n[r],h=o._oldObj;if(h){var l=h.node;l&&(o.node=l,l.setLayoutObject(o),l.isSelected()&&l.clearSelectionState()),o._oldObj=null}}}}calcLayout(){var e=this._gantt.getOptions(),t=this._gantt.getRenderState();if(null==t){this._clearStickyRowObj();var i=this._calcRowsLayout(e)}else this._expandCollapseRowObject(e,t.state,t.payload);if(this._rowObjs.length>0){var a=this._rowObjs[this._rowObjs.length-1];this._contentHeight=a.unstickyY+a.height;var s=e.dependencies;null!=s&&(this._dependencyObjs=this._generateDependencyObjs(s,i))}}_calcRowsLayout(e){var t=e.rows;if(null!=t&&0!==t.length){var i=t;this._gantt.isRowsHierarchical()&&(i=this._flattenRows(t,e.expanded,e.parentRowPosition));var a=this._generateRowObjs(i);if(this._rowObjs&&!this._gantt.isInitialRender()&&this._gantt.isLastRenderValid()){var s=this._createIdObjMap(this._rowObjs),n=this._createIdObjMap(a),r=this._createIdObjMap(this._rowObjs,"taskObjs"),o=this._createIdObjMap(a,"taskObjs");this._setDifferenceRenderState(this._rowObjs,n,"delete"),this._setDifferenceRenderState(a,s,"add"),this._setIntersectionRenderState(s,a),this._setDifferenceRenderState(this._rowObjs,o,"delete","taskObjs"),this._setDifferenceRenderState(a,r,"add","taskObjs"),this._setIntersectionRenderState(r,a,"taskObjs"),"none"!==this._gantt.getAnimationManager().getAnimationMode()&&this._prepareAnimationDOM(a,s,n,r,o),this._associateOldNodesAndNewLayoutObjs(a)}return this._rowObjs=a,o}this._rowObjs=[]}isRowExpandable(e){if(null==e.expanded)return!1;var t=this._gantt.getOptions().expanded,i=e.id;return!t.has(i)}isRowCollapsible(e){if(null==e.expanded)return!1;var t=this._gantt.getOptions().expanded,i=e.id;return t.has(i)}_expandCollapseRowObject(e,t,i){var a=this,n=i.index,r=i.data,o=r.rows,h=e.expanded,l=e.parentRowPosition,d=this._gantt.getAnimationManager(),g=d.getAnimationMode(),_="none"!==g;if(_)var c=this._gantt.getViewportYBounds(A),u=c.yMin,p=c.yMax-u,m=(e,t,i)=>{d.setAnimationMode("none");for(var s=0,n=t;n<e.length;n++){var r=e[n];if(a.ensureInDOM(r,"row"),a._addAnimationFinalStateRowObjs(r),(s+=r.height)>i)break}d.setAnimationMode(g)};var b=(e,t,i,a)=>{for(var s=i;s<a;s++){var n=e[s];if(n.renderState=t,"delete"===t){var r=n.node;r&&r.getParent()&&r.remove()}for(var o=n.taskObjs,h=0;h<o.length;h++){o[h].renderState=t}}};if(i.expanded="expand"===t,r._expanded=i.expanded,b(this._rowObjs,"exist",0,this._rowObjs.length),"expand"===t){var v=this._flattenRows(o,h,l,0,i.depth+1),S=this._generateRowObjs(v);S.forEach(e=>e.parent=e.parent||i),b(S,"add",0,S.length),_&&m(this._rowObjs,n,p),this._rowObjs=this._rowObjs.slice(0,n+1).concat(S,this._rowObjs.slice(n+1,this._rowObjs.length))}else{var D=this._calcFlattenedRowsLength(o,h);b(this._rowObjs,"delete",n+1,n+1+D),_&&m(this._rowObjs,n+1+D,p);var T=this._rowObjs.splice(n+1,D);_&&(this._animationInitialStateRowObjsDelete=T)}var y=0;this._gantt.isHorizontalGridlinesVisible()&&(y=s.getHorizontalGridlineWidth(e));for(var C=i.unstickyY+i.height+y,f=n+1;f<this._rowObjs.length;f++){var k=this._rowObjs[f];k.index=f;for(var E=k.taskObjs,O=0;O<E.length;O++){var w=E[O];w.y=w.y-k.unstickyY+C}k.y=C,k.unstickyY=C,C+=k.height+y}if(_){var R=this._rowObjs[this._rowObjs.length-1];this._contentHeight=R.unstickyY+R.height;for(var A=this._gantt.scrollPositionToTranslateY(this._gantt.getOptions().scrollPosition),x=this._gantt.getViewportYBounds(A),L=x.yMin,M=x.yMax,P=this.findRowIndRange(this._rowObjs,L,M),j=P.minRowInd,I=P.maxRowInd,F=j;F<=I;F++)this._addAnimationFinalStateRowObjs(this._rowObjs[F])}}_flattenRows(e,t,i,a,s){a=a||0,s=s||0;var n=this._gantt.getOptions(),r=n.rowData||n.taskData,o=(e,t,s,n)=>e.reduce((e,h)=>{h._depth=n,h._isStickyCandidate=0===n&&"sticky"===i,h._parentFlatIndex=s?s._flatIndex:null,h._flatIndex=a,a+=1;var l=h.rows;if(l){if(t.has(h.id))return h._expanded=!0,e.concat(h,o(l,t,h,n+1));h._expanded=!1}else if(r){var d=r.getChildDataProvider(h.id),g=!d||"yes"===d.isEmpty();h._expanded=!!g&&null}else h._expanded=null;return e.concat(h)},[]);return o(e,t,null,s)}_calcFlattenedRowsLength(e,t){var i=e=>e.reduce((e,a)=>{var s=a.rows;return s&&t.has(a.id)?e+1+i(s):e+1},0);return i(e)}isRoot(e){return null==e.parent}isHiddenCollapsed(e){for(var i=0;i<this._rowObjs.length;i++)if(t.Obj.compareValues(this._ctx,this._rowObjs[i].id,e.id))return!1;return!0}getParentRowObj(e){return e.parent}_renderRowObj(e,t,i){var a=e.isSticky?this._gantt.getStickyRowsContainer():this._gantt.getDatabody(),s=e.node;if("update"===i)s.render(s.getParent()===a?null:a,t);else{if(s||((s=new m(this._gantt)).setLayoutObject(e),e.node=s),this._gantt.isRowAxisEnabled()){var n=this._gantt.getRowAxis();if(n){var o=n.getRowLabelContents(),h=e.index,l=o[h];l||((l=new r(n,n.getLabelContentType())).setRowIndex(h),o[h]=l),l.render(e),s.setRowLabelContent(l)}}s.render(a,t)}}_renderTaskObj(e,t){var i=e.rowObj,a=i.node,s=e.node;t&&s&&a&&s.getParent()===a||this._renderRowObj(i,{rowObj:i,tasksAdd:new Set([e]),tasksUpdate:new Set,tasksDelete:new Set,updateRender:!t},a&&a.getParent()?"update":"add")}_renderDependencyObj(e,t){var i=this._gantt.getDependenciesContainer(),a=e.node;if(a&&a.getParent())return!1;var s=this._gantt.getAnimationManager(),r=s.getAnimationMode();s.setAnimationMode("none");var o=e.predecessorTaskObj,h=e.successorTaskObj;if(this._animationFinalStateRowObjs){var l=o.rowObj,d=h.rowObj;this._animationFinalStateRowObjs.has(l)&&this._animationFinalStateRowObjs.get(l).has(o)||this.ensureInDOM(o,"task",t),this._animationFinalStateRowObjs.has(d)&&this._animationFinalStateRowObjs.get(d).has(h)||this.ensureInDOM(h,"task",t)}else this.ensureInDOM(o,"task",t),this.ensureInDOM(h,"task",t);return s.setAnimationMode(r),a||((a=new n(this._gantt)).setLayoutObject(e),e.node=a),a.render(i),!0}ensureInDOM(e,t,i){switch(t){case"row":return void this._renderRowObj(e);case"task":return void this._renderTaskObj(e,i);case"dependency":return void this._renderDependencyObj(e,!0);case"rowLabel":return void this._renderRowObj(e,{rowObj:e,tasksAdd:new Set,tasksUpdate:new Set,tasksDelete:new Set,updateRender:!1},"add")}}_binarySearchLeftMost(e,t,i,a,s){if(0===e.length)return 0;for(var n=0,r=e.length;n<r;){var o=Math.floor((n+r)/2),h=a?s?e[o][a][s]:e[o][a]:e[o];h<t?n=o+1:r=o}return n<e.length&&((h=a?s?e[n][a][s]:e[n][a]:e[n])===t||"successor"===i)?n:n>0?n-1:0}findRowIndRange(e,t,i){for(var a=this._binarySearchLeftMost(e,t,"predecessor","y"),s=a,n=a;n<e.length;n++){if(!(e[n].unstickyY<=i))break;s=n}return{minRowInd:a,maxRowInd:s}}findTaskObjsRange(e,t,i,a,s){for(var n=[],r=e.taskObjs,o=0;o<r.length;o++){var h=r[o];this._isIntervalOverlap(h.overallStartTime,h.overallEndTime,t,a)&&(i&&s?n.push(h):i||s?s?h.overallStartTime>t&&n.push(h):h.overallEndTime<a&&n.push(h):h.overallStartTime>t&&h.overallEndTime<a&&n.push(h))}return n}findBufferTaskObjsRange(e,t,i){for(var a=[],s=e.taskObjs,n=0;n<s.length;n++){var r=s[n],o=r.previousAdjacentTaskObj,h=r.nextAdjacentTaskObj,l=!o&&!h&&!this._isIntervalOverlap(r.overallStartTime,r.overallEndTime,t,i),d=r.overallEndTime<t&&(!h||h&&h.overallEndTime>=t),g=r.overallStartTime>i&&(!o||o&&o.overallStartTime<=i);(l||d||g)&&a.push(r)}return a}getLayoutObjectsInBBox(e){for(var i=this.findRowIndRange(this._rowObjs,e.y,e.y+e.h),s=i.minRowInd,n=i.maxRowInd,r=t.Agent.isRightToLeft(this._gantt.getCtx()),o=this._gantt.getStartTime(),h=this._gantt.getEndTime(),l=this._gantt.getContentLength(),d=a.TimeAxisUtils.getPositionDate(o,h,r?l-(e.x+e.w):e.x,l),g=a.TimeAxisUtils.getPositionDate(o,h,r?l-e.x:e.x+e.w,l),_=[],c=[],u=s;u<=n;u++){var p=this._rowObjs[u];_.push(p);for(var m=p.taskObjs,b=0;b<m.length;b++){var v=m[b];this._isIntervalOverlap(v.overallStartTime,v.overallEndTime,d,g)&&this._isIntervalOverlap(v.y,v.y+v.height,e.y,e.y+e.h)&&c.push(m[b])}}return{rowObjs:_,taskObjs:c}}getLayoutObjectsInViewBox(e){const{minRowInd:t,maxRowInd:i,viewStartTime:a,viewEndTime:s}=e,n=[],r=[];for(let e=t;e<=i;e++){const t=this._rowObjs[e];n.push(t);const i=t.taskObjs;for(let e=0;e<i.length;e++){var o=i[e];this._isIntervalOverlap(o.startTime,o.endTime,a,s)&&r.push(i[e])}}return{rowObjs:n,taskObjs:r}}getTaskLayoutObjectsOverlappingRange(e,t,i,a){return e.filter(({startTime:e,endTime:s})=>this._isIntervalOverlap(e,s,t,i,a))}getClosestTaskLayoutObjToTime(e,t){if(0!==e.length)return e.reduce((e,i)=>{const a=Math.abs(e.startTime-t);return Math.abs(i.startTime-t)<a?i:e})}_getSelectionDependencies(e,t){var i,a=this._createIdObjMap(this._rowObjs,"taskObjs");e===b.VPC_REFRESH?i=this._gantt.getOptions().selection.map(e=>a.get(e)).filter(e=>void 0!==e):i=this._gantt.getSelectionHandler().getSelection().map(e=>e.getLayoutObject());t&&(t.isSelected?i.push(t.taskObj):i=i.filter(e=>e!==t.taskObj));var s=(e,t,i,n)=>{var r;null!=e&&!i.has(e)&&a.has(e.id)&&(i.add(e),"up"===t?(r=e.predecessorDepObjs.map(e=>e.predecessorTaskObj),e.predecessorDepObjs.forEach(e=>n.add(e))):(r=e.successorDepObjs.map(e=>e.successorTaskObj),e.successorDepObjs.forEach(e=>n.add(e))),r.forEach(e=>s(e,t,i,n)))},n=new Set,r=new Set;i.forEach(e=>s(e,"up",n,r));var o=new Set;return i.forEach(e=>s(e,"down",o,r)),o.forEach(e=>n.add(e)),{taskObjs:n,dependencyObjs:r}}highlightTasks(e){this._gantt.getEventManager().isDnDDragging()||this._gantt.getDatabody()&&(0===e.size?this._gantt.undimDatabody():this._gantt.dimDatabody(),this._prevHighlightedTaskObjs.forEach(t=>{t.node&&!e.has(t)&&t.node.unhighlight()}),e.forEach(e=>{e.node&&!this._prevHighlightedTaskObjs.has(e)&&e.node.highlight()}),this._prevHighlightedTaskObjs=e)}_clearStickyRowObj(){this._prevViewportStickyRowObj=null,this._viewportStickyRowObj=null}_findAndUpdateStickyRowObj(){if(!this._gantt.isStickyRowsEnabled())return void this._clearStickyRowObj();const{yMin:e}=this._gantt.getViewportYBounds(),t=this._binarySearchLeftMost(this._rowObjs,e,"predecessor","unstickyY");let i=this._rowObjs[t];for(;i.depth>0&&!i.isStickyCandidate;)i=i.parent;i.isStickyCandidate&&(this._viewportStickyRowObj&&(this._viewportStickyRowObj.isSticky=!1,this._viewportStickyRowObj.y=this._viewportStickyRowObj.unstickyY,this._prevViewportStickyRowObj=this._viewportStickyRowObj),i.y=e,i.isSticky=!0,this._viewportStickyRowObj=i)}getStickyRowObj(){return this._viewportStickyRowObj}renderViewportDependencyLines(e,t,i){var a,s=this._gantt.getOptions().selectionBehavior;if("highlightDependencies"===s){var r=this._getSelectionDependencies(t,i);this.highlightTasks(r.taskObjs),a=r.dependencyObjs}else a=new Set(this._dependencyObjs),this.highlightTasks(new Set);var o=this._gantt.getDependenciesContainer();o&&(this._gantt.getEventManager().isMarqueeDragging()&&"highlightDependencies"===s?this._prevDependencyObjs.forEach(e=>{!a.has(e)&&e.node&&o.removeChild(e.node)}):o.removeChildren());if(this._prevDependencyObjs=a,a.size>0){for(var h=(e,t)=>{var i,a,s=e.predecessorTaskObj,r=e.successorTaskObj;switch(e.type){case n.START_FINISH:i=s.startTime,a=r.endTime;break;case n.START_START:i=s.startTime,a=r.startTime;break;case n.FINISH_FINISH:i=s.endTime,a=r.endTime;break;case n.FINISH_START:default:i=s.endTime,a=r.startTime}return this._isIntervalOverlap(Math.min(i,a),Math.max(i,a),t.viewStartTime,t.viewEndTime)},l=this._binarySearchLeftMost(this._dependencyObjs,e.minRowInd,"successor","rowObjBottom","index"),d=this._dependencyObjs[l],g=d.prevTopDependencyObj,_=t===b.VPC_TRANSLATE||t===b.VPC_REFRESH;d&&d.rowObjTop.index<=e.maxRowInd;)a.has(d)&&h(d,e)&&this._renderDependencyObj(d,_),d=d.nextTopDependencyObj;for(;g;){g.rowObjBottom.index>=e.minRowInd&&a.has(g)&&h(g,e)&&this._renderDependencyObj(g,_),g=g.prevTopDependencyObj}}}_detachRowObjNode(e){var t=e.node;t&&(e.taskObjs.forEach(e=>{var t=e.node;t&&t.remove()}),t.remove())}_prepareViewport(e,t){t===b.VPC_REFRESH&&(this._rowObjs.forEach(this._detachRowObjNode,this),this._gantt.getDatabody().removeChildren(),this._gantt.getStickyRowsContainer()?.removeChildren(),this._gantt.getDatabodyBackground().removeChildren(),this._gantt.getStickyRowBackgroundsContainer()?.removeChildren(),this._gantt.getRowReferenceObjectsContainer().removeChildren(),this._gantt.getStickyRowReferenceObjectsContainer()?.removeChildren());var i=this._gantt.getRowAxis();this._gantt.isRowAxisEnabled()&&i&&t!==b.VPC_TRANSLATE&&t!==b.VPC_SCALE&&i.clear(),this._findAndUpdateStickyRowObj()}_computeViewportRenderOperations(e,t){var i=[],s=[],n=[],r=t=>{var i=this.findTaskObjsRange(t,e.viewStartTime,!0,e.viewEndTime,!0);this.findBufferTaskObjsRange(t,e.viewStartTime,e.viewEndTime).forEach(e=>{i.push(e)}),s.push({rowObj:t,tasksAdd:new Set(i),tasksUpdate:new Set,tasksDelete:new Set,updateRender:!0})};if(t===b.VPC_REFRESH)for(var o=e.minRowInd;o<=e.maxRowInd;o++){var h=this._rowObjs[o];r(h)}else if(t===b.VPC_ANIMATE){this._animationFinalStateRowObjs?.forEach((t,i)=>{var a=new Set,n=this.findTaskObjsRange(i,e.viewStartTime,!0,e.viewEndTime,!0),r=this.findBufferTaskObjsRange(i,e.viewStartTime,e.viewEndTime);n.forEach(e=>{t.has(e)||a.add(e)}),r.forEach(e=>{t.has(e)||a.add(e)}),t.forEach(e=>{a.add(e)}),this._animationFinalStateRowObjs.set(i,a),s.push({rowObj:i,tasksAdd:a,tasksUpdate:new Set,tasksDelete:new Set,updateRender:!0})},this);var l=this._gantt.getRowAxis();for(o=0;o<this._animationInitialStateRowObjsDelete.length;o++){var d=this._animationInitialStateRowObjsDelete[o].node;if(d&&l)d.getRowLabelContent().ensureInDOM(),this._gantt.isHorizontalGridlinesVisible()&&l.addHorizontalLine(d.getRowAxisHorizontalLine())}}else{var g=this._gantt.getEventManager(),_=a.TimeAxisUtils.supportsTouch()&&g&&g.isDnDDragging();for(o=this._prevViewport.minRowInd;o<Math.min(e.minRowInd,this._prevViewport.maxRowInd);o++)i.push(this._rowObjs[o]);for(o=Math.max(e.maxRowInd+1,this._prevViewport.minRowInd);o<=this._prevViewport.maxRowInd;o++)i.push(this._rowObjs[o]);for(o=e.minRowInd;o<Math.min(this._prevViewport.minRowInd,e.maxRowInd);o++){h=this._rowObjs[o];r(h)}for(o=Math.max(this._prevViewport.maxRowInd+1,e.minRowInd);o<=e.maxRowInd;o++){h=this._rowObjs[o];r(h)}var c=t===b.VPC_SCALE;if(this._prevViewport.maxRowInd>=e.minRowInd&&this._prevViewport.minRowInd<=e.maxRowInd){var u=this._prevViewport.viewStartTime,p=this._prevViewport.viewEndTime,m=e.viewStartTime,v=e.viewEndTime;for(o=Math.max(e.minRowInd,this._prevViewport.minRowInd);o<=Math.min(e.maxRowInd,this._prevViewport.maxRowInd);o++){h=this._rowObjs[o];var S=new Set,D=new Set,T=new Set;u<m&&this.findTaskObjsRange(h,u,!0,Math.min(m,p),p<m).forEach(e=>{S.add(e)}),p>v&&this.findTaskObjsRange(h,Math.max(v,u),u>v,p,!0).forEach(e=>{S.add(e)}),m<u&&this.findTaskObjsRange(h,m,!0,Math.min(v,u),v<u).forEach(e=>{D.add(e)}),v>p&&this.findTaskObjsRange(h,Math.max(p,m),m>p,v,!0).forEach(e=>{D.add(e)}),p>=m&&u<=v&&(T=new Set(this.findTaskObjsRange(h,Math.max(m,u),!0,Math.min(v,p),!0))),this.findBufferTaskObjsRange(h,this._prevViewport.viewStartTime,this._prevViewport.viewEndTime).forEach(e=>{S.add(e)}),this.findBufferTaskObjsRange(h,e.viewStartTime,e.viewEndTime).forEach(e=>{D.add(e)});var y=[];S.forEach(e=>{D.has(e)&&y.push(e)}),y.forEach(e=>{T.add(e),S.delete(e),D.delete(e)}),_&&(S=new Set),n.push({rowObj:h,tasksAdd:D,tasksUpdate:T,tasksDelete:S,updateRender:c})}}}if(_&&(i=[]),this._viewportStickyRowObj){var C=e=>{i=i.filter(t=>!(t===e)),s=s.filter(t=>!(t===e)),n=n.filter(t=>!(t===e)),r(e)};this._prevViewportStickyRowObj&&C(this._prevViewportStickyRowObj),C(this._viewportStickyRowObj)}return{rowsDelete:i,rowsAdd:s,rowsUpdate:n}}_executeViewportRenderOperations(e){e.rowsDelete.forEach(this._detachRowObjNode,this),e.rowsAdd.forEach(e=>{this._renderRowObj(e.rowObj,e,"add")},this),e.rowsUpdate.forEach(e=>{this._renderRowObj(e.rowObj,e,"update")},this)}renderViewport(e,i){this._prepareViewport(e,i);var a=this._computeViewportRenderOperations(e,i),s=(e,t)=>e+t.tasksAdd.size+t.tasksUpdate.size;this._numViewportTasks=a.rowsAdd.reduce(s,0)+a.rowsUpdate.reduce(s,0);var n=this._gantt.getDatabody().getElem(),r=this._gantt.getStickyRowsContainer()?.getElem(),o=t.ToolkitUtils.getAttrNullNS(n,"shape-rendering");this._gantt.getViewportDensity()>1?"optimizeSpeed"!==o&&(t.ToolkitUtils.setAttrNullNS(n,"shape-rendering","optimizeSpeed"),t.ToolkitUtils.setAttrNullNS(n,"text-rendering","optimizeSpeed"),r&&(t.ToolkitUtils.setAttrNullNS(r,"shape-rendering","optimizeSpeed"),t.ToolkitUtils.setAttrNullNS(r,"text-rendering","optimizeSpeed"))):"optimizeSpeed"===o&&(t.ToolkitUtils.removeAttrNullNS(n,"shape-rendering"),t.ToolkitUtils.removeAttrNullNS(n,"text-rendering"),r&&(t.ToolkitUtils.removeAttrNullNS(r,"shape-rendering"),t.ToolkitUtils.removeAttrNullNS(r,"text-rendering"))),this._executeViewportRenderOperations(a),this.renderViewportDependencyLines(e,i),this._prevViewport=e,this._animationFinalStateRowObjs=null,this._animationInitialStateRowObjsDelete=[]}}b.VPC_TRANSLATE="vpc_translate",b.VPC_SCALE="vpc_scale",b.VPC_ANIMATE="vpc_animate",b.VPC_REFRESH="vpc_refresh";class v{constructor(e){this._gantt=e}prepareForAnimations(){var e=this._gantt.getCtx();this._gantt.StopAnimation(!0),this._animationMode="none",this._animationDuration=s.getAnimationDuration(this._gantt.getOptions()),this._gantt.isInitialRender()?this._gantt.isIRAnimationEnabled&&(this._animationMode="onDisplay"):this._gantt.isDCAnimationEnabled&&(this._animationMode="dataChange"),"onDisplay"===this._animationMode?(this.fadeInElemsIR=[],this.fadeInPlayableIR=new t.AnimFadeIn(e,this.fadeInElemsIR,this._animationDuration,0),this.dimensionsPlayableIR=this._createCustomPlayable(t.Easing.linear),this.translationsPlayableIR=this._createCustomPlayable(t.Easing.cubicInOut)):"dataChange"===this._animationMode&&(this.fadeInElemsDC=[],this.fadeInPlayableDC=new t.AnimFadeIn(e,this.fadeInElemsDC,this._animationDuration,0),this.fadeOutElemsDC=[],this.fadeOutPlayableDC=new t.AnimFadeOut(e,this.fadeOutElemsDC,this._animationDuration,0),this.dimensionsPlayableDC=this._createCustomPlayable(t.Easing.linear),this.translationsPlayableDC=this._createCustomPlayable(t.Easing.cubicInOut)),this._onEnds=[]}getAnimationMode(){return this._animationMode}setAnimationMode(e){this._animationMode=e}_createCustomPlayable(e){var i;return(i=new t.CustomAnimation(this._gantt.getCtx(),this._gantt,this._animationDuration)).setEasing(e),i}triggerAnimations(){var e,i;if(this._gantt.StopAnimation(!0),i=this._gantt.getCtx(),"onDisplay"===this._animationMode?(e=[this.fadeInPlayableIR,this.translationsPlayableIR,this.dimensionsPlayableIR],this._gantt.Animation=new t.ParallelPlayable(i,e,this._animationDuration,0)):"dataChange"===this._animationMode&&(e=[this.fadeInPlayableDC,this.translationsPlayableDC,this.dimensionsPlayableDC,this.fadeOutPlayableDC],this._gantt.Animation=new t.ParallelPlayable(i,e,this._animationDuration,0)),this._gantt.Animation){this._hideDepLines(),t.Playable.appendOnEnd(this._gantt.Animation,this._showDepLines,this),this._gantt.isDndEnabled()||(this._gantt.EventManager.removeListeners(this._gantt),this._bListenersRemoved=!0);for(var a=0;a<this._onEnds.length;a++)t.Playable.appendOnEnd(this._gantt.Animation,this._onEnds[a],this);t.Playable.appendOnEnd(this._gantt.Animation,this._onAnimationEnd,this),this._gantt.Animation.play()}}_hideDepLines(){var e=this._gantt.getDependenciesContainer();null!=e&&t.ToolkitUtils.setAttrNullNS(e.getElem(),"display","none")}_showDepLines(){var e=this._gantt.getDependenciesContainer();null!=e&&t.ToolkitUtils.removeAttrNullNS(e.getElem(),"display")}_onAnimationEnd(){this._gantt.AnimationStopped||this._gantt.RenderComplete(),this._bListenersRemoved&&this._gantt.EventManager.addListeners(this._gantt),this._gantt.Animation=null,this._gantt.AnimationStopped=!1,this._animationMode="none",this._gantt.renderViewport(b.VPC_REFRESH,!1)}preAnimateGanttIR(e){"onDisplay"===this._animationMode&&this.fadeInElemsIR.push(e._canvas)}preAnimateTaskNode(e,i){var a,s=e.getRenderState();"dataChange"===this._animationMode?"add"===s?(e.setTranslate(i.x,i.y),this.fadeInElemsDC.push(e)):"exist"!==s&&"migrate"!==s||((a=this.translationsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,e,e.getTranslateX,e.setTranslateX,i.x),a.addProp(t.Animator.TYPE_NUMBER,e,e.getTranslateY,e.setTranslateY,i.y)):e.setTranslate(i.x,i.y)}preAnimateTaskNodeRemove(e,t){"dataChange"===this._animationMode?(this.fadeOutElemsDC.push(e),this._onEnds.push(t)):t()}preAnimateTaskBaseline(e,i,a,s){var n,r,o=e.getRenderState("baseline");"onDisplay"===this._animationMode?(i.setDimensions(a.x,a.y,0,a.h,a.r),s(),(n=this.dimensionsPlayableIR.getAnimator()).addProp(t.Animator.TYPE_NUMBER,i,i.getWidth,i.setWidth,a.w)):"dataChange"===this._animationMode?"add"===o?(i.setDimensions(a.x,a.y,0,a.h,a.r),s(),(n=this.dimensionsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,i,i.getWidth,i.setWidth,a.w)):"exist"===o&&((r=this.translationsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,i,i.getX,i.setX,a.x),r.addProp(t.Animator.TYPE_NUMBER,i,i.getY,i.setY,a.y),(n=this.dimensionsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,i,i.getWidth,i.setWidth,a.w),n.addProp(t.Animator.TYPE_NUMBER,i,i.getHeight,i.setHeight,a.h),i.setBorderRadius(a.r),this._onEnds.push(s)):(i.setDimensions(a.x,a.y,a.w,a.h,a.r),s())}preAnimateTaskBaselineRemove(e,t){"dataChange"===this._animationMode?(this.fadeOutElemsDC.push(e),this._onEnds.push(t)):t()}preAnimateTaskMain(e,i,a){var s,n,r=e.getRenderState("main");"onDisplay"===this._animationMode?(e.setMainDimensions(i.x,i.y,0,i.h,i.r),a(),(s=this.dimensionsPlayableIR.getAnimator()).addProp(t.Animator.TYPE_NUMBER,e,e.getMainWidth,e.setMainWidth,i.w)):"dataChange"===this._animationMode?"add"===r?(e.setMainDimensions(i.x,i.y,0,i.h,i.r),a(),(s=this.dimensionsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,e,e.getMainWidth,e.setMainWidth,i.w)):"exist"===r&&((n=this.translationsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,e,e.getMainX,e.setMainX,i.x),n.addProp(t.Animator.TYPE_NUMBER,e,e.getMainY,e.setMainY,i.y),(s=this.dimensionsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,e,e.getMainWidth,e.setMainWidth,i.w),s.addProp(t.Animator.TYPE_NUMBER,e,e.getMainHeight,e.setMainHeight,i.h),e.setMainBorderRadius(i.r),this._onEnds.push(a)):(e.setMainDimensions(i.x,i.y,i.w,i.h,i.r),a())}preAnimateTaskMainRemove(e,t,i,a,s,n,r){"dataChange"===this._animationMode?(this.fadeOutElemsDC.push(e),t&&this.fadeOutElemsDC.push(t),i&&this.fadeOutElemsDC.push(i),a&&this.fadeOutElemsDC.push(a),s&&this.fadeOutElemsDC.push(s),n&&this.fadeOutElemsDC.push(n),this._onEnds.push(r)):r()}preAnimateTaskProgress(e,i,a,s){var n,r,o=e.getRenderState("progress");"onDisplay"===this._animationMode?(i.setDimensions(a.x,a.y,0,a.h,a.r),s(),(n=this.dimensionsPlayableIR.getAnimator()).addProp(t.Animator.TYPE_NUMBER,i,i.getWidth,i.setWidth,a.w)):"dataChange"===this._animationMode?"add"===o?(i.setDimensions(a.x,a.y,0,a.h,a.r),s(),(n=this.dimensionsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,i,i.getWidth,i.setWidth,a.w)):"exist"===o&&((r=this.translationsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,i,i.getX,i.setX,a.x),r.addProp(t.Animator.TYPE_NUMBER,i,i.getY,i.setY,a.y),(n=this.dimensionsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,i,i.getWidth,i.setWidth,a.w),n.addProp(t.Animator.TYPE_NUMBER,i,i.getHeight,i.setHeight,a.h),i.setBorderRadius(a.r),this._onEnds.push(s)):(i.setDimensions(a.x,a.y,a.w,a.h,a.r),s())}preAnimateTaskProgressRemove(e,t){"dataChange"===this._animationMode?(this.fadeOutElemsDC.push(e),this._onEnds.push(t)):t()}preAnimateTaskOvertime(e,i,a,s){var n,r,o=e.getRenderState("overtime");"onDisplay"===this._animationMode?(i.setDimensions(a.x,a.y,0,a.h,a.r),s(),(n=this.dimensionsPlayableIR.getAnimator()).addProp(t.Animator.TYPE_NUMBER,i,i.getWidth,i.setWidth,a.w)):"dataChange"===this._animationMode?"add"===o?(i.setDimensions(a.x,a.y,0,a.h,a.r),s(),(n=this.dimensionsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,i,i.getWidth,i.setWidth,a.w)):"exist"===o&&((r=this.translationsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,i,i.getX,i.setX,a.x),r.addProp(t.Animator.TYPE_NUMBER,i,i.getY,i.setY,a.y),(n=this.dimensionsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,i,i.getWidth,i.setWidth,a.w),n.addProp(t.Animator.TYPE_NUMBER,i,i.getHeight,i.setHeight,a.h),i.setBorderRadius(a.r),this._onEnds.push(s)):(i.setDimensions(a.x,a.y,a.w,a.h,a.r),s())}preAnimateTaskOvertimeRemove(e,t){"dataChange"===this._animationMode?(this.fadeOutElemsDC.push(progressShape),this._onEnds.push(t)):t()}preAnimateTaskDowntime(e,i,a,s){var n,r,o=e.getRenderState("downtime");"onDisplay"===this._animationMode?(i.setDimensions(a.x,a.y,0,a.h,a.r),s(),(n=this.dimensionsPlayableIR.getAnimator()).addProp(t.Animator.TYPE_NUMBER,i,i.getWidth,i.setWidth,a.w)):"dataChange"===this._animationMode?"add"===o?(i.setDimensions(a.x,a.y,0,a.h,a.r),s(),(n=this.dimensionsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,i,i.getWidth,i.setWidth,a.w)):"exist"===o&&((r=this.translationsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,i,i.getX,i.setX,a.x),r.addProp(t.Animator.TYPE_NUMBER,i,i.getY,i.setY,a.y),(n=this.dimensionsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,i,i.getWidth,i.setWidth,a.w),n.addProp(t.Animator.TYPE_NUMBER,i,i.getHeight,i.setHeight,a.h),i.setBorderRadius(a.r),this._onEnds.push(s)):(i.setDimensions(a.x,a.y,a.w,a.h,a.r),s())}preAnimateTaskDowntimeRemove(e,t){"dataChange"===this._animationMode?(this.fadeOutElemsDC.push(e),this._onEnds.push(t)):t()}preAnimateTaskAttribute(e,i,a,s){var n,r,o=e.getRenderState("attribute");"onDisplay"===this._animationMode?(i.setDimensions(a.x,a.y,a.w,0,a.r),s(),(n=this.dimensionsPlayableIR.getAnimator()).addProp(t.Animator.TYPE_NUMBER,i,i.getHeight,i.setHeight,a.h)):"dataChange"===this._animationMode?"add"===o?(i.setDimensions(a.x,a.y,a.w,0,a.r),s(),(n=this.dimensionsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,i,i.getHeight,i.setHeight,a.h)):"exist"===o&&((r=this.translationsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,i,i.getX,i.setX,a.x),r.addProp(t.Animator.TYPE_NUMBER,i,i.getY,i.setY,a.y),(n=this.dimensionsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,i,i.getWidth,i.setWidth,a.w),n.addProp(t.Animator.TYPE_NUMBER,i,i.getHeight,i.setHeight,a.h),i.setBorderRadius(a.r),this._onEnds.push(s)):(i.setDimensions(a.x,a.y,a.w,a.h,a.r),s())}preAnimateTaskAttributeRemove(e,t){"dataChange"===this._animationMode?(this.fadeOutElemsDC.push(e),this._onEnds.push(t)):t()}preAnimateTaskLabel(e,i,a){var s,n=e.getTask(),r=e.getTaskLabel(),o=r.getLabelOutputText(),h=r.getRenderState(),l=n.getRenderState("main");"onDisplay"===this._animationMode?(a(),o.setY(i.y),o.setX(n.getShape("main").getX()),(s=this.translationsPlayableIR.getAnimator()).addProp(t.Animator.TYPE_NUMBER,o,o.getX,o.setX,i.x),s.addProp(t.Animator.TYPE_NUMBER,o,o.getY,o.setY,i.y)):"dataChange"===this._animationMode?"add"===h?(o.setX(i.x),o.setY(i.y),a(),"add"===l?(o.setX(n.getShape("main").getX()),(s=this.translationsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,o,o.getX,o.setX,i.x),s.addProp(t.Animator.TYPE_NUMBER,o,o.getY,o.setY,i.y)):"exist"===l&&this.fadeInElemsDC.push(o)):"exist"===h&&((s=this.translationsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,o,o.getX,o.setX,i.x),s.addProp(t.Animator.TYPE_NUMBER,o,o.getY,o.setY,i.y),this._onEnds.push(a)):(o.setX(i.x),o.setY(i.y),a())}preAnimateTaskLabelRemove(e,t){"dataChange"===this._animationMode?(this.fadeOutElemsDC.push(e),this._onEnds.push(t)):t()}preAnimateHorizontalGridline(e,i,a){var s;"dataChange"===this._animationMode?"add"===a?(e.setY1(i.y1),e.setY2(i.y2),e.setX1(i.x1),e.setX2(i.x2),this.fadeInElemsDC.push(e)):"exist"===a&&((s=this.translationsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,e,e.getX1,e.setX1,i.x1),s.addProp(t.Animator.TYPE_NUMBER,e,e.getX2,e.setX2,i.x2),s.addProp(t.Animator.TYPE_NUMBER,e,e.getY1,e.setY1,i.y1),s.addProp(t.Animator.TYPE_NUMBER,e,e.getY2,e.setY2,i.y2)):(e.setY1(i.y1),e.setY2(i.y2),e.setX1(i.x1),e.setX2(i.x2))}preAnimateRowBackground(e,i,a){var s;"dataChange"===this._animationMode?("add"===a&&this.fadeInElemsDC.push(e),(s=this.dimensionsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,e,e.getHeight,e.setHeight,i.h),s.addProp(t.Animator.TYPE_NUMBER,e,e.getWidth,e.setWidth,i.w),this.translationsPlayableDC.getAnimator().addProp(t.Animator.TYPE_NUMBER,e,e.getY,e.setY,i.y)):(e.setY(i.y),e.setHeight(i.h),e.setWidth(i.w))}preAnimateRowReferenceObject(e,i){"dataChange"===this._animationMode?this.dimensionsPlayableDC.getAnimator().addProp(t.Animator.TYPE_NUMBER,e,e.getY2,e.setY2,i.y2):e.updateRefObjs(e._refObjs,i.y1,i.y2)}preAnimateRowNodeRemove(e,t){"dataChange"===this._animationMode?(this.fadeOutElemsDC.push(e),this.fadeOutElemsDC.push(e.getBackground()),this._onEnds.push(t)):t()}preAnimateRowLabel(e,i,a){var s,n,r=e.getRenderState(),o=i.getBackground();"dataChange"===this._animationMode?"add"===r?(i.setY(a.y),i.setX(a.x),this.fadeInElemsDC.push(i.getDisplayable()),o.setRect(a.backgroundX,a.backgroundY,a.backgroundWidth,a.backgroundHeight),this.fadeInElemsDC.push(o)):"exist"===r&&((s=this.translationsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,i,i.getX,i.setX,a.x),s.addProp(t.Animator.TYPE_NUMBER,i,i.getY,i.setY,a.y),s.addProp(t.Animator.TYPE_NUMBER,o,o.getX,o.setX,a.backgroundX),s.addProp(t.Animator.TYPE_NUMBER,o,o.getY,o.setY,a.backgroundY),(n=this.dimensionsPlayableDC.getAnimator()).addProp(t.Animator.TYPE_NUMBER,o,o.getWidth,o.setWidth,a.backgroundWidth),n.addProp(t.Animator.TYPE_NUMBER,o,o.getHeight,o.setHeight,a.backgroundHeight)):(i.setY(a.y),i.setX(a.x),o.setRect(a.backgroundX,a.backgroundY,a.backgroundWidth,a.backgroundHeight))}preAnimateRowLabelRemove(e,t,i){"dataChange"===this._animationMode?(this.fadeOutElemsDC.push(e.getBackground()),this.fadeOutElemsDC.push(e.getDisplayable()),this.fadeOutElemsDC.push(t),this._onEnds.push(i)):i()}}class S extends t.Automation{GetSubIdForDomElement(e){var t=this._comp.getEventManager().GetLogicalObject(e);if(t&&t instanceof p){var i=t.getLayoutObject().rowObj;return"taskbar["+i.index+"]["+i.taskObjs.map(e=>e.node).indexOf(t)+"]"}return t&&t instanceof r?"rowLabel["+t.getRowIndex()+"]":t&&t instanceof n?t.getLayoutObject().index:null}getDomElementForSubId(e){if(e===t.Automation.TOOLTIP_SUBID)return this.GetTooltipElement(this._comp);var i=e.indexOf("["),a=e.indexOf("]"),s=e.substring(0,i);if(i>-1&&a>-1)if("taskbar"===s){var n=e.indexOf("[",i+1),r=e.indexOf("]",n+1);if(n>-1&&r>-1){var o=parseInt(e.substring(i+1,a)),h=parseInt(e.substring(n+1,r));if(isNaN(o)||isNaN(h))return null;if((_=this._comp.getRowLayoutObjs()).length>o){var l=_[o].taskObjs;if(l.length>h){var d=l[h];this._comp.getDataLayoutManager().ensureInDOM(d,"task",!0);var g=d.node.getTask().getShape("main");if(null!=g)return g.getElem()}}}}else if("rowLabel"===s){var _;if(o=parseInt(e.substring(i+1,a)),(_=this._comp.getRowLayoutObjs()).length>o){var c=_[o];this._comp.getDataLayoutManager().ensureInDOM(c,"rowLabel");var u=c.node.getRowLabelContent();if(null!=u)return u.getDisplayable().getElem()}}else if("dependency"===s){var p=parseInt(e.substring(i+1,a)),m=this._comp.getDependencyLayoutObjs();if(m.length>p)for(var b=0;b<m.length;b++){var v=m[b];if(v.index===p){this._comp.getDataLayoutManager().ensureInDOM(v,"dependency");var S=v.node;if(null!=S)return S.getElem()}}}return null}}class D extends t.BaseComponentDefaults{constructor(e){super({alta:{axisPosition:"top",animationOnDataChange:"none",animationOnDisplay:"none",scrollbar:{horizontal:"off",vertical:"off"},gridlines:{horizontal:"hidden",vertical:"visible"},selectionMode:"none",scrollPosition:{y:0},rowDefaults:{height:null},taskDefaults:{labelPosition:["end","innerCenter","start","max"],borderRadius:"0",overlap:{behavior:"auto",offset:null},progress:{height:"100%",borderRadius:"0"},baseline:{borderRadius:"0"},type:"auto"},rowAxis:{rendered:"off",width:"max-content",maxWidth:"none"}}},e)}getNoCloneObject(){return{start:!0,end:!0,viewportStart:!0,viewportEnd:!0,rows:!0,dependencies:!0,referenceObjects:{value:!0},majorAxis:{converter:!0,scale:!0,zoomOrder:!0},minorAxis:{converter:!0,scale:!0,zoomOrder:!0},valueFormats:{baselineDate:{converter:!0},baselineEnd:{converter:!0},baselineStart:{converter:!0},date:{converter:!0},downtimeEnd:{converter:!0},downtimeStart:{converter:!0},end:{converter:!0},overtimeEnd:{converter:!0},overtimeStart:{converter:!0},progress:{converter:!0},start:{converter:!0}},_resources:{converter:!0,defaultDateConverter:!0,defaultDateTimeConverter:!0,percentConverter:!0}}}getAnimationDuration(e){return e._resources?e._resources.animationDuration:null}}const T=e=>{var t={},i=t=>{var i=typeof e[t];if("number"===i||"string"===i){var a=new Date(e[t]).getTime();if(!isNaN(a))return a}return null};return t.start=i("start"),t.end=i("end"),e.viewportStart&&(t.viewStart=i("viewportStart")),e.viewportEnd&&(t.viewEnd=i("viewportEnd")),t.rows=e.rows,t.dependencies=e.dependencies,t.axisPosition="top",null!=e.axisPosition&&(t.axisPosition=e.axisPosition),t.selectionMode="none",null!=e.selectionMode&&(t.selectionMode=e.selectionMode),t.horizontalGridline="hidden",t.verticalGridline="hidden",null!=e.gridlines&&(null!=e.gridlines.horizontal&&(t.horizontalGridline=e.gridlines.horizontal),null!=e.gridlines.vertical&&(t.verticalGridline=e.gridlines.vertical)),t.xScrollbar="off",t.yScrollbar="off",e.scrollbars&&(e.scrollbars.horizontal&&(t.xScrollbar=e.scrollbars.horizontal),e.scrollbars.vertical&&(t.yScrollbar=e.scrollbars.vertical)),t.isIRAnimationEnabled="auto"===e.animationOnDisplay,t.isDCAnimationEnabled="auto"===e.animationOnDataChange,null!=e.rowAxis&&(t.rowAxisRendered=e.rowAxis.rendered,t.rowAxisWidth=e.rowAxis.width,t.rowAxisMaxWidth=e.rowAxis.maxWidth),t.referenceObjects=e.referenceObjects,t.styleClass=e.className,t.inlineStyle=e.style,t};class y extends t.Container{constructor(e){super(e.getCtx()),this._gantt=e;var i=e.getEventManager();this.addEvtListener(t.MouseEvent.MOUSEMOVE,i.OnMouseMove.bind(i),!1,this),this.addEvtListener(t.MouseEvent.MOUSEOVER,i.PreOnMouseOver.bind(i),!1,this),this.addEvtListener(t.MouseEvent.MOUSEOUT,i.PreOnMouseOut.bind(i),!1,this),this._labelBackgroundContainerContainer=new t.Container(e.getCtx()),this._labelBackgroundContainer=new t.Container(e.getCtx()),this._labelBackgroundContainerContainer.addChild(this._labelBackgroundContainer),this._labelContentContainerContainer=new t.Container(e.getCtx()),this._labelContentContainer=new t.Container(e.getCtx()),this._labelContentContainerContainer.addChild(this._labelContentContainer),this._stickyLabelBackgroundContainerContainer=new t.Container(e.getCtx()),this._stickyLabelBackgroundContainer=new t.Container(e.getCtx()),this._stickyLabelBackgroundContainerContainer.addChild(this._stickyLabelBackgroundContainer),this._stickyLabelContentContainerContainer=new t.Container(e.getCtx()),this._stickyLabelContentContainer=new t.Container(e.getCtx()),this._stickyLabelContentContainerContainer.addChild(this._stickyLabelContentContainer)}getDefaultRowLabelStyle(e){var t=this._gantt.getOptions();return e?(this._defaultLabelCSSStyle||(this._defaultLabelCSSStyle=s.getRowLabelStyle(t)),this._defaultLabelCSSStyle):s.getRowLabelStyle(t)}_getCSSStyle(e){if(null!=e&&""!==e&&0!==Object.keys(e).length){var t=this.getDefaultRowLabelStyle(!1);return t.parseInlineStyle(e),t}return this.getDefaultRowLabelStyle(!0)}getLabelContentType(){var e=this._gantt.getOptions().rowAxis;return e.label&&e.label.renderer?"custom":"text"}_getAvailableWidth(e){var t,i,a=this._gantt.getRowAxisMaxWidth(),n=this._gantt.getRowAxisWidth();return null!=a&&"none"!==a&&(t=Math.min(s.getSizeInPixels(a,e),e)),t=null==t||isNaN(t)?e:t,null!=n&&"max-content"!==n&&(i=s.getSizeInPixels(this._gantt.getRowAxisWidth(),e)),{maxWidth:t,width:i=null==i||isNaN(i)?-1:i,calculatedWidth:-1!==i?Math.min(i,t):t}}getAvailableWidth(){return this._availableWidth}getWidth(){return this._width}getLabelContentIndentSize(e){return e.depth*s.getRowLabelIndentSize()+s.getRowLabelButtonSize()+s.getRowLabelButtonContentGapSize()}_getMaxTextContentWidth(e,i,a){if(!this._gantt.isRowsHierarchical())return t.TextUtils.getMaxTextStringWidth(e,i,a);for(var s=this._gantt.getRowLayoutObjs(),n=0,r=0;r<i.length;r++){var o=i[r]?i[r]:"",h=a[r],l=t.TextUtils.getTextStringWidth(e,o,h),d=(null==s[r].expanded&&0===o.length?0:this.getLabelContentIndentSize(s[r]))+l;d>n&&(n=d)}return n}render(e,t){if(!t){this._gantt.isStickyRowsEnabled()?(this.addChild(this._labelBackgroundContainerContainer),this.addChild(this._stickyLabelBackgroundContainerContainer),this.addChild(this._labelContentContainerContainer),this.addChild(this._stickyLabelContentContainerContainer)):(this._stickyLabelBackgroundContainerContainer.removeFromParent(),this._stickyLabelContentContainerContainer.removeFromParent(),this._labelBackgroundContainerContainer.setClipPath(null),this._labelContentContainerContainer.setClipPath(null),this.addChild(this._labelBackgroundContainerContainer),this.addChild(this._labelContentContainerContainer)),this.setAriaRole("grid",!0);var i=this._gantt.getOptions().translations;this.setAriaProperty("label",i.rowAxisLabel,!0)}if(this._availableWidth=this._getAvailableWidth(e),t)-1!==this._availableWidth.width&&(this._width=this._availableWidth.calculatedWidth);else{this._rowLabelContents=[];var a=this.getLabelContentType(),n=this._gantt.getRowLayoutObjs();if(-1===this._availableWidth.width){if("text"===a){for(var o=[],h=[],l=0;l<n.length;l++){var d=n[l].data,g=null!=d.label?d.label:"",_=this._getCSSStyle(d.labelStyle);o.push(g),h.push(_),this._rowLabelContents.push(null)}this._width=this._getMaxTextContentWidth(this._gantt.getCtx(),o,h)}else if("custom"===a){this._width=0;for(l=0;l<n.length;l++){var c=n[l],u=new r(this,a);u.setRowIndex(l),u.render(c),this._width=Math.max(this._width,u.getWidth()),this._rowLabelContents.push(u)}}var p=this._gantt.getOptions(),m=s.getRowLabelPaddingStart(p),b=s.getRowLabelPaddingEnd(p);this._width+=m+b}else{this._width=this._availableWidth.calculatedWidth;for(l=0;l<n.length;l++)this._rowLabelContents.push(null)}this._width=Math.ceil(Math.min(this._width,this._availableWidth.maxWidth))}}addLabelContent(e,t){const i=t?this._stickyLabelContentContainer:this._labelContentContainer;e.getParent()!==i&&i.addChild(e)}removeLabelContent(e){e?.removeFromParent()}addLabelBackground(e,t){const i=t?this._stickyLabelBackgroundContainer:this._labelBackgroundContainer;e.getParent()!==i&&i.addChild(e)}removeLabelBackground(e){e?.removeFromParent()}addHorizontalLine(e,t){const i=t?this._stickyLabelContentContainer:this._labelContentContainer;e.getParent()!==i&&i.addChild(e)}removeHorizontalLine(e){e?.removeFromParent()}getRowLabelContents(){return this._rowLabelContents}setBackgroundContainer(e){this._backgroundContainer=e}getBackgroundContainer(){return this._backgroundContainer}setBackgroundDivider(e){this._backgroundDivider=e}getBackgroundDivider(){return this._backgroundDivider}adjustPosition(){var e=t.Agent.isRightToLeft(this._gantt.getCtx()),i=this._width,a=this._gantt.getDatabodyHeight(),n=s.getComponentPaddingStart(this._gantt.getOptions()),r=e?this._gantt.getStartXOffset()+this._gantt.getCanvasLength()+this._gantt.getBorderWidth()+s.getRowAxisGap():n;this.setTranslateX(r);var o=new t.ClipPath;o.addRect(e?r:r-n,this._gantt.getDatabodyStart()+this._gantt.getStartYOffset(),i+n,a),this.setClipPath(o),this._backgroundContainer.setTranslateX(e?r-1:r);var h=new t.ClipPath;if(h.addRect(this.getTranslateX(),0,i,this._gantt._backgroundHeight),this._backgroundContainer.setClipPath(h),this._backgroundDivider){var l=this._gantt.getDatabodyStart()+this._gantt.getStartYOffset()+("top"!==this._gantt.getAxisPosition())*(this._gantt.getDatabodyHeight()+1);this._backgroundDivider.setY1(l),this._backgroundDivider.setY2(l)}}setY(e){this._labelBackgroundContainer.setTranslateY(e),this._stickyLabelBackgroundContainer.setTranslateY(e),this._labelContentContainer.setTranslateY(e),this._stickyLabelContentContainer.setTranslateY(e)}updateStickyRowsVisibility(e){const{height:i}=this._gantt.getStickyRowRegionHeight(e);if(i!==this._prevStickyRowRegionHeight){const e=this._gantt.getDatabodyStart(),n=this._gantt.getDatabodyHeight(),r=this._gantt.getStartYOffset(),o=this._backgroundDivider?1:0,h=[this._labelBackgroundContainerContainer,this._labelContentContainerContainer],l=[this._stickyLabelBackgroundContainerContainer,this._stickyLabelContentContainerContainer];for(let s=0;s<h.length;s++){const l=h[s];if(l){var a=new t.ClipPath;a.addRect(0,e+r+i-o,this._width,n),l.setClipPath(a)}}for(let a=0;a<l.length;a++){const n=l[a];if(n){var s=new t.ClipPath;s.addRect(0,e+r,this._width,i),n.setClipPath(s)}}}this._prevStickyRowRegionHeight=i}clear(){this._labelContentContainer.removeChildren(),this._stickyLabelContentContainer.removeChildren(),this._labelBackgroundContainer.removeChildren(),this._prevStickyRowRegionHeight=null}}class C extends t.Container{constructor(e,t,i){super(e.getCtx(),null),this._gantt=e,this._type=t,this._refObjs=i,this._gantt.getEventManager().associate(this,this)}_applyStyles(){var e,t=this._refObjs[0].svgStyle,i=this._refObjs[0].svgClassName;switch(null!=t&&this._ref.setStyle(t),this._type){case"line":default:e=this._gantt.GetStyleClass("referenceObjectLine");break;case"timeCursor":e=this._gantt.GetStyleClass("timeCursorLine");break;case"area":e=this._gantt.GetStyleClass("referenceObjectArea")}var a=null!=i?e+" "+i:e;this._ref.setClassName(a,!0)}_calcCmds(e,i,s){var n=t.Agent.isRightToLeft(this._gantt.getCtx()),r=this._gantt.getStartTime(),o=this._gantt.getEndTime(),h=this._gantt.getContentLength(),l="";return"line"===this._type||"timeCursor"===this._type?this._refObjs.forEach(d=>{var g=new Date(d.value).getTime(),_=a.TimeAxisUtils.getDatePosition(r,o,g,h)+(s||0);n&&(_=h-_),l+=t.PathUtils.moveTo(_,e)+t.PathUtils.verticalLineTo(i)},this):this._refObjs.forEach(s=>{var d=new Date(s.start).getTime(),g=new Date(s.end).getTime(),_=a.TimeAxisUtils.getDatePosition(r,o,d,h),c=a.TimeAxisUtils.getDatePosition(r,o,g,h),u=n?h-c:_,p=n?h-_:c;l+=t.PathUtils.moveTo(u,e)+t.PathUtils.horizontalLineTo(p)+t.PathUtils.verticalLineTo(i)+t.PathUtils.horizontalLineTo(u)+t.PathUtils.verticalLineTo(e)},this),l}render(e,i,a){if(0!==this._refObjs.length){if(this._y1=null==i?this._gantt.getDatabodyStart():i,this._y2=null==a?this._gantt.getDatabodyStart()+this._gantt.getDatabodyHeight():a,this._ref=new t.Path(this._gantt.getCtx(),this._calcCmds(this._y1,this._y2,0)),"line"===this._type||"timeCursor"===this._type){this._partnerRef=new t.Path(this._gantt.getCtx(),this._calcCmds(this._y1,this._y2,1));var s=this._gantt.GetStyleClass("timeCursor"===this._type?"timeCursorInnerLine":"referenceObjectInnerLine");this._partnerRef.setClassName(s,!0),this.addChild(this._partnerRef)}this._applyStyles(),this.addChild(this._ref),e.addChild(this)}}updateRefObjs(e,t,i){this._refObjs=e,this._y1=null==t?this._y1:t,this._y2=null==i?this._y2:i,this._ref.setCmds(this._calcCmds(this._y1,this._y2,0)),this._partnerRef&&this._partnerRef.setCmds(this._calcCmds(this._y1,this._y2,1))}getY1(){return this._y1}getY2(){return this._y2}setY2(e){this.updateRefObjs(this._refObjs,this._y1,e)}hide(){this.setAlpha(0)}show(){this.setAlpha(1)}getDatatip(){return this._refObjs[0].shortDesc}}const f={renderGantt:e=>{if(f._renderBackground(e),f._renderScrollableCanvas(e),e.getAnimationManager().preAnimateGanttIR(e),e.removeEmptyText(),e.hasValidOptions(!0)){f._prepareTaskFillFilters(e),e.renderTimeZoomCanvas(e._canvas);var t=!(e.getStickyRowsContainer()||!e.isStickyRowsEnabled()),i=e.getTimeZoomCanvas();if(f._renderAxes(e,i),f._renderDatabodyBackground(e,i,t),f._renderStickyContainer(e,i,f._renderStickyRowBackgroundsContainer,e.getStickyRowBackgroundsContainer.bind(e),e.setStickyRowBackgroundsContainer.bind(e)),f._renderRowReferenceObjectsContainer(e,i,t),f._renderStickyContainer(e,i,f._renderStickyRowReferenceObjectsContainer,e.getStickyRowReferenceObjectsContainer.bind(e),e.setStickyRowReferenceObjectsContainer.bind(e)),f._renderReferenceObjects(e,i,"area",t),f._renderVerticalGridline(e,i,t),e.isRowAxisEnabled()&&e.getRowAxis().adjustPosition(),f._renderData(e,i,b.VPC_REFRESH,t),f._renderReferenceObjects(e,i,"line",t),f._renderTimeCursor(e,i,t),f._renderZoomControls(e),e.isMarqueeSelectEnabled())f._renderMarqueeArtifactsContainer(e,i);else{var a=e.getMarqueeArtifactsContainer();a&&(a.getParent().removeChild(a),e.setMarqueeArtifactsContainer(null))}if(e.isDndEnabled()&&f._renderDnDArtifactsContainer(e,i),null!=e.getRenderState()){var s=e.getEventManager().getFocus();s&&s instanceof p&&s.refreshAriaLabel()}e._processInitialSelections(),(e.isTimeDirScrollbarOn()||e.isContentDirScrollbarOn())&&f._renderScrollbars(e,e),e.setIsLastRenderValid(!0)}else f._renderEmptyText(e),e.setIsLastRenderValid(!1);f.renderRowAxisVerticalDivider(e,e._canvas)},_prepareTaskFillFilters:e=>{if(!document.getElementById(s.getTaskTintFilterId())){var i=s.getTaskTintAlpha(),a=t.SvgShapeUtils.createElement("filter",s.getTaskTintFilterId()),n=t.SvgShapeUtils.createElement("feColorMatrix");n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("type","matrix"),n.setAttribute("values",1-i+" 0 0 0 "+i+" 0 "+(1-i)+" 0 0 "+i+" 0 0 "+(1-i)+" 0 "+i+" 0 0 0 1 0"),a.appendChild(n);var r=s.getTaskShadeAlpha(),o=t.SvgShapeUtils.createElement("filter",s.getTaskShadeFilterId()),h=t.SvgShapeUtils.createElement("feColorMatrix");h.setAttribute("color-interpolation-filters","sRGB"),h.setAttribute("type","matrix"),h.setAttribute("values",1-r+" 0 0 0 0 0 "+(1-r)+" 0 0 0 0 0 "+(1-r)+" 0 0 0 0 0 1 0"),o.appendChild(h),e.appendSharedDefs(a),e.appendSharedDefs(o)}},_prerenderTimeDirScrollbar:(e,i,a)=>{var s=a.w,n=t.CSSStyle.toNumber(e.timeDirScrollbarStyles.getHeight());return e.setTimeDirScrollbar(new t.SimpleScrollbar(e.getCtx(),e.HandleEvent,e)),i.addChild(e.timeDirScrollbar),t.LayoutUtils.position(a,"bottom",e.timeDirScrollbar,s,n,0),new t.Dimension(s,n)},_prerenderContentDirScrollbar:(e,i,a)=>{var s=t.CSSStyle.toNumber(e.contentDirScrollbarStyles.getWidth()),n=a.h;return e.setContentDirScrollbar(new t.SimpleScrollbar(e.getCtx(),e.HandleEvent,e)),i.addChild(e.contentDirScrollbar),t.LayoutUtils.position(a,t.Agent.isRightToLeft(e.getCtx())?"left":"right",e.contentDirScrollbar,s,n,0),new t.Dimension(s,n)},_renderScrollbars:(e,i)=>{var a=e.getDatabody();if(null!=a){var s=e.getDatabodyStart(),n=e.getCtx(),r=e.getScrollbarPadding();if(null==e._scrollbarsCanvas?(e._scrollbarsCanvas=new t.Container(n,"g","sbCanvas"),i.addChild(e._scrollbarsCanvas)):e._scrollbarsCanvas.removeChildren(),e.isTimeDirScrollbarOn())var o=e.getCanvasLength(),h=e.Height-r,l=f._prerenderTimeDirScrollbar(e,e._scrollbarsCanvas,new t.Rectangle(0,0,o,h));if(e.isContentDirScrollbarOn()){o=e.Width-r,h=e.getDatabodyHeight();var d=t.Agent.isRightToLeft(e.getCtx())?e.getScrollbarPadding():0,g=f._prerenderContentDirScrollbar(e,e._scrollbarsCanvas,new t.Rectangle(d,0,o-d,h))}if(e.timeDirScrollbar&&l){var _={};_.color=e.timeDirScrollbarStyles.getStyle(t.CSSStyle.COLOR),_.backgroundColor=e.timeDirScrollbarStyles.getStyle(t.CSSStyle.BACKGROUND_COLOR),_.min=e._start,_.max=e._end,_.isHorizontal=!0,_.isReversed=t.Agent.isRightToLeft(e.getCtx()),e.timeDirScrollbar.setTranslateX(e.getStartXOffset()),e.timeDirScrollbar.render(_,l.w,l.h),e.timeDirScrollbar.setViewportRange(e._viewStartTime,e._viewEndTime)}if(e.contentDirScrollbar&&g){(_={}).color=e.contentDirScrollbarStyles.getStyle(t.CSSStyle.COLOR),_.backgroundColor=e.contentDirScrollbarStyles.getStyle(t.CSSStyle.BACKGROUND_COLOR),_.min=-(Math.max(e.getContentHeight(),g.h)-s),_.max=s,_.isHorizontal=!1,_.isReversed=!0,e.contentDirScrollbar.setTranslateY(s+e.getStartYOffset()),e.contentDirScrollbar.render(_,g.w,g.h);var c=0;"bottom"===e.getAxisPosition()&&(c=e.getAxesHeight()),e.contentDirScrollbar.setViewportRange(a.getTranslateY()-(Math.max(0,e.getCanvasSize()-c)-s),a.getTranslateY())}}else null!=e._scrollbarsCanvas&&e._scrollbarsCanvas.removeChildren()},renderRowAxisVerticalDivider:(e,i)=>{var a=e.getCtx();if("alta"!==a.getThemeBehavior()&&e.isRowAxisEnabled()){var s=t.Agent.isRightToLeft(a)?e.getStartXOffset()+e.getCanvasLength():Math.round(e.getStartXOffset())+.5;e._rowAxisVerticalDivider?e._rowAxisVerticalDivider.setX1(s).setX2(s):(e._rowAxisVerticalDivider=new t.Line(a,s,e.getStartYOffset(),s,e._canvasSize+2*e.getBorderWidth()),e._rowAxisVerticalDivider.setPixelHinting(!0),e._rowAxisVerticalDivider.setClassName(e.GetStyleClass("majorvgridline"),!0),i.addChild(e._rowAxisVerticalDivider))}},renderRowAxis:(e,i)=>{var a=t.Agent.isRightToLeft(e.getCtx()),n=e.getRowAxis();if(e.isRowAxisEnabled()){n||((n=new y(e)).setPixelHinting(!0),e.setRowAxis(n),n.setBackgroundContainer(new t.Container(e.getCtx()))),i&&(i.addChild(n),e.getParent().addChildAt(n.getBackgroundContainer(),0)),n.render(e.Width-s.getRowAxisGap(),null==i);var r=n.getWidth(),o=r>0?r+s.getRowAxisGap():0;e._backgroundWidth-=o,a||(e._widthOffset+=o,e.setStartXOffset(e.getStartXOffset()+o)),e._canvasLength-=o;var h=n.getBackgroundContainer();h.removeChildren(),n.setBackgroundDivider();var l=new t.Rect(e.getCtx(),0,0,r+1,e._backgroundHeight);if(l.setClassName(e.GetStyleClass("databody")),l.setPixelHinting(!0),h.addChild(l),"alta"===e.getCtx().getThemeBehavior()||e.isHorizontalGridlinesVisible()){var d=new t.Line(e.getCtx(),0,0,r,0);d.setPixelHinting(!0),d.setClassName(e.GetStyleClass("hgridline"),!0),h.addChild(d),n.setBackgroundDivider(d)}}else i&&n&&(e.getParent().removeChild(n.getBackgroundContainer()),i.removeChild(n)),e.setRowAxis(null)},_renderBackground:e=>{var i=e._backgroundWidth,a=e._backgroundHeight;e._background?(e._background.setClipPath(null),e._background.setWidth(i),e._background.setHeight(a),e._background.setX(e._widthOffset)):e._background=new t.Rect(e.getCtx(),e._widthOffset,0,i,a,"bg"),e._background.setClassName(e.GetStyleClass("databody")),e._background.setPixelHinting(!0);var s=new t.ClipPath;s.addRect(e._widthOffset,0,i,a),e._background.setClipPath(s),e._background.getParent()!=e&&e.addChild(e._background)},_renderDatabodyBackground:(e,i,a)=>{var s=e.getDatabodyBackground();null==s&&(s=new t.Container(e.getCtx()),e.setDatabodyBackground(s),a||i.addChild(s)),a&&i.addChild(s),null==e.getDatabody()&&s.setTranslateY(e.scrollPositionToTranslateY(e.getOptions().scrollPosition));var n=new t.ClipPath;n.addRect(0,e.getDatabodyStart(),e.getContentLength(),e.getDatabodyHeight()),s.setClipPath(n)},_renderStickyRowBackgroundsContainer:(e,i)=>{const a=e.getDatabodyBackground();if(a){var s=e.getStickyRowBackgroundsContainer();null==s&&((s=new t.Container(e.getCtx())).setTranslateY(a.getTranslateY()),i.addChild(s),e.setStickyRowBackgroundsContainer(s));var n=new t.ClipPath;n.addRect(0,e.getDatabodyStart(),e.getContentLength(),e.getDatabodyHeight()),s.setClipPath(n)}},_renderRowReferenceObjectsContainer:(e,i,a)=>{var s=e.getRowReferenceObjectsContainer();null==s&&(s=new t.Container(e.getCtx()),a||i.addChild(s),e.setRowReferenceObjectsContainer(s)),a&&i.addChild(s),null==e.getDatabody()&&s.setTranslateY(e.getDatabodyBackground().getTranslateY());var n=new t.ClipPath;n.addRect(0,e.getDatabodyStart(),e.getContentLength(),e.getDatabodyHeight()),s.setClipPath(n)},_renderStickyRowReferenceObjectsContainer:(e,i)=>{const a=e.getRowReferenceObjectsContainer();if(a){var s=e.getStickyRowReferenceObjectsContainer();null==s&&((s=new t.Container(e.getCtx())).setTranslateY(a.getTranslateY()),i.addChild(s),e.setStickyRowReferenceObjectsContainer(s));var n=new t.ClipPath;n.addRect(0,e.getDatabodyStart(),e.getContentLength(),e.getDatabodyHeight()),s.setClipPath(n)}},_renderDnDArtifactsContainer:(e,i)=>{var a=e.getDatabody();if(a){var s=e.getDnDArtifactsContainer();null==s&&(s=new t.Container(e.getCtx()),e.setDnDArtifactsContainer(s),s.setTranslateY(a.getTranslateY())),i.addChild(s);var n=new t.ClipPath;n.addRect(0,e.getDatabodyStart(),e.getContentLength(),e.getDatabodyHeight()),s.setClipPath(n)}},_renderMarqueeArtifactsContainer:(e,i)=>{var a=e.getDatabody();if(a){var s=e.getMarqueeArtifactsContainer();null==s&&(s=new t.Container(e.getCtx()),e.setMarqueeArtifactsContainer(s),s.setTranslateY(a.getTranslateY())),i.addChild(s);var n=new t.ClipPath;n.addRect(0,e.getDatabodyStart(),e.getContentLength(),e.getDatabodyHeight()),s.setClipPath(n);var r=e.getEventManager();if("multiple"===e.getOptions().selectionMode){var o=new t.Rectangle(1,1,e.getContentLength()-1,e.getContentHeight()-1),h=new t.SolidFill(""),l=new t.Stroke(""),d=new t.MarqueeHandler(s,o,o,h,l,!0,!0);r.setMarqueeSelectHandler(d)}}},_renderScrollableCanvas:e=>{e._canvas||(e._canvas=new t.Container(e.getCtx(),"g","canvas"),e.addChild(e._canvas))},_renderAxes:(e,t,i)=>{var a=e.getMajorAxis(),s=e.getMinorAxis(),n=e.getAxisPosition(),r=e.getOptions(),o=e.getReferenceObjects(),h=e.isMinorAxisDrillable(),l=e.isMajorAxisDrillable();if("top"===n){var d=0;a&&(f._renderAxis(e,t,a,d,e.getAxisHeight(r,"majorAxis"),[],"major",l,i),d+=a.getSize()),s&&(f._renderAxis(e,t,s,d,e.getAxisHeight(r,"minorAxis"),o,"minor",h,i),d+=s.getSize()),e.setDatabodyStart(d)}else d=e._canvasSize,a&&(f._renderAxis(e,t,a,null,e.getAxisHeight(r,"majorAxis"),[],"major",l,i),d-=a.getSize(),f._positionAxis(a,d)),s&&(f._renderAxis(e,t,s,d,e.getAxisHeight(r,"minorAxis"),o,"minor",h,i),d-=s.getSize(),f._positionAxis(s,d)),e.setDatabodyStart(0)},_renderAxis:(e,t,i,a,s,n,r,o,h)=>{i.getParent()!==t&&t.addChild(i),i.render({_type:r,_viewStartTime:e._viewStartTime,_viewEndTime:e._viewEndTime,_referenceObjects:{referenceObjects:n,defaultStyleClass:e.GetStyleClass("referenceObjectLine"),defaultStroke:null},_throttle:h,_isDrillable:o,_parentComp:e},e.getContentLength(),s),null!=a&&f._positionAxis(i,a)},_positionAxis:(e,i)=>{var a=new t.Matrix(1,0,0,1,0,i);e.setMatrix(a)},_renderZoomControls:e=>{var i=e.getCtx(),a=e._resources,n=t.Agent.isRightToLeft(i),r={zoomInProps:{imageSize:16,class:a.zoomIn},zoomOutProps:{imageSize:16,class:a.zoomOut}};if(n)var o=e.getStartXOffset()+s._DEFAULT_ZOOM_CONTROL_PADDING;else o=e.getCanvasLength()+e.getStartXOffset()-(s._DEFAULT_ZOOM_CONTROL_PADDING+s._DEFAULT_ZOOM_CONTROL_DIAMETER);r.zoomInProps.posX=o,r.zoomOutProps.posX=o;var h=e._startY+s._DEFAULT_ZOOM_CONTROL_PADDING;if("top"===e.getAxisPosition())var l=h;else l=e._backgroundHeight-h;if("top"===e.getAxisPosition())var d=l,g=l+s._DEFAULT_ZOOM_CONTROL_DIAMETER+s._DEFAULT_ZOOM_CONTROL_SPACING;else d=l-2*s._DEFAULT_ZOOM_CONTROL_DIAMETER-s._DEFAULT_ZOOM_CONTROL_SPACING,g=l-s._DEFAULT_ZOOM_CONTROL_DIAMETER;r.zoomInProps.posY=d,r.zoomOutProps.posY=g,e.renderZoomControls(r)},_renderEmptyText:(e,i)=>{if(i){var a=e.getDatabody(),s=e.getDependenciesContainer();a&&a.getParent()&&(a.getParent().removeChild(a),e.setDatabody(null)),s&&s.getParent()&&(s.getParent().removeChild(s),e.setDependenciesContainer(null)),e.getDataLayoutManager().clear();var n=e.getOptions().translations.labelNoData;e.removeEmptyText()}else n=e.getOptions().translations.labelInvalidData,e.clearComponent();var r=e.getAxesHeight(),o=e.renderEmptyText(e._canvas,n,new t.Rectangle(e.getStartXOffset(),e.getStartYOffset()+r*("top"===e.getAxisPosition()),e.getCanvasLength(),e.getDatabodyHeight()),e.EventManager,null);o.setClassName(e.GetStyleClass("nodata")),e.setEmptyText(o)},_renderDatabody:(e,i,a)=>{var s=e.getDatabody();null==s&&(s=new t.Container(e.getCtx(),"g","db"),a||i.addChild(s),e.setDatabody(s),s.setTranslateY(e.getDatabodyBackground().getTranslateY())),a&&i.addChild(s);var n=new t.ClipPath;n.addRect(0,e.getDatabodyStart(),e.getContentLength(),e.getDatabodyHeight()),s.setClipPath(n)},_renderStickyRowsContainer:(e,i)=>{var a=e.getDatabody();if(a){var s=e.getStickyRowsContainer();null==s&&((s=new t.Container(e.getCtx())).setTranslateY(a.getTranslateY()),i.addChild(s),e.setStickyRowsContainer(s));var n=new t.ClipPath;n.addRect(0,e.getDatabodyStart(),e.getContentLength(),e.getDatabodyHeight()),s.setClipPath(n)}},_renderVerticalGridline:(e,i,s)=>{var n=e.getVerticalGridlines();if(null!=n&&n.removeChildren(),e.isVerticalGridlinesVisible()){null==n&&(n=new t.Container(e.getCtx()),s||i.addChild(n),e.setVerticalGridlines(n)),s&&i.addChild(n);const r=e.getStartTime(),o=e.getEndTime(),h=e.getContentLength(),l=(i,s,n)=>{var l=e.getCtx(),d=t.Agent.isRightToLeft(l);s.forEach((g,_)=>{let c=a.TimeAxisUtils.getDatePosition(r,o,g.getTime(),h);d&&(c=h-c),(!d&&0===_||d&&_===s.length-1)&&(c=Math.round(c)+.5);const u=new t.Line(l,c,e.getDatabodyStart(),c,e.getDatabodyStart()+e.getDatabodyHeight());u.setPixelHinting(!0),u.setMouseEnabled(!1),u.setClassName(n,!0),i.addChild(u)})},d=((t,i)=>{const a=i?i.getViewportDates(i.getScale(),r,o):[],s=t.getViewportDates(t.getScale(),r,o);if("alta"===e.getCtx().getThemeBehavior())return{major:a,minor:i?[]:s};const n=new Set(a.map(e=>e.getTime())),h=new Set(s.map(e=>e.getTime())),l=0===a.filter(e=>e.getTime()>r&&e.getTime()<o&&!h.has(e.getTime())).length;return{major:l?a:[],minor:l?s.filter(e=>!n.has(e.getTime())):s}})(e.getMinorAxis(),e.getMajorAxis());l(n,d.minor,e.GetStyleClass("minorvgridline")),l(n,d.major,e.GetStyleClass("majorvgridline"))}},_renderReferenceObjects:(e,i,a,s)=>{var n="line"===a?e.getReferenceLinesContainer():e.getReferenceAreasContainer();null==n&&(n=new t.Container(e.getCtx()),s||i.addChild(n),"line"===a?e.setReferenceLinesContainer(n):e.setReferenceAreasContainer(n)),n.removeChildren(),s&&i.addChild(n);var r=e=>null!=e&&!isNaN(new Date(e).getTime()),o=e.getReferenceObjects().filter(e=>"line"===a?("line"===e.type||null==e.type)&&r(e.value):"area"===e.type&&r(e.start)&&r(e.end));e.generateReferenceObjects(o,a).forEach(e=>e.render(n))},_renderTimeCursor:(e,i,a)=>{var s=e.getTimeCursorContainer();null==s&&(s=new t.Container(e.getCtx()),a||i.addChild(s),e.setTimeCursorContainer(s)),s.removeChildren(),a&&i.addChild(s);var n=new C(e,"timeCursor",[{type:"line",value:new Date(e.getStartTime()).toISOString()}]);n.render(s),n.setMouseEnabled(!1),n.hide(),e.setTimeCursor(n)},_renderStickyContainer:(e,t,i,a,s)=>{if(e.isStickyRowsEnabled())i(e,t);else{var n=a();n&&(n.getParent().removeChild(n),s(null))}},_renderData:(e,t,i,a)=>{var n=e.getOptions(),r=e.getRowLayoutObjs(),o=e.getDependencyLayoutObjs();if(0!==r.length){f._renderDatabody(e,t,a),f._renderStickyContainer(e,t,f._renderStickyRowsContainer,e.getStickyRowsContainer.bind(e),e.setStickyRowsContainer.bind(e)),o.length>0&&f._renderDependenciesContainer(e,t),e.getCache().getFromCache("baseTaskLabelCSSStyle")||e.getCache().putToCache("baseTaskLabelCSSStyle",s.getTaskLabelStyle(n)),e.setDataRegionTranslateY(e.getBoundedContentTranslateY(e.getDatabody().getTranslateY()));var h=!e.isInitialRender()&&e.isLastRenderValid()&&"none"!==e.getAnimationManager().getAnimationMode();e.renderViewport(h?b.VPC_ANIMATE:i,!0)}else f._renderEmptyText(e,!0)},_renderDependenciesContainer:(e,i)=>{var a=e.getDependenciesContainer();null==a&&((a=new t.Container(e.getCtx())).setTranslateY(e.getDatabody().getTranslateY()),i.addChild(a),e.setDependenciesContainer(a),f._prepareDependencyMarkers(e));var s=new t.ClipPath;s.addRect(0,e.getDatabodyStart(),e.getContentLength(),e.getDatabodyHeight()),a.setClipPath(s)},_prepareDependencyMarkers:e=>{if(!document.getElementById(s.getDependencyLineAngleMarkerId())){var t=f._createTriangleMarker(e),i=f._createAngleMarker(e),a=f._createOpenCircleMarker(e),n=f._createClosedCircleMarker(e);e.appendSharedDefs(t),e.appendSharedDefs(i),e.appendSharedDefs(a),e.appendSharedDefs(n)}},_createTriangleMarker:e=>{var t=s.getDependencyLineTriangleMarkerId(),i=s.getDependencyLineTriangleMarkerWidth(),a=s.getDependencyLineTriangleMarkerHeight(),n=e.GetStyleClass("dependencyLineConnector"),r="M0,0L"+i+","+a/2+",0,"+a+"V0Z";return f._createMarker(e,t,i,a,r,n)},_createAngleMarker:e=>{var t=s.getDependencyLineAngleMarkerId(),i=s.getDependencyLineAngleMarkerWidth(),a=s.getDependencyLineAngleMarkerHeight(),n=e.GetStyleClass("dependencyRectilinearLineArrowConnector"),r="M0,0L"+i+","+a/2+",0,"+a;return f._createMarker(e,t,i,a,r,n)},_createMarker:(e,i,a,s,n,r)=>{var o=e.GetStyleClass("dependencyLineConnector")+" "+r,h=t.SvgShapeUtils.createElement("marker",i);t.ToolkitUtils.setAttrNullNS(h,"class",o),t.ToolkitUtils.setAttrNullNS(h,"markerUnits","userSpaceOnUse");var l=t.SvgShapeUtils.createElement("path");return t.ToolkitUtils.setAttrNullNS(h,"viewBox","0 0 "+a+" "+s),t.ToolkitUtils.setAttrNullNS(h,"refX",a),t.ToolkitUtils.setAttrNullNS(h,"refY",s/2),t.ToolkitUtils.setAttrNullNS(h,"markerWidth",a),t.ToolkitUtils.setAttrNullNS(h,"markerHeight",s),t.ToolkitUtils.setAttrNullNS(h,"orient","auto"),t.ToolkitUtils.setAttrNullNS(l,"d",n),h.appendChild(l),h},_createOpenCircleMarker:e=>{var t=s.getDependencyLineOpenCircleMarkerId(),i=s.getDependencyLineCircleMarkerRadius(),a=e.GetStyleClass("dependencyStraightLineOpenCircleConnector");return f._createCircleMarker(e,t,i,a)},_createClosedCircleMarker:e=>{var t=s.getDependencyLineClosedCircleMarkerId(),i=s.getDependencyLineCircleMarkerRadius(),a=e.GetStyleClass("dependencyStraightLineClosedCircleConnector");return f._createCircleMarker(e,t,i,a)},_createCircleMarker:(e,i,a,s)=>{var n=e.GetStyleClass("dependencyLineConnector")+" "+s,r=t.SvgShapeUtils.createElement("marker",i);t.ToolkitUtils.setAttrNullNS(r,"class",n),t.ToolkitUtils.setAttrNullNS(r,"markerUnits","userSpaceOnUse");var o=t.SvgShapeUtils.createElement("circle"),h=2*a+2,l=2*a+2;return t.ToolkitUtils.setAttrNullNS(r,"viewBox","0 0 "+h+" "+l),t.ToolkitUtils.setAttrNullNS(r,"refX",h/2),t.ToolkitUtils.setAttrNullNS(r,"refY",l/2),t.ToolkitUtils.setAttrNullNS(r,"markerWidth",h),t.ToolkitUtils.setAttrNullNS(r,"markerHeight",l),t.ToolkitUtils.setAttrNullNS(r,"orient","auto"),t.ToolkitUtils.setAttrNullNS(o,"cx",h/2),t.ToolkitUtils.setAttrNullNS(o,"cy",l/2),t.ToolkitUtils.setAttrNullNS(o,"r",a),r.appendChild(o),r}};class k extends i.TimeComponent{constructor(e,t,i){super(e,t,i),this._isInitialRender=!0,this.Defaults=new D(e),this.EventManager=new d(this,e,t,i),this.EventManager.addListeners(this),this._keyboardHandler=new g(this,this.EventManager),this.EventManager.setKeyboardHandler(this._keyboardHandler)}SetOptions(e){null==e.taskDefaults&&(e.taskDefaults={baseline:{}}),null==e.taskDefaults.baseline&&(e.taskDefaults.baseline={}),null==e.taskDefaults.height&&(e.taskDefaults.height=s.getStandaloneTaskHeight(e)),null==e.taskDefaults.baseline.height&&(e.taskDefaults.baseline.height=s.getBaselineTaskHeight(e)),super.SetOptions(e),this.setSelectionMode(this.Options.selectionMode);var i=this.isTaskMoveEnabled(),a=this.isTaskResizeEnabled();if((i||a)&&t.Agent.getAgentInfo().isTouchSupported){this.Options.dnd=t.JsonUtils.merge(this.Options.dnd,{drag:{tasks:{dataTypes:[]},taskResizeHandles:{dataTypes:[]}},drop:{rows:{dataTypes:[]}}});var n=this,r=(e,t)=>{var i=n.Options.dnd.drag[t].dataTypes;Array.isArray(i)||(n.Options.dnd.drag[t].dataTypes=[i],i=n.Options.dnd.drag[t].dataTypes),i.push(e);var a=n.Options.dnd.drop.rows.dataTypes;Array.isArray(a)||(n.Options.dnd.drop.rows.dataTypes=[a],a=n.Options.dnd.drop.rows.dataTypes),a.push(e)};a&&r(d.RESIZE_TASKS_DATA_TYPE,"taskResizeHandles"),i&&r(d.MOVE_TASKS_DATA_TYPE,"tasks")}}getAutomation(){return this.Automation||(this.Automation=new S(this)),this.Automation}GetStyleClass(e){var t=this.getCtx().styleClasses;return null!=t?t[e]:e}Parse(e){return T(e)}_applyParsedProperties(e){this._axisPosition=e.axisPosition,this._selectionMode=e.selectionMode,this._horizontalGridline=e.horizontalGridline,this._verticalGridline=e.verticalGridline,this._viewStartTime=e.viewStart,this._viewEndTime=e.viewEnd,this._rowsData=e.rows,this.isIRAnimationEnabled=e.isIRAnimationEnabled,this.isDCAnimationEnabled=e.isDCAnimationEnabled,this._rowAxisRendered=e.rowAxisRendered,this._rowAxisWidth=e.rowAxisWidth,this._rowAxisMaxWidth=e.rowAxisMaxWidth,this._referenceObjects=e.referenceObjects,super._applyParsedProperties(e)}_bundleTimeAxisOptions(e,t){var i=this._resources;i.axisClass=this.GetStyleClass(t),i.axisSeparatorClass=this.GetStyleClass(t+"Ticks");var a,n={start:e.start,end:e.end,_resources:i,shortDesc:e.shortDesc,orientation:"horizontal"};if(e[t]){var r=e[t];r.scale&&(n.scale=r.scale),r.converter&&(n.converter=r.converter),n.zoomOrder=r.zoomOrder||[r.scale];"alta"===this.getCtx().getThemeBehavior()?(n._scaleLabelPosition={seconds:"center",minutes:"center",hours:"center",days:"center",weeks:"center",months:"center",quarters:"center",years:"center"},n._labelAlignment={horizontal:"middle",vertical:"middle"}):(n._scaleLabelPosition={seconds:"start",minutes:"start",hours:"start",days:"minorAxis"===t?"center":"start",weeks:"start",months:"start",quarters:"start",years:"start"},n._labelAlignment={horizontal:"top",vertical:"middle"}),n.zoomOrder.forEach(e=>{if(e&&e.name){const t=e.labelPosition||"auto",i="auto"===t?"start":t;n._scaleLabelPosition[e.name]=i}})}return"majorAxis"===t?a=s.getMajorAxisLabelStyle(e):"minorAxis"===t&&(a=s.getMinorAxisLabelStyle(e)),n.labelStyle=a,n}_getPreferredSize(e,i){return new t.Dimension(e,i)}render(e,t,i){this.getCache().clearCache();var s=this.getEventManager();if(s&&s.cancelMarquee(),this._prevStickyRowRegionHeight=null,e){if(super.render(e,t,i),this.isDndEnabled()){var n=this.getCtx();this.renderAriaLiveRegion("_dvtGanttAriaLiveRegion"+n.getStage().getId())}else this.removeAriaLiveRegion();this._animationManager=new v(this),this._animationManager.prepareForAnimations(),this._dataLayoutManager||(this._dataLayoutManager=new b(this)),this._dataLayoutManager.calcLayout(),f.renderRowAxis(this,this.getParent());var r,o,h=this.getAxisPosition(),l=e.majorAxis;if(l)if(l.scale){if(r=this._bundleTimeAxisOptions(this.Options,"majorAxis"),null==this._majorAxis){this._majorAxis=new a.TimeAxis(this.getCtx(),null,null);var d="alta"===this.getCtx().getThemeBehavior();"top"===h?this._majorAxis.setBorderVisibility(!1,!1,d,!1):this._majorAxis.setBorderVisibility(d,!1,!1,!1),this._slaveAxis=this._majorAxis}this._majorAxis.setCanvasSize(null);var g=this._majorAxis.getPreferredLength(r,this._canvasLength);o&&g>o&&(this._masterAxis=this._majorAxis,this._slaveAxis=this._minorAxis,o=g)}else this._majorAxis=null;if(e.minorAxis){if((r=this._bundleTimeAxisOptions(this.Options,"minorAxis"))._secondaryAxis=this._majorAxis,null==this._minorAxis){var _="alta"===this.getCtx().getThemeBehavior();this._minorAxis=new a.TimeAxis(this.getCtx(),null,null),"top"===h?this._minorAxis.setBorderVisibility(!1,!1,_,!1):this._minorAxis.setBorderVisibility(_,!1,!1,!1),this._masterAxis=this._minorAxis}this._minorAxis.setCanvasSize(null),o=this._minorAxis.getPreferredLength(r,this._canvasLength)}o&&this.setContentLength(o),this._minorAxis&&this._minorAxis.hasValidOptions()&&this.prepareViewportLength(),f.renderGantt(this),this._animationManager.triggerAnimations(),this._updateTimeAxisLabelFocus(),this.UpdateAriaAttributes(),this.Animation||this.RenderComplete(),this._renderState=null,this._isInitialRender=!1}else this._handleResize(t,i)}_updateTimeAxisLabelFocus(){var e=this.getEventManager();if(!e)return;const t=e.getFocus();if(!t||"timeAxisLabel"!==t.nodeType)return;const i=this.isMajorAxisDrillable()&&this._majorAxis,a=this.isMinorAxisDrillable()&&this._minorAxis,s=()=>{const t=e.getLastFocusedItem();if(t)return void e.setFocus(t);const i=e.getDefaultNavigable();i&&e.setFocus(i)};if(!i&&!a)return void s();const n=(t,i)=>{e.setFocus(t),i&&t.showKeyboardFocusEffect()},r=(e,t)=>{e._labels.length>0?n(e._labels[0],t):s()},o=t.getAxisType(),h=t.isShowingKeyboardFocusEffect(),l="major"===o,d=l?this._majorAxis:this._minorAxis;if(l?i:a){const e=t.identity(d);e?n(e,h):r(d,h)}else r(l?this._minorAxis:this._majorAxis,h)}getAnimationManager(){return this._animationManager}getDataLayoutManager(){return this._dataLayoutManager}isRowsHierarchical(){var e=this.getOptions(),i=e.rowData||e.taskData;return i&&i.getChildDataProvider||t.Agent.isEnvironmentTest()&&this.getOptions().expanded instanceof Set}getViewportYBounds(e){var t=Math.max(0,this._backgroundHeight-this.getAxesHeight()),i=0;return null!=e?i=this._translateYToScrollPositionY(e):this._databody&&(i=this._translateYToScrollPositionY(this._databody.getTranslateY())),{yMin:i,yMax:i+t}}getViewPort(){var e=this.getViewportYBounds(),t=this._dataLayoutManager.findRowIndRange(this.getRowLayoutObjs(),e.yMin,e.yMax);return{minRowInd:t.minRowInd,maxRowInd:t.maxRowInd,viewStartTime:this._viewStartTime,viewEndTime:this._viewEndTime}}getViewportDensity(){if(void 0!==this._viewportDensity)return this._viewportDensity;var e=this._dataLayoutManager.getNumViewportTasks();return this._viewportDensity=e<2e3?0:e<5e3?1:2,this._viewportDensity}getRenderingPrecision(){if(void 0!==this._renderingPrecision)return this._renderingPrecision;var e=this.getViewportDensity();return this._renderingPrecision=0===e?null:1===e?1:0,this._renderingPrecision}round(e,t){return Math.round(e*10**t)/10**t}renderViewport(e,i){if(null!=this._databody){this._viewportDensity=void 0,this._renderingPrecision=void 0;var a=this.getViewPort();if(this._dataLayoutManager.renderViewport(a,e),this.isStickyRowsEnabled()&&(this.isRowAxisEnabled()&&this.getRowAxis().updateStickyRowsVisibility(a),this.updateStickyRowsVisibility(a)),i){var s=this._translateYToScrollPositionY(this._databody.getTranslateY()),n=s-this.getRowLayoutObjs()[a.minRowInd].unstickyY,r=t.EventFactory.newGanttScrollPositionChangeEvent(s,a.minRowInd,n);this.dispatchEvent(r)}}}isInitialRender(){return this._isInitialRender}isLastRenderValid(){return this._isLastRenderValid}setIsLastRenderValid(e){this._isLastRenderValid=e}getRenderState(){return this._renderState}setRenderState(e){this._renderState=e}isDndEnabled(){const e=this.isHighLevelDnDEnabled();return this.getEventManager().isDndSupported()&&e}isHighLevelDnDEnabled(){const e=this.isTaskMoveEnabled(),t=this.isTaskResizeEnabled();return e||t}isTaskMoveEnabled(){var e=this.Options.dnd;return e&&e.move&&"enabled"===e.move.tasks}isTaskResizeEnabled(){var e=this.Options.taskDefaults;return e&&"enabled"===e.resizable}isStickyRowsEnabled(){const e=this.getDataLayoutManager().getDependencyObjs();return"sticky"===this.getOptions().parentRowPosition&&0===e.length}scroll(e){if(this.getDatabody()){var t=this.scrollPositionToTranslateY(e);this.isContentDirScrollbarOn()&&this.contentDirScrollbar&&this.contentDirScrollbar.setViewportRange(t-this.getDatabodyHeight(),t),this.setDataRegionTranslateY(t),this.renderViewport(b.VPC_TRANSLATE,!0)}}scrollPositionToTranslateY(e){var t=e.rowIndex,i=this.getRowLayoutObjs(),a=0;if(null!=t){var s=i[t=Math.min(Math.max(0,t),i.length-1)];if(null!=s){var n=null!=e.offsetY?e.offsetY:0;a=s.unstickyY+n}}else null!=e.y&&(a=e.y);return this._scrollPositionYToTranslateY(a)}_scrollPositionYToTranslateY(e){return this.getBoundedContentTranslateY(this.getDatabodyStart()-e)}_translateYToScrollPositionY(e){return this._databody?-(e-this.getDatabodyStart()):0}setDataRegionTranslateY(e){this._databody&&this._databody.setTranslateY(e),this._stickyRowsContainer&&this._stickyRowsContainer.setTranslateY(e),this._databodyBackground&&this._databodyBackground.setTranslateY(e),this._stickyRowBackgroundsContainer&&this._stickyRowBackgroundsContainer.setTranslateY(e),this._rowReferenceObjectsContainer&&this._rowReferenceObjectsContainer.setTranslateY(e),this._stickyRowReferenceObjectsContainer&&this._stickyRowReferenceObjectsContainer.setTranslateY(e),this.isMarqueeSelectEnabled()&&this._marqueeArtifactsContainer&&this._marqueeArtifactsContainer.setTranslateY(e),this.isDndEnabled()&&this._dndArtifactsContainer&&this._dndArtifactsContainer.setTranslateY(e),this.isRowAxisEnabled()&&this.getRowAxis().setY(e+this.getStartYOffset()),this._dependenciesContainer&&this._dependenciesContainer.setTranslateY(e)}processScrollbarEvent(e,t){if(super.processScrollbarEvent(e,t),t===this.timeDirScrollbar&&f._renderAxes(this,this.getTimeZoomCanvas(),!0),t===this.contentDirScrollbar){var i=e.newMax;this.setDataRegionTranslateY(i,!0)}this.renderViewport(b.VPC_TRANSLATE,t===this.contentDirScrollbar)}createViewportChangeEvent(){var e=this._majorAxis?this._majorAxis.getScale():null,i=this._minorAxis?this._minorAxis.getScale():null;return t.EventFactory.newGanttViewportChangeEvent(this._viewStartTime,this._viewEndTime,e,i)}_handleResize(e,t){this.Width=e,this.Height=t,this.applyStyleValues();var i=this.hasValidOptions(!1);if(i&&f.renderRowAxis(this),this.prepareViewportLength(),f._renderBackground(this),i){this.renderTimeZoomCanvas(this._canvas),this.isRowAxisEnabled()&&this.getRowAxis().adjustPosition();var a=this.getTimeZoomCanvas();f._renderAxes(this,a),f._renderDatabodyBackground(this),f._renderStickyContainer(this,null,f._renderStickyRowBackgroundsContainer,this.getStickyRowBackgroundsContainer.bind(this),this.setStickyRowBackgroundsContainer.bind(this)),f._renderRowReferenceObjectsContainer(this),f._renderStickyContainer(this,null,f._renderStickyRowReferenceObjectsContainer,this.getStickyRowReferenceObjectsContainer.bind(this),this.setStickyRowReferenceObjectsContainer.bind(this)),f._renderReferenceObjects(this,a,"area"),f._renderVerticalGridline(this,a),f._renderData(this,null,b.VPC_SCALE),f._renderReferenceObjects(this,a,"line"),f._renderTimeCursor(this,a),f._renderZoomControls(this),this.isMarqueeSelectEnabled()&&f._renderMarqueeArtifactsContainer(this,a),this.isDndEnabled()&&f._renderDnDArtifactsContainer(this,a),(this.isTimeDirScrollbarOn()||this.isContentDirScrollbarOn())&&f._renderScrollbars(this,this)}else f._renderEmptyText(this);f.renderRowAxisVerticalDivider(this,this._canvas),this.Animation||this.RenderComplete()}applyStyleValues(){var e=t.Agent.isRightToLeft(this.getCtx()),i=this.getScrollbarPadding();this._borderWidth=s.getChartStrokeWidth(this.Options);var a=2*this._borderWidth;if(this._widthOffset=0,this.timeDirScrollbarStyles=this.getTimeDirScrollbarStyle(),this.contentDirScrollbarStyles=this.getContentDirScrollbarStyle(),this._backgroundWidth=this.Width,this._backgroundHeight=this.Height,this.isTimeDirScrollbarOn()&&(this._backgroundHeight=Math.max(0,this._backgroundHeight-t.CSSStyle.toNumber(this.timeDirScrollbarStyles.getHeight())-3*i)),this.isContentDirScrollbarOn()){var n=3*i+t.CSSStyle.toNumber(this.contentDirScrollbarStyles.getWidth());this._backgroundWidth-=n,e&&(this._widthOffset=n)}this.setStartXOffset(this._widthOffset+this._borderWidth),this.setStartYOffset(this._borderWidth);var r=s.getComponentPaddingStart(this.Options);this._backgroundWidth-=r,e||(this._widthOffset+=r,this.setStartXOffset(this.getStartXOffset()+r)),this._canvasLength=this._backgroundWidth-a,this._canvasSize=Math.max(0,this._backgroundHeight-a)}getBorderWidth(){return this._borderWidth}HandleMouseWheel(e){if(super.HandleMouseWheel(e),this.hasValidOptions(!1))if(!e||e.ctrlKey||t.Agent.isTouchDevice()){if(e.zoomWheelDelta){var a=this.getCtx().pageToStageCoords(e.pageX,e.pageY);if(this.getGraphicalAreaBounds().containsPoint(a.x,a.y)){var s=this.getContentLength()*e.zoomWheelDelta,n=e.zoomTime,r=e.zoomCompLoc;this.handleZoomWheel(s,n,r,!0)}}}else{var o=e.wheelDelta?e.wheelDelta*i.TimeComponent.SCROLL_LINE_HEIGHT:0,h=e.wheelDeltaX?e.wheelDeltaX*i.TimeComponent.SCROLL_LINE_HEIGHT:0;if(this.panBy(-h,-o),e.wheelDeltaX){var l=this.createViewportChangeEvent();this.dispatchEvent(l)}}}handleZoomWheel(e,t,i,a){if(this.isZoomingEnabled()){this._prevStickyRowRegionHeight=null,e>this._masterAxis.getMaxContentLength()?(e=this._masterAxis.getMaxContentLength(),this.disableZoomButton(!0)):this.enableZoomButton(!0),this._canvasLength>e?(e=this._canvasLength,this.disableZoomButton(!1)):this.enableZoomButton(!1);var s=this.getContentLength()<=e;super.handleZoomWheel(e,t,i,a);var n=this._masterAxis.getZoomLevelLengths();if(s)for(;this._masterAxis.getZoomLevelOrder()>0&&(!this._slaveAxis||this._slaveAxis.getZoomLevelOrder()>0);){var r=n[this._masterAxis.getZoomLevelOrder()-1];if(!(this.getContentLength()>=r))break;this._masterAxis.setZoomLevelOrder(this._masterAxis.getZoomLevelOrder()-1),this._masterAxis.decreaseScale(),this._slaveAxis&&(this._slaveAxis.setZoomLevelOrder(this._slaveAxis.getZoomLevelOrder()-1),this._slaveAxis.decreaseScale())}else for(;this._masterAxis.getZoomLevelOrder()<n.length-1&&(!this._slaveAxis||this._slaveAxis.getZoomLevelOrder()<this._slaveAxis.getZoomLevelLengths().length-1)&&(r=n[this._masterAxis.getZoomLevelOrder()],this.getContentLength()<r);)this._masterAxis.setZoomLevelOrder(this._masterAxis.getZoomLevelOrder()+1),this._masterAxis.increaseScale(),this._slaveAxis&&(this._slaveAxis.setZoomLevelOrder(this._slaveAxis.getZoomLevelOrder()+1),this._slaveAxis.increaseScale());this.isTimeDirScrollbarOn()&&this.timeDirScrollbar&&this.timeDirScrollbar.setViewportRange(this._viewStartTime,this._viewEndTime);var o=this.getTimeZoomCanvas();if(f._renderAxes(this,o,!0),f._renderDatabodyBackground(this),f._renderStickyContainer(this,null,f._renderStickyRowBackgroundsContainer,this.getStickyRowBackgroundsContainer.bind(this),this.setStickyRowBackgroundsContainer.bind(this)),f._renderRowReferenceObjectsContainer(this),f._renderStickyContainer(this,null,f._renderStickyRowReferenceObjectsContainer,this.getStickyRowReferenceObjectsContainer.bind(this),this.setStickyRowReferenceObjectsContainer.bind(this)),f._renderReferenceObjects(this,o,"area"),f._renderVerticalGridline(this,o),f._renderData(this,null,b.VPC_SCALE),f._renderReferenceObjects(this,o,"line"),f._renderTimeCursor(this,o),this.isMarqueeSelectEnabled()&&f._renderMarqueeArtifactsContainer(this,o),this.isDndEnabled()&&f._renderDnDArtifactsContainer(this,o),a){var h=this.createViewportChangeEvent();this.dispatchEvent(h)}}}getMajorAxis(){return this._majorAxis}getMinorAxis(){return this._minorAxis}getTimeAxis(){return this._minorAxis?this._minorAxis:this._majorAxis}getDatabody(){return this._databody}setDatabody(e){this._databody=e}dimDatabody(){this._databody&&!this._isDatabodyDimmed&&t.ToolkitUtils.addClassName(this._databody.getElem(),this.GetStyleClass("databodyDim")),this._stickyRowsContainer&&!this._isDatabodyDimmed&&t.ToolkitUtils.addClassName(this._stickyRowsContainer.getElem(),this.GetStyleClass("databodyDim")),this._isDatabodyDimmed=!0}undimDatabody(){this._databody&&this._isDatabodyDimmed&&t.ToolkitUtils.removeClassName(this._databody.getElem(),this.GetStyleClass("databodyDim")),this._stickyRowsContainer&&this._isDatabodyDimmed&&t.ToolkitUtils.removeClassName(this._stickyRowsContainer.getElem(),this.GetStyleClass("databodyDim")),this._isDatabodyDimmed=!1}getDatabodyBackground(){return this._databodyBackground}setDatabodyBackground(e){this._databodyBackground=e}getStickyRowBackgroundsContainer(){return this._stickyRowBackgroundsContainer}setStickyRowBackgroundsContainer(e){this._stickyRowBackgroundsContainer=e}getDatabodyStart(){return this._databodyStart}setDatabodyStart(e){this._databodyStart=e}getDatabodyHeight(){return Math.max(0,this.getCanvasSize()-this.getAxesHeight())}getStickyRowsContainer(){return this._stickyRowsContainer}setStickyRowsContainer(e){this._stickyRowsContainer=e}getVerticalGridlines(){return this._gridlines}setVerticalGridlines(e){this._gridlines=e}getReferenceObjects(){return this._referenceObjects||[]}generateReferenceObjects(e,t){const i=[];let a=0,s=0;for(;s<e.length;){var n=e[s];(n.svgStyle||n.svgClassName||n.shortDesc)&&(s>a&&i.push(new C(this,t,e.slice(a,s))),i.push(new C(this,t,[e[s]])),a=s+1),s+=1}return s>a&&i.push(new C(this,t,e.slice(a,s))),i}getReferenceLinesContainer(){return this._refLinesContainer}setReferenceLinesContainer(e){this._refLinesContainer=e}getReferenceAreasContainer(){return this._refAreasContainer}setReferenceAreasContainer(e){this._refAreasContainer=e}getTimeCursorContainer(){return this._timeCursorContainer}setTimeCursorContainer(e){this._timeCursorContainer=e}getTimeCursor(){return this._timeCursor}setTimeCursor(e){this._timeCursor=e}getMarqueeArtifactsContainer(){return this._marqueeArtifactsContainer}setMarqueeArtifactsContainer(e){this._marqueeArtifactsContainer=e}getDnDArtifactsContainer(){return this._dndArtifactsContainer}setDnDArtifactsContainer(e){this._dndArtifactsContainer=e}getRowReferenceObjectsContainer(){return this._rowReferenceObjectsContainer}setRowReferenceObjectsContainer(e){this._rowReferenceObjectsContainer=e}getStickyRowReferenceObjectsContainer(){return this._stickyRowReferenceObjectsContainer}setStickyRowReferenceObjectsContainer(e){this._stickyRowReferenceObjectsContainer=e}setEmptyText(e){this._emptyText=e}removeEmptyText(){if(this._emptyText&&this._emptyText.getParent()){this._emptyText.getParent().removeChild(this._emptyText),delete this._emptyText,this._emptyText=null;let e=this.getEventManager(),t=e.getFocus();t&&t.getId&&"noDataPeer"===t.getId()&&e.setFocus(null)}}getRowsData(){return this._rowsData}getRowLayoutObjs(){return this._dataLayoutManager.getRowObjs()}getDependencyLayoutObjs(){return this._dataLayoutManager.getDependencyObjs()}setRows(e){this._rows=e}getAxisPosition(){return this._axisPosition}getAxisHeight(e,t){return s.getTimeAxisHeight(e,t)}getStartTime(){return this._start}getEndTime(){return this._end}getHoverBehavior(){return"none"}isHorizontalGridlinesVisible(){return"visible"===this._horizontalGridline}isVerticalGridlinesVisible(){return"visible"===this._verticalGridline}getContentHeight(){return this._dataLayoutManager.getContentHeight()}getAxesHeight(){var e=0;return this._majorAxis&&(e+=this._majorAxis.getSize()),this._minorAxis&&(e+=this._minorAxis.getSize()),e}getDrillableAxisAbove(e){if(e)if("top"===this._axisPosition){if(e===this._majorAxis)return;if(this.isMajorAxisDrillable())return this._majorAxis}else{if(e===this._minorAxis)return;if(this.isMinorAxisDrillable())return this._minorAxis}}getDrillableAxisBelow(e){if(e)if("top"===this._axisPosition){if(e===this._minorAxis)return;if(this.isMinorAxisDrillable())return this._minorAxis}else{if(e===this._majorAxis)return;if(this.isMajorAxisDrillable())return this._majorAxis}}isMinorAxisDrillable(){return"on"===this.getOptions().minorAxis.drillable}isMajorAxisDrillable(){return"on"===this.getOptions().majorAxis.drillable}isRowAxisEnabled(){var e="on"===this._rowAxisRendered,t=this.getRowLayoutObjs().length>0;return e&&t}getRowAxisWidth(){return this._rowAxisWidth}getRowAxisMaxWidth(){return this._rowAxisMaxWidth}getRowAxis(){return this._rowAxis}setRowAxis(e){this._rowAxis=e}getStickyRowRegionHeight(e){const t=this.getDataLayoutManager().getStickyRowObj();if(t){const i=this.isHorizontalGridlinesVisible()?s.getHorizontalGridlineWidth(this.getOptions()):0,a=this.getRowLayoutObjs(),{yMin:n}=this.getViewportYBounds(),r=t.height+i;let o=0;for(let i=t.index+1;i<=e.maxRowInd;i++){const e=a[i];if(!(e&&e.unstickyY-n<r))break;if(e.isStickyCandidate&&e!==t){o=r-Math.max(0,e.unstickyY-n);break}}return{height:t.height+i-o,isNextStickyOverlapping:0!==o}}return{height:0,isNextStickyOverlapping:!1}}updateStickyRowsVisibility(e){const{height:i}=this.getStickyRowRegionHeight(e),a=this.isHorizontalGridlinesVisible()?s.getHorizontalGridlineWidth(this.getOptions()):0,n=this.getDatabodyStart(),r=this.getContentLength(),o=this.getDatabodyHeight();if(i!==this._prevStickyRowRegionHeight){const e=[this.getDatabodyBackground(),this.getRowReferenceObjectsContainer(),this.getDatabody()],s=[this.getStickyRowBackgroundsContainer(),this.getStickyRowReferenceObjectsContainer(),this.getStickyRowsContainer()];for(let s=0;s<e.length;s++){const l=e[s];if(l){var h=new t.ClipPath;h.addRect(0,n+i-a,r,o),l.setClipPath(h)}}for(let e=0;e<s.length;e++){const a=s[e];if(a){var l=new t.ClipPath;l.addRect(0,n,r,i),a.setClipPath(l)}}}this._prevStickyRowRegionHeight=i}getViewportDimensions(e){var i=e?this.getStickyRowRegionHeight(this.getViewPort()).height:0;return new t.Rectangle(this.getStartXOffset()-this.getTimeZoomCanvas().getTranslateX(),this._databodyStart-this._databody.getTranslateY()+i,this._canvasLength,this.getDatabodyHeight()-i)}scrollIntoView(e,i,a,s,n){var r=t.Agent.isRightToLeft(this.getCtx()),o=this.getViewportDimensions(n),h=0,l=0;i=i||"auto",a=a||"auto",s=s||0;var d=Math.min(e.x-o.x-s,0),g=Math.max(0,e.x+e.w-(o.x+o.w)+s),_=r?g:d,c=r?d:g;switch(i){case"start":h=_;break;case"end":h=c;break;default:h=(r?c<0:c>0)?c:_}var u=Math.min(e.y-o.y-s,0),p=Math.max(0,e.y+e.h-(o.y+o.h)+s);switch(a){case"top":l=u;break;case"bottom":l=p;break;default:l=u<0?u:p}this.panBy(h,l,!0,!0)}scrollTimeIntervalIntoView(e,i,s,n,r){t.Agent.isRightToLeft(this.getCtx());const o=this.getStartTime(),h=this.getEndTime(),l=this.getContentLength(),d=a.TimeAxisUtils.getDatePosition(o,h,e,l),g=a.TimeAxisUtils.getDatePosition(o,h,i,l)-d;this.scrollPosIntervalIntoView(d,g,s,n,r)}scrollPosIntervalIntoView(e,i,a,s,n){const r=t.Agent.isRightToLeft(this.getCtx()),o=this.getContentLength(),h=this.getViewportDimensions(),l=new t.Rectangle(r?o-(e+i):e,h.y,i,h.h);this.scrollIntoView(l,a,s,n)}autoPanOnEdgeDrag(e,t,i,a,s){var n=this.getViewportDimensions(s),r=0,o=0;if(!i){var h=Math.max(e.x-n.x,0),l=Math.max(n.x+n.w-e.x,0);h<t?(r=h-t,r=Math.max(r,-n.x)):l<t&&(r=t-l,r=Math.min(r,this.getContentLength()-(n.x+n.w)))}if(!a){var d=Math.max(e.y-n.y,0),g=Math.max(n.y+n.h-e.y,0);d<t?(o=d-t,o=Math.max(o,-n.y)):g<t&&(o=t-g,o=this.getContentHeight()+this._databodyStart>=this._canvasSize?"bottom"===this.getAxisPosition()?Math.min(o,this._databody.getTranslateY()+this.getContentHeight()-n.h):Math.min(o,this._databody.getTranslateY()+this.getContentHeight()-this._canvasSize):Math.min(o,-n.y))}return this.panBy(r,o,!0),{deltaX:r,deltaY:o}}panBy(e,t,i,a){if(0!==e||0!==t){i=void 0!==i?i:"alta"!==this.getCtx().getThemeBehavior();var s=0!==e&&(i||Math.abs(e)>Math.abs(t)),n=this._databody&&0!==t&&(i||Math.abs(t)>Math.abs(e));if(s&&super.panBy(e,0),n){var r=this.getBoundedContentTranslateY(this._databody.getTranslateY()-t);this.isContentDirScrollbarOn()&&this.contentDirScrollbar.setViewportRange(r-this.getDatabodyHeight(),r),this.setDataRegionTranslateY(r,!0)}this.isTimeDirScrollbarOn()&&this.timeDirScrollbar&&this.timeDirScrollbar.setViewportRange(this._viewStartTime,this._viewEndTime),this.renderViewport(b.VPC_TRANSLATE,n),s&&f._renderAxes(this,this.getTimeZoomCanvas(),!a)}}getBoundedContentTranslateY(e){var t=this.getContentHeight();if(null==t)return e;var i=this.getDatabodyHeight(),a=this.getDatabodyStart(),s=a+Math.min(0,i-t);return Math.min(a,Math.max(e,s))}beginDragPan(e,t){super.beginDragPan(e,t),this._currentViewStartTime=this._viewStartTime,this._currentViewEndTime=this._viewEndTime}endDragPan(e,t){this._currentViewStartTime===this._viewStartTime&&this._currentViewEndTime===this._viewEndTime&&(this._triggerViewportChange=!1),super.endDragPan(e,t)}setTaskBrightness(e,t){null!=(e=this.findTaskNodeById(e.getId()))&&(t?e.darken():e.brighten())}findTaskNodeById(e){var i=this.getCtx(),a=this.getRows();if(a)for(var s=0;s<a.length;s++)for(var n=a[s].getTasks(),r=0;r<n.length;r++)if(t.Obj.compareValues(i,e,n[r].getId()))return n[r];return null}hasValidOptions(e){var t=!this._majorAxis||this._majorAxis.hasValidOptions(),i=this._minorAxis&&this._minorAxis.hasValidOptions(),a=this._start&&this._end&&this._end>this._start,s=!this._viewStartTime||!this._viewEndTime||this._viewEndTime>this._viewStartTime,n=!this._viewStartTime||this._viewStartTime>=this._start&&this._viewStartTime<this._end,r=!this._viewEndTime||this._viewEndTime>this._start&&this._viewEndTime<=this._end,o=e?this._isValidTasks():this._hasValidTasks;return this._hasValidTasks=o,t&&i&&a&&s&&n&&r&&o}_isValidTask(e){const t=(e,t)=>null==e||null==t||t>=e;return!(null==e.startTime&&null==e.endTime||!t(e.startTime,e.endTime))&&(!!t(e.baselineStartTime,e.baselineEndTime)&&(!!t(e.downtimeStartTime,e.downtimeEndTime)&&!!t(e.overtimeStartTime,e.overtimeEndTime)))}_isValidTasks(){const e=this.getRowLayoutObjs();for(let t=0;t<e.length;t++){const i=e[t].taskObjs;for(let e=0;e<i.length;e++){const t=i[e];if(!this._isValidTask(t))return!1}}return!0}getSelectionHandler(){return this._selectionHandler}isSelectionSupported(){return!!this._selectionHandler}setSelectionMode(e){this._selectionHandler="single"===e?new t.SelectionHandler(this.getCtx(),t.SelectionHandler.TYPE_SINGLE):"multiple"===e?new t.SelectionHandler(this.getCtx(),t.SelectionHandler.TYPE_MULTIPLE):null,this.getEventManager().setSelectionHandler(this._selectionHandler)}select(e){this.isLastRenderValid()&&(this.Options.selection=t.JsonUtils.clone(e),this._processInitialSelections())}_processInitialSelections(){var e=this.Options.selection;if(null!=e&&0!==e.length&&this.isSelectionSupported()){for(var t=new this._context.KeySetImpl(e),i=this.getRowLayoutObjs(),a=[],s=0;s<i.length;s++)for(var n=i[s].taskObjs,r=0;r<n.length;r++){var o=n[r];if(t.has(o.id)){this._dataLayoutManager.ensureInDOM(o,"task");var h=o.node;a.push(h)}}this.getSelectionHandler().processInitialSelections(e,a)}}getDependenciesContainer(){return this._dependenciesContainer}setDependenciesContainer(e){this._dependenciesContainer=e}setDefaultMarkerId(e){this._markerId=e}getDefaultMarkerId(){return this._markerId}getNavigableDependencyLinesForTask(e,t){return"successor"===t?e.getSuccessorDependencies():e.getPredecessorDependencies()}HandleTouchStart(e){}}e.Gantt=k,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ojgantt-toolkit.js.map