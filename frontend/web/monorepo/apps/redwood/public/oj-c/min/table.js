define("oj-c/table/hooks/UNSAFE_useWhenReadyContext/useWhenReadyContext",["require","exports","preact/hooks","ojs/ojcontext"],(function(require,e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useWhenReadyContext=function(e){const a=(0,t.useCallback)((t=>e.current?r.getContext(e.current).getBusyContext().whenReady(t):Promise.resolve()),[e]);return(0,t.useMemo)((()=>({whenReady:a})),[a])}})),define("oj-c/hooks/UNSAFE_useListData/useListData",["require","exports","ojs/ojabortreason","ojs/ojdataproviderfactory","preact/hooks"],(function(require,e,t,r,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getEmptyState=e.useListData=void 0;const n=Object.freeze({status:"loading",data:null}),o={isInitialFetchDeferred:!1};e.useListData=(r,c=o)=>{const d=(0,a.useRef)(null),u=(0,a.useRef)(0),h=(0,a.useRef)(!1),m=(0,a.useRef)(null),p=(0,a.useRef)(null),g=c.fetchSize&&c.fetchSize>0?c.fetchSize:25,C=(0,a.useMemo)((()=>s(r)),[r]),[R,v]=(0,a.useReducer)(l,0===c.initialRowsFetched?(0,e.getEmptyState)("atLeast"):n),k=(0,a.useCallback)((async(e,t)=>{if(null==C)return;const r={attributes:c.attributes,sortCriteria:c.sortCriteria,filterCriterion:c.filterCriterion,offset:e.offset,size:e.count},a=!0===h.current?"exact":"atLeast";if(0!==e.count)try{const n=(await C.fetchByOffset(r)).results;t&&t(n),v({status:"success",data:{offset:e.offset,data:n,totalSize:u.current,sizePrecision:a}})}catch(e){v({status:"error",error:e})}else v({status:"success",data:{offset:e.offset,data:[],totalSize:u.current,sizePrecision:a}})}),[C,c.attributes,c.filterCriterion,c.sortCriteria]),w=(0,a.useCallback)((async()=>{if(null==C)return;"loading"===R.status&&p.current?.abort((0,t.getAbortReason)()),v({status:"loading",data:null});const e=new AbortController;p.current=e;const r=C.fetchFirst({attributes:c.attributes,sortCriteria:c.sortCriteria,filterCriterion:c.filterCriterion,size:g,signal:e.signal})[Symbol.asyncIterator]();m.current=r;try{const e=await r.next();if(r!==m.current)return;const t=e.value.fetchParameters;if(t.signal&&t.signal.aborted)return;u.current=e.value.data.length,void 0!==e.done&&(h.current=e.done);const a=c.initialRowsFetched&&c.initialRowsFetched>0?c.initialRowsFetched:g;k({offset:0,count:Math.min(u.current,a)})}catch(e){if(e instanceof DOMException&&"AbortError"===e.name)return;v({status:"error",error:e}),m.current=null}}),[C,k,g,c.attributes,c.filterCriterion,c.initialRowsFetched,c.sortCriteria,c.fetchSize]),j=(0,a.useCallback)((async e=>{if(null===m.current)w();else{const t=e.offset+e.count;if(t>u.current){if(null==d.current){const r=i(m,u.current,t);d.current=r;try{const t=await r;void 0!==t.done&&(h.current=t.done);const a=t.total;(a>0||0===a&&h.current)&&(u.current=a,k({offset:e.offset,count:Math.min(u.current-e.offset,e.count)})),d.current=null}catch(e){v({status:"error",error:e}),d.current=null}}}else k(e)}}),[w,k]),S=(0,a.useCallback)((()=>{m.current=null,d.current=null,u.current=0,h.current=!1,0===c.initialRowsFetched?v((0,e.getEmptyState)("atLeast")):c.isInitialFetchDeferred?v({status:"loading",data:null}):w()}),[w,c.isInitialFetchDeferred,c.initialRowsFetched]);(0,a.useEffect)((()=>{C&&S()}),[C,S]);const x=(0,a.useCallback)((e=>{if("success"===R.status&&R.data){const t=R.data;let r,a=t.data.length,n=!1;if(e.detail.add){const r=f(e.detail.add,t,c,!0);u.current=u.current+r,a+=r,n=r>0||"exact"===t.sizePrecision,r<e.detail.add.data.length&&(h.current=!1)}if(e.detail.remove){const r=f(e.detail.remove,t,c,!1);u.current=Math.max(0,u.current-r),a=Math.max(0,a-r),n=n||r>0}const o=e.detail.update;o&&(n=n||b(o,t,c),r=e=>{y(o,t,e)}),n&&k({offset:t.offset,count:a},r)}}),[R,c,k]),T=(0,a.useCallback)((e=>{let t=-1;const r=e.detail?.disregardAfterKey;if(r&&"success"===R.status){const e=R.data.data.findIndex((e=>e.metadata.key===r));if(e>-1&&(t=R.data.data.length-e-1),0===t&&R.data.data.length>=g)return}t>-1&&"success"===R.status?(u.current=u.current-t,j({offset:R.data.offset,count:Math.max(R.data.data.length,g)})):("loading"===R.status&&p.current?.abort(),S())}),[R,g,j,S]);if((0,a.useEffect)((()=>(C&&(C.addEventListener("refresh",T),C.addEventListener("mutate",x)),()=>{C&&(C.removeEventListener("refresh",T),C.removeEventListener("mutate",x))})),[C,S,x,T]),!r){return[(0,e.getEmptyState)("exact"),e=>Promise.resolve()]}return[R,j]};const s=e=>{if(null==e)return null;return(0,r.getEnhancedDataProvider)(e,{fetchFirst:{caching:"visitedByCurrentIterator",forceLocalCaching:"enabled"}})},l=(e,t)=>e.status===t.status&&"loading"===t.status?e:t,i=async(e,t,r)=>await c(e,t,r),c=async(e,t,r)=>{const a=e.current;if(null===a)return{total:-1,done:void 0};const n=await a.next();return a===e.current?(t+=n.value.data.length)>=r||n.done?{total:t,done:n.done}:c(e,t,r):{total:-1,done:void 0}};e.getEmptyState=e=>"atLeast"===e?d:u;const d=Object.freeze({status:"success",data:{offset:0,data:[],totalSize:0,sizePrecision:"atLeast"}}),u=Object.freeze({status:"success",data:{offset:0,data:[],totalSize:0,sizePrecision:"exact"}}),f=(e,t,r,a)=>{let n=0;if(h(e,r)){const r=a?e.indexes?.sort(((e,t)=>e-t)):e.indexes;let o=t.totalSize-1;r?.forEach((e=>{e<=o&&(n=n+=1,a&&(o=o+=1))}))}else if(a);else{const r=t.data.map((e=>e.metadata.key));e.keys.forEach((e=>{r.includes(e)&&(n+=1)}))}return n},b=(e,t,r)=>{if(h(e,r)){const r=e.indexes?e.indexes:[],a=t.offset,n=a+t.data.length;for(let e=0;e<r.length;e++)if(r[e]>=a&&r[e]<n)return!0}else{const r=Array.from(e.keys),a=t.data.map((e=>e.metadata.key));for(let e=0;e<r.length;e++){const t=r[e];if(a.includes(t))return!0}}return!1},y=(e,t,r)=>{e.keys.forEach((e=>{const a=r.find((t=>t.metadata.key==e)),n=t.data.find((t=>t.metadata.key==e));n&&a&&n.data===a.data&&(a.data=new Proxy(a.data,{}))}))},h=(e,t)=>e.indexes&&null==t.sortCriteria&&null==t.filterCriterion})),
/**
 * @license
 * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define("oj-c/utils/PRIVATE_keyUtils/keySetUtils",["require","exports","ojs/ojkeyset"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isEqual=e.getFirstKey=e.isEmpty=e.keysToKeySet=e.keySetToKeys=void 0;e.keySetToKeys=e=>{if(!e)return{all:!1,keys:new Set};let t={};if(e.isAddAll()){t={all:!0,deletedKeys:new Set(e.deletedValues())}}else if(!e.isAddAll()){t={all:!1,keys:new Set(e.values())}}return t};e.keysToKeySet=e=>{let r;return e.all?(r=new t.AllKeySetImpl,r=r.delete(new Set(e.deletedKeys.values()))):e.all||(r=new t.KeySetImpl(new Set(e.keys.values()))),r};e.isEmpty=e=>!e.all&&0===e.keys.size;e.getFirstKey=(e,t)=>{if(!1===e.all&&e.keys.size>0){const[t]=e.keys;return t}return t.length>0?t[0]:null};e.isEqual=(e,t)=>{if(e===t)return!0;if(e.keys.all!==t.keys.all)return!1;const r=!0===e.keys.all?Array.from(e.keys.deletedKeys.values()):Array.from(e.keys.keys.values()),a=!0===t.keys.all?Array.from(t.keys.deletedKeys.values()):Array.from(t.keys.keys.values());if(r.length!==a.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==a[e])return!1;return!0}})),define("oj-c/table/utils/TableRendererUtils",["require","exports","preact/jsx-runtime"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getRowContext=function(e){return{item:e.data}},e.getPreactRowKey=function(e){return e.metadata.key},e.getPreactCellRenderer=function(e,t){return r=>{const a={item:r.rowData,columnKey:r.columnKey,data:null!=t?r.rowData.data[t]:void 0,isTabbable:r.isTabbable};return null!=e?e(a):null!=a.data?String(a.data):void 0}},e.getPreactHeaderRenderer=function(e){if(null!=e)return t=>{const r={key:t.key,headerText:t.headerText,isTabbable:t.isTabbable};return e(r)};return},e.getPreactFooterRenderer=function(e){if(null!=e)return t=>{const r={key:t.key,footerText:t.footerText,isTabbable:t.isTabbable};return e(r)};return},e.getPreactNoDataRenderer=function(e){if(null!=e)return t=>e({isTabbable:t.isTabbable});return},e.tableCellSelectorRenderer=function(e){return null!=e.selector?e.selector():void 0},e.tableHeaderSelectorRenderer=function(e){return null!=e.selector?(0,t.jsx)("div",{"data-oj-table-selector":"all",children:e.selector()}):void 0}})),define("oj-c/table/table",["require","exports","preact/jsx-runtime","@oracle/oraclejet-preact/translationBundle","ojs/ojcustomelement-registry","ojs/ojkeyset","ojs/ojvcomponent","preact/hooks","./hooks/UNSAFE_useWhenReadyContext/useWhenReadyContext","../hooks/UNSAFE_useListData/useListData","../utils/PRIVATE_keyUtils/keySetUtils","@oracle/oraclejet-preact/hooks/UNSAFE_useBusyStateContext","@oracle/oraclejet-preact/hooks/UNSAFE_useCollectionInteractionContext","@oracle/oraclejet-preact/hooks/UNSAFE_useFormVariantContext","@oracle/oraclejet-preact/hooks/UNSAFE_useTableViewColumnResizing","@oracle/oraclejet-preact/UNSAFE_TableView","./utils/TableRendererUtils","css!oj-c/table/table-styles.css"],(function(require,e,t,r,a,n,o,s,l,i,c,d,u,f,b,y,h){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Table=void 0;const m="oj-c-table_selection",p={},g={row:"none",column:"none"},C={fetchSize:25};const R=(0,o.registerCustomElement)("oj-c-table",(function({"aria-label":e,"aria-labelledby":r,id:a,data:u,columns:R,row:v,horizontalGridVisible:k="enabled",verticalGridVisible:w="disabled",layout:j="contents",currentCellOverride:S,onCurrentCellChanged:x,selected:T=p,selectionMode:P=g,onSelectedChanged:A,selectAllControl:z="visible",columnOrder:E,cellTemplate:_,headerTemplate:O,footerTemplate:M,templates:F,onOjRowAction:K,noData:D,columnWidths:L,onColumnWidthsChanged:V,columnResizeBehavior:I="redistribute",scrollPolicyOptions:W=C}){const B=(0,s.useRef)(null),U=(0,s.useRef)(null),H=(0,s.useCallback)((e=>null!=e&&null!=B.current&&function(e,t){let r=e.target;for(;null!=r&&r!==t;){if("disabled"===r.dataset.ojClickthrough)return!0;r=r.parentNode}return!1}({target:e},B.current)),[]),[N,q]=(0,i.useListData)(u,{fetchSize:W?.fetchSize}),G=(0,s.useCallback)((()=>{if("success"===N.status&&N.data&&q){const e=W&&null!=W.fetchSize?W.fetchSize:25;q({offset:0,count:N.data.data.length+e})}}),[N,q,W]),Y="loading"===N.status||"success"===N.status&&"atLeast"===N.data.sizePrecision,J="multiple"===P?.row||"multipleToggle"===P?.row,[Q,X]=(0,s.useState)((()=>{const e={...L};return J&&(e[m]=36),e}));(0,s.useEffect)((()=>{const e={...L};J&&(e[m]=36),X(e)}),[L,J]);const Z=(0,s.useCallback)((e=>{if(" "===e.key){const t=e.target;if(t.children.length>0&&"all"===t.children[0].dataset.ojTableSelector&&!e.repeat){let e;e=T.row?.isAddAll()&&0===T.row.keys.deletedKeys?.size?new n.KeySetImpl:new n.AllKeySetImpl,A({row:e,column:new n.KeySetImpl})}}}),[A,T]),$=J&&"hidden"!==z?{onKeyDown:Z}:{},ee=(0,s.useMemo)((()=>{const e=[];let t=!1;if(J&&(e.push(m),t=!0),null!=R)if(null!=E)for(const t of E)null==R[t]||e.includes(t)||e.push(t);else for(const[t]of Object.entries(R))t!==m&&e.push(t);return 1===e.length&&t?[]:e}),[E,R,J]),te=(0,s.useMemo)((()=>{const e={};return null!=R&&(J&&(e[m]={sticky:"enabled",selectable:"disabled",renderer:h.tableCellSelectorRenderer,headerRenderer:"hidden"!==z?h.tableHeaderSelectorRenderer:void 0,padding:"disabled",headerPadding:"disabled",tooltip:"disabled",headerTooltip:"disabled",accessibleColumnHeader:"disabled"}),Object.keys(R).forEach((t=>{const r=t,a=R[r],n=a.template&&F&&F[a.template]?(0,h.getPreactCellRenderer)(F[a.template],a.field):(0,h.getPreactCellRenderer)(_,a.field),o=a.headerTemplate&&F&&F[a.headerTemplate]?(0,h.getPreactHeaderRenderer)(F[a.headerTemplate]):(0,h.getPreactHeaderRenderer)(O),s=a.footerTemplate&&F&&F[a.footerTemplate]?(0,h.getPreactFooterRenderer)(F[a.footerTemplate]):(0,h.getPreactFooterRenderer)(M),l=a.headerText??void 0,i=a.footerText??void 0,c=a.maxWidth??void 0,d=a.minWidth??void 0,u=a.weight??void 0;let f;const b=a.padding;f="function"==typeof b?e=>{const t=(0,h.getRowContext)(e);return b(t)}:b??"enabled";const y=a.headerPadding??"enabled",m=a.footerPadding??"enabled";let p;const g=a.tooltip;p="function"==typeof g?e=>{const t=(0,h.getRowContext)(e);return g(t)}:g??"enabled";const C=a.headerTooltip??"enabled",v=a.footerTooltip??"enabled",k=a.sticky??"disabled",w=a.horizontalAlignment??"start",j=a.resizable??"disabled";let S=j;if("enabled"===j&&"redistribute"===I){const e=ee.indexOf(r),t=e===ee.length-1,a=t?void 0:ee[e+1],n=null!=a?R[a]?.resizable:void 0;S=t||"enabled"!==n?"disabled":"enabled"}e[r]={headerText:l,footerText:i,renderer:n,headerRenderer:o,footerRenderer:s,maxWidth:c,minWidth:d,weight:u,padding:f,headerPadding:y,footerPadding:m,tooltip:p,headerTooltip:C,footerTooltip:v,sticky:k,horizontalAlignment:w,resizable:j,edgeResizable:S}}))),e}),[R,_,O,M,z,F,J,I,ee]),re="success"===N.status&&N?.data?.data||[],ae=(0,s.useCallback)((e=>{K&&null!=e&&!H(e.target)&&K({context:(0,h.getRowContext)(e.context)})}),[K,H]),ne=(0,s.useMemo)((()=>({horizontal:"enabled"===k?"visible":"hidden",vertical:"enabled"===w?"visible":"hidden"})),[k,w]),oe=(0,s.useMemo)((()=>(0,h.getPreactNoDataRenderer)(D)),[D]),se=(0,s.useMemo)((()=>T?{row:T.row?(0,c.keySetToKeys)(T.row):void 0,column:T.column?(0,c.keySetToKeys)(T.column):void 0}:void 0),[T]),le=(0,s.useCallback)((e=>{if(!H(e.target)){const t=e.value,r=t.row?(0,c.keysToKeySet)(t.row):void 0,a=t.column?(0,c.keysToKeySet)(t.column):void 0;A({row:r,column:a})}}),[A,H]),ie=(0,s.useCallback)((e=>{x&&x(e.value)}),[x]),ce=(0,s.useMemo)((()=>({itemsRenderer:e=>e.defaultMenuItems})),[]),de=(0,s.useContext)(d.BusyStateContext),ue=(0,l.useWhenReadyContext)(U),fe=(0,s.useRef)(),be=(0,s.useRef)(),[ye,he]=(0,s.useState)("contents"===j),me=(0,s.useRef)(ye);(0,s.useEffect)((()=>("loading"===N.status?fe.current=de.addBusyState("loading data"):me.current&&(be.current=de.addBusyState("content initializing"),ue.whenReady().then((function(){be.current&&(be.current(),be.current=void 0),he(!1),me.current=!1}))),()=>{fe.current&&(fe.current(),fe.current=void 0),be.current&&(be.current(),be.current=void 0)})),[N.status,de,ue]);const pe=(0,s.useCallback)((e=>{X(e),V&&V(e)}),[V]),ge=(0,s.useCallback)((e=>{X(e)}),[]),{columnResizingProps:Ce}=(0,b.useTableViewColumnResizing)({columnOrder:ee,columnWidths:Q,onColumnWidthsChanging:ge,onColumnWidthsChange:pe,resizeBehavior:I});return(0,t.jsx)(o.Root,{id:a,ref:B,children:(0,t.jsx)("div",{ref:U,"data-oj-context":!0,...$,..._?{"data-oj-ct":!0}:{},...O?{"data-oj-ht":!0}:{},...M?{"data-oj-ft":!0}:{},...D?{"data-oj-ndt":!0}:{},style:"display: contents;",children:(0,t.jsx)(f.FormVariantContext.Provider,{value:"embedded",children:(0,t.jsx)(o.ReportBusyContext.Provider,{value:U,children:(0,t.jsx)(y.TableView,{"aria-label":e,"aria-labelledby":r,columns:te,contextMenuConfig:ce,data:re,getRowKey:h.getPreactRowKey,getAccessibleRowHeaders:e=>{const t=(0,h.getRowContext)(e),r=new Set;if(null!=v&&null!=v.accessibleRowHeader){if("string"==typeof v.accessibleRowHeader)r.add(v.accessibleRowHeader);else if(Array.isArray(v.accessibleRowHeader))v.accessibleRowHeader.forEach((e=>r.add(e)));else if("function"==typeof v.accessibleRowHeader){const e=v.accessibleRowHeader(t);"string"==typeof e?r.add(e):Array.isArray(e)&&e.forEach((e=>r.add(e)))}}else ee.length>0&&(J?r.add(ee[1]):r.add(ee[0]));return r},gridlines:ne,layout:ye?"pending":j,selected:se,selectionMode:P,onSelectionChange:le,columnOrder:ee,onRowAction:ae,noDataRenderer:oe,onLoadMore:G,hasMore:Y,currentCellOverride:S,onPersistCurrentCell:ie,width:"100%",...Ce})})})})})}),"Table",{properties:{layout:{type:"string",enumValues:["fixed","contents"]},data:{type:"DataProvider"},columns:{type:"object"},row:{type:"object",properties:{accessibleRowHeader:{type:"string|Array<string>|function"}}},horizontalGridVisible:{type:"string",enumValues:["disabled","enabled"]},verticalGridVisible:{type:"string",enumValues:["disabled","enabled"]},selected:{type:"object",properties:{column:{type:"object"},row:{type:"object"}},writeback:!0},selectionMode:{type:"object",properties:{column:{type:"string",enumValues:["none","multiple","single"]},row:{type:"string",enumValues:["none","multiple","single","multipleToggle"]}}},selectAllControl:{type:"string",enumValues:["hidden","visible"]},columnOrder:{type:"Array<string>",writeback:!0},currentCellOverride:{type:"object"},currentCell:{type:"object",readOnly:!0,writeback:!0},columnWidths:{type:"object",writeback:!0},scrollPolicyOptions:{type:"object",properties:{fetchSize:{type:"number"}}},columnResizeBehavior:{type:"string",enumValues:["add","redistribute"]}},slots:{cellTemplate:{data:{}},headerTemplate:{data:{}},footerTemplate:{data:{}},noData:{data:{}}},extension:{_DYNAMIC_SLOT:{prop:"templates",isTemplate:1},_WRITEBACK_PROPS:["selected","columnOrder","currentCell","columnWidths"],_READ_ONLY_PROPS:["currentCell"],_OBSERVED_GLOBAL_PROPS:["aria-label","aria-labelledby","id"]},events:{ojRowAction:{bubbles:!0}}},{horizontalGridVisible:"enabled",verticalGridVisible:"disabled",layout:"contents",selected:{},selectionMode:{row:"none",column:"none"},selectAllControl:"visible",columnResizeBehavior:"redistribute",scrollPolicyOptions:{fetchSize:25}},{"@oracle/oraclejet-preact":r.default},{consume:[u.CollectionInteractionContext]});e.Table=R;(0,a.getMetadata)("oj-c-table").properties.__oj_private_do_not_use_userAssistanceDensity={binding:{provide:[{name:"containerUserAssistanceDensity",default:"compact"},{name:"userAssistanceDensity",default:"compact"}]}}})),define("oj-c/table",["require","exports","oj-c/table/table"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Table=void 0,Object.defineProperty(e,"Table",{enumerable:!0,get:function(){return t.Table}})}));
//# sourceMappingURL=table.js.map