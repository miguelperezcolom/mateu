define(['exports', 'preact/jsx-runtime', 'preact/compat', 'preact/hooks', './useVisEvents-3839d74f', './mergeProps-bcfa6a92', './layoutUtils-641af87a', './useLegendDnd-daee983e', './useLegendContextMenu-acabb503', './useItemFocus-75d6510d', './Flex-4bc3a394', './PRIVATE_BaseLegend/themes/LegendStyles.css', './useCssVars-d782da3d', './classNames-08d99695', './useTestId-a2e433c2', './useVisTouchResponse-88a7bb09', './stringUtils-4ffd9d59', './useTextDimensions-f254e8f5', './TrackResizeContainer-a4999df9', './hooks/PRIVATE_useVisDnd/themes/VisDndStyles.css'], (function(e,t,n,i,o,s,a,r,d,l,c,m,g,h,u,x,I,f,y,p){"use strict";function v(e,t){const{sectionIdx:n,itemIdx:i}=e;if(-1==n&&-1==i){const e=t[t.length-1].items.length;return t[t.length-1].items[e-1]}return t[n].items[i]}function D(e,t){let{itemIdx:n,sectionIdx:i}=e;if(-1==i&&-1==n)return{itemIdx:t[t.length-1].items.length-1,sectionIdx:t.length-1};n+=1;n>=t[i].items.length&&(i===t.length-1?n=e.itemIdx:(i+=1,n=0));const o=t[i].items[n];return"off"!==o?.actionable?{itemIdx:n,sectionIdx:i}:D({itemIdx:n,sectionIdx:i},t)}function b(e,t){let{itemIdx:n,sectionIdx:i}=e;-1==i&&-1==n&&(n=t[t.length-1].items.length-1,i=t.length-1),n-=1,n<0&&(0===i?n=0:(n=t[i-1].items.length-1,i-=1));const o=t[i].items[n];return"off"!==o?.actionable?{itemIdx:n,sectionIdx:i}:b({itemIdx:n,sectionIdx:i},t)}function S(e){return{getItem:t=>v(t,e),getDetailFromInfo:t=>{if(!t||0===e.length)return{itemId:void 0,sectionId:void 0,data:void 0};const n=v(t,e),i=e[t.sectionIdx].id;return{itemId:n.id,sectionId:i,data:e[t.sectionIdx].items[t.itemIdx]}},getPrevItemInfo:t=>b(t,e),getNextItemInfo:t=>D(t,e)}}const R=({width:e,getTextDimensions:t,resolvedVars:n,rootRef:i,orientation:o,legendFontStylesObj:s={},symbolWidth:a,symbolHeight:d,sections:l})=>{let c=0,m=0,g=0;const h=e;if(!i.current||!Object.keys(n).length||!t)return;const u=parseFloat(n.unit);let x=0,I=0;const f=[],y=[],p=[];let v=0;const D=.75*u;l.forEach(((e,n)=>{let i,l,b=!1,S=!1;const R=t(e.title,{fontWeight:"600"}),W=R.height+D+.5,w=R.width+3,{maxItemWidth:F,maxItemHeight:P,horizontalSectionWidth:C}=T(e.items,u,t,s,a,d);let M=e.items.length;const L=4*u;if(w+C<h)i=C+w,0!==x&&x+L+i<h&&!y[n-1]?x=x+i+L:(x=i,v+=Math.max(W,P),0!==n&&(v+=L));else{b=!0,i=C;const t=.4*u;C>h?(S=!0,x=0,M=Math.floor(h/F),l=r.getSectionGridNums(e.items.length,M),l.itemsPerCol&&l.itemsPerRow&&(v+=W+2*(P+t)+2*D,x=l.itemsPerRow*F,l.itemsPerCol>2&&(v+=(l.itemsPerCol-2)*(P+2*t)))):(x=i,v+=P+W+2*D,0!==n&&(v+=L))}I=Math.max(x,I),g+=C,c=Math.max(c,F),m=P,f.push(b),y.push(S),p.push("vertical"===o?1:Math.max(1,M))}));return{maxRowWidth:Math.ceil(I),legendHeight:v,totalWidth:g,maxItemWidth:Math.min(c,h),maxItemHeight:Math.ceil(m),itemsPerRowArray:p,isSectionWrappedArray:f,isLegendWrappedArray:y}},T=(e,t,n,i,o,s)=>{let a=0,r=0,d=0,l=0,c=0;l=o?1.5*t+o:4*t;const m=1.7*t;c=s?s+m:2.5*t+m;const g=2.5*t;return e?.forEach((e=>{const t=e,{width:o,height:s}=n(t.text,i),m=g+o;d+=l+m,a=Math.max(a,l+m),r=Math.max(r,s,c)})),{maxItemWidth:a,maxItemHeight:r,horizontalSectionWidth:d}},W=n.forwardRef((({orientation:e="horizontal",sectionTitleHAlign:n="start",sections:v,isReadOnly:D=!0,onItemAction:b,onItemHover:T,onItemFocus:W,testId:w,contextMenuConfig:F,hideAndShowBehavior:P="off",hoverBehavior:C="none",valign:M="top",halign:L="start",...A},H=null)=>t.jsx(y.TrackResizeContainer,{width:"100%",height:"100%",class:h.classNames([m.styles.flexStyle,m.styles[`${L}HAlign`],m.styles[`${M}VAlign`]]),children:function(y,M){const L=u.useTestId(w),V=i.useRef(null),j=void 0!==L["data-testid"],E=i.useRef(),{resolvedVars:z,cssContent:O}=g.useCssVars(r.legendVars),{getItem:B,getDetailFromInfo:N,getPrevItemInfo:k,getNextItemInfo:U}=S(v),_=r.getLegendTextStyle({fontStyle:A.textFontStyle,fontSize:A.textFontSize?.toString(),fontWeight:A.textFontWeight?.toString(),fontFamily:A.textFontFamily},z),{textMeasureContent:G,getTextDimensions:$}=f.useTextDimensions(),q=r.getIsLegendItemActionable(v,D,!0),K=v.length>0,J=R({width:y,rootRef:V,getTextDimensions:$,resolvedVars:z,orientation:e,legendFontStylesObj:_,symbolWidth:A.symbolWidth,symbolHeight:A.symbolHeight,sections:v}),{touchResponse:Q,touchResponseStyle:X}=x.useVisTouchResponse({type:"touchStart"}),{focusedItemInfo:Y,hoveredItemInfo:Z,onContextMenuDismissed:ee,activeId:te,eventsProps:ne}=o.useVisEvent(Q,!D,q,r.getKeyUpHandler,N,k,U,b,T,W,r.isEqualItem,r.getItemInfo,{itemIdx:0,sectionIdx:0}),{focusedItemRef:ie}=l.useItemFocus(Y),oe=r.getDatatipText(v,B,Y,Z),[se,ae]=i.useState(!1),{datatipContent:re,datatipProps:{"aria-describedby":de,...le}}=d.useLegendDatatip({text:oe,rootDimsRef:E,focusedItemInfo:Y,focusedItemRef:ie,touchResponse:Q,isDisabled:se}),ce=r.getAriaProps(D,A["aria-label"],A.hiddenIds,I.l([A["aria-describedby"],de]),A["aria-labelledby"]),{contextMenuContent:me,contextMenuProps:ge}=d.useSectionalLegendContextMenu({rootRef:V,contextMenuConfig:K?F:void 0,focusedItemInfo:Y,sections:v,isReadOnly:D,onContextMenuDismissed:ee}),[he,ue]=i.useState(),{draggable:xe,dndProps:Ie,dndContent:fe}=r.useLegendDnd({onDrag:A.onDrag,onDragStart:A.onDragStart,onDragEnd:A.onDragEnd,onDragEnter:A.onDragEnter,onDragLeave:A.onDragLeave,onDragOver:A.onDragOver,onDrop:A.onDrop,sections:v,setDragOver:ue,setDatatipDisabled:ae,itemDraggable:A.itemDraggable}),ye=s.mergeProps(ne,le,ge,Ie),pe={fontFamily:A.sectionTitleFontFamily,fontSize:A.sectionTitleFontSize,color:A.sectionTitleColor,fontStyle:A.sectionTitleFontStyle,fontWeight:A.sectionTitleFontWeight,textDecoration:A.sectionTitleTextDecoration},{sectionalLegendBaseStyles:ve,renderedLegendStyle:De}=m.styles,be="horizontal"===e;return i.useImperativeHandle(H,(()=>({_getPreferredSize:(t,n)=>{const i=R({width:t,getTextDimensions:$,resolvedVars:z,rootRef:V,orientation:e,legendFontStylesObj:_,symbolWidth:A.symbolWidth,symbolHeight:A.symbolHeight,sections:v});return i?{width:i?.maxRowWidth,height:i?.legendHeight}:void 0}})),[$,_,z]),t.jsxs("div",{ref:V,tabIndex:D?void 0:0,role:"application",class:h.classNames([ve,De,he?p.styles.dndDragOverHTMLStyle:!1===he?p.styles.dndRejectedStyle:void 0]),draggable:xe,style:X,...L,...ce,...ye,"aria-activedescendant":te,children:[t.jsx(c.Flex,{direction:be?"row":"column",wrap:"wrap",gap:"4x",children:v.map(((i,o)=>{const s=D?"":a.getRandomId(),l=!!J&&J.isSectionWrappedArray[o],m=!be||l?"column":"row",g=!be||l?"start":"center",{itemsPerCol:h,itemsPerRow:u}=r.getSectionGridNums(i.items.length,J?.itemsPerRowArray[o]);return t.jsxs(c.Flex,{align:g,direction:m,maxWidth:"100%",justify:"start",wrap:"wrap",children:[t.jsx(d.LegendText,{text:i.title,...pe,type:"title",id:s,align:n}),t.jsx(d.BaseLegend,{...A,focusedItemRef:ie,labelledBy:s,sectionIdx:o,items:i.items,orientation:e,itemsPerRow:u,itemsPerCol:h,itemWidth:J?.isLegendWrappedArray[o]?J?.maxItemWidth:void 0,isReadOnly:D,focusedItemInfo:Y,hoveredItemInfo:Z,activeId:te,hideAndShowBehavior:P,hoverBehavior:C,isTestEnv:j})]})}))}),re,G,O,me,fe]})}})));e.SectionalLegend=W}));
//# sourceMappingURL=SectionalLegend-a37ee0ec.js.map
