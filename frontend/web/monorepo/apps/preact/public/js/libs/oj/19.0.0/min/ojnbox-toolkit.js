/**
 * @license
 * Copyright (c) 2014, 2025, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["exports","ojs/ojdvt-toolkit","ojs/ojtranslation"],function(e,t,a){"use strict";const i=e=>{var a=e.getDimensions(),i=e.localToStage(new t.Point(a.x,a.y)),o=e.localToStage(new t.Point(a.x+a.w,a.y+a.h));return new t.Rectangle(i.x,i.y,o.x-i.x,o.y-i.y)},o=(e,a,i,o,n)=>{var r=new t.OutputText(e,a,0,0);return r.setCSSStyle(i),r.setHorizAlignment(o),r.setVertAlignment(n),r},n=e=>{for(var t=e.getMatrix(),a=e.getParent();a;){var i=a.getMatrix();t=t.translate(i.getTx(),i.getTy()),a=a.getParent()}return t},r=(e,t,a,i)=>{if(e.setX(t),e.setY(a),i){var o=e.getMatrix();o=(o=o.translate(-t,-a)).rotate(i),e.setMatrix(o.translate(t,a))}},l=(e,a)=>{if(0==a.indexOf("linear-gradient")){var i=t.GradientParser.parseCSSGradient(a);i&&e.setFill(new t.LinearGradientFill(i.getAngle(),i.getColors(),i.getAlphas(),i.getRatios()))}else e.setSolidFill(a)},s=(e,t,a,i)=>{var o=e.getDisplayables(),n=i?"__displayable:"+i:"__displayable",r=null==t.__cacheId?t.id:t.__cacheId,l=e.getOptions().__displayableCache,s=null==r?t[n]:l.getFromCachedMap(r,n);null!=s?o[s]=a:(null==r?t[n]=o.length:l.putToCachedMap(r,n,o.length),o.push(a))},d=(e,t,a)=>{if(!t)return null;var i=a?"__displayable:"+a:"__displayable",o=null==t.__cacheId?t.id:t.__cacheId,n=e.getOptions().__displayableCache,r=null==o?t[i]:n.getFromCachedMap(o,i),l=e.getDisplayables();return null==r?null:l[r]},g={processDataObj:e=>{if(g.hasValidData(e)){var t=e.getOptions(),a=t.cells,i={};if(a)for(var o=0;o<a.length;o++){var n=a[o],r=n.row;i[r]||(i[r]={});var l=n.column;i[r][l]=n}for(var s=[],d={},h={},u=0;u<g.getRowCount(e);u++){var c=g.getRow(e,u);c.__cacheId="row:"+c.id,d[c.id]=u}t.__rowMap=d;for(var C=0;C<g.getColCount(e);C++){var _=g.getCol(e,C);_.__cacheId="column:"+_.id,h[_.id]=C}t.__columnMap=h;for(var p=0;p<g.getRowCount(e);p++)for(var b=g.getRow(e,p).id,v=0;v<g.getColCount(e);v++){var f=g.getCol(e,v).id;if(i[b]&&i[b][f]){var x=i[b][f];s.push(x)}else s.push({row:b,column:f})}t.cells=s;for(var y=new(e.getCtx().ojMap),m=!1,S=0;S<g.getNodeCount(e);S++){var w=g.getNode(e,S);y.set(w.id,S),!m&&(w.groupCategory||w._groupCategories||w._groupLabels)&&(m=!0)}t.__nodeMap=y,t.__grouping="none"!=t.groupBehavior&&m,g.getGrouping(e)&&"acrossCells"==g.getGroupBehavior(e)&&(t.maximizedRow=null,g.fireOptionChangeEvent(e,"maximizedRow",null),t.maximizedColumn=null,g.fireOptionChangeEvent(e,"maximizedColumn",null)),(t.maximizedRow&&isNaN(d[t.maximizedRow])||t.maximizedColumn&&isNaN(h[t.maximizedColumn]))&&(t.maximizedRow=null,g.fireOptionChangeEvent(e,"maximizedRow",null),t.maximizedColumn=null,g.fireOptionChangeEvent(e,"maximizedColumn",null))}},hasValidData:e=>{var t=e.getOptions();return!(!t||!t.rows||t.rows.length<1||!t.columns||t.columns.length<1)},getColCount:e=>e.getOptions().columns.length,getRowCount:e=>e.getOptions().rows.length,getColLabel:(e,t)=>{var a=g.getCol(e,g.getColIdx(e,t));return a&&a.label?a.label:null},getRowLabel:(e,t)=>{var a=g.getRow(e,g.getRowIndex(e,t));return a&&a.label?a.label:null},getCellByRowCol:(e,t,a)=>{var i=g.getCell(e,g.getCellIdxByRowCol(e,t,a));return i?d(e,i):null},getCellIdxByRowCol:(e,t,a)=>g.getColIdx(e,a)+g.getRowIndex(e,t)*g.getColCount(e),getCol:(e,t)=>e.getOptions().columns[t],getRow:(e,t)=>e.getOptions().rows[t],getMaximizedRow:e=>e.getOptions().maximizedRow,getMaximizedCol:e=>e.getOptions().maximizedColumn,getRowIndex:(e,t)=>e.getOptions().__rowMap[t],getColIdx:(e,t)=>e.getOptions().__columnMap[t],getCell:(e,t)=>e.getOptions().cells[t],getNodeCount:e=>e.getOptions().nodes?e.getOptions().nodes.length:0,getNode:(e,t)=>e.getOptions().nodes[t],getNodeIndex:(e,t)=>{var a=e.getOptions().__nodeMap;return a?a.get(t):-1},getCellIndex:(e,t)=>{var a=g.getRowIndex(e,t.row);return g.getColIdx(e,t.column)+a*g.getColCount(e)},getSelectedItems:e=>e.getOptions().selection,setSelectedItems:(e,t)=>{e.getOptions().selection=t},getHighlightedItems:e=>{var t,a=e.getOptions().highlightedCategories;if(a&&a.length>0){t=[];for(var i=0;i<g.getNodeCount(e);i++){var o=g.getNode(e,i);g.isNodeHighlighted(e,o)&&t.push(o)}}return t},getGrouping:e=>e.getOptions().__grouping,getGroupAttr:e=>e.getOptions().groupAttributes,getGroupBehavior:e=>e.getOptions().groupBehavior,getNodeGroupId:e=>{if(e.groupCategory)return e.groupCategory;var t=e._groupCategories;return t&&t.length>0?t.join(";"):null},getXPercentage:(e,t)=>{if(!isNaN(t.xPercentage))return t.xPercentage;var a=g.getColCount(e);return(g.getColIdx(e,t.column)+.5)/a},getYPercentage:(e,t)=>{if(!isNaN(t.yPercentage))return t.yPercentage;var a=g.getRowCount(e);return(g.getRowIndex(e,t.row)+.5)/a},getOtherThreshold:e=>e.getOptions().otherThreshold,getOtherColor:e=>e.getOptions().otherColor,getDrawer:e=>e.getOptions()._drawer,getCategoryNode:(e,t)=>{var a=g.getGroupBehavior(e),i=e.getOptions().__groups,o=t;if("withinCell"==a){var n=t.substring(0,t.indexOf(":"));o=t.substring(t.indexOf(":")+1),i=i[n]}return i?i[o]:null},getCategoryNodeLabels:(e,t)=>{if(t.__labels)return t.__labels;var a=g.getNode(e,t.nodeIndices[0]);if(a.groupCategory)return t.__labels=[a.groupCategory],t.__labels;if(t.__labels=[],a._groupCategories)for(var i=e.getOptions()._groupLabels,o=0;o<a._groupCategories.length;o++)i&&i[a._groupCategories[o]]?t.__labels[o]=i[a._groupCategories[o]]:t.__labels[o]=a._groupCategories[o];return t.__labels},isMaximizeEnabled:e=>"off"!=e.getOptions().cellMaximize,getCellContent:e=>"counts"==e.getOptions().cellContent?"counts":"auto",isCellMinimized:(e,t)=>{var a=g.getMaximizedRow(e),i=g.getMaximizedCol(e);if(!a&&!i)return!1;var o=g.getCell(e,t),n=o.row,r=o.column;return a&&i?a!=n||i!=r:a!=n&&i!=r},isCellMaximized:(e,t)=>{var a=g.getMaximizedRow(e),i=g.getMaximizedCol(e),o=g.getCell(e,t),n=o.row,r=o.column;return a==n&&i==r},isNodeHidden:(e,a)=>{var i=e.getOptions();return i.hiddenCategories&&!i.__hiddenMap&&(i.__hiddenMap=t.ArrayUtils.createBooleanMap(i.hiddenCategories)),t.ArrayUtils.hasAnyMapItem(i.__hiddenMap,a.categories)},isNodeHighlighted:(e,a)=>{var i=e.getOptions();return i.highlightedCategories&&!i.__highlightedMap&&(i.__highlightedMap=t.ArrayUtils.createBooleanMap(i.highlightedCategories)),"all"==i.highlightMatch?t.ArrayUtils.hasAllMapItems(i.__highlightedMap,a.categories):t.ArrayUtils.hasAnyMapItem(i.__highlightedMap,a.categories)},getNodeScrollableContainer:(e,t)=>{if(!t)return null;var a=g.getDrawer(e);if(a){var i=d(e,a);if(i)return i.getChildContainer()}var o=g.getCellIndex(e,t.getData());if(g.isCellMaximized(e,o)){var n=g.getCell(e,o);return d(e,n).getChildContainer()}return null},fireOptionChangeEvent:(e,a,i)=>{var o=t.EventFactory.newOptionChangeEvent(a,i);e.processEvent(o)},getMaximizedCellIndex:e=>{var t=null,a=g.getMaximizedRow(e),i=g.getMaximizedCol(e);if(a&&i){var o=g.getColCount(e);t=g.getColIdx(e,i)+o*g.getRowIndex(e,a)}return t},isDrawerSelected:(e,t)=>{var a=!1,i=g.getSelectedItems(e);if(i){for(var o={},n=0;n<i.length;n++)o[i[n]]=!0;var r=t.getData().nodeIndices;a=!0;for(var l=0;l<r.length;l++){if(!o[g.getNode(e,r[l]).id]){a=!1;break}}}return a},buildAriaDesc:(e,a,i,o,n)=>{var r=e.getOptions().translations,l="categoryNode"===a.nboxType||"drawer"===a.nboxType?t.ResourceUtils.format(r.labelAndValue,[r.labelGroup,i]):i,s=[];if(o?s.push(r.stateSelected):s.push(r.stateUnselected),"categoryNode"===a.nboxType){var d=a.getData().nodeIndices.length;s.push(r.stateCollapsed),s.push(t.ResourceUtils.format(r.labelAndValue,[r.labelSize,d]))}else if("drawer"===a.nboxType){var h=g.getCategoryNode(e,a.getData().id).nodeIndices.length;s.push(r.stateExpanded),s.push(t.ResourceUtils.format(r.labelAndValue,[r.labelSize,h]))}return t.Displayable.generateAriaLabel(l,s,n)},getFirstNavigableNode:e=>{var t=null;if(e.getNumChildren()>0){var a;t=e.getChildAt(0);do{"node"!==t.nboxType&&"overflow"!==t.nboxType||(a=t.previousNavigable),t=a||t}while(a)}return t},getLastNavigableNode:e=>{var t=null,a=e.getNumChildren();if(a>0){var i;t=e.getChildAt(a-1);do{t=(i="node"===t.nboxType?t.nextNavigable:null)||t}while(i)}return t},getNextNavigableNode:(e,a)=>{var i,o=a.keyCode==t.KeyboardEvent.RIGHT_ARROW||a.keyCode==t.KeyboardEvent.DOWN_ARROW;return"node"===e.nboxType?i=o?e.nextNavigable:e.previousNavigable:"overflow"===e.nboxType&&(i=o?null:e.previousNavigable),i||e},getCellCounts:e=>e.getOptions().__cellCounts||g._calculateCellCounts(e),_calculateCellCounts:e=>{var t=g.getRowCount(e)*g.getColCount(e),a=[],i=null,o=g.getHighlightedItems(e),n={};if(o){i=[];for(var r=0;r<o.length;r++)n[o[r].id]=!0}for(var l=0;l<t;l++)a[l]=0,i&&(i[l]=0);for(var s=g.getNodeCount(e),d=0;d<s;d++){var h=g.getNode(e,d);if(!g.isNodeHidden(e,h)){var u=g.getCellIndex(e,h);a[u]++,i&&n[h.id]&&i[u]++}}var c={};return c.total=a,i&&(c.highlighted=i),e.getOptions().__cellCounts=c,c},getRowDims:(e,a,i)=>{var o=g.getRowCount(e),n=i.h/o,r=i.y+(o-a-1)*n,l=n;return new t.Rectangle(i.x,r,i.w,l)},getColDims:(e,a,i)=>{var o=g.getColCount(e),n=i.w/o,r=t.Agent.isRightToLeft(e.getCtx()),l=i.x+(r?i.w-n:0)+(r?-1:1)*a*n,s=n;return new t.Rectangle(l,i.y,s,i.h)},compareCategoryNodeSize:(e,t)=>{var a=e.nodeIndices.length,i=t.nodeIndices.length;return a==i?0:a<i?1:-1}},h={getAnimOnDisplay:e=>{if(!e.isAnimationAllowed())return"none";var a=e.getOptions().animationOnDisplay;return"auto"==a&&(a=t.BlackBoxAnimationHandler.ALPHA_FADE),a},getAnimOnDataChange:e=>e.isAnimationAllowed()?e.getOptions().animationOnDataChange:"none",getAnimDuration:e=>t.CSSStyle.getTimeMilliseconds(e.getOptions().styleDefaults.animationDuration)/1e3,getColLabelStyle:(e,a)=>{var i=e.getOptions().styleDefaults.columnLabelStyle,o=g.getCol(e,a);return o.labelStyle?t.JsonUtils.merge(new t.CSSStyle(o.labelStyle),i):i},getRowLabelStyle:(e,a)=>{var i=e.getOptions().styleDefaults.rowLabelStyle,o=g.getRow(e,a);return o.labelStyle?t.JsonUtils.merge(new t.CSSStyle(o.labelStyle),i):i},getCellStyle:(e,a)=>{var i=e.getOptions(),o=h._getCellStyleKeys(e,a),n=h._getCellStyleOption(e,a,o[0],o[1]),r=i.styleDefaults.cellDefaults["_"+o[0]],l=new t.CSSStyle;return h._getCellStyleProperties().forEach(e=>{var a=t.CSSStyle.cssStringToObjectProperty(e),i=n&&null!=n[a]?n[a]:r.getStyle(e);l.setStyle(e,i)}),l},getCellStyleObject:(e,a)=>{var i=h._getCellStyleKeys(e,a),o=h._getCellStyleOption(e,a,i[0],i[1]);return o&&h._getCellStyleProperties().forEach(e=>{delete o[t.CSSStyle.cssStringToObjectProperty(e)]}),o},_getCellStyleKeys:(e,t)=>{var a="style",i="svgStyle",o=g.getMaximizedRow(e),n=g.getMaximizedCol(e);return g.isCellMinimized(e,t)?(a="minimizedStyle",i="minimizedSvgStyle"):!o&&!n||g.isCellMinimized(e,t)||(a="maximizedStyle",i="maximizedSvgStyle"),[a,i]},_getCellStyleOption:(e,a,i,o)=>{var n=e.getOptions(),r=g.getCell(e,a),l=n.styleDefaults.cellDefaults,s=l[o]||l[i];!s||s instanceof Object||(s=t.CSSStyle.cssStringToObject(s));var d=r[o]||r[i];return d?(d instanceof Object||(d=t.CSSStyle.cssStringToObject(d)),d=t.JsonUtils.merge(d,s)):s&&(d=t.JsonUtils.clone(s)),d},_getCellStyleProperties:()=>[t.CSSStyle.BACKGROUND,t.CSSStyle.BACKGROUND_COLOR,t.CSSStyle.BORDER_STYLE,t.CSSStyle.BORDER_COLOR,t.CSSStyle.BORDER_WIDTH],getCellClassName:(e,t)=>{var a="className",i="svgClassName",o=g.getMaximizedRow(e),n=g.getMaximizedCol(e);g.isCellMinimized(e,t)?(a="minimizedClassName",i="minimizedSvgClassName"):!o&&!n||g.isCellMinimized(e,t)||(a="maximizedClassName",i="maximizedSvgClassName");var r=g.getCell(e,t);return r[i]||r[a]},getCellLabelStyle:(e,a)=>{var i=e.getOptions(),o=g.isCellMinimized(e,a)?"_labelMinimizedStyle":"labelStyle",n=i.styleDefaults.cellDefaults[o],r=g.getCell(e,a);return r.labelStyle?t.JsonUtils.merge(new t.CSSStyle(r.labelStyle),n):n},getCellShowCount:(e,t)=>t.showCount?t.showCount:e.getOptions().styleDefaults.cellDefaults.showCount,getCellCountLabelStyle:(e,t)=>{var a=g.isCellMinimized(e,t)?"_labelMinimizedStyle":"countLabelStyle";return e.getOptions().styleDefaults.cellDefaults[a]},getCellBorderRadius:e=>e.getOptions().styleDefaults.cellDefaults._borderRadius,getCellBodyCountLabelStyle:e=>e.getOptions().styleDefaults.cellDefaults.bodyCountLabelStyle,getCellDropTargetStyle:e=>e.getOptions().styleDefaults.cellDefaults.dropTargetStyle,getNodeLabel:(e,a)=>{if(!a.label)return null;var i=d(e,a,"label");if(i)return i;var n=t.Agent.isRightToLeft(e.getCtx())?t.OutputText.H_ALIGN_RIGHT:t.OutputText.H_ALIGN_LEFT;return i=o(e.getCtx(),a.label,h.getNodeLabelStyle(e),n,t.OutputText.V_ALIGN_CENTRAL),a.secondaryLabel&&i.setClassName("oj-typography-semi-bold"),s(e,a,i,"label"),i},getNodeSecondaryLabel:(e,a)=>{if(!a.secondaryLabel)return null;var i=d(e,a,"secondaryLabel");if(i)return i;var n=t.Agent.isRightToLeft(e.getCtx())?t.OutputText.H_ALIGN_RIGHT:t.OutputText.H_ALIGN_LEFT;return i=o(e.getCtx(),a.secondaryLabel,h.getNodeSecondaryLabelStyle(e),n,t.OutputText.V_ALIGN_CENTRAL),s(e,a,i,"secondaryLabel"),i},getNodeLabelStyle:e=>e.getOptions().styleDefaults.nodeDefaults.labelStyle,getNodeSecondaryLabelStyle:e=>e.getOptions().styleDefaults.nodeDefaults.secondaryLabelStyle,getNodeColor:(e,t)=>t.color?t.color:e.getOptions().styleDefaults.nodeDefaults.color,getNodeBorderColor:(e,t)=>{var a=t.borderColor?t.borderColor:e.getOptions().styleDefaults.nodeDefaults.borderColor;return a||null},getNodeBorderWidth:(e,t)=>{var a=t.borderWidth?t.borderWidth:e.getOptions().styleDefaults.nodeDefaults.borderWidth;return a||null},getNodeIndicatorColor:(e,t)=>t.indicatorColor?t.indicatorColor:e.getOptions().styleDefaults.nodeDefaults.indicatorColor,getNodeCutAlpha:e=>e.getOptions().styleDefaults.nodeDefaults._cutAlpha,getNodeDragSourceAlpha:e=>e.getOptions().styleDefaults.nodeDefaults._dragSourceAlpha,getIcon:(e,t)=>t.icon?h.getStyledIcon(e,t.icon):null,getIndicatorIcon:(e,t)=>t.indicatorIcon?h.getStyledIndicatorIcon(e,t.indicatorIcon):null,getStyledIcon:(e,a)=>t.JsonUtils.merge(a,e.getOptions().styleDefaults.nodeDefaults.iconDefaults),getStyledIndicatorIcon:(e,a)=>t.JsonUtils.merge(a,e.getOptions().styleDefaults.nodeDefaults.indicatorIconDefaults),getFadedNodeAlpha:e=>e.getOptions().styleDefaults.nodeDefaults.alphaFade,getScrollbarStyleMap:e=>e.getOptions().styleDefaults.__scrollbar,getCategoryNodeColor:(e,t)=>{if("none"==g.getGroupBehavior(e)||g.getGroupAttr(e)&&-1==g.getGroupAttr(e).indexOf("color"))return e.getOptions().styleDefaults.nodeDefaults.color;if(t.otherNode)return g.getOtherColor(e);var a=t.nodeIndices,i=g.getNode(e,a[0]).color;if(!i)return e.getOptions().styleDefaults.nodeDefaults.color;for(var o=1;o<a.length;o++){if(i!=g.getNode(e,a[o]).color)return e.getOptions().styleDefaults.nodeDefaults.color}return i},getCategoryNodeIndicatorColor:(e,t)=>{if("none"==g.getGroupBehavior(e)||g.getGroupAttr(e)&&-1==g.getGroupAttr(e).indexOf("indicatorColor"))return null;var a=t.nodeIndices,i=g.getNode(e,a[0]).indicatorColor;if(!i)return e.getOptions().styleDefaults.nodeDefaults.indicatorColor;for(var o=1;o<a.length;o++){if(i!=g.getNode(e,a[o]).indicatorColor)return e.getOptions().styleDefaults.nodeDefaults.indicatorColor}return i},getStyledCategoryIndicatorIcon:(e,a)=>{if("none"==g.getGroupBehavior(e))return null;if(g.getGroupAttr(e)&&-1==g.getGroupAttr(e).indexOf("indicatorIconShape")&&-1==g.getGroupAttr(e).indexOf("indicatorIconColor")&&-1==g.getGroupAttr(e).indexOf("indicatorIconPattern"))return null;var i={},o=a.nodeIndices,n=g.getNode(e,o[0]).indicatorIcon;if(!n)return null;n.width&&(i.width=n.width),n.height&&(i.height=n.height),n.borderWidth&&(i.borderWidth=n.borderWidth),n.borderStyle&&(i.borderStyle=n.borderStyle),n.borderColor&&(i.borderColor=n.borderColor),n.borderRadius&&(i.borderRadius=n.borderRadius),n.style&&(i.style=n.style),n.className&&(i.className=n.className);var r,l=!0;if(!g.getGroupAttr(e)||-1!=g.getGroupAttr(e).indexOf("indicatorIconShape")){for(var s=n.shape,d=1;d<o.length;d++)(r=g.getNode(e,o[d]).indicatorIcon)&&s!=r.shape&&(l=!1);i.shape=l?s:e.getOptions().styleDefaults.nodeDefaults.indicatorIconDefaults.shape}if(l=!0,!g.getGroupAttr(e)||-1!=g.getGroupAttr(e).indexOf("indicatorIconColor")){for(var h=n.color,u=1;u<o.length;u++)(r=g.getNode(e,o[u]).indicatorIcon)&&h!=r.color&&(l=!1);i.color=l?h:e.getOptions().styleDefaults.nodeDefaults.indicatorIconDefaults.color}if(l=!0,!g.getGroupAttr(e)||-1!=g.getGroupAttr(e).indexOf("indicatorIconPattern")){for(var c=n.pattern,C=1;C<o.length;C++){var _=g.getNode(e,o[C]).indicatorIcon;_&&c!=_.pattern&&(l=!1)}i.pattern=l?c:e.getOptions().styleDefaults.nodeDefaults.indicatorIconDefaults.pattern}return t.JsonUtils.merge(i,e.getOptions().styleDefaults.nodeDefaults.indicatorIconDefaults)},getDrawerBackground:e=>e.getOptions().styleDefaults._drawerDefaults.background,getDrawerHeaderBackground:e=>e.getOptions().styleDefaults._drawerDefaults.headerBackground,getDrawerBorderColor:e=>e.getOptions().styleDefaults._drawerDefaults.borderColor,getDrawerBorderRadius:e=>e.getOptions().styleDefaults._drawerDefaults.borderRadius,getDrawerLabelStyle:e=>e.getOptions().styleDefaults._drawerDefaults.labelStyle,getDrawerCountLabelStyle:e=>e.getOptions().styleDefaults._drawerDefaults.countLabelStyle,getDrawerCountBorderRadius:e=>e.getOptions().styleDefaults._drawerDefaults.countBorderRadius,getCategoryNodeLabelStyle:e=>e.getOptions().styleDefaults._categoryNodeDefaults.labelStyle,getNodeBorderRadius:e=>e.getOptions().styleDefaults.nodeDefaults._borderRadius,getNodeHoverColor:e=>e.getOptions().styleDefaults.nodeDefaults.hoverColor,getNodeSelectionColor:e=>e.getOptions().styleDefaults.nodeDefaults.selectionColor,getLabelHalign:(e,a)=>{var i=a.labelHalign;i||(i=e.getOptions().styleDefaults.cellDefaults.labelHalign);var o=t.Agent.isRightToLeft(e.getCtx());return"end"==i?o?t.OutputText.H_ALIGN_LEFT:t.OutputText.H_ALIGN_RIGHT:"center"==i?t.OutputText.H_ALIGN_CENTER:o?t.OutputText.H_ALIGN_RIGHT:t.OutputText.H_ALIGN_LEFT}};class u extends t.DataAnimationHandler{constructor(e,t,a,i){super(e,t),this._oldNBox=a,this._newNBox=i}getOldNBox(){return this._oldNBox}getNewNBox(){return this._newNBox}getAnimationDuration(){return h.getAnimDuration(this._oldNBox)}}u.DELETE=0,u.UPDATE=1,u.INSERT=2;const c={_MIN_CORNER_RADIUS:2.5,_ASPECT_RATIO_SCALING:"xMidYMid slice",render:(e,t,a,i)=>{c._renderNodeBackground(e,t,a,i),c._renderNodeIndicator(e,t,a,i),c._renderNodeIcon(e,t,a,i),c._renderNodeLabels(e,t,a,i),c._addAccessibilityAttr(a);var o=a.getChildContainer();o&&c._clip(e,o,i)},calculateNodeLayout:(e,a)=>{for(var i,o,n=e.getOptions(),r=parseInt(n.__layout.gridGap),l=n.__layout.nodeStartLabelGap,s=n.__layout.nodeLabelOnlyStartLabelGap,d=n.__layout.nodeEndLabelGap,u=n.__layout.nodeSwatchSize,C=parseInt(n.__layout.maximumLabelWidth),_=c._calculateSimpleNodeLayout(e),p=_.nodeHeight,b=_.indicatorSectionWidth,v=_.iconSectionWidth,f=b||v?l:s,x=g.getNode(e,0),y=h.getIndicatorIcon(e,x),m=h.getIcon(e,x),S=0,w=[],N=0,A=0,D=g.getMaximizedRow(e),I=g.getMaximizedCol(e),E=g.getRowCount(e),T=g.getColCount(e),O=0;O<E;O++)for(var M=0;M<T;M++)w.push({cellRows:0,cellColumns:0,overflow:!1});for(var R=[],L=g.getNodeCount(e),P=0;P<L;P++){var H=g.getNode(e,P);if(!g.isNodeHidden(e,H)){var F=g.getCellIndex(e,H);isNaN(R[F])&&(R[F]=0),R[F]++}}if(D&&I){var B=g.getColIdx(e,I)+T*g.getRowIndex(e,D),G=g.getCell(e,B).__childArea;if(null==(S=_.labelSectionWidth)){if("ifRequired"!=n.labelTruncation)S=C+f+d;else{var k=a[B];S=Math.max(C,c._getMaxLabelWidth(e,k))+f+d}S=Math.min(S,G.w-b-v)}if(A=Math.floor((G.w+r)/(b+v+S+r)),x.label){var z=new t.Container,U=!1,K=h.getNodeLabel(e,x),W=K.getDimensions().h;if(t.TextUtils.fitText(K,S-f-d,W,z)&&(U=!0),x.secondaryLabel){var j=h.getNodeSecondaryLabel(e,x),V=j.getDimensions().h;t.TextUtils.fitText(j,S-f-d,V,z)&&(U=!0)}U||(S=0,x.color&&(y&&!h.getNodeIndicatorColor(e,x)||m&&!m.source||(S=Math.max(0,Math.min(u,G.w-b-v)))))}if(G.w-b-v<0){var Y=v;v=Math.max(0,G.w-b)}G.w-b<0&&(b=G.w),w[B]={cellRows:-1,cellColumns:A,overflow:!1}}else{var X=[];if(D)for(var q=g.getRowIndex(e,D),J=0;J<T;J++)X.push(J+q*T);else if(I)for(var Q=g.getColIdx(e,I),Z=0;Z<E;Z++)X.push(Q+Z*T);else for(var $=0;$<w.length;$++)X.push($);if(null!=_.labelSectionWidth)S=_.labelSectionWidth,G=g.getCell(e,X[0]).__childArea,N=Math.floor((G.h+r)/(p+r)),A=Math.floor((G.w+r)/(b+v+S+r));else{for(var ee=0,te=0;te<X.length;te++)"number"==typeof R[X[te]]&&(R[X[te]]>R[ee]||"number"!=typeof R[ee])&&(ee=X[te]);if("ifRequired"!=n.labelTruncation)if(G=g.getCell(e,ee).__childArea,(i=Math.floor((G.h+r)/(p+r)))*(o=Math.floor((G.w+r)/(b+v+parseInt(n.__layout.minimumLabelWidth)+f+d+r)))<R[ee])S=Math.floor(Math.min(parseInt(n.__layout.maximumLabelWidth)+f+d,(G.w+r)/o-(b+v+r))),N=i,A=o;else{var ae=o;for(S=Math.floor(Math.min(parseInt(n.__layout.maximumLabelWidth)+f+d,(G.w+r)/ae-(b+v+r)));S<parseInt(n.__layout.maximumLabelWidth)+f+d&&(ae-1)*i>=R[ee];)ae--,S=Math.floor(Math.min(parseInt(n.__layout.maximumLabelWidth)+f+d,(G.w+r)/ae-(b+v+r)));N=i,A=ae}else{G=g.getCell(e,X[0]).__childArea,i=Math.floor((G.h+r)/(p+r)),o=Math.floor((G.w+r)/(b+v+parseInt(n.__layout.minimumLabelWidth)+f+d+r)),N=i;for(var ie=0,oe=0;A<=o;){A++;var ne=Math.floor((G.w+r)/A-(b+v+r));if(ie>ne){A=Math.max(A-1,1);break}for(var re=A*N,le=[],se=0;se<E;se++)for(var de=0;de<T;de++){if((x=a[g.getColIdx(e,de)+T*g.getRowIndex(e,se)])&&x.length){var ge=Math.min(x.length,re);x.length>re&&ge--;for(var he=oe;he<ge;he++)le.push(x[he])}}if((ie=Math.max(ie,Math.ceil(c._getMaxLabelWidth(e,le)+f+d)))>ne){A=Math.max(A-1,1);break}if(re>=R[ee])break;oe=re}(S=ie>(ne=Math.floor((G.w+r)/A-(b+v+r)))?ne:Math.max(ie,Math.min(ne,C+f+d)))<parseInt(n.__layout.minimumLabelWidth)&&(A=0)}}for(var ue=0;ue<X.length;ue++){var ce=X[ue],Ce=!1;R[ce]>N*A&&(Ce=!0),w[ce]={cellRows:N,cellColumns:A,overflow:Ce}}}var _e={nodeHeight:p,indicatorSectionWidth:b,iconSectionWidth:v,iconWidth:Y,labelSectionWidth:S,cellLayouts:w};return n.__layout.__nodeLayout=_e,_e},calculateNodeDrawerLayout:(e,a,i)=>{var o,n=e.getOptions(),r=parseInt(n.__layout.gridGap),l=n.__layout.nodeStartLabelGap,s=n.__layout.nodeLabelOnlyStartLabelGap,d=n.__layout.nodeEndLabelGap,u=n.__layout.nodeSwatchSize,C=parseInt(n.__layout.maximumLabelWidth),_=g.getNode(e,0),p=h.getIndicatorIcon(e,_),b=h.getIcon(e,_),v=c._calculateSimpleNodeLayout(e),f=v.nodeHeight,x=v.indicatorSectionWidth,y=v.iconSectionWidth,m=x||y?l:s,S=a.__childArea;null==(o=v.labelSectionWidth)&&(o="ifRequired"!=n.labelTruncation?C+m+d:Math.max(C,c._getMaxLabelWidth(e,i))+m+d,o=Math.min(o,S.w-x-y));var w=Math.floor((S.w+r)/(x+y+o+r));if(_.label){var N=new t.Container,A=!1,D=h.getNodeLabel(e,_),I=D.getDimensions().h;if(t.TextUtils.fitText(D,o-m-d,I,N)&&(A=!0),_.secondaryLabel){var E=h.getNodeSecondaryLabel(e,_),T=E.getDimensions().h;t.TextUtils.fitText(E,o-m-d,T,N)&&(A=!0)}A||(o=0,_.color&&(p&&!h.getNodeIndicatorColor(e,_)||b&&!b.source||(o=Math.max(0,Math.min(u,S.w-x-y)))))}if(S.w-x-y<0){var O=y;y=Math.max(0,S.w-x)}S.w-x<0&&(x=S.w);var M={nodeHeight:f,indicatorSectionWidth:x,iconSectionWidth:y,iconWidth:O,labelSectionWidth:o,drawerLayout:{rows:-1,columns:w}};return n.__layout.__nodeDrawerLayout=M,M},_calculateSimpleNodeLayout:e=>{var a=e.getOptions(),i=a.__layout.nodeIndicatorGap,o=parseInt(a.__layout.nodeSingleLabelGap),n=parseInt(a.__layout.nodeDualLabelGap),r=a.__layout.nodeInterLabelGap,l=a.__layout.nodeSwatchSize,s=g.getNode(e,0),d=0,u=0,c=0,C=null,_=h.getIndicatorIcon(e,s),p=h.getNodeIndicatorColor(e,s),b=h.getIcon(e,s);if(_){var v=_.width,f=_.height;u=v+2*i,d=Math.max(d,f+2*i)}else p&&(u=l);if(s.label){var x=h.getNodeLabel(e,s).getDimensions().h;if(d=Math.max(d,x+2*o),s.secondaryLabel){var y=h.getNodeSecondaryLabel(e,s).getDimensions().h;d=Math.max(d,x+y+2*n+r)}}else C=0,s.color&&(_&&!h.getNodeIndicatorColor(e,s)||b&&!b.source||(C=u||l));if(b){var m=t.Agent.isTouchDevice()?b.preferredSizeTouch:b.preferredSize,S=Math.max(d,s.label?m:parseInt(b.preferredSizeNoLabel)),w=(b.source?b.sourcePaddingRatio:b.shapePaddingRatio)*S,N=b.width?b.width:S-2*w,A=b.height?b.height:S-2*w;c=N+2*w,d=Math.max(d,A+2*w)}return{nodeHeight:d,indicatorSectionWidth:u,iconSectionWidth:c,labelSectionWidth:C}},_renderNodeBackground:(e,a,i,o)=>{var n=o.indicatorSectionWidth+o.iconSectionWidth+o.labelSectionWidth,r=o.nodeHeight,l=h.getNodeBorderRadius(e),d=h.getNodeHoverColor(e),g=h.getNodeSelectionColor(e),u=new t.Rect(e.getCtx(),0,0,n,r);u.setFill(null),l&&(u.setRx(l),u.setRy(l)),u.setHoverStroke(new t.Stroke(d,1,2),new t.Stroke(g,1,4)),u.setSelectedStroke(new t.Stroke(g,1,4),null),u.setSelectedHoverStroke(new t.Stroke(d,1,2),new t.Stroke(g,1,6)),i.addChild(u),i.setSelectionShape(u);var c=new t.Rect(e.getCtx(),0,0,n,r);l&&(c.setRx(l),c.setRy(l));var C=h.getNodeColor(e,a);c.setSolidFill(C),h.getNodeBorderColor(e,a)&&h.getNodeBorderWidth(e,a)&&c.setSolidStroke(h.getNodeBorderColor(e,a),null,h.getNodeBorderWidth(e,a));var _=a.svgStyle||a.style,p=a.svgClassName||a.className;c.setStyle(_).setClassName(p),i.addChild(c),s(e,a,c,"background")},_renderNodeIndicator:(e,a,i,o)=>{var n=h.getNodeColor(e,a),r=t.ColorUtils.getContrastingTextColor(n),l=t.Agent.isRightToLeft(e.getCtx())?o.labelSectionWidth+o.iconSectionWidth:0,d=h.getNodeIndicatorColor(e,a);if(d){r=t.ColorUtils.getContrastingTextColor(d);var g=new t.Rect(e.getCtx(),l,0,o.indicatorSectionWidth,o.nodeHeight);g.setSolidFill(d),c._clip(e,g,o),i.addChild(g),s(e,a,g,"indicator")}var u=h.getIndicatorIcon(e,a);if(u){var C,_=u.width,p=u.height,b=l+o.indicatorSectionWidth/2,v=o.nodeHeight/2,f=_,x=u.color?u.color:r,y=u.borderColor,m=u.borderWidth,S=u.borderRadius,w=u.pattern;u.source?(C=new t.ImageMarker(e.getCtx(),b,v,_,p,S,u.source)).setPreserveAspectRatio(c._ASPECT_RATIO_SCALING):(C=new t.SimpleMarker(e.getCtx(),u.shape,b,v,_,p,S),m>0&&(f+=m)),m&&C.setSolidStroke(y,null,m),"none"!=w?C.setFill(new t.PatternFill(w,x,n)):C.setSolidFill(x);var N=u.svgStyle||u.style,A=u.svgClassName||u.className;if(C.setStyle(N).setClassName(A),f>o.indicatorSectionWidth)if(S&&u.source)i.getChildContainer(!0).addChild(C);else c._clip(e,C,o),i.addChild(C);else i.addChild(C);s(e,a,C,"indicatorIcon")}},_renderNodeIcon:(e,a,i,n)=>{var l=e.getOptions(),d=h.getNodeColor(e,a),g=t.ColorUtils.getContrastingTextColor(d),u=t.Agent.isRightToLeft(e.getCtx()),C=h.getIcon(e,a);if(C){var _,p,b=(C.source||C.initials?C.sourcePaddingRatio:C.shapePaddingRatio)*n.nodeHeight,v=n.iconWidth?n.iconWidth:n.iconSectionWidth-2*b,f=C.width?C.width:v,x=C.height?C.height:n.nodeHeight-2*b,y=n[u?"labelSectionWidth":"indicatorSectionWidth"]+Math.max(n.iconSectionWidth/2,n.iconWidth?n.iconWidth/2:0),m=n.nodeHeight/2,S=C.color?C.color:g,w=C.borderColor,N=C.borderWidth,A=C.borderRadius,D=C.pattern,I=C.source,E=l._resources["background_"+C.background];if(I)(_=new t.ImageMarker(e.getCtx(),y,m,f,x,A,I)).setPreserveAspectRatio(c._ASPECT_RATIO_SCALING);else if(C.initials){var T=E.src,O=t.ToolkitUtils.getImageUrl(e.getCtx(),T).includes(".");_=new t.SimpleMarker(e.getCtx(),null,y,m,f,x);var M=C.background;if(_.setClassName("oj-nbox-node-initials-bg-color"+("neutral"===M?" oj-nbox-node-initials-neutral":" oj-avatar-bg-"+M+" oj-nbox-node-initials-"+M)),O){var R="ios"===t.Agent.os,L=new t.Container(e.getCtx()),P=R?C.backgroundIosSize:C.backgroundSize,H=new t.ImageMarker(e.getCtx(),y,m,parseInt(P),parseInt(P),A,E.src);H.setClipPath(c._getIconClipPath(e,y,m,f,x)),L.addChild(_),L.addChild(H),H.setClassName(R?"oj-nbox-node-initials-background-pattern oj-nbox-ios":"oj-nbox-node-initials-background-pattern"),_=L}p=o(e.getCtx(),C.initials,null,t.OutputText.H_ALIGN_CENTER,t.OutputText.V_ALIGN_CENTRAL),r(p,y,m),a.label&&!a.secondaryLabel||!a.label&&parseInt(l.styleDefaults.nodeDefaults.height)>0?p.setClassName("oj-nbox-node-initials"):p.setClassName("oj-nbox-node-initials oj-nbox-node-initials-lg")}else _=new t.SimpleMarker(e.getCtx(),C.shape,y,m,f-N,x-N,A);if(N&&_.setSolidStroke(w,null,N),"none"!=D?_.setFill(new t.PatternFill(D,S,d)):_.setSolidFill(S),!C.initials){var F=C.svgStyle||C.style,B=C.svgClassName||C.className;_.setStyle(F).setClassName(B)}if(0==n.indicatorSectionWidth||0==n.labelSectionWidth)if(A&&C.source)i.getChildContainer(!0).addChild(_);else c._clip(e,_,n),i.addChild(_);else i.addChild(_);s(e,a,_,"icon"),p&&i.addChild(p)}},_renderNodeLabels:(e,a,i,o)=>{var n=e.getOptions(),l=n.__layout.nodeInterLabelGap,d=n.__layout.nodeLabelOnlyStartLabelGap,g=n.__layout.nodeStartLabelGap,u=n.__layout.nodeEndLabelGap,c=o.indicatorSectionWidth||o.iconSectionWidth?g:d,C=h.getNodeColor(e,a),_=t.ColorUtils.getContrastingTextColor(C),p=t.Agent.isRightToLeft(e.getCtx())?o.labelSectionWidth-c:o.indicatorSectionWidth+o.iconSectionWidth+c;if(a.label){var b=h.getNodeLabel(e,a),v=b.getDimensions().h;if(t.TextUtils.fitText(b,o.labelSectionWidth-c-u,v,i)&&(r(b,p,o.nodeHeight/2),b.getCSSStyle()&&b.getCSSStyle().getStyle("color")?b.setSolidFill(b.getCSSStyle().getStyle("color")):b.setSolidFill(_),s(e,a,b,"label")),a.secondaryLabel){var f=h.getNodeSecondaryLabel(e,a),x=f.getDimensions().h;if(t.TextUtils.fitText(f,o.labelSectionWidth-c-u,x,i)){var y=(o.nodeHeight-v-x-l)/2;r(b,p,y+v/2),r(f,p,y+v+l+x/2),f.getCSSStyle()&&f.getCSSStyle().getStyle("color")?f.setSolidFill(f.getCSSStyle().getStyle("color")):f.setSolidFill(_),s(e,a,f,"secondaryLabel")}}}},_getMaxLabelWidth:(e,a)=>{for(var i=[],o=0;o<a.length;o++){var n=a[o];i.push(h.getNodeLabel(e,n)),i.push(h.getNodeSecondaryLabel(e,n))}return t.TextUtils.getMaxTextDimensions(i).w},_clip:(e,a,i)=>{var o=e.getNodeClipPath();if(!o){var n=h.getNodeBorderRadius(e);if(!(n=n<c._MIN_CORNER_RADIUS?0:n))return;var r=i.indicatorSectionWidth+i.iconSectionWidth+i.labelSectionWidth,l=i.nodeHeight;(o=new t.ClipPath).addRect(0,0,r,l,n,n),e.setNodeClipPath(o)}a.setClipPath(o)},_getIconClipPath:(e,a,i,o,n)=>{var r=e.getNodeIconClipPath();return r||((r=new t.ClipPath).addRect(a-o/2,i-n/2,o,n),e.setNodeIconClipPath(r)),r},animateUpdate:(e,a,i)=>{var o=e.getOldNBox(),r=e.getNewNBox(),l=n(a),s=n(i),h=i.getMatrix(),C=i.getParent();a.setAlpha(0),e.getNewNBox().addChild(i),i.setMatrix(l);var _=g.getNodeScrollableContainer(o,a),p=g.getNodeScrollableContainer(r,i);if(_||p){var b,v=new t.ClipPath;if(_){var f=n(_),x=new t.Rectangle(f.getTx(),f.getTy(),_.getWidth(),_.getHeight()),y=g.getCellIndex(o,a.getData()),m=g.getCell(o,y),S=d(o,m,"background"),w=n(S),N=new t.Rectangle(w.getTx(),w.getTy(),S.getWidth(),S.getHeight());b=x.getUnion(N)}if(p){var A=n(p),D=new t.Rectangle(A.getTx(),A.getTy(),p.getWidth(),p.getHeight()),I=g.getCellIndex(r,i.getData()),E=g.getCell(r,I),T=d(r,E,"background"),O=n(T),M=new t.Rectangle(O.getTx(),O.getTy(),T.getWidth(),T.getHeight()),R=D.getUnion(M);b=b?b.getUnion(R):R}b&&(v.addRect(b.x,b.y,b.w,b.h),i.setClipPath(v))}var L=new t.AnimMoveTo(i.getCtx(),i,new t.Point(s.getTx(),s.getTy()),e.getAnimationDuration());t.Playable.appendOnEnd(L,()=>{C.addChild(i),i.setMatrix(h),i.setClipPath(null)}),e.add(L,u.UPDATE);var P=new t.CustomAnimation(r.getCtx(),i,e.getAnimationDuration());c._animateFill(P,o,r,a,i,"background"),c._animateFill(P,o,r,a,i,"label"),c._animateFill(P,o,r,a,i,"secondaryLabel"),c._animateFill(P,o,r,a,i,"indicator"),c._animateFill(P,o,r,a,i,"indicatorIcon"),c._animateFill(P,o,r,a,i,"icon"),e.add(P,u.UPDATE)},_animateFill:(e,a,i,o,n,r)=>{var l=d(a,o.getData(),r),s=d(i,n.getData(),r);l&&s&&s.getFill()instanceof t.SolidFill&&!s.getFill().equals(l.getFill())&&(e.getAnimator().addProp(t.Animator.TYPE_FILL,s,s.getFill,s.setFill,s.getFill()),s.setFill(l.getFill()))},animateDelete:(e,a)=>{var i=u.DELETE,o=e.getOldNBox(),r=e.getNewNBox(),l=o.getOptions().__layout.__nodeLayout;if(l){var s=a.getData(),h=s.id,c=g.getNodeIndex(r,h);if(!isNaN(c)){var C=g.getNode(r,c);if(!g.isNodeHidden(r,C))if(i=u.UPDATE,g.getGrouping(r)){var _=r.getOptions().__groups;"withinCell"==g.getGroupBehavior(r)&&(_=_[g.getCellIndex(r,C)]);var p=_[g.getNodeGroupId(C)];if(p){var b=d(r,p);if(b){var v=n(b),f=new t.Point((l.indicatorSectionWidth+l.iconSectionWidth+l.labelSectionWidth)/2,l.nodeHeight/2);e.add(new t.AnimMoveTo(r.getCtx(),a,new t.Point(v.getTx()-f.x,v.getTy()-f.y),e.getAnimationDuration()),i)}}}else if(s.row!=C.row||s.column!=C.column){var x=n(a),y=a.getDimensions();e.getNewNBox().addChild(a),a.setMatrix(x);var m=g.getCellByRowCol(r,C.row,C.column),S=d(r,m.getData(),"overflow");if(S){var w=n(S);e.add(new t.AnimMoveTo(r.getCtx(),a,new t.Point(w.getTx(),w.getTy()),e.getAnimationDuration()),u.UPDATE)}else{var N=n(m),A=m.getDimensions(),D=new t.Point((l.indicatorSectionWidth+l.iconSectionWidth+l.labelSectionWidth)/2,l.nodeHeight/2);e.add(new t.AnimMoveTo(r.getCtx(),a,new t.Point(N.getTx()+A.w/2-D.x,N.getTy()+A.h/2-D.y),e.getAnimationDuration()),u.UPDATE)}var I=new t.CustomAnimation(r.getCtx(),C,e.getAnimationDuration());return I.getAnimator().addProp(t.Animator.TYPE_NUMBER,a,a.getScaleX,a.setScaleX,.01),I.getAnimator().addProp(t.Animator.TYPE_NUMBER,a,a.getScaleY,a.setScaleY,.01),t.Playable.appendOnEnd(I,()=>{r.getDeleteContainer().addChild(a)}),e.add(I,u.INSERT),e.add(new t.AnimMoveBy(r.getCtx(),a,new t.Point(y.w/2,y.h/2),e.getAnimationDuration()),u.INSERT),void e.add(new t.AnimFadeOut(r.getCtx(),a,e.getAnimationDuration()),u.INSERT)}}a.setMatrix(n(a));var E=g.getNodeScrollableContainer(o,a);if(E){var T=new t.ClipPath,O=n(E),M=new t.Rectangle(O.getTx(),O.getTy(),E._width,E._height);T.addRect(M.x,M.y,M.w,M.h),a.setClipPath(T)}e.add(new t.AnimFadeOut(r.getCtx(),a,e.getAnimationDuration()),i),r.getDeleteContainer().addChild(a)}},animateInsert:(e,a)=>{var i=u.INSERT,o=e.getOldNBox(),r=e.getNewNBox(),l=r.getOptions().__layout.__nodeLayout;if(l){var s=a.getData().id,h=g.getNodeIndex(o,s);if(!isNaN(h)){var c=g.getNode(o,h);if(!g.isNodeHidden(o,c)&&(i=u.UPDATE,g.getGrouping(o))){var C=o.getOptions().__groups;"withinCell"==g.getGroupBehavior(o)&&(C=C[g.getCellIndex(o,c)]);var _=C[g.getNodeGroupId(c)];if(_){var p=d(o,_);if(p){var b=a.getMatrix(),v=a.getParent(),f=n(a),x=n(p),y=new t.Point((l.indicatorSectionWidth+l.iconSectionWidth+l.labelSectionWidth)/2,l.nodeHeight/2);r.addChild(a),a.setMatrix(x.translate(-y.x,-y.y));var m=new t.AnimMoveTo(r.getCtx(),a,new t.Point(f.getTx(),f.getTy()),e.getAnimationDuration());t.Playable.appendOnEnd(m,()=>{a.setMatrix(b),v.addChild(a)}),e.add(m,i)}}}}var S=new t.CustomAnimation(r.getCtx(),a,e.getAnimationDuration());S.getAnimator().addProp(t.Animator.TYPE_NUMBER,a,a.getAlpha,a.setAlpha,a.getAlpha()),e.add(S,i),a.setAlpha(0)}},_addAccessibilityAttr:e=>{if(e.setAriaRole("img"),!t.Agent.deferAriaCreation()){var a=e.getAriaLabel();a&&e.setAriaProperty("label",a)}}};class C extends t.Container{constructor(e,a){super(e.getCtx(),null,a.id),this._nbox=e,this._data=a,this._nbox.registerObject(this);var i=this._nbox.getOptions().selectionMode;"single"!=i&&"multiple"!=i||this.setCursor(t.SelectionEffectUtils.getSelectingCursor()),this._maxAlpha=1,this.nboxType="node"}getData(){return this._data}render(e,t){c.render(this._nbox,this._data,this,t),this._nodeLayout=t,e.addChild(this),s(this._nbox,this._data,this),this._setDraggableStyleClass(),this._nbox.EventManager.associate(this,this)}isSelectable(){return!0}isSelected(){return this.getSelectionShape().isSelected()}setSelected(e){this.getSelectionShape().setSelected(e),this.UpdateAccessibilityAttr()}showHoverEffect(){this.getSelectionShape().showHoverEffect()}hideHoverEffect(){this.getSelectionShape().hideHoverEffect()}setSelectionShape(e){this._selectionShape=e}getSelectionShape(){return this._selectionShape}getDatatip(){var e=this._nbox.getOptions().tooltip,a=e?e.renderer:null;if(a){var i=this.getDataContext();return this._nbox.getCtx().getTooltipManager().getCustomTooltip(a,i)}return t.Displayable.resolveShortDesc(this.getShortDesc(),()=>C.getShortDescContext(this))}getDataContext(){return{id:this._data.id,label:this._data.label,secondaryLabel:this._data.secondaryLabel,row:this._data.row,column:this._data.column,color:h.getNodeColor(this._nbox,this._data),indicatorColor:h.getNodeIndicatorColor(this._nbox,this._data)}}getShortDesc(){return this._data.shortDesc}getDatatipColor(){return h.getNodeColor(this._nbox,this._data)}setMaxAlpha(e){this._maxAlpha=e,this.setAlpha(this.getAlpha())}getMaxAlpha(){return this._maxAlpha}setAlpha(e){super.setAlpha(Math.min(e,this._maxAlpha))}animateUpdate(e,t){c.animateUpdate(e,t,this)}animateDelete(e){c.animateDelete(e,this)}animateInsert(e){c.animateInsert(e,this)}isDoubleClickable(){return!0}handleDoubleClick(){this._getParentContainer().handleDoubleClick()}isDragAvailable(e){return this._nbox.__isDragAvailable(e)}getDragTransferable(){return this._nbox.__getDragTransferable(this)}getDragFeedback(){return this._nbox.__getDragFeedback()}getParentCell(){return this._getParentContainer()}_getParentContainer(){var e,t=g.getDrawer(this._nbox);if(t)e=d(this._nbox,t);else{var a=g.getCellIndex(this._nbox,this._data),i=g.getCell(this._nbox,a);e=d(this._nbox,i)}return e}UpdateAccessibilityAttr(){if(!t.Agent.deferAriaCreation()){var e=this.getAriaLabel();e&&this.setAriaProperty("label",e)}}getAriaLabel(){return g.buildAriaDesc(this._nbox,this,this.getShortDesc(),this.isSelected(),()=>C.getShortDescContext(this))}static getShortDescContext(e){var t=e.getData();return{id:t.id,label:t.label,secondaryLabel:t.secondaryLabel,row:t.row,column:t.column}}getCategories(){return this.getData().categories?this.getData().categories:[]}getKeyboardBoundingBox(){return i(this)}getTargetElem(){return this.getElem()}showKeyboardFocusEffect(){this._isShowingKeyboardFocusEffect=!0,this.showHoverEffect();var e=g.getNodeScrollableContainer(this._nbox,this);e&&e.scrollIntoView(this)}hideKeyboardFocusEffect(){this._isShowingKeyboardFocusEffect=!1,this.hideHoverEffect()}isShowingKeyboardFocusEffect(){return this._isShowingKeyboardFocusEffect}getNextNavigable(e){var a=null;return e.keyCode==t.KeyboardEvent.SPACE&&e.ctrlKey?this:(this._nbox.EventManager.getKeyboardHandler().isNavigationEvent(e)?a=e.keyCode==t.KeyboardEvent.CLOSE_BRACKET?this._getParentContainer():e.keyCode==t.KeyboardEvent.OPEN_BRACKET?this:g.getNextNavigableNode(this,e):e.type==t.MouseEvent.CLICK&&(a=this),a)}HandleKeyboardEvent(e){if(g.getDrawer(this._nbox)&&e.keyCode==t.KeyboardEvent.ESCAPE)this.handleDoubleClick();else{var a=g.getMaximizedRow(this._nbox),i=g.getMaximizedCol(this._nbox),o=a==this._data.row&&i==this._data.column;(!o&&e.keyCode==t.KeyboardEvent.ENTER||o&&e.keyCode==t.KeyboardEvent.ESCAPE)&&this.handleDoubleClick()}}getDisplayable(){return this}getKeyboardFocusDisplayable(){var e=g.getNode(this._nbox,g.getNodeIndex(this._nbox,this.getData().id));if(e){var t=d(this._nbox,e);if(t)return t;var a=g.getCell(this._nbox,g.getCellIndex(this._nbox,e)),i=d(this._nbox,a),o=g.getLastNavigableNode(i.getChildContainer());if(null!==o&&"overflow"===o.nboxType)return o;var n=this._getParentDrawer();return n?n.getKeyboardFocusDisplayable():i.getKeyboardFocusDisplayable()}return null}_getParentDrawer(){for(var e=this;e&&e.getParent;)if((e=e.getParent())&&"drawer"===e.nboxType)return e;return null}getChildContainer(e){return!e||this._childContainer||(this._childContainer=new t.Container(this.getCtx()),this.addChild(this._childContainer)),this._childContainer}setChildContainer(e){this._childContainer=e}_setDraggableStyleClass(){this._nbox.getOptions().dnd&&t.ToolkitUtils.addClassName(this.getElem(),"oj-draggable")}}class _ extends t.KeyboardHandler{constructor(e,t){super(e),this._nbox=t}processKeyDown(e){var a=e.keyCode,i=this._nbox.getOptions().dataTransferOptions,o=this._eventManager.getFocus();if(a==t.KeyboardEvent.TAB){var n=null;if(t.EventManager.consumeEvent(e),o)n=o;else{var r=g.getDrawer(this._nbox);if(r)n=d(this._nbox,r);else if("acrossCells"==g.getGroupBehavior(this._nbox)){var l=this._nbox.getOptions().__groups;if(l){var s=[];for(var h in l){var u=d(this._nbox,l[h]);u&&s.push(u)}n=_.getNextNavigableCategoryNode(null,e,s)}}if(!n){var c=g.getColCount(this._nbox)*(g.getRowCount(this._nbox)-1);n=d(this._nbox,g.getCell(this._nbox,c))}}return n}if(a==t.KeyboardEvent.X&&e.ctrlKey&&"enable"===i.cut||a==t.KeyboardEvent.C&&e.ctrlKey&&"enable"===i.copy){var p=[],b=[];if(this._nbox.isSelectionSupported()&&this._nbox.getSelectionHandler().getSelectedCount()>1)for(var v=this._nbox.getSelectionHandler().getSelection(),f=0;f<v.length;f++)v[f]instanceof C&&(p.push(v[f]),b.push(v[f].getDataContext()));else o instanceof C&&(p.push(o),b.push(o.getDataContext()));return a==t.KeyboardEvent.X?(e=new t.EventFactory.newEvent("cutRequest"),this._nbox.setActiveCut(p)):a==t.KeyboardEvent.C&&(e=new t.EventFactory.newEvent("copyRequest")),e&&(e.source=b,this._nbox.dispatchEvent(e)),null}if(a==t.KeyboardEvent.V&&e.ctrlKey&&"enable"===i.paste){if(o&&o.getData().row){var x=o.getData(),y={column:x.column,row:x.row};(e=new t.EventFactory.newEvent("pasteRequest")).target=y,this._nbox.setActiveCut(null),this._nbox.dispatchEvent(e)}return null}return a==t.KeyboardEvent.ESCAPE&&this._nbox.getActiveCut()?(this._nbox.setActiveCut(null),null):super.processKeyDown(e)}isSelectionEvent(e){return e.keyCode!=t.KeyboardEvent.TAB&&(this.isNavigationEvent(e)&&!e.ctrlKey)}isMultiSelectEvent(e){return e.keyCode==t.KeyboardEvent.SPACE&&e.ctrlKey}isNavigationEvent(e){var a=!1;switch(e.keyCode){case t.KeyboardEvent.OPEN_BRACKET:case t.KeyboardEvent.CLOSE_BRACKET:a=!0;break;default:a=super.isNavigationEvent(e)}return a}static getNextNavigableCategoryNode(e,a,i){if(!i||i.length<=0)return null;if("categoryNode"===i[0].nboxType&&i.sort((e,t)=>g.compareCategoryNodeSize(e.getData(),t.getData())),null==e)return i[0];for(var o=e,n=a.keyCode==t.KeyboardEvent.RIGHT_ARROW||a.keyCode==t.KeyboardEvent.DOWN_ARROW,r=i.length,l=0;l<r;l++){if(i[l]===e){o=i[n?l+1<r?l+1:l:l-1>=0?l-1:l];break}}return o}static getNextNavigableCell(e,a,i,o){if(!i||0===i.length)return null;var n=parseInt(e.getData().row),r=parseInt(e.getData().column),l=g.getRowCount(o),s=g.getColCount(o);const d=(e,t)=>(t+e)%t;return a.keyCode==t.KeyboardEvent.RIGHT_ARROW?r=d(r+1,s):a.keyCode==t.KeyboardEvent.LEFT_ARROW?r=d(r-1,s):n=a.keyCode==t.KeyboardEvent.UP_ARROW?d(n+1,l):d(n-1,l),g.getCellByRowCol(o,n,r)}}const p={render:(e,a,i,o)=>{var n=e.getOptions(),r=parseInt(n.__layout.cellGap),l=parseInt(n.__layout.cellInnerPadding),d=p.getCellLayout(e),u=g.getRowIndex(e,a.row),c=g.getColIdx(e,a.column),C=p.getCellDims(e,u,c,o);i.setTranslate(C.x+r/2,C.y+r/2);var _=u*g.getColCount(e)+c,b=new t.Rect(e.getCtx(),0,0,Math.max(C.w-r,0),Math.max(C.h-r,0));b.setPixelHinting(!0);var v=h.getCellStyle(e,_);p._applyStyleToRect(b,v);var f=h.getCellBorderRadius(e);b.setRx(f),b.setRy(f);var x=h.getCellStyleObject(e,_);b.setStyle(x);var y=h.getCellClassName(e,_);b.setClassName(y),i.addChild(b);var m=e.getCellFilter();void 0===m&&(m=p._createShadow(n.styleDefaults.cellDefaults._panelShadow),e.setCellFilter(m)),m&&b.addDrawEffect(m),s(e,a,b,"background");var S=new t.KeyboardFocusEffect(e.getCtx(),i,new t.Rectangle(-1,-1,b.getWidth()+2,b.getHeight()+2));s(e,a,S,"focusEffect"),s(e,a,S,"dragEffect"),p.renderHeader(e,a,i,!1,_);var w=g.isCellMaximized(e,_),N=w?d.maximizedHeaderSize:d.headerSize,A=w?d.maximizedLabelHeight:d.labelHeight,D=w?new t.SimpleScrollableContainer(e.getCtx(),b.getWidth(),b.getHeight()-N):new t.Container(e.getCtx());i.addChild(D),i.setChildContainer(D);var I=null;A?(I=p._isLabelVertical(e,a)?new t.Rectangle(N,l,b.getWidth()-N-l,b.getHeight()-l-l):new t.Rectangle(l,N,b.getWidth()-l-l,b.getHeight()-N-l),D instanceof t.SimpleScrollableContainer&&D.setTranslate(0,N)):I=new t.Rectangle(l,l,b.getWidth()-l-l,b.getHeight()-l-l),I.w=Math.max(I.w,0),I.h=Math.max(I.h,0),a.__childArea=I},renderHeader:(e,a,i,n,l)=>{var u=d(e,a,"label");u&&(u.getParent().removeChild(u),s(e,a,null,"label"));var c=d(e,a,"countLabel");c&&(c.getParent().removeChild(c),s(e,a,null,"countLabel"));var C=d(e,a,"closeButton");C&&(C.getParent().removeChild(C),s(e,a,null,"closeButton"));var _=!1;if(a){var b,v=e.getOptions(),f=v.__layout.countLabelGap,x=v.__layout.cellCloseGap,y=parseInt(v.__layout.cellInnerPadding),m=p.getCellLayout(e),S=g.getCellCounts(e),w=d(e,a,"background"),N=g.getRowIndex(e,a.row),A=g.getColIdx(e,a.column),D=N*g.getColCount(e)+A,I=t.Agent.isRightToLeft(e.getCtx()),E=0;if(g.isCellMaximized(e,D)){var T=v._resources.close,O=T.width;if(w.getWidth()-y-y>O){var M=e.getCtx(),R=t.ToolkitUtils.getIconStyle(M,T.class),L=new t.IconButton(M,"borderless",{style:R,size:O},null,null,i.handleDoubleClick,i),P=I?Math.min((w.getWidth()-O)/2,y):Math.max((w.getWidth()-O)/2,w.getWidth()-y-O);L.setTranslate(P,y),i.addChild(L),E=O+x,s(e,a,L,"closeButton"),_=!0}}if(a.label){var H=m.labelHeight,F=!1,B=h.getLabelHalign(e,a),G=0,k=null,z=0,U=0,K=null,W=h.getCellShowCount(e,a);if(!n&&"off"!=W){var j=d(e,a).getCountLabel();j?K=j:"on"==W&&(K=""+S.total[D],S.highlighted&&(K=t.ResourceUtils.format(v.translations.highlightedCount,[S.highlighted[D],K])))}if(p._isLabelVertical(e,a)){if(K&&((k=o(e.getCtx(),K,h.getCellCountLabelStyle(e,D),t.OutputText.H_ALIGN_CENTER,t.OutputText.V_ALIGN_CENTRAL)).setClassName("oj-typography-semi-bold"),t.TextUtils.fitText(k,w.getHeight()-y-y,w.getWidth()-2*y,i)?(s(e,a,k,"countLabel"),_=!0,G=k.getDimensions().w+f,U=w.getHeight()/2,z=w.getWidth()/2):F=!0),b=0,!F){var V=o(e.getCtx(),a.label,h.getCellLabelStyle(e,D),t.OutputText.H_ALIGN_CENTER,t.OutputText.V_ALIGN_CENTRAL);if(t.TextUtils.fitText(V,w.getHeight()-y-y-G,w.getWidth()-2*y,i)){s(e,a,V,"label");var Y=V.getDimensions().w;_=!0,r(V,w.getWidth()/2,(w.getHeight()+G)/2,I?Math.PI/2:-Math.PI/2),b=(Y+f)/2}}k&&r(k,z,U-=b,I?Math.PI/2:-Math.PI/2)}else{if(K&&((k=o(e.getCtx(),K,h.getCellCountLabelStyle(e,D),B,t.OutputText.V_ALIGN_CENTRAL)).setClassName("oj-typography-semi-bold"),t.TextUtils.fitText(k,w.getWidth()-y-y-E,w.getHeight()-2*y,i)?(s(e,a,k,"countLabel"),_=!0,G=k.getDimensions().w+f,z=B==t.OutputText.H_ALIGN_CENTER?w.getWidth()/2:B==t.OutputText.H_ALIGN_RIGHT?w.getWidth()-y:y,U=g.isCellMinimized(e,D)?w.getHeight()/2:y+H/2,r(k,z,U)):F=!0),b=0,!F){var X=o(e.getCtx(),a.label,h.getCellLabelStyle(e,D),B,t.OutputText.V_ALIGN_CENTRAL);if(t.TextUtils.fitText(X,w.getWidth()-y-y-E-G,w.getHeight()-2*y,i)){s(e,a,X,"label");var q,J=X.getDimensions().w;_=!0,B==t.OutputText.H_ALIGN_CENTER?(q=(w.getWidth()-(I?-1:1)*G)/2,b=(I?-1:1)*(J+f)/2):B==t.OutputText.H_ALIGN_RIGHT?(q=w.getWidth()-y-(I?0:1)*G,b=(I?-1:0)*(J+f)):(q=y+(I?1:0)*G,b=(I?0:1)*(J+f));var Q=g.isCellMinimized(e,D)?w.getHeight()/2:y+H/2;r(X,q,Q)}}k&&b&&r(k,z+b,U)}}}var Z=g.isCellMinimized(e,l);return p._addAccessibilityAttr(e,a,i,Z?"button":"group"),_},renderBodyCountLabels:(e,a)=>{var i=parseInt(e.getOptions().__layout.cellInnerPadding),n=p.getCellLayout(e),l=g.getCellCounts(e),u=Number.MAX_VALUE,c=!1,C=g.getCell(e,a[0]),_=d(e,C,"label"),b=d(e,C,"countLabel"),v=_&&_.getCSSStyle()?_.getCSSStyle().getFontSize():null,f=b&&b.getCSSStyle()?b.getCSSStyle().getFontSize():null;if(v=isNaN(v)?parseFloat(v):v,f=isNaN(f)?parseFloat(f):f,!isNaN(v)||!isNaN(f)){var x=isNaN(f)?v:Math.max(v,f);u=isNaN(v)?f:x}for(var y,m,S=[],w=[],N=0;N<a.length;N++)y=a[N],g.isCellMinimized(e,y)?w.push(y):S.push(y);for(var A=[],D=[],I=0;I<S.length;I++)y=S[I],m=l.total[y],A[I]=o(e.getCtx(),""+m,h.getCellBodyCountLabelStyle(e),t.OutputText.H_ALIGN_CENTER,t.OutputText.V_ALIGN_CENTRAL);for(var E=0;E<w.length;E++)y=w[E],m=l.total[y],D[E]=o(e.getCtx(),""+m,h.getCellBodyCountLabelStyle(e),t.OutputText.H_ALIGN_CENTER,t.OutputText.V_ALIGN_CENTRAL);var T=p.getBodyCountLabelsFontSize(e,S,A);(T<=u||b&&!_)&&(c=!0);var O,M=p.getBodyCountLabelsFontSize(e,w,D);if((M<=u||b&&!_)&&(c=!0),c){for(var R=0;R<a.length;R++){C=g.getCell(e,a[R]),_=d(e,C,"label"),b=d(e,C,"countLabel");var L=C.__childArea,P=!1;_&&(_.getParent().removeChild(_),s(e,C,null,"label"),P=!0),b&&(b.getParent().removeChild(b),s(e,C,null,"countLabel"),P=!0),P&&(p._isLabelVertical(e,C)?(L.x-=n.headerSize-i,L.w+=n.headerSize-i):(L.y-=n.headerSize-i,L.h+=n.headerSize-i),C.__childArea=L)}T=p.getBodyCountLabelsFontSize(e,S,A),M=p.getBodyCountLabelsFontSize(e,w,D)}for(var H=0;H<S.length;H++)y=S[H],C=g.getCell(e,y),O=d(e,C),L=C.__childArea,A[H].setFontSize(T),t.TextUtils.fitText(A[H],L.w,L.h,O)&&(c||p.renderHeader(e,C,O,!0,y),r(A[H],L.x+L.w/2,L.y+L.h/2)),p._addAccessibilityAttr(e,C,O,"button");for(var F=0;F<w.length;F++)y=w[F],C=g.getCell(e,y),O=d(e,C),L=C.__childArea,D[F].setFontSize(M),t.TextUtils.fitText(D[F],L.w,L.h,O)&&(c||p.renderHeader(e,C,O,!0,y),r(D[F],L.x+L.w/2,L.y+L.h/2)),p._addAccessibilityAttr(e,C,O,"button")},getBodyCountLabelsFontSize:(e,a,i)=>{for(var o=Number.MAX_VALUE,n=0;n<a.length;n++){var r=g.getCell(e,a[n]).__childArea;o=Math.min(o,parseInt(t.TextUtils.getOptimalFontSize(i[n].getCtx(),i[n].getTextString(),i[n].getCSSStyle(),r)))}return o},_isLabelVertical:(e,t)=>{var a=g.getMaximizedCol(e),i=g.getMaximizedRow(e);return!(!a||a==t.column||i&&i!=t.row)},getCellDims:(e,a,i,o)=>{var n=e.getOptions(),r=parseInt(n.__layout.cellGap),l=p.getCellLayout(e),s=t.Agent.isRightToLeft(e.getCtx()),d=r+parseInt(l.minimumCellSize),h=g.getRowCount(e),u=g.getColCount(e),c=g.getRowDims(e,a,o),C=g.getColDims(e,i,o),_=g.getMaximizedRow(e),b=g.getMaximizedCol(e),v=C.x,f=c.y,x=C.w,y=c.h,m=!0;if(_){var S=g.getRowIndex(e,_),w=Math.min(o.h/(3*(h-1)),d);a<S?(f=o.y+o.h-(a+1)*w,y=w,m=!1):a==S?(f=o.y+(h-a-1)*w,y=o.h-(h-1)*w):(f=o.y+(h-a-1)*w,y=w,m=!1)}if(b&&m){var N=g.getColIdx(e,b),A=Math.min(o.w/(3*(u-1)),d);i<N?(x=A,v=o.x+(s?o.w-A:0)+(s?-1:1)*i*A):i==N?(x=o.w-(u-1)*A,v=o.x+(s?o.w-x:0)+(s?-1:1)*i*A):(x=A,v=o.x+(s?-A:o.w)+(s?1:-1)*(u-i)*A)}return new t.Rectangle(v,f,x,y)},getCellLayout:e=>e.getOptions().__layout.__cellLayout||p._calculateCellLayout(e),_calculateCellLayout:e=>{for(var a=e.getOptions(),i=g.getCellCounts(e),n=parseInt(a.__layout.cellInnerPadding),r=a.__layout.cellLabelGap,l=parseInt(a.__layout.minimumCellSize),s=0,d=0,u=g.getRowCount(e)*g.getColCount(e),c=0;c<u;c++){var C=g.getCell(e,c);if(C&&C.label){var _=C.labelHalign,p=o(e.getCtx(),C.label,h.getCellLabelStyle(e,c),_,t.OutputText.V_ALIGN_CENTRAL).getDimensions().h;if("on"==h.getCellShowCount(e,C)){var b=o(e.getCtx(),i.total[c],h.getCellCountLabelStyle(e,c),_,t.OutputText.V_ALIGN_CENTRAL).getDimensions().h;p=Math.max(p,b)}s=Math.max(s,p)}}g.getMaximizedRow(e)&&g.getMaximizedCol(e)&&(d=Math.max(s,a._resources.close.height));var v=s+n+n,f={labelHeight:s,headerSize:s+n+r,maximizedLabelHeight:d,maximizedHeaderSize:d+n+r,minimumCellSize:l=Math.max(v,l)};return a.__layout.__cellLayout=f,f},animateUpdate:(e,a,i)=>{var o=e.getOldNBox(),r=e.getNewNBox(),l=new t.CustomAnimation(r.getCtx(),i,e.getAnimationDuration()),s=i.getChildContainer(),g=s.getMatrix();s.setMatrix(n(s));var h=i.getParent();h.addChildAt(s,h.getChildIndex(i)+1);var c=i.getTranslateX(),C=i.getTranslateY();l.getAnimator().addProp(t.Animator.TYPE_MATRIX,i,i.getMatrix,i.setMatrix,i.getMatrix()),i.setMatrix(a.getMatrix());var _=d(o,a.getData(),"background"),b=d(r,i.getData(),"background"),v=t.Agent.isRightToLeft(r.getCtx())?0:b.getWidth()-_.getWidth();if(b.getFill().equals(_.getFill())||(l.getAnimator().addProp(t.Animator.TYPE_FILL,b,b.getFill,b.setFill,b.getFill()),b.setFill(_.getFill())),l.getAnimator().addProp(t.Animator.TYPE_NUMBER,b,b.getWidth,b.setWidth,b.getWidth()),b.setWidth(_.getWidth()),l.getAnimator().addProp(t.Animator.TYPE_NUMBER,b,b.getHeight,b.setHeight,b.getHeight()),b.setHeight(_.getHeight()),i.isShowingKeyboardFocusEffect()){var f=d(r,i.getData(),"focusEffect").getEffect();f&&(l.getAnimator().addProp(t.Animator.TYPE_NUMBER,f,f.getWidth,f.setWidth,f.getWidth()),f.setWidth(_.getWidth()+2),l.getAnimator().addProp(t.Animator.TYPE_NUMBER,f,f.getHeight,f.setHeight,f.getHeight()),f.setHeight(_.getHeight()+2))}p._animateLabels(e,a,i,"countLabel"),p._animateLabels(e,a,i,"label");var x=d(o,a.getData(),"closeButton"),y=d(r,i.getData(),"closeButton");if(x)if(y)l.getAnimator().addProp(t.Animator.TYPE_MATRIX,y,y.getMatrix,y.setMatrix,y.getMatrix()),y.setMatrix(x.getMatrix());else{var m=n(x);x.setTranslate(x.getTranslateX()+v+c,x.getTranslateY()+C),e.add(new t.AnimFadeOut(r.getCtx(),x,e.getAnimationDuration()),u.UPDATE),l.getAnimator().addProp(t.Animator.TYPE_MATRIX,x,x.getMatrix,x.setMatrix,x.getMatrix()),x.setMatrix(m),r.getDeleteContainer().addChild(x)}else y&&(e.add(new t.AnimFadeIn(r.getCtx(),y,e.getAnimationDuration()),u.UPDATE),l.getAnimator().addProp(t.Animator.TYPE_MATRIX,y,y.getMatrix,y.setMatrix,y.getMatrix()),y.setTranslate(y.getTranslateX()-v,y.getTranslateY()),y.setAlpha(0));t.Playable.appendOnEnd(l,()=>{i.addChild(s),s.setMatrix(g)}),e.add(l,u.UPDATE)},_animateLabels:(e,a,i,o)=>{var r=e.getOldNBox(),l=e.getNewNBox(),s=d(r,a.getData(),o),g=d(l,i.getData(),o),h=p._isLabelVertical(r,a.getData()),c=p._isLabelVertical(l,i.getData());if(s||g)if(s&&g&&h==c){var C=new t.CustomAnimation(l.getCtx(),g,e.getAnimationDuration()),_=s.getHorizAlignment();_="left"==_?-1:"center"==_?0:1;var b=g.getHorizAlignment(),v=((b="left"==b?-1:"center"==b?0:1)-_)*g.getDimensions().w/2;if(C.getAnimator().addProp(t.Animator.TYPE_NUMBER,g,g.getX,g.setX,g.getX()),g.setX(s.getX()+v),C.getAnimator().addProp(t.Animator.TYPE_NUMBER,g,g.getY,g.setY,g.getY()),g.setY(s.getY()),C.getAnimator().addProp(t.Animator.TYPE_MATRIX,g,g.getMatrix,g.setMatrix,g.getMatrix()),g.setMatrix(s.getMatrix()),e.add(C,u.UPDATE),"countLabel"==o&&s.getTextString()!=g.getTextString()){g.setAlpha(0),i.addChild(s);var f=new t.AnimFadeOut(l.getCtx(),s,e.getAnimationDuration()),x=new t.AnimFadeIn(l.getCtx(),g,e.getAnimationDuration());e.add(f,u.UPDATE),e.add(x,u.INSERT),t.Playable.appendOnEnd(f,()=>{l.getDeleteContainer().addChild(s)})}}else s&&(s.setMatrix(n(s)),l.getDeleteContainer().addChild(s),e.add(new t.AnimFadeOut(l.getCtx(),s,e.getAnimationDuration()),u.UPDATE)),g&&(g.setAlpha(0),e.add(new t.AnimFadeIn(l.getCtx(),g,e.getAnimationDuration()),u.UPDATE))},animateDelete:(e,a)=>{var i=e.getNewNBox(),o=a.getChildContainer();if(o){var r=n(o),l=a.getParent();l.addChildAt(o,l.getChildIndex(a)+1),o.setMatrix(r)}i.getDeleteContainer().addChild(a),e.add(new t.AnimFadeOut(i.getCtx(),a,e.getAnimationDuration()),u.UPDATE)},animateInsert:(e,a)=>{var i=e.getNewNBox(),o=a.getChildContainer(),r=null;if(o){r=o.getMatrix();var l=n(a),s=a.getParent();s.addChildAt(o,s.getChildIndex(a)+1),o.setMatrix(l)}a.setAlpha(0);var d=new t.AnimFadeIn(i.getCtx(),a,e.getAnimationDuration());o&&t.Playable.appendOnEnd(d,()=>{a.addChild(o),o.setMatrix(r)}),e.add(d,u.UPDATE)},renderDropSiteFeedback:(e,a)=>{var i=d(e,a.getData(),"background"),o=new t.Rect(e.getCtx(),i.getX(),i.getY(),i.getWidth(),i.getHeight());o.setPixelHinting(!0);var n=h.getCellDropTargetStyle(e);return p._applyStyleToRect(o,n),a.addChildAt(o,a.getChildIndex(i)+1),o},_applyStyleToRect:(e,a)=>{var i=a.getStyle(t.CSSStyle.BACKGROUND),o=a.getStyle(t.CSSStyle.BACKGROUND_COLOR),n=i||o;if(n&&l(e,n),"solid"==a.getStyle(t.CSSStyle.BORDER_STYLE)){var r=a.getStyle(t.CSSStyle.BORDER_COLOR);r=r||"#000000";var s=a.getStyle(t.CSSStyle.BORDER_WIDTH);s=null==s?1:parseFloat(s),e.setSolidStroke(r,null,s)}},_addAccessibilityAttr:(e,a,i,o)=>{var n=t.Agent.isTouchDevice()?d(e,a,"background"):i;if(n.setAriaRole(o),!t.Agent.deferAriaCreation()){var r=i.getAriaLabel();r&&n.setAriaProperty("label",r)}},_createShadow:e=>{if(e&&e.length>0&&"none"!==e){var a=e.match(/\S+\([^\)]+\)|\S+/g),i=e.charAt(0);return i>="0"&&i<="9"?new t.Shadow(parseInt(a[0]),parseInt(a[1]),parseInt(a[2])/2,a[4]):new t.Shadow(parseInt(a[1]),parseInt(a[2]),parseInt(a[3])/2,a[0])}return null}};class b extends t.Container{constructor(e,t){var a=g.getRowIndex(e,t.row),i=g.getColIdx(e,t.column);super(e.getCtx(),null,"c:"+a+","+i),this._nbox=e,this._data=t,this._data.__cacheId="cell:"+this.getId(),this._scrollContainer=!1,this.nboxType="cell"}getData(){return this._data}render(e,t){e.addChild(this),s(this._nbox,this._data,this),p.render(this._nbox,this._data,this,t),this._nbox.EventManager.associate(this,this)}getChildContainer(){return this._childContainer}setChildContainer(e){this._childContainer=e}animateUpdate(e,t){p.animateUpdate(e,t,this)}animateDelete(e){p.animateDelete(e,this)}animateInsert(e){p.animateInsert(e,this)}isDoubleClickable(){return g.isMaximizeEnabled(this._nbox)}handleDoubleClick(){if(this.isDoubleClickable()){var e,a=g.getMaximizedRow(this._nbox),i=g.getMaximizedCol(this._nbox);g.fireOptionChangeEvent(this._nbox,"_drawer",null),a==this._data.row&&i==this._data.column?(g.fireOptionChangeEvent(this._nbox,"maximizedRow",null),g.fireOptionChangeEvent(this._nbox,"maximizedColumn",null)):(g.fireOptionChangeEvent(this._nbox,"maximizedRow",this._data.row),g.fireOptionChangeEvent(this._nbox,"maximizedColumn",this._data.column));var o=this._nbox.EventManager.getFocus();o?"node"===o.nboxType?e=this.getCellIndex()!=g.getCellIndex(this._nbox,o.getData()):"overflow"===o.nboxType?e=this!=o.getParentCell():"cell"===o.nboxType?e=this.getCellIndex()!=o.getCellIndex():"categoryNode"===o.nboxType&&(e=this.getCellIndex()!=o.getData().cell):this._nbox.EventManager.setFocusObj(this),e&&(this._nbox.EventManager.setFocusObj(this),this._nbox.EventManager.setFocused(!1)),this._nbox.processEvent(t.EventFactory.newRenderEvent())}}contains(e,t){var a=d(this._nbox,this._data,"background"),i=this.getTranslateX()+a.getX(),o=this.getTranslateY()+a.getY(),n=i+a.getWidth(),r=o+a.getHeight();return i<=e&&e<=n&&o<=t&&t<=r}renderDropSiteFeedback(){return p.renderDropSiteFeedback(this._nbox,this)}HandleKeyboardEvent(e){var a=g.getMaximizedRow(this._nbox),i=g.getMaximizedCol(this._nbox),o=a==this._data.row&&i==this._data.column;(!o&&e.keyCode==t.KeyboardEvent.ENTER||o&&e.keyCode==t.KeyboardEvent.ESCAPE)&&this.handleDoubleClick()}getAriaLabel(){var e=this.getCellIndex(),a=[],i=this._nbox.getOptions().translations;return g.isCellMaximized(this._nbox,e)?a.push(i.stateMaximized):g.isCellMinimized(this._nbox,e)&&a.push(i.stateMinimized),a.push([i.labelSize,this.getNodeCount()]),t.Displayable.generateAriaLabel(this.getData().shortDesc,a)}getKeyboardBoundingBox(){return i(this)}getTargetElem(){return this.getElem()}showKeyboardFocusEffect(){this._isShowingKeyboardFocusEffect=!0,d(this._nbox,this.getData(),"focusEffect").show()}hideKeyboardFocusEffect(){this._isShowingKeyboardFocusEffect=!1,d(this._nbox,this.getData(),"focusEffect").hide()}isShowingKeyboardFocusEffect(){return this._isShowingKeyboardFocusEffect}getNextNavigable(e){var a=null;return this._nbox.EventManager.getKeyboardHandler().isNavigationEvent(e)&&(a=e.keyCode==t.KeyboardEvent.OPEN_BRACKET?this._getFirstNavigableChild(e):this._getNextSibling(e)),a}showDragOverEffect(){this._isShowingKeyboardFocusEffect=!0,d(this._nbox,this.getData(),"dragEffect").show()}hideDragOverEffect(){this._isShowingKeyboardFocusEffect=!1,d(this._nbox,this.getData(),"dragEffect").hide()}_getNextSibling(e){for(var t=[],a=g.getRowCount(this._nbox)*g.getColCount(this._nbox),i=0;i<a;i++)t.push(d(this._nbox,g.getCell(this._nbox,i)));return _.getNextNavigableCell(this,e,t,this._nbox)}_getFirstNavigableChild(e){var t=null,a=g.getMaximizedRow(this._nbox),i=g.getMaximizedCol(this._nbox),o=g.getDrawer(this._nbox);if(o&&a==this.getData().row&&i==this.getData().column)t=d(this._nbox,o);else{var n=this.getChildContainer();if(n.getScrollingPane&&(n=n.getScrollingPane()),n.getNumChildren()>0&&("node"===n.getChildAt(0).nboxType||"overflow"===n.getChildAt(0).nboxType))t=g.getFirstNavigableNode(n);else{for(var r=[],l=0;l<n.getNumChildren();l++){var s=n.getChildAt(l);"categoryNode"===s.nboxType&&r.push(s)}t=_.getNextNavigableCategoryNode(null,e,r)}}return t}getCellIndex(){return g.getCellIdxByRowCol(this._nbox,this.getData().row,this.getData().column)}getLabel(){var e=this.getData().label;return e||null}getCountLabel(){var e=this.getData(),t=this._nbox.getOptions().countLabel;return t?t({row:e.row,column:e.column,nodeCount:this.getNodeCount(),highlightedNodeCount:this.getHighlightedNodeCount(),totalNodeCount:g.getNodeCount(this._nbox)}):e.countLabel}getBackground(){var e=h.getCellStyle(this._nbox,this.getCellIndex()),a=e.getStyle(t.CSSStyle.BACKGROUND),i=e.getStyle(t.CSSStyle.BACKGROUND_COLOR);return a||i}hasOverflowIndicator(){var e=this._nbox.getOptions();if(e&&e.__layout&&e.__layout.__nodeLayout&&e.__layout.__nodeLayout.cellLayouts){var t=this.getCellIndex(),a=e.__layout.__nodeLayout.cellLayouts[t];if(a)return a.overflow}return!1}getNodeCount(){return g.getCellCounts(this._nbox).total[this.getCellIndex()]}getHighlightedNodeCount(){var e=g.getCellCounts(this._nbox);return e.highlighted?e.highlighted[this.getCellIndex()]:null}getNode(e){var t=this._nbox.getOptions().nodes;if(t)for(var a=0,i=0;i<t.length;i++)if(this.getData().row==t[i].row&&this.getData().column==t[i].column&&!g.isNodeHidden(this._nbox,t[i])){if(e==a)return t[i];a++}return null}getDisplayable(){return this}getKeyboardFocusDisplayable(){return"acrossCells"==g.getGroupBehavior(this._nbox)&&this._nbox.getOptions().__groups?null:d(this._nbox,g.getCell(this._nbox,g.getCellIndex(this._nbox,this.getData())))}}const v={render:(e,t,a,i,o)=>{v._renderNodeBackground(e,t,a,i,o);var n=v._renderNodeIndicator(e,t,a,i,o);v._renderNodeCount(e,t,a,i,n,o),v._addAccessibilityAttr(a)},_renderNodeBackground:(e,a,i,o,n)=>{a.__scale=o,a.__gap=n;var r=Math.max(0,v.getSideLength(a)),l=h.getNodeBorderRadius(e),s=h.getNodeHoverColor(e),d=h.getNodeSelectionColor(e),g=new t.Rect(e.getCtx(),-r/2,-r/2,r,r);g.setFill(null),l&&(g.setRx(l),g.setRy(l)),g.setHoverStroke(new t.Stroke(s,1,2),new t.Stroke(d,1,4)),g.setSelectedStroke(new t.Stroke(d,1,4),null),g.setSelectedHoverStroke(new t.Stroke(s,1,2),new t.Stroke(d,1,6)),i.addChild(g),i.setSelectionShape(g);var u=new t.Rect(e.getCtx(),-r/2,-r/2,r,r);l&&(u.setRx(l),u.setRy(l));var c=h.getCategoryNodeColor(e,a);u.setSolidFill(c),i.addChild(u)},getSideLength:e=>e.__scale*Math.sqrt(e.nodeIndices.length)-e.__gap,_renderNodeIndicator:(e,a,i,o,n)=>{var r=!1,l=e.getOptions().__layout.markerGap,d=t.Agent.isRightToLeft(e.getCtx()),g=o*Math.sqrt(a.nodeIndices.length)-n,u=h.getCategoryNodeColor(e,a),c=t.ColorUtils.getContrastingTextColor(u),C=g/4,_=1,p=d?g/2-C:-g/2,b=h.getStyledCategoryIndicatorIcon(e,a);if(b){var v=C/(b.width+2*l),f=g/(b.height+2*l);_=Math.min(v,f)}var x=h.getCategoryNodeIndicatorColor(e,a);if(x){c=t.ColorUtils.getContrastingTextColor(x);var y=new t.Rect(e.getCtx(),p,-g/2,C,g);y.setSolidFill(x),i.addChild(y),r=!0}if(b){var m=b.color?b.color:c,S=new t.SimpleMarker(e.getCtx(),b.shape,(d?1:-1)*(g-C)/2,0,b.width*_,b.height*_,b.borderRadius);b.borderWidth&&S.setSolidStroke(b.borderColor,null,b.borderWidth),b.pattern&&"none"!=b.pattern?S.setFill(new t.PatternFill(b.pattern,m,u)):S.setSolidFill(m),S.setStyle(b.style).setClassName(b.className),i.addChild(S),s(e,a,S,"indicatorIcon"),r=!0}return r},_renderNodeCount:(e,a,i,n,l,u)=>{var c,C=e.getOptions().__layout.categoryNodeLabelGap,_=t.Agent.isRightToLeft(e.getCtx()),p=h.getFadedNodeAlpha(e),b=g.getHighlightedItems(e),v=d(e,a,"label");if(b){if(0==(c=a.highlightedCount))return v&&v.setTextString(""),void i.setAlpha(p)}else c=a.nodeIndices.length;var f=n*Math.sqrt(a.nodeIndices.length)-u,x=l?.75*f:f,y=(_?-1:1)*(f-x)/2,m=h.getCategoryNodeColor(e,a),S=t.ColorUtils.getContrastingTextColor(m),w=new t.Rectangle(0,0,x-2*C,f-2*C);v?v.setTextString(""+c):(v=o(e.getCtx(),""+c,h.getCategoryNodeLabelStyle(e),t.OutputText.H_ALIGN_CENTER,t.OutputText.V_ALIGN_CENTRAL),s(e,a,v,"label"));var N=t.TextUtils.getOptimalFontSize(v.getCtx(),v.getTextString(),v.getCSSStyle(),w);v.setFontSize(N),t.TextUtils.fitText(v,x-2*C,f-2*C,i)&&(r(v,y,0),v.setSolidFill(S))},animateUpdate:(e,a,i)=>{var o=n(a),r=n(i),l=i.getMatrix(),s=i.getParent();a.setAlpha(0),e.getNewNBox().addChild(i),i.setMatrix(o);var d=new t.AnimMoveTo(i.getCtx(),i,new t.Point(r.getTx(),r.getTy()),e.getAnimationDuration());t.Playable.appendOnEnd(d,()=>{s.addChild(i),i.setMatrix(l)}),e.add(d,u.UPDATE)},animateDelete:(e,a)=>{var i=u.UPDATE,o=e.getOldNBox(),r=e.getNewNBox();v.isMaximizeEqual(o,r)&&v.isGroupingEqual(o,r)&&(i=u.DELETE);var l=new t.AnimScaleTo(r.getCtx(),a,new t.Point(.01,.01),e.getAnimationDuration());e.add(l,i);var s=new t.AnimFadeOut(r.getCtx(),a,e.getAnimationDuration());e.add(s,i),a.setMatrix(n(a)),r.getDeleteContainer().addChild(a)},animateInsert:(e,a)=>{var i=u.UPDATE,o=e.getOldNBox(),n=e.getNewNBox();v.isMaximizeEqual(o,n)&&v.isGroupingEqual(o,n)&&(i=u.INSERT),a.setScaleX(.01),a.setScaleY(.01);var r=new t.AnimScaleTo(n.getCtx(),a,new t.Point(1,1),e.getAnimationDuration());e.add(r,i);var l=new t.CustomAnimation(n.getCtx(),a,e.getAnimationDuration());l.getAnimator().addProp(t.Animator.TYPE_NUMBER,a,a.getAlpha,a.setAlpha,a.getAlpha()),e.add(l,i),a.setAlpha(0)},isGroupingEqual:(e,t)=>{var a=g.getGroupBehavior(e),i=g.getGroupBehavior(t),o=g.getNodeCount(e),n=g.getNodeCount(t),r=!1;if(a==i&&o==n){r=!0;for(var l=0;l<o;l++){if(g.getNodeGroupId(g.getNode(e,l))!=g.getNodeGroupId(g.getNode(t,l))){r=!1;break}}}return r},isMaximizeEqual:(e,t)=>{var a=g.getMaximizedRow(e),i=g.getMaximizedCol(e),o=g.getMaximizedRow(t),n=g.getMaximizedCol(t);return a==o&&i==n},_addAccessibilityAttr:e=>{if(e.setAriaRole("img"),!t.Agent.deferAriaCreation()){var a=e.getAriaLabel();a&&e.setAriaProperty("label",a)}}},f={render:(e,a,i,o)=>{var n=f.getDrawerBounds(e,a,o);a.__drawerBounds=n,i.setTranslate(n.x,n.y);var r=new t.KeyboardFocusEffect(e.getCtx(),i,new t.Rectangle(-1,-1,n.w+2,n.h+2));s(e,a,r,"focusEffect"),f._renderBody(e,a,i),f._renderHeader(e,a,i),f._addAccessibilityAttr(e,a,i)},_renderHeader:(e,a,i)=>{var n=e.getOptions(),l=n.__layout.drawerButtonGap,s=n.__layout.drawerStartGap,u=n.__layout.drawerLabelGap,c=n.__layout.drawerCountHorizontalGap,C=n.__layout.drawerCountVerticalGap,_=n.__layout.drawerHeaderHeight,p=n.__layout.nodeIndicatorGap,b=n.__layout.nodeSwatchSize,v=t.Agent.isRightToLeft(e.getCtx()),f=g.getCategoryNode(e,a.id),x=f.nodeIndices.length,y=a.__drawerBounds,m=n._resources.close,S=m.width;if(y.w>S){var w=m.height,N=e.getCtx(),A=t.ToolkitUtils.getIconStyle(N,m.class),D=new t.IconButton(N,"borderless",{style:A,size:S},null,null,i.closeDrawer,i),I=v?Math.min((y.w-S)/2,l):Math.max((y.w-S)/2,y.w-l-S);D.setTranslate(I,_/2-w/2),i.addChild(D)}var E=h.getCategoryNodeColor(e,f),T=t.ColorUtils.getContrastingTextColor(E),O=h.getCategoryNodeIndicatorColor(e,f),M=O?t.ColorUtils.getContrastingTextColor(O):T,R=h.getStyledCategoryIndicatorIcon(e,f),L=b,P=1;if(R){var H=R.width;L=(P=b/R.height)*H,M=R.color?R.color:M}var F,B=h.getDrawerCountBorderRadius(e),G=v?t.OutputText.H_ALIGN_RIGHT:t.OutputText.H_ALIGN_LEFT,k=o(e.getCtx(),""+x,h.getDrawerCountLabelStyle(e),G,t.OutputText.V_ALIGN_CENTRAL),z=k.getDimensions(),U=z.w,K=z.h+2*C,W=R?L+2*p:O?b:0,j=U+2*c,V=W+j;if(y.w-S-2*l-s>V){var Y=t.PathUtils.roundedRectangle(0,0,V,K,B,B,B,B);(F=new t.Path(e.getCtx(),Y)).setSolidFill(E),i.addChild(F);var X=v?j:0;if(W>0){if(O){var q=t.PathUtils.roundedRectangle(X,0,W,K,v?0:B,v?B:0,v?B:0,v?0:B),J=new t.Path(e.getCtx(),q);J.setSolidFill(O),F.addChild(J)}if(R){var Q=new t.SimpleMarker(e.getCtx(),R.shape,X+W/2,K/2,R.width*P,R.height*P,R.borderRadius);R.borderWidth&&Q.setSolidStroke(R.borderColor,null,R.borderWidth),R.pattern&&"none"!=R.pattern?Q.setFill(new t.PatternFill(R.pattern,M,O||E)):Q.setSolidFill(M),Q.setStyle(R.style).setClassName(R.className),F.addChild(Q)}}F.addChild(k),k.setSolidFill(T),r(k,v?j-c:W+c,K/2)}var Z=d(e,f).getLabel(),$=o(e.getCtx(),Z,h.getDrawerLabelStyle(e),G,t.OutputText.V_ALIGN_CENTRAL),ee=0;if(t.TextUtils.fitText($,y.w-s-u-V-2*l-S,_,i)){var te=v?y.w-s:s;r($,te,_/2),ee=$.getDimensions().w+u}if(F){var ae=v?y.w-s-V-ee:s+ee;F.setTranslate(ae,(_-K)/2)}},_renderBody:(e,a,i)=>{var o=e.getOptions(),n=parseInt(o.__layout.gridGap),r=o.__layout.drawerHeaderHeight,u=a.__drawerBounds,_=t.Agent.isRightToLeft(e.getCtx()),p=h.getDrawerBorderRadius(e),b=h.getDrawerBorderColor(e),v=t.PathUtils.roundedRectangle(0,0,u.w,u.h,p,p,p,p),x=new t.Path(e.getCtx(),v);l(x,h.getDrawerBackground(e)),x.setSolidStroke(b),x.setPixelHinting(!0),i.addChild(x),s(e,a,x,"background"),a.__childArea=new t.Rectangle(n,r+n,Math.max(u.w-2*n,0),Math.max(u.h-r-2*n,0));var y=new t.SimpleScrollableContainer(e.getCtx(),u.w,u.h-r);y.setTranslate(0,r),i.addChild(y),i.setChildContainer(y);var m=h.getFadedNodeAlpha(e),S=g.getHighlightedItems(e),w={};if(S)for(var N=0;N<S.length;N++)w[S[N].id]=!0;for(var A=f.calculateNodeOrders(e,a),D=c.calculateNodeDrawerLayout(e,a,A),I=D.indicatorSectionWidth+D.iconSectionWidth+D.labelSectionWidth+n,E=D.nodeHeight+n,T=d(e,a).getChildContainer(),O=0;O<A.length;O++){var M=A[O];if(0!=D.drawerLayout.columns&&0!=D.drawerLayout.rows){var R=new C(e,M),L=a.__childArea.x+(a.__childArea.w-D.drawerLayout.columns*I+n)/2,P=n,H=O%D.drawerLayout.columns;_&&(H=D.drawerLayout.columns-H-1);var F=Math.floor(O/D.drawerLayout.columns);R.setTranslate(L+I*H,P+E*F),R.render(T.getScrollingPane(),D),S&&!w[M.id]&&R.setAlpha(m);var B=O>0?A[O-1]:null;if(B){var G=d(e,B);R.previousNavigable=G,G.nextNavigable=R}}}T.prepareContentPane()},calculateNodeOrders:(e,t)=>{var a=["normal"],i=g.getHighlightedItems(e),o={};if(i)for(var n=0;n<i.length;n++)o[i[n].id]=!0;var r=g.getSelectedItems(e),l={};if(r)for(var s=0;s<r.length;s++)l[r[s]]=!0;i?a=r?["highlighted-selected","highlighted-unselected","unhighlighted-selected","unhighlighted-unselected"]:["highlighted-unselected","unhighlighted-unselected"]:r&&(a=["unhighlighted-selected","unhighlighted-unselected"]);for(var d=[],h=g.getCategoryNode(e,t.id),u=h.nodeIndices.length,c=0;c<a.length;c++)for(var C=0;C<u;C++){var _=g.getNode(e,h.nodeIndices[C]);("normal"==a[c]||"highlighted-selected"==a[c]&&o[_.id]&&l[_.id]||"highlighted-unselected"==a[c]&&o[_.id]&&!l[_.id]||"unhighlighted-selected"==a[c]&&!o[_.id]&&l[_.id]||"unhighlighted-unselected"==a[c]&&!o[_.id]&&!l[_.id])&&d.push(_)}return d},getDrawerBounds:(e,a,i)=>{var o=e.getOptions(),n=parseInt(o.__layout.gridGap),r=p.getCellLayout(e),l=new t.Rectangle(i.x+n,i.y+n,Math.max(i.w-2*n,0),Math.max(i.h-2*n,0));if("withinCell"==g.getGroupBehavior(e)){var s=parseInt(a.id.substring(0,a.id.indexOf(":")));if(g.isCellMaximized(e,s)){var d=g.getCell(e,s),h=g.getRowIndex(e,d.row),u=g.getColIdx(e,d.column),c=p.getCellDims(e,h,u,i);l=new t.Rectangle(c.x+n,c.y+n+r.maximizedHeaderSize,Math.max(c.w-2*n,0),Math.max(c.h-r.maximizedHeaderSize-2*n,0))}}return l},animateUpdate:()=>{},animateDelete:(e,a)=>{var i=u.UPDATE,o=e.getNewNBox(),r=a.getData().__drawerBounds,l=a.getData().id,s=g.getCategoryNode(o,l);if(s){var h=v.getSideLength(s),c=h/r.w,C=h/r.h,_=d(o,s);if(_){var p=n(_),b=new t.Matrix(c,0,0,C,p.getTx()-h/2,p.getTy()-h/2),f=new t.CustomAnimation(o.getCtx(),a,e.getAnimationDuration());f.getAnimator().addProp(t.Animator.TYPE_MATRIX,a,a.getMatrix,a.setMatrix,b),e.add(f,i)}}o.getDeleteContainer().addChild(a);var x=new t.AnimFadeOut(o.getCtx(),a,e.getAnimationDuration());e.add(x,i)},animateInsert:(e,a)=>{var i=u.UPDATE,o=e.getNewNBox(),r=a.getData().__drawerBounds,l=a.getData().id,s=g.getCategoryNode(o,l);if(s){var h=v.getSideLength(s),c=h/r.w,C=h/r.h,_=d(o,s);if(_){var p=n(_),b=new t.Matrix(c,0,0,C,p.getTx()-h/2,p.getTy()-h/2),f=new t.CustomAnimation(o.getCtx(),a,e.getAnimationDuration());f.getAnimator().addProp(t.Animator.TYPE_MATRIX,a,a.getMatrix,a.setMatrix,a.getMatrix());var x=a.getParent();o.addChild(a),t.Playable.appendOnEnd(f,()=>{x.addChild(a)}),a.setMatrix(b),e.add(f,i)}}a.setAlpha(0);var y=new t.AnimFadeIn(o.getCtx(),a,e.getAnimationDuration());e.add(y,i)},_addAccessibilityAttr:(e,a,i)=>{var o=t.Agent.isTouchDevice()?d(e,a,"background"):i;if(o.setAriaRole("img"),!t.Agent.deferAriaCreation()){var n=i.getAriaLabel();n&&o.setAriaProperty("label",n)}}};class x extends t.Container{constructor(e,t){super(e.getCtx(),null,t.id+"_d"),this._nbox=e,this._data=t,this._data.__cacheId="drawer:"+this.getId(),this._nbox.registerObject(this),this.nboxType="drawer"}getData(){return this._data}render(e,t){e.addChild(this),s(this._nbox,this._data,this),f.render(this._nbox,this._data,this,t),this._nbox.EventManager.associate(this,this)}getChildContainer(){return this._childContainer}setChildContainer(e){this._childContainer=e}isDoubleClickable(){return!0}handleDoubleClick(){this.closeDrawer()}closeDrawer(){g.fireOptionChangeEvent(this._nbox,"_drawer",null),this._nbox.processEvent(t.EventFactory.newRenderEvent())}animateUpdate(){f.animateUpdate()}animateDelete(e){f.animateDelete(e,this)}animateInsert(e){f.animateInsert(e,this)}HandleKeyboardEvent(e){e.keyCode==t.KeyboardEvent.ESCAPE&&this.closeDrawer()}UpdateAccessibilityAttr(){if(!t.Agent.deferAriaCreation()){var e=this.getAriaLabel();if(e)(t.Agent.isTouchDevice()?d(this._nbox,this.getData(),"background"):this).setAriaProperty("label",e)}}getAriaLabel(){var e=d(this._nbox,g.getCategoryNode(this._nbox,this.getData().id)),t=g.isDrawerSelected(this._nbox,e);return g.buildAriaDesc(this._nbox,this,e.getShortDesc(),t)}getKeyboardBoundingBox(){return i(this)}getTargetElem(){return this.getElem()}showKeyboardFocusEffect(){this._isShowingKeyboardFocusEffect=!0,d(this._nbox,this.getData(),"focusEffect").show()}hideKeyboardFocusEffect(){this._isShowingKeyboardFocusEffect=!1,d(this._nbox,this.getData(),"focusEffect").hide()}isShowingKeyboardFocusEffect(){return this._isShowingKeyboardFocusEffect}getNextNavigable(e){var a=null;if(this._nbox.EventManager.getKeyboardHandler().isNavigationEvent(e))if(e.keyCode==t.KeyboardEvent.OPEN_BRACKET){var i=this.getChildContainer();i.getScrollingPane&&(i=i.getScrollingPane()),a=g.getFirstNavigableNode(i)}else if(e.keyCode==t.KeyboardEvent.CLOSE_BRACKET){var o=g.getMaximizedCellIndex(this._nbox);a=d(this._nbox,g.getCell(this._nbox,o))}return a}getDisplayable(){return this}getKeyboardFocusDisplayable(){if(this._nbox.getOptions()._drawer)return this;var e=g.getCategoryNode(this._nbox,this.getData().id);return e?d(this._nbox,e):null}}class y extends t.Container{constructor(e,t){super(e.getCtx()),this._nbox=e,this._cell=t,this._button,this.nboxType="overflow"}render(e,a,i){var o=this._nbox.getCtx(),n=this._nbox.getOptions()._resources.overflow,r=n.width,l=n.height,d=t.ToolkitUtils.getIconStyle(o,n.class),h=1;(a<r||i<l)&&(h=Math.min(a/r,i/l)),r*=h,l*=h;Math.max(r,l);var u=new t.Rect(o,0,0,a,i);this._button=new t.IconButton(o,"borderless",{style:d,size:Math.max(r,l),pos:{x:a/2,y:i/2}},u,null,this.HandleClick,this),g.isMaximizeEnabled(this._nbox)||this._button.setEnabled(!1),this.addChild(this._button);var c=new t.KeyboardFocusEffect(this._nbox.getCtx(),this,new t.Rectangle(-1,-1,a+2,i+2));s(this._nbox,this,c,"focusEffect"),e.addChild(this),this._addAccessibilityAttr(),this._nbox.EventManager.associate(this,this)}getParentCell(){return this._cell}getButton(){return this._button}HandleClick(e){t.EventManager.consumeEvent(e),this._cell.handleDoubleClick(!0)}HandleKeyboardEvent(e){e.keyCode==t.KeyboardEvent.ENTER&&this._cell.handleDoubleClick()}_addAccessibilityAttr(){if(this.setAriaRole("button"),!t.Agent.deferAriaCreation()){var e=this.getAriaLabel();e&&this.setAriaProperty("label",e)}}getDatatip(){return this._nbox.getOptions().translations.labelAdditionalData}getAriaLabel(){return this.getDatatip()}getKeyboardBoundingBox(e){return i(this,e)}getTargetElem(){return this.getElem()}showKeyboardFocusEffect(){this._isShowingKeyboardFocusEffect=!0,d(this._nbox,this,"focusEffect").show()}hideKeyboardFocusEffect(){this._isShowingKeyboardFocusEffect=!1,d(this._nbox,this,"focusEffect").hide()}isShowingKeyboardFocusEffect(){return this._isShowingKeyboardFocusEffect}getNextNavigable(e){var a=null;return this._nbox.EventManager.getKeyboardHandler().isNavigationEvent(e)&&(a=e.keyCode==t.KeyboardEvent.CLOSE_BRACKET?this.getParentCell():g.getNextNavigableNode(this,e)),a}getDisplayable(){return this}getKeyboardFocusDisplayable(){var e=this.previousNavigable.getData(),t=g.getNode(this._nbox,g.getNodeIndex(this._nbox,e.id));return d(this._nbox,t).nextNavigable}}class m extends t.Automation{GetSubIdForDomElement(e){for(var a=this._getParentObject(e,b),i=this._getParentObject(e,x);e&&"nbox"!==e.nboxType;){var o,n,r=this.getComponent();if("node"===e.nboxType){var l=g.getNodeIndex(r,e.getData().id);return o="node"+this._createBrackets([l]),this._createSubId(o,n)}if(a){var s=a.getData().row,h=a.getData().column,u=a.getChildContainer();if(u.getScrollingPane&&(u=u.getScrollingPane()),o="cell"+this._createBrackets([s,h]),"cell"===e.nboxType)return this._createSubId(o,n);if(e instanceof t.IconButton){if(this._getParentObject(e,y))return n="overflow",this._createSubId(o,n);if(e==d(r,a.getData(),"closeButton"))return n="closeButton",this._createSubId(o,n)}if("categoryNode"===e.nboxType){var c=e.getData().id;return n="groupNode",g.getNode(r,e.getData().nodeIndices[0]).groupCategory?n+=this._createBrackets([c]):n+=this._createBraces(c.split(";")),this._createSubId(o,n)}}if(i){if(o="dialog","drawer"===e.nboxType)return this._createSubId(o,n);if(e instanceof t.IconButton)return n="closeButton",this._createSubId(o,n)}if("categoryNode"===e.nboxType){var C=e.getData().id;return o="groupNode",g.getNode(r,e.getData().nodeIndices[0]).groupCategory?o+=this._createBrackets([C]):o+=this._createBraces(C.split(";")),this._createSubId(o,n)}e=e.getParent()}return null}_createSubId(e,t){var a=e;return t&&(a+="#"+t),a}getDomElementForSubId(e){var a=this.getComponent();if(e==t.Automation.TOOLTIP_SUBID)return this.GetTooltipElement(a);var i,o=this._parseSubId(e),n=o.component,r=o.action,l=null,s=null,h=null;if(0===n.lastIndexOf("node",0)&&(l=this._parseBrackets(n,!0),i=g.getNode(a,l[0]),h=d(a,i)),0===n.lastIndexOf("cell",0)){l=this._parseBrackets(n);var u=this._getCellIndexFromValues(l);if(!(i=g.getCell(a,u)))return null;var c=d(a,i);if(r){if((s=c.getChildContainer()).getScrollingPane&&(s=s.getScrollingPane()),"overflow"==r)for(var C=s.getNumChildren();C>0;C--)if("overflow"===s.getChildAt(C-1).nboxType){h=s.getChildAt(C-1).getButton();break}if("closeButton"==r&&(h=d(a,c.getData(),"closeButton")),0===r.lastIndexOf("node",0)){var _=(l=this._parseBrackets(r,!0))[0];if(_<0)return null;for(var p=g.getFirstNavigableNode(s),b=0;"node"===p.nboxType;){if(b==_){h=p;break}p=p.nextNavigable,b++}}if(0===r.lastIndexOf("groupNode",0)){var v,f,x;r.indexOf("{")>-1?l=this._parseBraces(r):v=r.substring(r.indexOf("[")+1,r.indexOf("]"));for(var y=0;y<s.getNumChildren();y++)if("categoryNode"===(f=s.getChildAt(y)).nboxType&&(x=f.getData().id,l&&this._compareCategories(l,x.split(";"))||v&&v==x)){h=f;break}}}else h=c}else if(0===n.lastIndexOf("groupNode",0)){var m,S,w;s=a.getChildContainer(),n.indexOf("{")>-1?l=this._parseBraces(n):m=n.substring(n.indexOf("[")+1,n.indexOf("]"));for(var N=0;N<s.getNumChildren();N++)if("categoryNode"===(S=s.getChildAt(N)).nboxType&&(w=S.getData().id,l&&this._compareCategories(l,w.split(";"))||m&&m==w)){h=S;break}}else if("dialog"===n&&(s=a.getChildContainer()))for(var A=0;A<s.getNumChildren();A++)if("drawer"===s.getChildAt(A).nboxType){var D=s.getChildAt(A);if(r){if("closeButton"==r)for(var I=0;I<D.getNumChildren();I++)D.getChildAt(I)instanceof t.IconButton&&(h=D.getChildAt(I));if(0===r.lastIndexOf("node",0)){var E=D.getChildContainer().getScrollingPane(),T=(l=this._parseBrackets(r,!0))[0];if(T<0)return null;for(var O=g.getFirstNavigableNode(E),M=0;"node"===O.nboxType;){if(M==T){h=O;break}O=O.nextNavigable,M++}}}else h=D;break}return h?h.getElem():null}_parseSubId(e){var t=null,a=null,i=e.indexOf("#");return-1!==i?(t=e.substring(0,i),a=e.substring(i+1)):t=e,{component:t,action:a}}getComponent(){return this._comp}_parseBrackets(e,t){var a=e.substring(e.indexOf("[")+1,e.indexOf("]")).split(",");if(t)for(var i=0;i<a.length;i++)a[i]=parseInt(a[i]);return a.length>0?a:null}_createBrackets(e){return e.length>0?"["+e.join(",")+"]":""}_parseBraces(e){return e.substring(e.indexOf("{")+1,e.lastIndexOf("}")).split(",")}_createBraces(e){for(var t="{",a=0;a<e.length;a++)t+=e[a].trim()+",";return t.substring(0,t.length-1)+"}"}_compareCategories(e,t){if(e.length!=t.length)return!1;e.sort(),t.sort();for(var a=0;a<e.length;a++)if(e[a].trim()!=t[a].trim())return!1;return!0}_getCellIndexFromValues(e){var t=this.getComponent();if(g.hasValidData(t)){var a=g.getColCount(t),i=g.getRowIndex(t,e[0]),o=g.getColIdx(t,e[1]);if(null!=o&&null!=i)return o+a*i}return null}_getParentObject(e,t){for(var a=e;a;){if(a instanceof t)return a;a=a.getParent()}return null}getData(e,t){if(this._comp&&g.hasValidData(this._comp))if("rowsTitle"==e){if(this._comp.getOptions().rowsTitle)return this._comp.getOptions().rowsTitle}else if("rowCount"==e){var a=this._comp.getOptions().rows;if(a)return a.length}else if("row"==e){if(g.getRowIndex(this._comp,t)>=0){var i={};return i.label=g.getRowLabel(this._comp,t),i}}else if("columnsTitle"==e){if(this._comp.getOptions().columnsTitle)return this._comp.getOptions().columnsTitle}else if("columnCount"==e){var o=this._comp.getOptions().columns;if(o)return o.length}else if("column"==e){if(g.getColIdx(this._comp,t)>=0){var n={};return n.label=g.getColLabel(this._comp,t),n}}else if("groupBehavior"==e)return g.getGroupBehavior(this._comp);return null}getGroupNode(e){if(e&&g.getGrouping(this._comp)&&"acrossCells"==g.getGroupBehavior(this._comp)){if("string"==typeof e)return this._getGroupNodeData(e);var t="";for(var a in e)e[a]?t+=a+":"+e[a]+";":t+=a+";";return this._getGroupNodeData(t.substring(0,t.length-1))}return null}_getGroupNodeData(e){var t=g.getCategoryNode(this._comp,e);if(t){var a=d(this._comp,t);if(a)return{selected:a.isSelected(),color:h.getCategoryNodeColor(this._comp,t),indicatorColor:h.getCategoryNodeIndicatorColor(this._comp,t),tooltip:a.getShortDesc(),size:t.nodeIndices?t.nodeIndices.length:-1,indicatorIcon:this._getMarkerData(d(this._comp,t,"indicatorIcon"))}}return null}getCell(e,t){if(this._comp&&g.hasValidData(this._comp)){var a=g.getCellByRowCol(this._comp,e,t);if(a)return{label:a.getLabel(),background:a.getBackground(),getNodeCount:()=>a.getNodeCount(),rowValue:e,columnValue:t,cellIndex:a.getCellIndex()}}return null}getCellNode(e,t){if(this._comp&&g.hasValidData(this._comp)&&!g.getGrouping(this._comp)){var a=g.getCellByRowCol(this._comp,e.rowValue,e.columnValue).getNode(t);return this._getNode(a)}return null}getNode(e){var t=g.getNode(this._comp,e);return this._getNode(t)}_getNode(e){if(e){var t=d(this._comp,e);if(t){var a={selected:t.isSelected(),tooltip:t.getShortDesc(),color:h.getNodeColor(this._comp,e),indicatorColor:h.getNodeIndicatorColor(this._comp,e)};e.label&&(a.label=e.label),e.secondaryLabel&&(a.secondaryLabel=e.secondaryLabel);var i=d(this._comp,e,"icon");a.icon=this._getMarkerData(i);var o=d(this._comp,e,"indicatorIcon");return a.indicatorIcon=this._getMarkerData(o),a}}return null}getCellGroupNode(e,t){if(t&&g.getGrouping(this._comp)&&"withinCell"==g.getGroupBehavior(this._comp)){if("string"==typeof t)return this._getGroupNodeData(e.cellIndex+":"+t);var a=e.cellIndex+":";for(var i in t)t[i]?a+=i+":"+t[i]+";":a+=i+";";return this._getGroupNodeData(a.substring(0,a.length-1))}return null}_getMarkerData(e){if(e){var a={};return a.shape=e instanceof t.SimpleMarker?e.getType():"none",e.getFill()&&(a.color=e.getFill().getColor()),a}return null}getDialog(){var e=g.getDrawer(this._comp);if(e){var t=g.getCategoryNode(this._comp,e.id);if(t){var a=d(this._comp,t),i={};i.label=a.getLabel(),i.getNodeCount=()=>t.nodeIndices?t.nodeIndices.length:-1;for(var o={},n=t.id.split(";"),r=0;r<n.length;r++){var l=n[r].split(":");l&&2==l.length&&(o[l[0]]=l[1])}return i.groupInfo=o,i}}return null}getDialogNode(e){var t=g.getDrawer(this._comp);if(t){var a=g.getCategoryNode(this._comp,t.id);if(a&&a.nodeIndices&&null!=a.nodeIndices[e]){var i=g.getNode(this._comp,a.nodeIndices[e]);return this._getNode(i)}}return null}getNodeIdFromIndex(e){return g.getNode(this._comp,e).id}getNodeIndexFromId(e){return g.getNodeIndex(this._comp,e)}}class S extends t.BaseComponentDefaults{constructor(e){super({alta:{skin:t.CSSStyle.SKIN_ALTA,selectionMode:"multiple",animationOnDataChange:"none",animationOnDisplay:"none",cellMaximize:"on",cellContent:"auto",groupBehavior:"withinCell",otherColor:"#636363",otherThreshold:0,hoverBehavior:"none",highlightMatch:"all",highlightedCategories:[],touchResponse:"auto",_statusMessageStyle:new t.CSSStyle,styleDefaults:{animationDuration:500,hoverBehaviorDelay:200,columnLabelStyle:new t.CSSStyle,rowLabelStyle:new t.CSSStyle,columnsTitleStyle:new t.CSSStyle,rowsTitleStyle:new t.CSSStyle,cellDefaults:{_style:new t.CSSStyle,_borderRadius:0,_maximizedStyle:new t.CSSStyle,_minimizedStyle:new t.CSSStyle,labelStyle:new t.CSSStyle,_labelMinimizedStyle:new t.CSSStyle,_labelMaximizedStyle:new t.CSSStyle,countLabelStyle:new t.CSSStyle,bodyCountLabelStyle:new t.CSSStyle,dropTargetStyle:new t.CSSStyle("background-color:rgba(217, 244, 250, .75);border-color:#ccf6ff"),showCount:"auto",showMaximize:"on",_panelShadow:"none"},__scrollbar:{scrollbarBackground:"linear-gradient(bottom, #dce2e7 0%, #f8f8f8 8%)",scrollbarBorderColor:"#dce2e7",scrollbarHandleColor:"#abb0b4",scrollbarHandleHoverColor:"#333333",scrollbarHandleActiveColor:"#333333"},_drawerDefaults:{background:"#e9e9e9",borderColor:"#bcc7d2",borderRadius:1,headerBackground:"linear-gradient(to bottom, #f5f5f5 0%, #f0f0f0 100%)",labelStyle:new t.CSSStyle,countLabelStyle:new t.CSSStyle,countBorderRadius:1},nodeDefaults:{color:"#FFFFFF",labelStyle:new t.CSSStyle,secondaryLabelStyle:new t.CSSStyle,alphaFade:.2,_cutAlpha:.4,_dragSourceAlpha:.4,_borderRadius:1,hoverColor:"#FFFFFF",selectionColor:"#000000",iconDefaults:{preferredSize:19,preferredSizeTouch:34,shapePaddingRatio:.15,sourcePaddingRatio:0,opacity:1,pattern:"none",borderColor:"#000000",borderWidth:0,borderRadius:0,shape:t.SimpleMarker.CIRCLE,background:"neutral",backgroundSize:196},indicatorIconDefaults:{width:10,height:10,opacity:1,pattern:"none",borderColor:"#000000",borderWidth:0,borderRadius:0,shape:t.SimpleMarker.CIRCLE}},_categoryNodeDefaults:{labelStyle:new t.CSSStyle}},__layout:{componentGap:8,titleGap:4,titleComponentGap:4,nodeLabelOnlyStartLabelGap:5,nodeStartLabelGap:3,nodeEndLabelGap:5,nodeSingleLabelGap:2,nodeDualLabelGap:2,nodeInterLabelGap:0,nodeIndicatorGap:3,nodeSwatchSize:10,categoryNodeLabelGap:5,minimumCellSize:34,cellGap:3,gridGap:6,cellInnerPadding:6,cellLabelGap:6,cellCloseGap:6,countLabelGap:10,markerGap:3,minimumLabelWidth:55,maximumLabelWidth:148,drawerButtonGap:6,drawerCountHorizontalGap:5,drawerCountVerticalGap:3,drawerStartGap:6,drawerLabelGap:6,drawerHeaderHeight:31}}},e)}getNoCloneObject(){return{data:!0}}}class w extends t.CategoryRolloverHandler{GetRolloverCallback(e){return function(){this.SetHighlightMode(!0),this._callbackObj.processEvent(e),this._callback&&this._callback.call(this._callbackObj,e,this._source)}.bind(this)}GetRolloutCallback(e){return function(){this.SetHighlightModeTimeout(),this._callbackObj.processEvent(e),this._callback&&this._callback.call(this._callbackObj,e,this._source)}.bind(this)}}class N extends t.EventManager{constructor(e){super(e.getCtx(),e.processEvent,e,e),this._nbox=e}OnClickInternal(e){var t=this.GetLogicalObject(e.target);t&&"categoryNode"===t.nboxType&&!t.isSelectable()&&t.openDrawer()}OnDblClickInternal(e){this._handleDblClick(e.target)}HandleTouchDblClickInternal(e){this._handleDblClick(e.target)}HandleTouchClickInternal(e){var t=this.GetLogicalObject(e.target);t&&"categoryNode"===t.nboxType&&!t.isSelectable()&&t.openDrawer()}_handleDblClick(e){var t=this.GetLogicalObject(e);t&&t.isDoubleClickable&&t.isDoubleClickable()&&t.handleDoubleClick&&t.handleDoubleClick()}ProcessKeyboardEvent(e){var a=!1,i=e.keyCode,o=this.getFocus();return i==t.KeyboardEvent.ENTER||i==t.KeyboardEvent.ESCAPE&&!this._nbox.getActiveCut()?o&&o.HandleKeyboardEvent&&o.HandleKeyboardEvent(e):e.keyCode==t.KeyboardEvent.SPACE&&e.ctrlKey&&"categoryNode"!==o.nboxType&&"node"!==o.nboxType||(a=super.ProcessKeyboardEvent(e)),a}ProcessRolloverEvent(e,a,i){var o=this._nbox.getOptions();if("dim"==o.hoverBehavior){var n=a.getCategories?a.getCategories():[];o.highlightedCategories=i?n.slice():null;var r=t.EventFactory.newCategoryHighlightEvent(o.highlightedCategories,i),l=t.CSSStyle.getTimeMilliseconds(o.styleDefaults.hoverBehaviorDelay);this.RolloverHandler.processEvent(r,this._nbox.getNodeDisplayables(),l,"any"==o.highlightMatch)}}CreateCategoryRolloverHandler(e,t){return new w(e,t)}GetTouchResponse(){var e=this._nbox.getOptions(),a=g.getDrawer(this._nbox),i=g.getCell(this._nbox,g.getMaximizedCellIndex(this._nbox));return a&&d(this._nbox,a).getChildContainer().hasScrollingContent()||i&&d(this._nbox,i).getChildContainer().hasScrollingContent()?t.EventManager.TOUCH_RESPONSE_TOUCH_HOLD:e.touchResponse===t.EventManager.TOUCH_RESPONSE_TOUCH_START?t.EventManager.TOUCH_RESPONSE_TOUCH_START:t.EventManager.TOUCH_RESPONSE_AUTO}isDndSupported(){return!0}GetDragSourceType(e){return this.DragSource.getDragObject()instanceof C?"nodes":null}ShowDropEffect(e){let t=this.GetLogicalObjectAndDisplayable(e.target).displayable;(t instanceof C||t instanceof y)&&(t=t.getParentCell()),t instanceof b&&(t.showDragOverEffect(),this._nbox.addDropEffectObj(t))}ClearDropEffect(){let e=this._nbox.getDropEffectObj();for(let a=0;a<e.length;a++){var t=e[a];(t instanceof C||t instanceof y)&&(t=t.getParentCell()),t instanceof b&&t.hideDragOverEffect()}this._nbox.clearDropEffectObj()}GetDragDataContexts(e){var a,i=this.DragSource.getDragObject(),o=[];if(this._component.isSelectionSupported()&&this._component.getSelectionHandler().getSelectedCount()>1)for(var n=this._component.getSelectionHandler().getSelection(),r=0;r<n.length;r++)n[r]instanceof C&&(a=n[r].getDataContext(),e&&t.ToolkitUtils.cleanDragDataContext(a),o.push(a));else i instanceof C&&(a=i.getDataContext(),e&&t.ToolkitUtils.cleanDragDataContext(a),o.push(a));return o}GetDropEventPayload(e){const t=this.GetLogicalObjectAndDisplayable(e.target).displayable;let a;return t instanceof b||t instanceof C?a=t.getData():t instanceof y&&(a=t.getParentCell().getData()),{row:a.row,column:a.column}}GetDropTargetType(e){var t=this.GetLogicalObject(e.target);return t instanceof b||t instanceof C||t instanceof y?"cells":null}SetDragSourceEffect(e){var t=[],a=h.getNodeDragSourceAlpha(this._nbox);if(this._component.isSelectionSupported()&&this._component.getSelectionHandler().getSelectedCount()>1)for(var i=this._component.getSelectionHandler().getSelection(),o=0;o<i.length;o++)i[o]instanceof C&&(i[o].setAlpha(a),t.push(i[o]));else e.setAlpha(a),t.push(e);this._component.getCache().putToCache("ghostNodes",t)}ClearDragSourceEffect(){var e=this._component.getCache().getFromCache("ghostNodes");if(e&&e.length>0)for(var a=0;a<e.length;a++)t.ToolkitUtils.setAttrNullNS(e[a].getElem(),"opacity","1");this._component.getCache().putToCache("ghostNodes",null)}}class A extends t.Container{constructor(e,a){super(e.getCtx(),null,isNaN(a.cell)?a.id:a.cell+":"+a.id),this.nboxType="categoryNode",this._nbox=e,this._data=a,this._data.__cacheId="categoryNode:"+this.getId(),this._nbox.registerObject(this),this.setCursor(t.SelectionEffectUtils.getSelectingCursor()),this._maxAlpha=1}getData(){return this._data}render(e,t,a){v.render(this._nbox,this._data,this,t,a),e.addChild(this),s(this._nbox,this._data,this),this._nbox.EventManager.associate(this,this)}isSelectable(){return"multiple"==this._nbox.getOptions().selectionMode}isSelected(){return this.getSelectionShape().isSelected()}setSelected(e){this.getSelectionShape().setSelected(e),this.UpdateAccessibilityAttr()}showHoverEffect(){this.getSelectionShape().showHoverEffect()}hideHoverEffect(){this.getSelectionShape().hideHoverEffect()}setSelectionShape(e){this._selectionShape=e}getSelectionShape(){return this._selectionShape}getLabel(){var e=a.getTranslatedString("oj-converter.plural-separator");return g.getCategoryNodeLabels(this._nbox,this._data).join(e)}getDatatip(){var e=this._nbox.getOptions().tooltip,a=e?e.renderer:null;if(a){var i={id:this._data.id,color:h.getCategoryNodeColor(this._nbox,this._data),indicatorColor:h.getCategoryNodeIndicatorColor(this._nbox,this._data),size:this._data.nodeIndices.length};return"withinCell"==g.getGroupBehavior(this._nbox)&&(i.row=g.getCell(this._nbox,this._data.cell).row,i.column=g.getCell(this._nbox,this._data.cell).column),this._nbox.getCtx().getTooltipManager().getCustomTooltip(a,i)}var o=this._nbox.getOptions().translations;return this.getShortDesc()+"\n"+t.ResourceUtils.format(o.labelAndValue,[o.labelSize,this._data.nodeIndices.length])}getShortDesc(){return g.getCategoryNodeLabels(this._nbox,this._data).join("\n")}getDatatipColor(){return h.getCategoryNodeColor(this._nbox,this._data)}setMaxAlpha(e){this._maxAlpha=e,this.setAlpha(this.getAlpha())}getMaxAlpha(){return this._maxAlpha}setAlpha(e){super.setAlpha(Math.min(e,this._maxAlpha))}isDoubleClickable(){return this.isSelectable()}handleDoubleClick(){this.isSelectable()&&this.openDrawer()}openDrawer(){g.fireOptionChangeEvent(this._nbox,"_drawer",{id:this.getId()}),this._nbox.processEvent(t.EventFactory.newRenderEvent())}animateUpdate(e,t){v.animateUpdate(e,t,this)}animateDelete(e){v.animateDelete(e,this)}animateInsert(e){v.animateInsert(e,this)}isDragAvailable(e){return this._nbox.__isDragAvailable(e)}getDragTransferable(){return this._nbox.__getDragTransferable(this)}getDragFeedback(){return this._nbox.__getDragFeedback()}HandleKeyboardEvent(e){if(e.keyCode==t.KeyboardEvent.ENTER)this.openDrawer();else if(e.keyCode==t.KeyboardEvent.ESCAPE&&"withinCell"==g.getGroupBehavior(this._nbox)){var a=g.getCell(this._nbox,this._data.cell);d(this._nbox,a).HandleKeyboardEvent(e)}}UpdateAccessibilityAttr(){if(!t.Agent.deferAriaCreation()){var e=this.getAriaLabel();e&&this.setAriaProperty("label",e)}}getAriaLabel(){return g.buildAriaDesc(this._nbox,this,this.getShortDesc(),this.isSelected())}getCategories(){var e=this.getData().categories;if(!e){var t=(e,t)=>e.filter(e=>t.indexOf(e)>-1),a=this.getData().nodeIndices;e=null;for(var i=0;i<a.length;i++){var o=g.getNode(this._nbox,a[i]).categories;if(!o){e=[];break}e=null==e?o:t(e,o)}this.getData().categories=e}return e}getKeyboardBoundingBox(){return i(this)}getTargetElem(){return this.getElem()}showKeyboardFocusEffect(){this._isShowingKeyboardFocusEffect=!0,this.showHoverEffect()}hideKeyboardFocusEffect(){this._isShowingKeyboardFocusEffect=!1,this.hideHoverEffect()}isShowingKeyboardFocusEffect(){return this._isShowingKeyboardFocusEffect}getNextNavigable(e){var a=null;if(e.keyCode==t.KeyboardEvent.SPACE&&e.ctrlKey)return this;if(e.keyCode==t.KeyboardEvent.CLOSE_BRACKET&&"withinCell"==g.getGroupBehavior(this._nbox)){var i=g.getCell(this._nbox,this.getData().cell);a=d(this._nbox,i)}else if(e.keyCode==t.KeyboardEvent.CLOSE_BRACKET||e.keyCode==t.KeyboardEvent.OPEN_BRACKET)a=this;else if(this._nbox.EventManager.getKeyboardHandler().isNavigationEvent(e))if("acrossCells"==g.getGroupBehavior(this._nbox)){var o=this._nbox.getOptions().__groups,n=[];for(var r in o){var l=d(this._nbox,o[r]);l&&n.push(l)}a=_.getNextNavigableCategoryNode(this,e,n)}else{for(var s=this.getParent(),h=[],u=0;u<s.getNumChildren();u++)"categoryNode"===s.getChildAt(u).nboxType&&h.push(s.getChildAt(u));a=_.getNextNavigableCategoryNode(this,e,h)}else e.type==t.MouseEvent.CLICK&&(a=this);return a}getDisplayable(){return this}getKeyboardFocusDisplayable(){var e=g.getDrawer(this._nbox);if(e)return d(this._nbox,e);if(g.getGrouping(this._nbox)){var t=g.getCategoryNode(this._nbox,this.getId());if(t)return d(this._nbox,t)}return null}}const D={create:(e,t)=>({x:e,y:t}),add:(e,t)=>D.create(e.x+t.x,e.y+t.y),subtract:(e,t)=>D.create(e.x-t.x,e.y-t.y),scale:(e,t)=>D.create(e.x*t,e.y*t),getMagnitude:e=>Math.sqrt(e.x*e.x+e.y*e.y)},I={render:(e,t,a)=>{I._renderBackground(e,t,a),g.hasValidData(e)?(I._adjustAvailSpace(a),I._renderTitles(e,t,a),I._adjustAvailSpace(a),I._renderCells(e,t,a),I._renderNodes(e,t,a),I._renderInitialSelection(e)):I._renderEmptyText(e,t,a)},processInitialSelections:e=>{I._renderInitialSelection(e)},_renderBackground:(e,a,i)=>{var o=new t.Rect(e.getCtx(),i.x,i.y,i.w,i.h);o.setInvisibleFill(),a.addChild(o);var n=new t.ClipPath;n.addRect(i.x,i.y,i.w,i.h),a.setClipPath(n)},_renderTitles:(e,a,i)=>{var n=e.getOptions(),l=g.getColCount(e),d=g.getRowCount(e),u=n.__layout.componentGap,c=n.__layout.titleGap,C=n.__layout.titleComponentGap,_=t.Agent.isRightToLeft(e.getCtx());i.x+=u,i.y+=u,i.w-=2*u,i.h-=2*u;var b=g.getMaximizedCol(e),v=b?g.getColIdx(e,b):-1,f=g.getMaximizedRow(e),x=f?g.getRowIndex(e,f):-1,y=null,m=null,S=[],w=[],N=0,A=0,D=0,I=0,E=0,T=0,O=0,M=0;n.columnsTitle&&(y=o(e.getCtx(),n.columnsTitle,n.styleDefaults.columnsTitleStyle,t.OutputText.H_ALIGN_CENTER,t.OutputText.V_ALIGN_MIDDLE),a.addChild(y),N=y.getDimensions().h),n.rowsTitle&&(m=o(e.getCtx(),n.rowsTitle,n.styleDefaults.rowsTitleStyle,t.OutputText.H_ALIGN_CENTER,t.OutputText.V_ALIGN_MIDDLE),a.addChild(m),A=m.getDimensions().h);for(var R=0;R<l;R++){var L=g.getCol(e,R);if(L.label){var P=o(e.getCtx(),L.label,h.getColLabelStyle(e,R),t.OutputText.H_ALIGN_CENTER,t.OutputText.V_ALIGN_MIDDLE);E=Math.max(E,P.getDimensions().h),b&&b!=L.id||(S[R]=P,a.addChild(S[R]))}}for(var H=0;H<d;H++){var F=g.getRow(e,H);if(F.label){var B=o(e.getCtx(),F.label,h.getRowLabelStyle(e,H),t.OutputText.H_ALIGN_CENTER,t.OutputText.V_ALIGN_MIDDLE);T=Math.max(T,B.getDimensions().h),f&&f!=F.id||(w[H]=B,a.addChild(w[H]))}}(A||T)&&(O=C,A&&T&&(D=c)),(N||E)&&(M=C,N&&E&&(I=c));var G=A+D+T+O,k=N+I+E+M;i.x+=_?0:G,i.w-=G,i.h-=k,y&&t.TextUtils.fitText(y,i.w,N,a)&&(r(y,i.x+i.w/2,i.y+i.h+k-N/2),s(e,e.getOptions(),y,"columnsTitle")),m&&t.TextUtils.fitText(m,i.h,A,a)&&(r(m,i.x+(_?i.w:0)+(_?1:-1)*(G-A/2),i.y+i.h/2,_?Math.PI/2:-Math.PI/2),s(e,e.getOptions(),m,"rowsTitle"));for(var z=0;z<l;z++)if(S[z]){var U=p.getCellDims(e,-1==x?0:x,z,i);t.TextUtils.fitText(S[z],U.w,E,a)&&(r(S[z],U.x+U.w/2,i.y+i.h+M+E/2),s(e,g.getCol(e,z),S[z],"label"))}for(var K=0;K<d;K++)if(w[K]){var W=p.getCellDims(e,K,-1==v?0:v,i);t.TextUtils.fitText(w[K],W.h,T,a)&&(r(w[K],i.x+(_?i.w:0)+(_?1:-1)*(O+T/2),W.y+W.h/2,_?Math.PI/2:-Math.PI/2),s(e,g.getRow(e,K),w[K],"label"))}},_renderCells:(e,t,a)=>{for(var i=g.getRowCount(e),o=g.getColCount(e),n=0;n<i;n++)for(var r=0;r<o;r++){var l=g.getCell(e,n*o+r);new b(e,l).render(t,a)}},calculateNodeOrders:e=>{var t=["normal"],a=g.getHighlightedItems(e),i={};if(a)for(var o=0;o<a.length;o++)i[a[o].id]=!0;var n=g.getSelectedItems(e),r={};if(n)for(var l=0;l<n.length;l++)r[n[l]]=!0;a?t=n?["highlighted-selected","highlighted-unselected","unhighlighted-selected","unhighlighted-unselected"]:["highlighted-unselected","unhighlighted-unselected"]:n&&(t=["unhighlighted-selected","unhighlighted-unselected"]);for(var s={},d=g.getNodeCount(e),h=0;h<t.length;h++)for(var u=0;u<d;u++){var c=g.getNode(e,u);if(!g.isNodeHidden(e,c)&&("normal"==t[h]||"highlighted-selected"==t[h]&&i[c.id]&&r[c.id]||"highlighted-unselected"==t[h]&&i[c.id]&&!r[c.id]||"unhighlighted-selected"==t[h]&&!i[c.id]&&r[c.id]||"unhighlighted-unselected"==t[h]&&!i[c.id]&&!r[c.id])){var C=g.getCellIndex(e,c);g.isCellMinimized(e,C)||(s[C]||(s[C]=[]),s[C].push(c))}}return s},_renderNodes:(e,t,a)=>{if(g.getNodeCount(e)>0){if("counts"==g.getCellContent(e)){for(var i=g.getRowCount(e),o=g.getColCount(e),n=[],r=0;r<i;r++)for(var l=0;l<o;l++)n.push(r*o+l);return void p.renderBodyCountLabels(e,n)}g.getGrouping(e)?(I._renderCategoryNodes(e,t,a),I._renderDrawer(e,t,a)):I._renderIndividualNodes(e),e.setNodeClipPath(null),e.setNodeIconClipPath(null)}},_renderIndividualNodes:e=>{var a=e.getOptions(),i=parseInt(a.__layout.gridGap),o=t.Agent.isRightToLeft(e.getCtx()),n=h.getFadedNodeAlpha(e),r=g.getHighlightedItems(e),l={};if(r)for(var u=0;u<r.length;u++)l[r[u].id]=!0;for(var _=I.calculateNodeOrders(e),b=c.calculateNodeLayout(e,_),v=b.indicatorSectionWidth+b.iconSectionWidth+b.labelSectionWidth+i,f=b.nodeHeight+i,x=g.getRowCount(e),m=g.getColCount(e),S=0;S<x;S++)for(var w=0;w<m;w++){var N=S*m+w,A=_[N];if(A&&A.length){var D=g.getCell(e,N),E=b.cellLayouts[N],T=E.cellRows,O=E.cellColumns;if(!(0==T||0==O||1==T&&1==O&&E.overflow))for(var M=T*O-(E.overflow?1:0),R=0;R<A.length;R++){var L=A[R];if(M<0||R<M){var P=d(e,D).getChildContainer(),H=P instanceof t.SimpleScrollableContainer,F=new C(e,L),B=D.__childArea.x+(D.__childArea.w-E.cellColumns*v+i)/2,G=H?i:D.__childArea.y,k=R%O;o&&(k=O-k-1);var z=Math.floor(R/O);F.setTranslate(B+v*k,G+f*z),F.render(H?P.getScrollingPane():P,b),r&&!l[L.id]&&F.setAlpha(n);var U=R>0?A[R-1]:null;if(U){var K=d(e,U);F.previousNavigable=K,K.nextNavigable=F}}}}}for(var W=g.getRowCount(e),j=g.getColCount(e),V=[],Y=0;Y<W;Y++)for(var X=0;X<j;X++){var q=Y*j+X;if(!g.isCellMinimized(e,q)){var J=g.getCell(e,q),Q=d(e,J),Z=b.cellLayouts[q];if(Z.overflow){var $=Z.cellRows,ee=Z.cellColumns;if(0==$||0==ee||1==$&&1==ee&&Z.overflow)V.push(q);else{var te=new y(e,Q),ae=g.getLastNavigableNode(Q.getChildContainer());ae&&"node"===ae.nboxType&&(te.previousNavigable=ae,ae.nextNavigable=te),s(e,te,te),s(e,J,te,"overflow");var ie=J.__childArea.x+(J.__childArea.w-Z.cellColumns*v+i)/2,oe=J.__childArea.y,ne=Z.cellColumns-1;o&&(ne=0);var re=Z.cellRows-1;te.setTranslate(ie+v*ne,oe+f*re),te.render(Q.getChildContainer(),v-i,f-i)}}}if(g.isCellMaximized(e,q))d(e,g.getCell(e,q)).getChildContainer().prepareContentPane()}V.length>0&&p.renderBodyCountLabels(e,V)},_renderCategoryNodes:(e,a,i)=>{var o,n,r={},l=g.getNodeCount(e),s=g.getGroupBehavior(e),h=t.Agent.isRightToLeft(e.getCtx()),u=g.getHighlightedItems(e),c={};if(u)for(var C=0;C<u.length;C++)c[u[C].id]=!0;for(var _=0;_<l;_++){var p=g.getNode(e,_);if(!g.isNodeHidden(e,p)){var b=r;"withinCell"==s&&((b=r[o=g.getCellIndex(e,p)+""])||(b={},r[o]=b));var v=b[o=g.getNodeGroupId(p)];v||((v={}).id=o,"withinCell"==s&&(v.cell=g.getCellIndex(e,p)),v.nodeIndices=[],v.highlightedCount=0,b[o]=v),v.nodeIndices.push(_),c[g.getNode(e,_).id]&&v.highlightedCount++}}if("withinCell"==s)for(var f in n={},r)n[f]=I._processOtherThreshold(e,r[f]);else n=I._processOtherThreshold(e,r);var x=n;if(e.getOptions().__groups=x,"acrossCells"==s){var y=[];for(var m in x)y.push(m);y.sort((e,t)=>g.compareCategoryNodeSize(x[e],x[t]));for(var S=Math.sqrt(i.w*i.h*.15/l),w=0;w<y.length;w++){for(var N=y[w],D=0,E=0,T=x[N].nodeIndices.length,O=0;O<T;O++){var M=g.getNode(e,x[N].nodeIndices[O]);D+=g.getXPercentage(e,M),E+=g.getYPercentage(e,M)}D/=T,E/=T;var R=new A(e,x[N]);R.setTranslate(i.x+(h?1-D:D)*i.w,i.y+(1-E)*i.h),R.render(a,S,0),R.setMaxAlpha(.8)}}else if("withinCell"==s){for(var L=g.getRowCount(e)*g.getColCount(e),P=[],H=0;H<L;H++)if(x[H]&&!g.isCellMinimized(e,H)){var F=g.getCell(e,H);P[H]=I._forceLayoutGroups(x[H],F.__childArea.w,F.__childArea.h)}for(var B=40,G=0;G<L;G++)x[G]&&!g.isCellMinimized(e,G)&&(B=Math.min(B,P[G].scale));for(var k=0;k<L;k++)if(x[k]&&!g.isCellMinimized(e,k)){var z=P[k].positions,U=P[k].center,K=g.getCell(e,k),W=d(e,K).getChildContainer(),j=W instanceof t.SimpleScrollableContainer;for(var V in z){var Y=new A(e,x[k][V]);Y.setTranslate(K.__childArea.x+K.__childArea.w/2+B*(z[V].x-U.x),(j?0:K.__childArea.y)+K.__childArea.h/2+B*(z[V].y-U.y)),Y.render(j?W.getScrollingPane():W,B,3)}}}},_adjustAvailSpace:e=>{e.x=Math.round(e.x),e.y=Math.round(e.y),e.w=Math.round(e.w),e.h=Math.round(e.h)},_renderInitialSelection:e=>{if(e.isSelectionSupported()){var t=new Map,a=[],i=g.getSelectedItems(e);if(i){for(var o=0;o<i.length;o++)t.set(i[o],!0);var n=e.getObjects();if(g.getGrouping(e))for(var r=0;r<n.length;r++)if("categoryNode"===n[r].nboxType){for(var l=n[r].getData().nodeIndices,s=!0,d=0;d<l.length;d++){var h=g.getNode(e,l[d]);if(!t.get(h.id)){s=!1;break}}if(s){var u=g.getDrawer(e);if(!u||u.id!==n[o].getId()){for(d=0;d<l.length;d++)h=g.getNode(e,l[d]),t.set(h.id,!1);a.push(n[r].getId())}}}t.forEach((e,t)=>{e&&a.push(t)})}e.getSelectionHandler().processInitialSelections(a,n)}},_forceLayoutGroups:(e,a,i)=>{var o=[];for(var n in e)o.push(n);o.sort((t,a)=>g.compareCategoryNodeSize(e[t],e[a]));for(var r={},l=2*Math.PI/o.length,s=0;s<o.length;s++){var d=s*Math.cos(l*s),h=s*Math.sin(l*s);r[o[s]]=D.create(d,h)}for(var u=1,c=-.25*i/Math.max(a,i),C=-.25*a/Math.max(a,i);u>.005;){for(var _={},p=0;p<o.length;p++){var b=o[p],v=r[b],f=e[b].nodeIndices.length;_[b]=D.create(u*c*v.x,u*C*v.y);for(var x=0;x<o.length;x++)if(p!=x){for(var y,m=o[x],S=r[m],w=e[m].nodeIndices.length,N=D.subtract(v,S),A=D.getMagnitude(N),I=Math.atan2(N.y,N.x);I<0;)I+=Math.PI/2;for(;I>=Math.PI/2;)I-=Math.PI/2;if(A<(y=I<Math.PI/4?.5*(Math.sqrt(f)+Math.sqrt(w))/Math.cos(I):.5*(Math.sqrt(f)+Math.sqrt(w))/Math.sin(I))){var E=w/(f+w)*((y-A)/A);_[b]=D.add(_[b],D.scale(N,(1-u)*E))}}}for(var T=0;T<o.length;T++){var O=o[T];r[O]=D.add(r[O],_[O])}u*=.98}for(var M=Number.MAX_VALUE,R=-Number.MAX_VALUE,L=Number.MAX_VALUE,P=-Number.MAX_VALUE,H=0;H<o.length;H++){var F=o[H],B=Math.sqrt(e[F].nodeIndices.length),G=r[F];M=Math.min(M,G.x-B/2),R=Math.max(R,G.x+B/2),L=Math.min(L,G.y-B/2),P=Math.max(P,G.y+B/2)}var k=a/(R-M),z=i/(P-L),U=(M+R)/2,K=(L+P)/2;return{scale:Math.min(k,z),center:new t.Point(U,K),positions:r}},_processOtherThreshold:(e,t)=>{var a=g.getNodeCount(e),i=g.getOtherThreshold(e)*a;if(i<=1)return t;var o={},n={};if("withinCell"==g.getGroupBehavior(e))for(var r in t){var l=t[r];n.cell=l.cell;break}for(var s in n.id="other",n.nodeIndices=[],n.otherNode=!0,t){var d=t[s];if(d.nodeIndices.length<i)for(var h=0;h<d.nodeIndices.length;h++)n.nodeIndices.push(d.nodeIndices[h]);else o[s]=d}return n.nodeIndices.length>0&&(o.other=n),o},_renderDrawer:(e,t,a)=>{var i=g.getDrawer(e);i&&(g.getCategoryNode(e,i.id)?new x(e,i).render(t,a):(e.getOptions()._drawer=null,g.fireOptionChangeEvent(e,"_drawer",null)))},animateUpdate:(e,t,a)=>{I._animateCells(e,t,a),I._animateNodes(e,t,a);var i=g.getDrawer(t);i=i?i.id:null;var o=g.getDrawer(a);i!=(o=o?o.id:null)&&I._animateDrawer(e,t,a)},_animateCells:(e,t,a)=>{for(var i=g.getRowCount(t),o=g.getRowCount(a),n=g.getColCount(t),r=g.getColCount(a),l=i*n,s=o*r,h=[],u=[],c=0;c<l;c++)h.push(d(t,g.getCell(t,c)));for(var C=0;C<s;C++)u.push(d(a,g.getCell(a,C)));if(i==o&&n==r){for(var _=!0,p=0;p<o;p++){if(g.getRow(t,p).id!=g.getRow(a,p).id){_=!1;break}}if(_)for(var b=0;b<r;b++){if(g.getCol(t,b).id!=g.getCol(a,b).id){_=!1;break}}if(_)return void e.constructAnimation(h,u)}e.constructAnimation(h,[]),e.constructAnimation([],u)},_animateNodes:(e,t,a)=>{for(var i=g.getNodeCount(t),o=g.getNodeCount(a),n=[],r=[],l=0;l<i;l++)n.push(d(t,g.getNode(t,l)));for(var s=0;s<o;s++)r.push(d(a,g.getNode(a,s)));e.constructAnimation(n,r);var h=g.getDrawer(t);if(!g.getDrawer(a)){var u=I._getSortedGroups(t),c=I._getSortedGroups(a);h&&(g.getMaximizedCellIndex(t)!=g.getMaximizedCellIndex(a)?(u=u.filter(e=>e.getData().cell!=g.getMaximizedCellIndex(t)),c=c.filter(e=>e.getData().cell!=g.getMaximizedCellIndex(t))):(u=null,c=null)),e.constructAnimation(u,c)}},_getSortedGroups:e=>{var t=g.getGroupBehavior(e),a=e.getOptions().__groups,i=[];if(a)if("withinCell"==t)for(var o=g.getRowCount(e)*g.getColCount(e),n=0;n<o;n++)for(var r=a[n+""],l=I._getSortedGroupsFromContainer(e,r),s=0;s<l.length;s++)i.push(l[s]);else i=I._getSortedGroupsFromContainer(e,a);return i},_getSortedGroupsFromContainer:(e,t)=>{var a=[];for(var i in t){var o=d(e,t[i]);o&&a.push(o)}return a.sort((e,t)=>{var a=e.getId(),i=t.getId();return a==i?0:a<i?-1:1}),a},_animateDrawer:(e,t,a)=>{var i=g.getDrawer(t);i=i?[d(t,i)]:null;var o=g.getDrawer(a);o=o?[d(a,o)]:[],e.constructAnimation(i,o)},getNodeOrderFunction:e=>{var a=[],i=g.getDrawer(e);if(i)for(var o=d(e,i).getChildContainer().getScrollingPane(),n=0;n<o.getNumChildren();n++)a.push(o.getChildAt(n));else for(var r=g.getRowCount(e)*g.getColCount(e),l=0;l<r;l++){var s=[],h=g.getCell(e,l),u=d(e,h).getChildContainer();u instanceof t.SimpleScrollableContainer&&(u=u.getScrollingPane());for(var c=0;c<u.getNumChildren();c++)s.push(u.getChildAt(c));a.push(s)}return()=>{if(a.length)if(a[0]&&isNaN(a[0].length)){var i=g.getDrawer(e);if(i)for(var o=d(e,i).getChildContainer().getScrollingPane(),n=0;n<a.length;n++)o.addChild(a[n])}else for(var r=0;r<a.length;r++){var l=a[r],s=g.getCell(e,r);if(l.length&&s){var h=d(e,s).getChildContainer();h instanceof t.SimpleScrollableContainer&&(h=h.getScrollingPane());for(var u=0;u<l.length;u++)h.addChild(l[u])}}}},_renderEmptyText:(e,a,i)=>{var o=e.getOptions(),n=o.translations.labelInvalidData;e.renderEmptyText(a,n,new t.Rectangle(i.x,i.y,i.w,i.h),e.getEventManager(),o._statusMessageStyle)}};class E extends t.BaseComponent{constructor(e,t,a){super(e,t,a),this.Defaults=new S(e),this.EventManager=new N(this),this.EventManager.addListeners(this),this.EventManager.setKeyboardHandler(this.CreateKeyboardHandler(this.EventManager)),this.setId("nbox1000"+Math.floor(1e9*Math.random())),this._peers=[],this._animationAllowed=!0,this._dropObj=[]}SetOptions(e){super.SetOptions(e),e||(e=this.getSanitizedOptions()),e?(this.Options=this.Defaults.calcOptions(e),g.processDataObj(this),t.Agent.isEnvironmentTest()&&(this.Options.animationOnDisplay="none",this.Options.animationOnDataChange="none")):this.Options||(this.Options=this.GetDefaults()),this._displayables=[],this.Options.__displayableCache=new t.BaseComponentCache;var a=this.Options.selectionMode;this._selectionHandler="single"==a?new t.SelectionHandler(this.getCtx(),t.SelectionHandler.TYPE_SINGLE):"multiple"==a?new t.SelectionHandler(this.getCtx(),t.SelectionHandler.TYPE_MULTIPLE):null,this.EventManager.setSelectionHandler(this._selectionHandler)}render(e,a,i){var o=h.getAnimOnDataChange(this),n=null;this.Options&&"none"!==o&&((n={options:this.Options,getOptions:function(){return this.options},displayables:this._displayables,getDisplayables:function(){return this.displayables},id:this.getId(),getId:function(){return this.id}}).getOptions=n.getOptions,n.getDisplayables=n.getDisplayables,n.getId=n.getId),this.__cleanUp(),this.StopAnimation(),this.SetOptions(e),!g.getGrouping(this)&&this.getOptions()._drawer&&(this.getOptions()._drawer=null),isNaN(a)||isNaN(i)||(this.Width=a,this.Height=i);var r=new t.Container(this.getCtx());if(this.addChild(r),I.render(this,r,new t.Rectangle(0,0,this.Width,this.Height)),e&&g.getDrawer(this)&&g.getGrouping(this)){var l=d(this,g.getDrawer(this));this.EventManager.setFocus(l),this.EventManager.setFocused(!1)}this._updateKeyboardFocusEffect();var s=h.getAnimOnDisplay(this),c=h.getAnimDuration(this),C=new t.Rectangle(0,0,this.Width,this.Height),_=!1;if(this._container){if("none"!=o&&e)if(this.Animation=t.BlackBoxAnimationHandler.getCombinedAnimation(this.getCtx(),o,this._container,r,C,c),this.Animation)_=!0;else{this._deleteContainer=new t.Container(this.getCtx(),"g","DeleteContainer"),this.addChild(this._deleteContainer);var p=new u(this.getCtx(),this._deleteContainer,n,this),b=I.getNodeOrderFunction(this);p.constructAnimation([n],[this]),this.Animation=p.getAnimation(),t.Playable.appendOnEnd(this.Animation,b,this)}}else"none"!==s&&(this.Animation=t.BlackBoxAnimationHandler.getInAnimation(this.getCtx(),s,r,C,c));this.Animation?(this.setMouseEnabled(!1),t.Playable.appendOnEnd(this.Animation,this._getOnAnimationEndFunction(e),this),this.Animation.play()):this._getOnAnimationEndFunction(e)(),_?this._oldContainer=this._container:this._container&&(this.removeChild(this._container),this._container.destroy()),this._container=r,this.UpdateAriaAttributes()}select(e){this.Options.selection=t.JsonUtils.clone(e),I.processInitialSelections(this)}__cleanUp(){this.EventManager.hideTooltip(),this._peers.length=0}_getOnAnimationEndFunction(e){return()=>{this._oldContainer&&(this.removeChild(this._oldContainer),this._oldContainer.destroy(),this._oldContainer=null),this._deleteContainer&&(this.removeChild(this._deleteContainer),this._deleteContainer.destroy()),this._deleteContainer=null,this.setMouseEnabled(!0),this.AnimationStopped||(this.Animation&&("ie"===t.Agent.browser||"edge"===t.Agent.browser)&&t.Agent.version>=12&&(this.Animation=null,this.setAnimationAllowed(!1),this.render(e),this.setAnimationAllowed(!0)),this.RenderComplete()),this.Animation=null,this.AnimationStopped=!1}}CreateKeyboardHandler(e){return new _(e,this)}getChildContainer(){return this._container}getDeleteContainer(){return this._deleteContainer}getDisplayables(){return this._displayables}_updateKeyboardFocusEffect(){var e,t=this.EventManager.getFocus(),a=!1;t&&(a=t.isShowingKeyboardFocusEffect(),t.getKeyboardFocusDisplayable&&(e=t.getKeyboardFocusDisplayable()),e&&a&&e.showKeyboardFocusEffect(),this.EventManager.setFocus(e))}processEvent(e){var t=e.type;"categoryHighlight"==t?e=this._processRolloverEvent(e):"selection"==t&&(e=this._processSelectionEvent(e)),e&&this.dispatchEvent(e)}_processRolloverEvent(e){return this._processHighlighting(e.categories),e}_processSelectionEvent(e){var a=e.selection,i=null;if(a){for(var o=new Map,n=0;n<a.length;n++)o.set(a[n],!0);var r=this.getObjects(),l=null;if(g.getGrouping(this))for(var s=0;s<r.length;s++)if("categoryNode"===r[s].nboxType){if(o.get(r[s].getId())){o.set(r[s].getId(),!1);for(var d=r[s].getData().nodeIndices,h=0;h<d.length;h++){var u=g.getNode(this,d[h]);o.set(u.id,!0)}}}else"drawer"===r[n].nboxType&&(l=r[n]);var c=[];i=[],o.forEach((e,t)=>{e&&(c.push(t),i.push(t))}),e=t.EventFactory.newSelectionEvent(c)}return g.setSelectedItems(this,i),l&&l.UpdateAccessibilityAttr(),e}registerObject(e){this._peers.push(e)}getObjects(){return this._peers}getWidth(){return this.Width}getHeight(){return this.Height}getSelectionHandler(){return this._selectionHandler}isSelectionSupported(){return!!this._selectionHandler}animateUpdate(e,t){I.animateUpdate(e,t,this)}getSanitizedOptions(){return t.JsonUtils.clone(this.getOptions(),e=>0!=e.indexOf("__"),this.Defaults.getNoCloneObject())}getSubcomponentStyles(){return{}}__isDragAvailable(e){return this._selectionHandler?e[0]:null}__getDragTransferable(e){e.isSelected()||(this._selectionHandler.processClick(e,!1),this.EventManager.fireSelectionEvent());for(var t=[],a={},i=this._selectionHandler.getSelection(),o=0;o<i.length;o++){var n=i[o];if("node"===n.nboxType){var r=n.getData().id;t.push(r),a[r]=!0}else if("categoryNode"===n.nboxType){for(var l=n.getData().nodeIndices,s=0;s<l.length;s++){var d=g.getNode(this,l[s]).id;t.push(d),a[d]=!0}a[n.getData().id]=!0}}for(var h=this._selectionHandler.getSelectedIds(),u=0;u<h.length;u++){var c=h[u];if(!a[c])if(isNaN(g.getNodeIndex(this,c))){if(g.getGrouping(this)&&g.getCategoryNode(this,c)){for(var C=g.getCategoryNode(this,c).nodeIndices,_=0;_<C.length;_++){var p=g.getNode(this,C[_]).id;a[p]||(t.push(p),a[p]=!0)}a[c]=!0}}else t.push(c),a[c]=!0}return t}__getDragFeedback(){return this._selectionHandler.getSelection().slice(0)}__getCellUnderPoint(e,t){for(var a=g.getRowCount(this)*g.getColCount(this),i=0;i<a;i++){var o=d(this,g.getCell(this,i));if(o.contains(e,t))return o}return null}__showDropSiteFeedback(e){return this._dropSiteFeedback&&(this._dropSiteFeedback.getParent().removeChild(this._dropSiteFeedback),this._dropSiteFeedback=null),e&&(this._dropSiteFeedback=e.renderDropSiteFeedback()),this._dropSiteFeedback}getAutomation(){return this.Automation||(this.Automation=new m(this)),this.Automation}GetComponentDescription(){var e=this.getOptions().translations;return g.hasValidData(this)?t.ResourceUtils.format(e.componentName,[g.getColCount(this)*g.getRowCount(this)]):e.labelInvalidData}highlight(e){this.Options.highlightedCategories=t.JsonUtils.clone(e),this._processHighlighting(e)}_processHighlighting(e){var a=this.getNodeDisplayables(),i=this,o=a=>{if("node"===a.nboxType){if(a.getCategories())return"all"==i.getOptions().highlightMatch?t.ArrayUtils.hasAllItems(e,a.getCategories()):t.ArrayUtils.hasAnyItem(e,a.getCategories())}else if("categoryNode"===a.nboxType)for(var o=a.getData(),n=o.nodeIndices.length,r=0;r<n;r++){var l=g.getNode(i,o.nodeIndices[r]);if(l.categories&&("all"==i.getOptions().highlightMatch?t.ArrayUtils.hasAllItems(e,l.categories):t.ArrayUtils.hasAnyItem(e,l.categories)))return!0}return!1},n=g.getRowCount(i)*g.getColCount(i);i.getOptions().__highlightedMap=null;for(var r=0;r<n;r++){var l=g.getCell(i,r),s=d(i,l);p.renderHeader(i,l,s,!1)}var u=g.getHighlightedItems(i),c={};if(u)for(var C=0;C<u.length;C++)c[u[C].id]=!0;for(var _=0;_<a.length;_++)if(e&&e.length>0&&!o(a[_])?a[_].setAlpha(h.getFadedNodeAlpha(this)):a[_].setAlpha(1),"categoryNode"===a[_].nboxType){for(var b=0,f=a[_].getData(),x=0;x<f.nodeIndices.length;x++)c[f.nodeIndices[x]]&&(b+=1);f.highlightedCount=b;var y=null!=h.getStyledCategoryIndicatorIcon(i,f)||null!=h.getCategoryNodeIndicatorColor(i,f);v._renderNodeCount(i,a[_].getData(),a[_],f.__scale,y,f.__gap)}}getNodeDisplayables(){for(var e=[],t=g.getNodeCount(this),a=0;a<t;a++)e.push(g.getNode(this,a));var i=g.getGroupBehavior(this),o=this.getOptions().__groups;if(o)if("withinCell"==i)for(var n=g.getRowCount(this)*g.getColCount(this),r=0;r<n;r++){var l=o[r+""];for(var s in l)e.push(l[s])}else for(var h in o)e.push(o[h]);for(var u=[],c=0;c<e.length;c++){var C=d(this,e[c]);C&&u.push(C)}return u}isAnimationAllowed(){return this._animationAllowed}setAnimationAllowed(e){this._animationAllowed=e}setCellFilter(e){this._filter=e}getCellFilter(){return this._filter}setNodeClipPath(e){this._nodeClipPath=e}getNodeClipPath(){return this._nodeClipPath}setNodeIconClipPath(e){this._nodeIconClipPath=e}getNodeIconClipPath(){return this._nodeIconClipPath}getActiveCut(){return this._activeCut}setActiveCut(e){if(this._activeCut&&this._activeCut.length>0)for(let e=0;e<this._activeCut.length;e++)this._activeCut[e].setAlpha(1);if(e)for(let a=0;a<e.length;a++){var t=h.getNodeCutAlpha(this);e[a].setAlpha(t)}this._activeCut=e}addDropEffectObj(e){this._dropObj.push(e)}getDropEffectObj(){return this._dropObj}clearDropEffectObj(){this._dropObj=[]}static getDefaults(e){return(new S).getDefaults(e)}}e.NBox=E,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ojnbox-toolkit.js.map