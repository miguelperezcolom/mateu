{"version":3,"file":"LineSeries-53e65053.js","sources":["../../src/PRIVATE_Chart/MarkerLabel.tsx","../../src/PRIVATE_LineAreaComponents/LineSeries.tsx","../../src/PRIVATE_Chart/MarkersWithLabel.tsx"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport { styles } from '#PRIVATE_Chart/themes/ChartStyles.css';\nimport { VNode } from 'preact';\nimport { classNames } from '#utils/UNSAFE_classNames';\nimport { VisLabelStyle } from '#utils/UNSAFE_visTypes/common/textTypes';\nimport { updateVisTextStyleProperties } from '#utils/UNSAFE_visUtils/textUtils';\nimport { Dimension } from '#utils/UNSAFE_visTypes/common';\nimport { Font } from '#hooks/PRIVATE_useTextDimensions';\nimport { getLabelPosition } from '#utils/PRIVATE_chartUtils/utils';\n\nconst DEFAULT_POSITION = 'center';\n\ntype Props = {\n  labelPosition?: 'belowMarker' | 'aboveMarker' | 'beforeMarker' | 'afterMarker' | 'center';\n  label?: string;\n  labelStyle?: VisLabelStyle;\n  tx?: number;\n  ty?: number;\n  defaultFontSize: string;\n  dataLabelEffect: 'outline' | 'none';\n  isHighContrast: boolean;\n  getTextDimensions?: (text: string, style: Font) => Dimension;\n};\n\nexport function MarkerLabel({\n  labelPosition,\n  label,\n  labelStyle,\n  tx,\n  ty,\n  defaultFontSize,\n  dataLabelEffect,\n  isHighContrast,\n  getTextDimensions\n}: Props) {\n  let markerLabel: VNode | null = null;\n  const position = labelPosition ? labelPosition : DEFAULT_POSITION;\n  const { dataLabelStyle, dataLabelContrast, highContrastLabelStyle } = styles;\n  const labelString = label;\n\n  if (position && labelString) {\n    const markerLabelStyle = {\n      fontSize: defaultFontSize,\n      ...updateVisTextStyleProperties(labelStyle)\n    };\n\n    const labelDims = getTextDimensions?.(labelString, markerLabelStyle);\n    const { x, y } = getLabelPosition(position, tx, ty, labelDims);\n    markerLabel = (\n      <text\n        x={x}\n        y={y}\n        class={classNames([\n          dataLabelStyle,\n          dataLabelEffect === 'outline' ? dataLabelContrast : '',\n          isHighContrast ? highContrastLabelStyle : ''\n        ])}\n        style={markerLabelStyle}>\n        {labelString}\n      </text>\n    );\n  }\n  return markerLabel;\n}\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport { ColorProps } from '#utils/UNSAFE_interpolations/colors';\nimport { isNonCurvedLine } from '#utils/PRIVATE_chartUtils/utils';\nimport { getCmdsForLine, Point } from '#utils/PRIVATE_visSVGUtils';\nimport { styles } from '#PRIVATE_Chart/themes/ChartStyles.css';\nimport { Property } from 'csstype';\nimport { AllLineType } from '#utils/UNSAFE_visTypes/common/common.types';\n\ntype LineSeriesProps = {\n  color: ColorProps['color'];\n  lineStyle?: 'dotted' | 'dashed' | 'solid';\n  lineColor?: Property.Color;\n  lineWidth?: number;\n  lineType?: AllLineType;\n  isHorizontal: boolean;\n  lineSegmentCoords: Point[][];\n  isHighlighted: boolean;\n  seriesIndex: number;\n  groupWidth?: number;\n  isRtl?: boolean;\n  timeAxisType?: 'enabled' | 'skipGaps' | 'mixedFrequency';\n  plotAreaClipPathId?: string;\n};\n\nexport function LineSeries({\n  color,\n  isHorizontal,\n  lineType = 'straight',\n  lineColor,\n  lineStyle,\n  lineWidth = 3,\n  isHighlighted,\n  lineSegmentCoords,\n  seriesIndex,\n  groupWidth,\n  isRtl,\n  timeAxisType,\n  plotAreaClipPathId\n}: LineSeriesProps) {\n  const style = {\n    stroke: lineColor || color,\n    strokeDasharray: lineStyle === 'dotted' ? 3 : lineStyle === 'dashed' ? 6 : undefined,\n    strokeWidth: lineWidth,\n    fill: 'none'\n  };\n  return (\n    <>\n      {lineSegmentCoords.map((value: Point[]) => {\n        if (value.length < 2) {\n          return;\n        }\n        const cmds = getCmdsForLine(value, lineType, isHorizontal, groupWidth, isRtl, timeAxisType);\n        return isNonCurvedLine(lineType) ? (\n          <g clip-path={`url(#${plotAreaClipPathId})`}>\n            {cmds.split(' ').map((cmd) => (\n              <polyline\n                points={cmd}\n                style={style}\n                className={isHighlighted ? undefined : styles.dimmed}\n                data-oj-private-series-index={seriesIndex}\n                data-oj-private-object={'line'}\n              />\n            ))}\n          </g>\n        ) : lineType === 'curved' ? (\n          <path\n            d={cmds}\n            clip-path={`url(#${plotAreaClipPathId})`}\n            style={style}\n            className={isHighlighted ? undefined : styles.dimmed}\n            data-oj-private-series-index={seriesIndex}\n            data-oj-private-object={'line'}\n          />\n        ) : undefined;\n      })}\n    </>\n  );\n}\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport { ColorProps } from '#utils/UNSAFE_interpolations/colors';\nimport { LineAreaItem } from '#UNSAFE_LineAreaChart/lineAreaChart.types';\nimport { Marker, MARKER_PADDING } from '#PRIVATE_SvgShapes';\nimport { MarkerShapes } from '#utils/UNSAFE_visTypes/common';\nimport { getGroupCenterCoord } from '#utils/PRIVATE_chartUtils/layoutUtils';\nimport { ChartSeriesData, Scale, Group } from '#utils/UNSAFE_visTypes/chart';\nimport { getMarkerFillAndStroke } from '#utils/PRIVATE_chartUtils/utils';\nimport { supportsMobileScreenReader } from '#utils/UNSAFE_visUtils';\nimport { MarkerLabel } from './MarkerLabel';\nimport { styles } from '#PRIVATE_Chart/themes/ChartStyles.css';\nimport { Dimension } from '#utils/UNSAFE_visTypes/common';\nimport { Font } from '#hooks/PRIVATE_useTextDimensions';\nimport { ScatterItem } from '#UNSAFE_ScatterChart/scatterChart.types';\n\nconst MARKER_DEFAULT_SIZE = 10;\ntype MarkersProps<K, D> = {\n  yScale: Scale;\n  xScale: Scale;\n  startIndex: number;\n  endIndex: number;\n  seriesIndex: number;\n  series: ChartSeriesData<K, D>;\n  markerType: MarkerShapes;\n  color: ColorProps['color'];\n  groups: Group[];\n  focusedItemIndex?: number;\n  isSelectionEnabled: boolean;\n  hoveredItemIndex?: number;\n  selectedIds?: Set<string | number>;\n  hiddenIds?: Set<string | number>;\n  highlightedIds?: Set<string | number>;\n  activeId?: string;\n  orientation: 'horizontal' | 'vertical';\n  isDrillEnabled: boolean;\n  isLog: boolean;\n  isPointInsideMarquee: ((id: K, point: { x: number; y: number }) => boolean) | undefined;\n  getDataItem: (seriesIndex: number, groupIndex: number) => D | undefined;\n  timeAxisType?: 'enabled' | 'skipGaps' | 'mixedFrequency';\n  defaultFontSize: string;\n  dataLabelEffect: 'outline' | 'none';\n  isHighContrast: boolean;\n  isTestEnv?: boolean;\n  isDataXAxis?: boolean;\n  getTextDimensions?: (text: string, style: Font) => Dimension;\n  itemValueFormatter?: (value: number) => string;\n  getItemAriaLabel: (\n    data: D,\n    seriesIndex: number,\n    groupIndex: number,\n    isSelectionEnabled: boolean,\n    isSelected: boolean,\n    isDrillable: boolean\n  ) => string;\n};\n\nexport function MarkersWithLabel<\n  K extends string | number,\n  D extends LineAreaItem<K> | ScatterItem<K>\n>({\n  yScale,\n  xScale,\n  color,\n  seriesIndex,\n  startIndex,\n  endIndex,\n  hiddenIds,\n  selectedIds,\n  highlightedIds,\n  orientation,\n  isLog,\n  markerType,\n  getDataItem,\n  focusedItemIndex,\n  hoveredItemIndex,\n  isDrillEnabled,\n  activeId,\n  isSelectionEnabled,\n  timeAxisType,\n  isPointInsideMarquee,\n  groups,\n  defaultFontSize,\n  dataLabelEffect,\n  isHighContrast,\n  isTestEnv,\n  isDataXAxis,\n  getTextDimensions,\n  getItemAriaLabel\n}: MarkersProps<K, D>) {\n  const isHoriz = orientation === 'horizontal';\n  const items = [];\n  for (let groupIndex = startIndex; groupIndex < endIndex + 1; groupIndex++) {\n    const item = getDataItem(seriesIndex, groupIndex);\n    if (!item || hiddenIds?.has(item.id)) {\n      continue;\n    }\n    let x, y;\n    const itemHasValue = 'value' in item;\n    if (isDataXAxis && 'y' in item) {\n      x = xScale.transform(item.x);\n      y = yScale.transform(item.y);\n    } else {\n      const value = itemHasValue ? item?.value : undefined;\n      if (value == null || (isLog && value <= 0)) {\n        continue;\n      }\n      x = isHoriz\n        ? yScale.transform(value)\n        : getGroupCenterCoord<K, D>(groups[groupIndex], groupIndex, xScale, item, timeAxisType);\n      y = isHoriz\n        ? getGroupCenterCoord<K, D>(groups[groupIndex], groupIndex, xScale, item, timeAxisType)\n        : yScale.transform(value);\n    }\n    const isFocused = focusedItemIndex === groupIndex;\n    const isHovered = hoveredItemIndex === groupIndex;\n    const isSelected = !!(selectedIds?.has(item.id!) || isPointInsideMarquee?.(item.id, { x, y })); // TODO: tagcloud has isItemSelected we should look to leverage here\n    const isDrillable = item.drilling === 'on' || (item.drilling != 'off' && isDrillEnabled);\n    const isHighlighted =\n      !highlightedIds || highlightedIds?.size === 0 || highlightedIds?.has(item.id); // TODO: tagcloud has isItemHighlighted we should look to leverage here\n    const { fill, stroke, outerStroke } = getMarkerFillAndStroke(\n      !!item.isMarkerDisplayed,\n      isSelectionEnabled,\n      isHovered,\n      isFocused,\n      isSelected,\n      color,\n      item.markerColor\n    );\n    const itemMarkerType = item.isMarkerDisplayed ? item.markerType || markerType : markerType;\n    const isActive = isFocused || isHovered;\n    const ariaLabel =\n      supportsMobileScreenReader || isActive\n        ? getItemAriaLabel(\n            item,\n            seriesIndex,\n            groupIndex,\n            isSelectionEnabled,\n            !!isSelected,\n            isDrillable\n          )\n        : undefined;\n\n    const dataInfo = {\n      'data-oj-private-series-index': seriesIndex,\n      'data-oj-private-group-index': groupIndex,\n      'data-oj-private-object': 'item',\n      id: isActive ? activeId : undefined,\n      role: ariaLabel ? 'img' : undefined,\n      'aria-label': ariaLabel,\n      'data-oj-private-item-id': isTestEnv ? item.id : undefined\n    };\n\n    const markerSize = (item.markerSize || MARKER_DEFAULT_SIZE) + 2 * MARKER_PADDING;\n    items.push(\n      <>\n        <Marker\n          type={itemMarkerType}\n          tx={x}\n          ty={y}\n          isInteractive={isDrillable || isSelectionEnabled}\n          scale={1}\n          fill={fill}\n          stroke={stroke}\n          outerStroke={outerStroke}\n          width={markerSize}\n          height={markerSize}\n          dataInfo={dataInfo}\n          preserveRectAspectRatio\n          styleClass={isHighlighted ? undefined : styles.dimmed}\n        />\n        <MarkerLabel\n          labelPosition={item.labelPosition}\n          label={item.label}\n          labelStyle={item.labelStyle}\n          tx={x}\n          ty={y}\n          defaultFontSize={defaultFontSize}\n          dataLabelEffect={dataLabelEffect}\n          isHighContrast={isHighContrast}\n          getTextDimensions={getTextDimensions}\n        />\n      </>\n    );\n  }\n  return <>{items}</>;\n}\n"],"names":["MarkerLabel","labelPosition","label","labelStyle","tx","ty","defaultFontSize","dataLabelEffect","isHighContrast","getTextDimensions","markerLabel","position","dataLabelStyle","dataLabelContrast","highContrastLabelStyle","styles","labelString","markerLabelStyle","fontSize","updateVisTextStyleProperties","labelDims","x","y","getLabelPosition","_jsx","class","classNames","style","color","isHorizontal","lineType","lineColor","lineStyle","lineWidth","isHighlighted","lineSegmentCoords","seriesIndex","groupWidth","isRtl","timeAxisType","plotAreaClipPathId","stroke","strokeDasharray","undefined","strokeWidth","fill","map","value","length","cmds","getCmdsForLine","isNonCurvedLine","children","split","cmd","points","className","dimmed","d","yScale","xScale","startIndex","endIndex","hiddenIds","selectedIds","highlightedIds","orientation","isLog","markerType","getDataItem","focusedItemIndex","hoveredItemIndex","isDrillEnabled","activeId","isSelectionEnabled","isPointInsideMarquee","groups","isTestEnv","isDataXAxis","getItemAriaLabel","isHoriz","items","groupIndex","item","has","id","itemHasValue","transform","getGroupCenterCoord","isFocused","isHovered","isSelected","isDrillable","drilling","size","outerStroke","getMarkerFillAndStroke","isMarkerDisplayed","markerColor","itemMarkerType","isActive","ariaLabel","supportsMobileScreenReader","dataInfo","role","markerSize","MARKER_PADDING","push","_jsxs","jsxs","_Fragment","Fragment","jsx","Marker","type","isInteractive","scale","width","height","preserveRectAspectRatio","styleClass"],"mappings":"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"}