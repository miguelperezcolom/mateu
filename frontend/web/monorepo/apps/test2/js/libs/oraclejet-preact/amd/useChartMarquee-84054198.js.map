{"version":3,"file":"useChartMarquee-84054198.js","sources":["../../src/hooks/PRIVATE_useChartMarquee/utils.ts","../../src/hooks/PRIVATE_useChartMarquee/Marquee.tsx","../../src/hooks/PRIVATE_useChartMarquee/useChartMarquee.tsx"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport { Dimension } from '#utils/UNSAFE_visTypes/common';\n\nexport function getResolvedDragMode(\n  isUserDragModeButtonShown: boolean,\n  isZoomAndScroll: boolean,\n  isMobile: boolean,\n  dragMode: 'off' | 'pan' | 'zoom' | 'user' | 'select',\n  userSelectedDragMode?: 'pan' | 'zoom' | 'select',\n  isMultiSelection?: boolean\n) {\n  if (userSelectedDragMode != undefined && isUserDragModeButtonShown) {\n    // when dragMode api value change happens, userDragMode state can be stale.\n    // only select userDragMode if there is a button that is present to select it.\n    return userSelectedDragMode;\n  }\n\n  if (dragMode === 'user') {\n    if (!isMobile) {\n      return isZoomAndScroll ? 'pan' : isMultiSelection ? 'select' : 'off';\n    }\n  }\n\n  return isMobile ? 'off' : dragMode;\n}\n\nexport function getMarqueeDims(\n  initialPoint: { x: number; y: number } | undefined,\n  finalPoint: { x: number; y: number } | undefined,\n  plotAreaSpace: Dimension,\n  xSpace: Dimension,\n  ySpace: Dimension,\n  treatAsXSpace: boolean\n) {\n  if (initialPoint && finalPoint) {\n    const spaceWidth = plotAreaSpace.x + plotAreaSpace.width;\n    const spaceHeight = plotAreaSpace.y + plotAreaSpace.height;\n\n    let x1 = Math.max(Math.min(initialPoint.x, finalPoint.x), plotAreaSpace.x);\n    let x2 = Math.min(Math.max(initialPoint.x, finalPoint.x), spaceWidth);\n\n    let y1 = Math.max(Math.min(initialPoint.y, finalPoint.y), plotAreaSpace.y);\n    const y2 = Math.min(Math.max(initialPoint.y, finalPoint.y), spaceHeight);\n\n    let width = Math.abs(x2 - x1);\n    let height = Math.abs(y2 - y1);\n\n    if (isPointInsideSpace(initialPoint.x, initialPoint.y, xSpace) || treatAsXSpace) {\n      y1 = plotAreaSpace.y;\n      height = plotAreaSpace.height;\n    } else if (isPointInsideSpace(initialPoint.x, initialPoint.y, ySpace)) {\n      x1 = plotAreaSpace.x;\n      x2 = spaceWidth;\n      width = plotAreaSpace.width;\n    }\n    return {\n      x1,\n      y1,\n      width,\n      height,\n      x2,\n      y2\n    };\n  }\n  return;\n}\n\nexport function getCursorType(\n  currentDragMode: 'zoom' | 'select' | 'pan' | 'off' | 'user',\n  isPointerDown: boolean\n) {\n  if (currentDragMode === 'zoom' || currentDragMode === 'select') {\n    return 'crosshair';\n  }\n\n  if (currentDragMode === 'pan') {\n    return isPointerDown ? 'grabbing' : 'grab';\n  }\n\n  return;\n}\n\nexport function isPointInsideSpace(x: number, y: number, space: Dimension) {\n  if (x >= space.x && x <= space.x + space.width && y >= space.y && y <= space.y + space.height) {\n    return true;\n  }\n  return false;\n}\n\nexport function isPointOutsideTargetSpace(\n  x: number,\n  y: number,\n  plotAreaSpace: Dimension,\n  xSpace: Dimension,\n  ySpace: Dimension\n) {\n  if (\n    !isPointInsideSpace(x, y, plotAreaSpace) &&\n    !isPointInsideSpace(x, y, xSpace) &&\n    !isPointInsideSpace(x, y, ySpace)\n  ) {\n    return true;\n  }\n  return false;\n}\n\nexport function getPanButtonVisibility(\n  isZoomAndScroll: boolean,\n  dragMode: 'off' | 'pan' | 'zoom' | 'user' | 'select',\n  isMobile: boolean\n) {\n  if (!isMobile || !isZoomAndScroll) {\n    return false;\n  }\n\n  return dragMode === 'user' || dragMode === 'pan';\n}\n\nexport function getZoomButtonVisibility(\n  isZoomAndScroll: boolean,\n  isMobile: boolean,\n  dragMode: 'zoom' | 'select' | 'pan' | 'off' | 'user'\n) {\n  if (!isZoomAndScroll) {\n    return false;\n  }\n\n  // In mobile don't show for user mode\n  return (isMobile && dragMode === 'zoom') || (!isMobile && dragMode === 'user');\n}\n\nexport function getSelectButtonVisibility(\n  isMultiSelection: boolean,\n  isZoomScroll: boolean,\n  isMobile: boolean,\n  dragMode: 'zoom' | 'select' | 'pan' | 'user' | 'off'\n) {\n\n  if (!isMultiSelection) {\n    return false;\n  }\n  else if(!isZoomScroll && ( dragMode === 'user' || dragMode === 'select')){\n    return isMobile;\n  }\n  \n  return dragMode === 'user' || (isMobile && dragMode === 'select');\n}\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport { styles } from './themes/useChartMarquee.css';\n\ntype Props = {\n  x1: number;\n  y1: number;\n  width: number;\n  height: number;\n};\nexport function Marquee({ x1, y1, width, height }: Props) {\n  return (\n    <>\n      <rect\n        x={x1}\n        y={y1}\n        width={width}\n        height={height}\n        class={styles.visMarquee}\n        data-oj-private-object=\"marquee\"\n      />\n      <rect\n        x={x1 + 1}\n        y={y1 + 1}\n        width={Math.max(0, width - 2)}\n        height={Math.max(0, height - 2)}\n        class={styles.visMarqueeInnerArea}\n      />\n    </>\n  );\n}\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport { RefObject, VNode } from 'preact';\nimport { useRef, useState } from 'preact/hooks';\nimport { Dimension } from '#utils/UNSAFE_visTypes/common';\nimport { Scale } from '#utils/UNSAFE_visTypes/chart';\nimport {\n  getCursorType,\n  getMarqueeDims,\n  isPointOutsideTargetSpace,\n  isPointInsideSpace,\n  getPanButtonVisibility,\n  getZoomButtonVisibility,\n  getSelectButtonVisibility,\n  getResolvedDragMode\n} from './utils';\nimport { isTouch } from '#utils/UNSAFE_visUtils/clientUtils';\nimport { useVisDragModeControls } from '#hooks/PRIVATE_useVisDragModeControls';\nimport { Marquee } from './Marquee';\nimport { SelectionDetail } from '#hooks/PRIVATE_useVisSelection/useSelection';\nimport { AxisInfo } from '#PRIVATE_Axis/axis.types';\nimport { getElementData } from '#utils/UNSAFE_visUtils';\n\ntype MarqueeProps<K, D> = {\n  rootRef: RefObject<HTMLElement>;\n  chartWidth: number;\n  plotAreaSpace: Dimension;\n  xSpace: Dimension;\n  ySpace: Dimension;\n  isZoomScroll: boolean;\n  isMultiSelection: boolean;\n  onSelectionChange?: (detail: SelectionDetail<K, D>) => void;\n  xScale: Scale;\n  onViewportChange?: (x: { xMin?: number; yMin?: number; xMax?: number; yMax?: number }) => void;\n  dragMode: 'user' | 'select' | 'zoom' | 'pan' | 'off';\n  getDataById: (id: K) => D | undefined;\n  selectedIds?: Set<K>;\n  isRtl: boolean;\n  xAxisInfo: AxisInfo;\n};\n\nexport function useChartMarquee<K, D>({\n  rootRef,\n  plotAreaSpace,\n  xSpace,\n  ySpace,\n  dragMode,\n  chartWidth,\n  isMultiSelection,\n  onViewportChange,\n  isZoomScroll,\n  xScale,\n  selectedIds,\n  getDataById,\n  onSelectionChange,\n  isRtl,\n  xAxisInfo\n}: MarqueeProps<K, D>) {\n  const isDeviceTouch = isTouch();\n  const isHovered = useRef(false);\n  const numOfActiveTouches = useRef(0);\n\n  const { min, max, viewportMax, viewportMin, minAxisExtent } = xAxisInfo;\n\n  const initialPointRef = useRef<{\n    x: number;\n    y: number;\n    isMeta?: boolean;\n  }>();\n\n  const showPanButton = getPanButtonVisibility(isZoomScroll, dragMode, isDeviceTouch);\n  const showZoomButton = getZoomButtonVisibility(isZoomScroll, isDeviceTouch, dragMode);\n  const showSelectButton = getSelectButtonVisibility(\n    isMultiSelection,\n    isZoomScroll,\n    isDeviceTouch,\n    dragMode\n  );\n\n  const { dragButtonDivRef, toggleButtonContent, userDragMode } = useVisDragModeControls({\n    componentWidth: chartWidth,\n    plotAreaSpace,\n    isRtl,\n    showPanButton,\n    showZoomButton,\n    showSelectButton,\n    dragMode\n  });\n\n  // for drag --> dragging cursor rerender in pan mode\n  const [isPointerDown, setIsPointerDown] = useState(false);\n  const isDragActiveRef = useRef(false);\n\n  const [finalPoint, setFinalPoint] = useState<{ x: number; y: number }>();\n\n  const selectedIdsRef = useRef<Set<K>>(new Set());\n\n  const isUserDragModeButtonShown =\n    (showPanButton && userDragMode === 'pan') ||\n    (showSelectButton && userDragMode === 'select') ||\n    (showZoomButton && userDragMode === 'zoom');\n\n  const mode = getResolvedDragMode(\n    isUserDragModeButtonShown,\n    isZoomScroll,\n    isDeviceTouch,\n    dragMode,\n    userDragMode,\n    isMultiSelection\n  );\n\n  const dims = getMarqueeDims(\n    initialPointRef.current,\n    finalPoint,\n    plotAreaSpace,\n    xSpace,\n    ySpace,\n    mode === 'zoom' // We need to revisit this for scatter chart and others charts\n  );\n\n  const onPointerEnter = () => {\n    isHovered.current = true;\n  };\n\n  const onPointerDown = (event: PointerEvent) => {\n    // prevent setIsPointerDown(true) when clicked on button\n    // otherwise the button will disapper before being clicked.\n    if (dragButtonDivRef?.current?.contains(event.target as HTMLElement)) {\n      return;\n    }\n\n    const x = event.offsetX;\n    const y = event.offsetY;\n\n    setIsPointerDown(true);\n\n    if (\n      isPointOutsideTargetSpace(x, y, plotAreaSpace, xSpace, ySpace) ||\n      (mode === 'zoom' && isPointInsideSpace(x, y, ySpace))\n    ) {\n      return;\n    }\n\n    initialPointRef.current = { x, y };\n  };\n\n  const onPointerLeave = (event: PointerEvent) => {\n    isHovered.current = false;\n    if (dims && isDeviceTouch && mode != 'off') {\n      (event.currentTarget as HTMLElement).setPointerCapture(event.pointerId);\n    }\n  };\n\n  const onPointerMove = (event: PointerEvent) => {\n    if (!isPointerDown) {\n      return;\n    }\n\n    isDragActiveRef.current = true;\n\n    if (event.metaKey && initialPointRef.current) {\n      initialPointRef.current.isMeta = true;\n    }\n\n    const x = event.offsetX;\n    const y = event.offsetY;\n\n    if (\n      isPointOutsideTargetSpace(x, y, plotAreaSpace, xSpace, ySpace) ||\n      (mode === 'zoom' && isPointInsideSpace(x, y, ySpace))\n    ) {\n      return;\n    }\n\n    const elementData = getElementData(rootRef, event.target as HTMLElement);\n    const elemType = elementData?.['ojPrivateObject'];\n    const originatedFromOverview =\n      elemType === 'window' || elemType === 'leftHandle' || elemType === 'rightHandle';\n\n    if (\n      !originatedFromOverview &&\n      mode === 'pan' &&\n      onViewportChange &&\n      (!isDeviceTouch || (isDeviceTouch && numOfActiveTouches.current === 1))\n    ) {\n      const axisDelta =\n        xScale.invert(x) - xScale.invert((finalPoint?.x || initialPointRef.current?.x)!);\n\n      const viewportRange = viewportMax - viewportMin;\n\n      let xMin = viewportMin - axisDelta;\n      let xMax = viewportMax - axisDelta;\n\n      if (xMin < min) {\n        xMin = min;\n        xMax = xMin + viewportRange;\n      }\n\n      if (xMax > max) {\n        xMax = max;\n        xMin = xMax - viewportRange;\n      }\n\n      if (xMin != viewportMin && xMax != viewportMax && Math.abs(xMax - xMin) >= minAxisExtent) {\n        onViewportChange({\n          xMin,\n          xMax\n        });\n      }\n    }\n\n    setFinalPoint({ x, y });\n  };\n\n  const onPointerUp = (event: PointerEvent) => {\n    setIsPointerDown(false);\n    setFinalPoint(undefined);\n    initialPointRef.current = undefined;\n    isDragActiveRef.current = false;\n\n    if (dragButtonDivRef.current?.contains(event.target as HTMLElement)) {\n      return;\n    }\n\n    if (!dims) {\n      return;\n    }\n\n    if (mode === 'zoom') {\n      const { x1, x2 } = dims;\n      let xMin = Math.min(xScale.invert(x1), xScale.invert(x2));\n      let xMax = Math.max(xScale.invert(x1), xScale.invert(x2));\n      if (Math.abs(xMax - xMin) < minAxisExtent) {\n        const mid = (xMin + xMax) / 2;\n        xMin = Math.max(min, mid - minAxisExtent / 2);\n        xMax = Math.min(max, xMin + minAxisExtent);\n      }\n      onViewportChange?.({\n        xMin,\n        xMax\n      });\n    }\n\n    if (mode === 'select') {\n      const ids = [\n        ...new Set([\n          ...selectedIdsRef.current,\n          ...(event.metaKey ? selectedIds || new Set<K>() : new Set<K>())\n        ])\n      ];\n      const data = ids.map((id) => getDataById(id));\n      onSelectionChange?.({ ids, data });\n      selectedIdsRef.current = new Set<K>();\n    }\n  };\n\n  // if mode is 'off', we still want to show the toggleButton.\n  // pointerUp will not fire because browser will have already claimed the\n  // pointer\n  const onTouchEnd = (event: TouchEvent) => {\n    setIsPointerDown(false);\n    setFinalPoint(undefined);\n    initialPointRef.current = undefined;\n    numOfActiveTouches.current = event.touches.length;\n  };\n\n  const onTouchStart = (event: TouchEvent) => {\n    numOfActiveTouches.current = event.touches.length;\n  };\n\n  let marqueeContent: VNode | undefined;\n\n  const isPointInsideMarquee =\n    mode === 'select' && dims\n      ? (id: K, point: { x: number; y: number }) => {\n          if (initialPointRef.current?.isMeta && selectedIds?.has(id)) {\n            return true;\n          }\n          const { x1, x2, y1, y2 } = dims;\n          const { x, y } = point;\n          if (isPointInsideSpace(x, y, { x: x1, width: x2 - x1, y: y1, height: y2 - y1 })) {\n            selectedIdsRef.current?.add(id);\n            return true;\n          } else {\n            selectedIdsRef.current?.delete(id);\n          }\n          return false;\n        }\n      : undefined;\n\n  if (dims && (mode === 'zoom' || mode === 'select')) {\n    marqueeContent = <Marquee {...dims} />;\n  }\n\n  return {\n    ignoreSelectPointerUp: (mode === 'pan' || mode === 'zoom') && isDragActiveRef.current,\n    cursor: getCursorType(mode, isPointerDown),\n    yAxisCursor: mode !== 'zoom' ? getCursorType(mode, isPointerDown) : 'initial',\n    marqueeContent,\n    toggleButtonContent:\n      !isPointerDown &&\n      ((!isDeviceTouch && isHovered.current) || isDeviceTouch) &&\n      toggleButtonContent,\n    isPointInsideMarquee,\n    dragMode: mode,\n    marqueeProps:\n      dragMode != 'off'\n        ? {\n            onPointerDown,\n            onPointerMove,\n            onPointerUp,\n            onPointerLeave,\n            onPointerEnter,\n            onTouchEnd,\n            onTouchStart\n          }\n        : {}\n  };\n}\n"],"names":["getCursorType","currentDragMode","isPointerDown","isPointInsideSpace","x","y","space","width","height","isPointOutsideTargetSpace","plotAreaSpace","xSpace","ySpace","Marquee","x1","y1","_jsxs","_Fragment","children","_jsx","class","styles","visMarquee","Math","max","visMarqueeInnerArea","rootRef","dragMode","chartWidth","isMultiSelection","onViewportChange","isZoomScroll","xScale","selectedIds","getDataById","onSelectionChange","isRtl","xAxisInfo","isDeviceTouch","isTouch","isHovered","useRef","numOfActiveTouches","min","viewportMax","viewportMin","minAxisExtent","initialPointRef","showPanButton","isZoomAndScroll","isMobile","getPanButtonVisibility","showZoomButton","getZoomButtonVisibility","showSelectButton","getSelectButtonVisibility","dragButtonDivRef","toggleButtonContent","userDragMode","useVisDragModeControls","componentWidth","setIsPointerDown","useState","isDragActiveRef","finalPoint","setFinalPoint","selectedIdsRef","Set","mode","isUserDragModeButtonShown","userSelectedDragMode","undefined","getResolvedDragMode","dims","initialPoint","treatAsXSpace","spaceWidth","spaceHeight","x2","y2","abs","getMarqueeDims","current","marqueeContent","isPointInsideMarquee","id","point","isMeta","has","add","delete","ignoreSelectPointerUp","cursor","yAxisCursor","marqueeProps","onPointerDown","event","contains","target","offsetX","offsetY","onPointerMove","metaKey","elementData","getElementData","elemType","axisDelta","invert","viewportRange","xMin","xMax","onPointerUp","mid","ids","data","map","onPointerLeave","currentTarget","setPointerCapture","pointerId","onPointerEnter","onTouchEnd","touches","length","onTouchStart"],"mappings":"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"}